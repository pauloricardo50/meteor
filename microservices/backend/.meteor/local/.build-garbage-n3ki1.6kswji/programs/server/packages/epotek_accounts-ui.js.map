{"version":3,"sources":["meteor://ðŸ’»app/packages/epotek:accounts-ui/check-npm.js","meteor://ðŸ’»app/packages/epotek:accounts-ui/main_server.js","meteor://ðŸ’»app/packages/epotek:accounts-ui/imports/accounts_ui.js","meteor://ðŸ’»app/packages/epotek:accounts-ui/imports/helpers.js","meteor://ðŸ’»app/packages/epotek:accounts-ui/imports/login_session.js","meteor://ðŸ’»app/packages/epotek:accounts-ui/imports/api/server/loginWithoutPassword.js","meteor://ðŸ’»app/packages/epotek:accounts-ui/imports/api/server/servicesListPublication.js","meteor://ðŸ’»app/packages/epotek:accounts-ui/imports/ui/components/Button.jsx","meteor://ðŸ’»app/packages/epotek:accounts-ui/imports/ui/components/Buttons.jsx","meteor://ðŸ’»app/packages/epotek:accounts-ui/imports/ui/components/Field.jsx","meteor://ðŸ’»app/packages/epotek:accounts-ui/imports/ui/components/Fields.jsx","meteor://ðŸ’»app/packages/epotek:accounts-ui/imports/ui/components/Form.jsx","meteor://ðŸ’»app/packages/epotek:accounts-ui/imports/ui/components/FormMessage.jsx","meteor://ðŸ’»app/packages/epotek:accounts-ui/imports/ui/components/FormMessages.jsx","meteor://ðŸ’»app/packages/epotek:accounts-ui/imports/ui/components/LoginForm.jsx","meteor://ðŸ’»app/packages/epotek:accounts-ui/imports/ui/components/PasswordOrService.jsx","meteor://ðŸ’»app/packages/epotek:accounts-ui/imports/ui/components/SocialButtons.jsx"],"names":["module","export","default","LoginForm","Accounts","STATES","link","v","redirect","validatePassword","validateEmail","validateUsername","ui","_options","requestPermissions","requestOfflineToken","forceApprovalPrompt","requireEmailVerification","passwordSignupFields","minimumPasswordLength","loginPath","signUpPath","resetPasswordPath","profilePath","changePasswordPath","homeRoutePath","onSubmitHook","onPreSignUpHook","Promise","resolve","onPostSignUpHook","onEnrollAccountHook","onResetPasswordHook","onVerifyEmailHook","onSignedInHook","onSignedOutHook","emailPattern","RegExp","config","options","VALID_KEYS","Object","keys","forEach","key","includes","Error","service","scope","Array","value","hook","path","exportDefault","loginButtonsSession","getLoginServices","hasPasswordService","loginResultCallback","capitalize","browserHistory","require","e","_loginButtonsSession","SIGN_IN","Symbol","SIGN_UP","PROFILE","PASSWORD_CHANGE","PASSWORD_RESET","ENROLL_ACCOUNT","services","Package","oauth","serviceNames","sort","map","name","err","LoginCancelledError","ServiceConfiguration","ConfigError","Meteor","isClient","window","location","href","email","showMessage","clearMessage","test","length","password","errMsg","username","formState","fieldName","history","setTimeout","FlowRouter","go","push","pushState","string","replace","split","word","charAt","toUpperCase","slice","join","validateKey","KEY_PREFIX","set","_set","Session","get","onPageLoadLogin","attemptInfo","type","error","doneCallback","onResetPasswordLink","token","done","onEnrollmentLink","onEmailVerificationLink","verifyEmail","methods","loginWithoutPassword","check","String","user","users","findOne","$or","$exists","emails","address","verified","sendLoginEmail","_id","userId","find","tokenRecord","Random","secret","when","Date","update","$push","_ensure","verificationTokens","loginUrl","urls","to","from","emailTemplates","loginNoPassword","subject","text","html","headers","Email","send","siteName","url","greeting","profile","publish","fields","Button","React","PropTypes","Link","Component","render","label","disabled","className","onClick","props","propTypes","func","Buttons","buttons","id","i","Field","constructor","state","mount","triggerUpdate","onChange","input","target","componentDidMount","componentDidUpdate","prevProps","setState","hint","required","defaultValue","message","ref","trim","Fields","Form","ReactDOM","form","addEventListener","preventDefault","oauthServices","messages","translate","ready","object","isRequired","bool","FormMessage","isObject","obj","style","deprecated","console","warn","FormMessages","filter","withTracker","T9n","indexBy","array","result","waiting","bind","prevState","changeState","getDefaultFieldValues","componentWillReceiveProps","nextProps","nextContext","validateField","field","getUsernameOrEmailField","handleChange","getMessageForField","getUsernameField","getEmailField","getPasswordField","getSetPasswordField","getNewPasswordField","evt","setDefaultFieldValues","loginFields","assign","showPasswordChangeForm","showEnrollAccountForm","loginButtons","signOut","showCreateAccountLink","switchToSignUp","switchToSignIn","showForgotPasswordLink","switchToPasswordReset","switchToChangePassword","signUp","showSignInLink","signIn","passwordReset","passwordChange","switchToSignOut","cancelResetPassword","a","b","undefined","forbidClientAccountCreation","defaults","localStorage","setItem","JSON","stringify","defaultFieldValues","parse","getItem","clearDefaultFieldValues","removeItem","event","clearMessages","logout","usernameOrEmail","loginSelector","loginWithPassword","reason","oauthButtons","oauthSignIn","serviceName","capitalService","loginWithService","self","uuid","SignUp","createUser","promise","then","forgotPassword","newPassword","resetPassword","changePassword","clearTimeout","hideMessageTimout","componentWillMount","container","document","createElement","getElementsByClassName","componentWillUnmount","symbol","defaultProps","LoginFormContainer","subscribe","PasswordOrService","labels","SocialButtons"],"mappings":"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","file":"/packages/epotek_accounts-ui.js","sourcesContent":["// import { checkNpmVersions } from 'meteor/tmeasday:check-npm-versions';\n//\n// checkNpmVersions({\n//   \"react\": \">=0.14.7 || ^15.0.0-rc.2\",\n//   \"react-dom\": \">=0.14.7 || ^15.0.0-rc.2\",\n// });\n","import { Accounts } from 'meteor/accounts-base';\nimport './imports/accounts_ui.js';\nimport './imports/login_session.js';\nimport { redirect, STATES } from './imports/helpers.js';\nimport './imports/api/server/loginWithoutPassword.js';\nimport './imports/api/server/servicesListPublication.js';\nimport LoginForm from './imports/ui/components/LoginForm.jsx';\n\nexport { LoginForm as default, Accounts, STATES };\n","import { Accounts } from 'meteor/accounts-base';\nimport {\n  redirect,\n  validatePassword,\n  validateEmail,\n  validateUsername\n} from './helpers.js';\n\n/**\n * @summary Accounts UI\n * @namespace\n * @memberOf Accounts\n */\nAccounts.ui = {};\n\nAccounts.ui._options = {\n  requestPermissions: [],\n  requestOfflineToken: {},\n  forceApprovalPrompt: {},\n  requireEmailVerification: false,\n  passwordSignupFields: 'EMAIL_ONLY_NO_PASSWORD',\n  minimumPasswordLength: 7,\n  loginPath: '/',\n  signUpPath: null,\n  resetPasswordPath: null,\n  profilePath: '/',\n  changePasswordPath: null,\n  homeRoutePath: '/',\n  onSubmitHook: () => {},\n  onPreSignUpHook: () => new Promise(resolve => resolve()),\n  onPostSignUpHook: () => {},\n  onEnrollAccountHook: () => redirect(`${Accounts.ui._options.loginPath}`),\n  onResetPasswordHook: () => redirect(`${Accounts.ui._options.loginPath}`),\n  onVerifyEmailHook: () => redirect(`${Accounts.ui._options.profilePath}`),\n  onSignedInHook: () => redirect(`${Accounts.ui._options.homeRoutePath}`),\n  onSignedOutHook: () => redirect(`${Accounts.ui._options.homeRoutePath}`),\n  emailPattern: new RegExp('[^@]+@[^@.]{2,}.[^.@]+')\n};\n\n/**\n * @summary Configure the behavior of [`<Accounts.ui.LoginForm />`](#react-accounts-ui).\n * @anywhere\n * @param {Object} options\n * @param {Object} options.requestPermissions Which [permissions](#requestpermissions) to request from the user for each external service.\n * @param {Object} options.requestOfflineToken To ask the user for permission to act on their behalf when offline, map the relevant external service to `true`. Currently only supported with Google. See [Meteor.loginWithExternalService](#meteor_loginwithexternalservice) for more details.\n * @param {Object} options.forceApprovalPrompt If true, forces the user to approve the app's permissions, even if previously approved. Currently only supported with Google.\n * @param {String} options.passwordSignupFields Which fields to display in the user creation form. One of '`USERNAME_AND_EMAIL`', '`USERNAME_AND_OPTIONAL_EMAIL`', '`USERNAME_ONLY`', '`EMAIL_ONLY`', or '`NO_PASSWORD`' (default).\n */\nAccounts.ui.config = function(options) {\n  // validate options keys\n  const VALID_KEYS = [\n    'passwordSignupFields',\n    'requestPermissions',\n    'requestOfflineToken',\n    'forbidClientAccountCreation',\n    'requireEmailVerification',\n    'minimumPasswordLength',\n    'loginPath',\n    'signUpPath',\n    'resetPasswordPath',\n    'profilePath',\n    'changePasswordPath',\n    'homeRoutePath',\n    'onSubmitHook',\n    'onPreSignUpHook',\n    'onPostSignUpHook',\n    'onEnrollAccountHook',\n    'onResetPasswordHook',\n    'onVerifyEmailHook',\n    'onSignedInHook',\n    'onSignedOutHook',\n    'validateField',\n    'emailPattern'\n  ];\n\n  Object.keys(options).forEach(function(key) {\n    if (!VALID_KEYS.includes(key))\n      throw new Error('Accounts.ui.config: Invalid key: ' + key);\n  });\n\n  // Deal with `passwordSignupFields`\n  if (options.passwordSignupFields) {\n    if (\n      [\n        'USERNAME_AND_EMAIL',\n        'USERNAME_AND_OPTIONAL_EMAIL',\n        'USERNAME_ONLY',\n        'EMAIL_ONLY',\n        'EMAIL_ONLY_NO_PASSWORD',\n        'USERNAME_AND_EMAIL_NO_PASSWORD'\n      ].includes(options.passwordSignupFields)\n    ) {\n      Accounts.ui._options.passwordSignupFields = options.passwordSignupFields;\n    } else {\n      throw new Error(\n        'Accounts.ui.config: Invalid option for `passwordSignupFields`: ' +\n          options.passwordSignupFields\n      );\n    }\n  }\n\n  // Deal with `requestPermissions`\n  if (options.requestPermissions) {\n    Object.keys(options.requestPermissions).forEach(service => {\n      const scope = options.requestPermissions[service];\n      if (Accounts.ui._options.requestPermissions[service]) {\n        throw new Error(\n          \"Accounts.ui.config: Can't set `requestPermissions` more than once for \" +\n            service\n        );\n      } else if (!(scope instanceof Array)) {\n        throw new Error(\n          'Accounts.ui.config: Value for `requestPermissions` must be an array'\n        );\n      } else {\n        Accounts.ui._options.requestPermissions[service] = scope;\n      }\n    });\n  }\n\n  // Deal with `requestOfflineToken`\n  if (options.requestOfflineToken) {\n    Object.keys(options.requestOfflineToken).forEach(service => {\n      const value = options.requestOfflineToken[service];\n      if (service !== 'google')\n        throw new Error(\n          'Accounts.ui.config: `requestOfflineToken` only supported for Google login at the moment.'\n        );\n\n      if (Accounts.ui._options.requestOfflineToken[service]) {\n        throw new Error(\n          \"Accounts.ui.config: Can't set `requestOfflineToken` more than once for \" +\n            service\n        );\n      } else {\n        Accounts.ui._options.requestOfflineToken[service] = value;\n      }\n    });\n  }\n\n  // Deal with `forceApprovalPrompt`\n  if (options.forceApprovalPrompt) {\n    Object.keys(options.forceApprovalPrompt).forEach(service => {\n      const value = options.forceApprovalPrompt[service];\n      if (service !== 'google')\n        throw new Error(\n          'Accounts.ui.config: `forceApprovalPrompt` only supported for Google login at the moment.'\n        );\n\n      if (Accounts.ui._options.forceApprovalPrompt[service]) {\n        throw new Error(\n          \"Accounts.ui.config: Can't set `forceApprovalPrompt` more than once for \" +\n            service\n        );\n      } else {\n        Accounts.ui._options.forceApprovalPrompt[service] = value;\n      }\n    });\n  }\n\n  // Deal with `requireEmailVerification`\n  if (options.requireEmailVerification) {\n    if (typeof options.requireEmailVerification != 'boolean') {\n      throw new Error(\n        `Accounts.ui.config: \"requireEmailVerification\" not a boolean`\n      );\n    } else {\n      Accounts.ui._options.requireEmailVerification =\n        options.requireEmailVerification;\n    }\n  }\n\n  // Deal with `minimumPasswordLength`\n  if (options.minimumPasswordLength) {\n    if (typeof options.minimumPasswordLength != 'number') {\n      throw new Error(\n        `Accounts.ui.config: \"minimumPasswordLength\" not a number`\n      );\n    } else {\n      Accounts.ui._options.minimumPasswordLength =\n        options.minimumPasswordLength;\n    }\n  }\n\n  // Deal with the hooks.\n  for (let hook of ['onSubmitHook', 'onPreSignUpHook', 'onPostSignUpHook']) {\n    if (options[hook]) {\n      if (typeof options[hook] != 'function') {\n        throw new Error(`Accounts.ui.config: \"${hook}\" not a function`);\n      } else {\n        Accounts.ui._options[hook] = options[hook];\n      }\n    }\n  }\n\n  // Deal with pattern.\n  for (let hook of ['emailPattern']) {\n    if (options[hook]) {\n      if (!(options[hook] instanceof RegExp)) {\n        throw new Error(\n          `Accounts.ui.config: \"${hook}\" not a Regular Expression`\n        );\n      } else {\n        Accounts.ui._options[hook] = options[hook];\n      }\n    }\n  }\n\n  // deal with the paths.\n  for (let path of [\n    'loginPath',\n    'signUpPath',\n    'resetPasswordPath',\n    'profilePath',\n    'changePasswordPath',\n    'homeRoutePath'\n  ]) {\n    if (typeof options[path] !== 'undefined') {\n      if (options[path] !== null && typeof options[path] !== 'string') {\n        throw new Error(`Accounts.ui.config: ${path} is not a string or null`);\n      } else {\n        Accounts.ui._options[path] = options[path];\n      }\n    }\n  }\n\n  // deal with redirect hooks.\n  for (let hook of [\n    'onEnrollAccountHook',\n    'onResetPasswordHook',\n    'onVerifyEmailHook',\n    'onSignedInHook',\n    'onSignedOutHook'\n  ]) {\n    if (options[hook]) {\n      if (typeof options[hook] == 'function') {\n        Accounts.ui._options[hook] = options[hook];\n      } else if (typeof options[hook] == 'string') {\n        Accounts.ui._options[hook] = () => redirect(options[hook]);\n      } else {\n        throw new Error(\n          `Accounts.ui.config: \"${hook}\" not a function or an absolute or relative path`\n        );\n      }\n    }\n  }\n};\n\nexport default Accounts;\n","let browserHistory;\ntry {\n  browserHistory = require('react-router').browserHistory;\n} catch (e) {}\nexport const loginButtonsSession = Accounts._loginButtonsSession;\nexport const STATES = {\n  SIGN_IN: Symbol('SIGN_IN'),\n  SIGN_UP: Symbol('SIGN_UP'),\n  PROFILE: Symbol('PROFILE'),\n  PASSWORD_CHANGE: Symbol('PASSWORD_CHANGE'),\n  PASSWORD_RESET: Symbol('PASSWORD_RESET'),\n  ENROLL_ACCOUNT: Symbol('ENROLL_ACCOUNT')\n};\n\nexport function getLoginServices() {\n  // First look for OAuth services.\n  const services = Package['accounts-oauth']\n    ? Accounts.oauth.serviceNames()\n    : [];\n\n  // Be equally kind to all login services. This also preserves\n  // backwards-compatibility.\n  services.sort();\n\n  return services.map(function(name) {\n    return { name: name };\n  });\n}\n// Export getLoginServices using old style globals for accounts-base which\n// requires it.\nthis.getLoginServices = getLoginServices;\n\nexport function hasPasswordService() {\n  // First look for OAuth services.\n  return !!Package['accounts-password'];\n}\n\nexport function loginResultCallback(service, err) {\n  if (!err) {\n  } else if (err instanceof Accounts.LoginCancelledError) {\n    // do nothing\n  } else if (err instanceof ServiceConfiguration.ConfigError) {\n  } else {\n    //loginButtonsSession.errorMessage(err.reason || \"Unknown error\");\n  }\n\n  if (Meteor.isClient) {\n    if (typeof redirect === 'string') {\n      window.location.href = '/';\n    }\n\n    if (typeof service === 'function') {\n      service();\n    }\n  }\n}\n\nexport function passwordSignupFields() {\n  return Accounts.ui._options.passwordSignupFields || 'EMAIL_ONLY_NO_PASSWORD';\n}\n\nexport function validateEmail(email, showMessage, clearMessage) {\n  if (\n    passwordSignupFields() === 'USERNAME_AND_OPTIONAL_EMAIL' &&\n    email === ''\n  ) {\n    return true;\n  }\n  if (Accounts.ui._options.emailPattern.test(email)) {\n    return true;\n  } else if (!email || email.length === 0) {\n    showMessage('error.emailRequired', 'warning', false, 'email');\n    return false;\n  } else {\n    showMessage('error.accounts.Invalid email', 'warning', false, 'email');\n    return false;\n  }\n}\n\nexport function validatePassword(password = '', showMessage, clearMessage) {\n  if (password.length >= Accounts.ui._options.minimumPasswordLength) {\n    return true;\n  } else {\n    // const errMsg = T9n.get(\"error.minChar\").replace(/7/, Accounts.ui._options.minimumPasswordLength);\n    const errMsg = 'error.minChar';\n    showMessage(errMsg, 'warning', false, 'password');\n    return false;\n  }\n}\n\nexport function validateUsername(\n  username,\n  showMessage,\n  clearMessage,\n  formState\n) {\n  if (username) {\n    return true;\n  } else {\n    const fieldName =\n      passwordSignupFields() === 'USERNAME_ONLY' || formState === STATES.SIGN_UP\n        ? 'username'\n        : 'usernameOrEmail';\n    showMessage('error.usernameRequired', 'warning', false, fieldName);\n    return false;\n  }\n}\n\nexport function redirect(redirect) {\n  if (Meteor.isClient) {\n    if (window.history) {\n      // Run after all app specific redirects, i.e. to the login screen.\n      Meteor.setTimeout(() => {\n        if (Package['kadira:flow-router']) {\n          Package['kadira:flow-router'].FlowRouter.go(redirect);\n        } else if (Package['kadira:flow-router-ssr']) {\n          Package['kadira:flow-router-ssr'].FlowRouter.go(redirect);\n        } else if (browserHistory) {\n          browserHistory.push(redirect);\n        } else {\n          window.history.pushState({}, 'redirect', redirect);\n        }\n      }, 100);\n    }\n  }\n}\n\nexport function capitalize(string) {\n  return string\n    .replace(/\\-/, ' ')\n    .split(' ')\n    .map(word => {\n      return word.charAt(0).toUpperCase() + word.slice(1);\n    })\n    .join(' ');\n}\n","import { Accounts } from 'meteor/accounts-base';\nimport { STATES, loginResultCallback, getLoginServices } from './helpers.js';\n\nconst VALID_KEYS = [\n  'dropdownVisible',\n\n  // XXX consider replacing these with one key that has an enum for values.\n  'inSignupFlow',\n  'inForgotPasswordFlow',\n  'inChangePasswordFlow',\n  'inMessageOnlyFlow',\n\n  'errorMessage',\n  'infoMessage',\n\n  // dialogs with messages (info and error)\n  'resetPasswordToken',\n  'enrollAccountToken',\n  'justVerifiedEmail',\n  'justResetPassword',\n\n  'configureLoginServiceDialogVisible',\n  'configureLoginServiceDialogServiceName',\n  'configureLoginServiceDialogSaveDisabled',\n  'configureOnDesktopVisible'\n];\n\nexport const validateKey = function(key) {\n  if (!VALID_KEYS.includes(key))\n    throw new Error('Invalid key in loginButtonsSession: ' + key);\n};\n\nexport const KEY_PREFIX = 'Meteor.loginButtons.';\n\n// XXX This should probably be package scope rather than exported\n// (there was even a comment to that effect here from before we had\n// namespacing) but accounts-ui-viewer uses it, so leave it as is for\n// now\nAccounts._loginButtonsSession = {\n  set: function(key, value) {\n    validateKey(key);\n    if (['errorMessage', 'infoMessage'].includes(key))\n      throw new Error(\n        \"Don't set errorMessage or infoMessage directly. Instead, use errorMessage() or infoMessage().\"\n      );\n\n    this._set(key, value);\n  },\n\n  _set: function(key, value) {\n    Session.set(KEY_PREFIX + key, value);\n  },\n\n  get: function(key) {\n    validateKey(key);\n    return Session.get(KEY_PREFIX + key);\n  }\n};\n\nif (Meteor.isClient) {\n  // In the login redirect flow, we'll have the result of the login\n  // attempt at page load time when we're redirected back to the\n  // application.  Register a callback to update the UI (i.e. to close\n  // the dialog on a successful login or display the error on a failed\n  // login).\n  //\n  Accounts.onPageLoadLogin(function(attemptInfo) {\n    // Ignore if we have a left over login attempt for a service that is no longer registered.\n    if (\n      getLoginServices()\n        .map(({ name }) => name)\n        .includes(attemptInfo.type)\n    )\n      loginResultCallback(attemptInfo.type, attemptInfo.error);\n  });\n\n  let doneCallback;\n\n  Accounts.onResetPasswordLink(function(token, done) {\n    Accounts._loginButtonsSession.set('resetPasswordToken', token);\n    Session.set(KEY_PREFIX + 'state', 'resetPasswordToken');\n    doneCallback = done;\n\n    Accounts.ui._options.onResetPasswordHook();\n  });\n\n  Accounts.onEnrollmentLink(function(token, done) {\n    Accounts._loginButtonsSession.set('enrollAccountToken', token);\n    Session.set(KEY_PREFIX + 'state', 'enrollAccountToken');\n    doneCallback = done;\n\n    Accounts.ui._options.onEnrollAccountHook();\n  });\n\n  Accounts.onEmailVerificationLink(function(token, done) {\n    Accounts.verifyEmail(token, function(error) {\n      if (!error) {\n        Accounts._loginButtonsSession.set('justVerifiedEmail', true);\n        Session.set(KEY_PREFIX + 'state', 'justVerifiedEmail');\n        Accounts.ui._options.onSignedInHook();\n      } else {\n        Accounts.ui._options.onVerifyEmailHook();\n      }\n\n      done();\n    });\n  });\n}\n","import { Meteor } from 'meteor/meteor';\nimport { Accounts } from 'meteor/accounts-base';\n\n///\n/// LOGIN WITHOUT PASSWORD\n///\n\n// Method called by a user to request a password reset email. This is\n// the start of the reset process.\nMeteor.methods({\n  loginWithoutPassword: function({ email, username = null }) {\n    if (username !== null) {\n      check(username, String);\n\n      var user = Meteor.users.findOne({\n        $or: [\n          {\n            username: username,\n            'emails.address': { $exists: 1 }\n          },\n          {\n            'emails.address': email\n          }\n        ]\n      });\n      if (!user) throw new Meteor.Error(403, 'User not found');\n\n      email = user.emails[0].address;\n    } else {\n      check(email, String);\n\n      var user = Meteor.users.findOne({ 'emails.address': email });\n      if (!user) throw new Meteor.Error(403, 'User not found');\n    }\n\n    if (Accounts.ui._options.requireEmailVerification) {\n      if (!user.emails[0].verified) {\n        throw new Meteor.Error(403, 'Email not verified');\n      }\n    }\n\n    Accounts.sendLoginEmail(user._id, email);\n  }\n});\n\n/**\n * @summary Send an email with a link the user can use verify their email address.\n * @locus Server\n * @param {String} userId The id of the user to send email to.\n * @param {String} [email] Optional. Which address of the user's to send the email to. This address must be in the user's `emails` list. Defaults to the first unverified email in the list.\n */\nAccounts.sendLoginEmail = function(userId, address) {\n  // XXX Also generate a link using which someone can delete this\n  // account if they own said address but weren't those who created\n  // this account.\n\n  // Make sure the user exists, and address is one of their addresses.\n  var user = Meteor.users.findOne(userId);\n  if (!user) throw new Error(\"Can't find user\");\n  // pick the first unverified address if we weren't passed an address.\n  if (!address) {\n    var email = (user.emails || []).find(({ verified }) => !verified);\n    address = (email || {}).address;\n  }\n  // make sure we have a valid address\n  if (\n    !address ||\n    !(user.emails || []).map(({ address }) => address).includes(address)\n  )\n    throw new Error('No such email address for user.');\n\n  var tokenRecord = {\n    token: Random.secret(),\n    address: address,\n    when: new Date()\n  };\n  Meteor.users.update(\n    { _id: userId },\n    { $push: { 'services.email.verificationTokens': tokenRecord } }\n  );\n\n  // before passing to template, update user object with new token\n  Meteor._ensure(user, 'services', 'email');\n  if (!user.services.email.verificationTokens) {\n    user.services.email.verificationTokens = [];\n  }\n  user.services.email.verificationTokens.push(tokenRecord);\n\n  var loginUrl = Accounts.urls.verifyEmail(tokenRecord.token);\n\n  var options = {\n    to: address,\n    from: Accounts.emailTemplates.loginNoPassword.from\n      ? Accounts.emailTemplates.loginNoPassword.from(user)\n      : Accounts.emailTemplates.from,\n    subject: Accounts.emailTemplates.loginNoPassword.subject(user)\n  };\n\n  if (typeof Accounts.emailTemplates.loginNoPassword.text === 'function') {\n    options.text = Accounts.emailTemplates.loginNoPassword.text(user, loginUrl);\n  }\n\n  if (typeof Accounts.emailTemplates.loginNoPassword.html === 'function')\n    options.html = Accounts.emailTemplates.loginNoPassword.html(user, loginUrl);\n\n  if (typeof Accounts.emailTemplates.headers === 'object') {\n    options.headers = Accounts.emailTemplates.headers;\n  }\n\n  Email.send(options);\n};\n\n// Check for installed accounts-password dependency.\nif (Accounts.emailTemplates) {\n  Accounts.emailTemplates.loginNoPassword = {\n    subject: function(user) {\n      return 'Login on ' + Accounts.emailTemplates.siteName;\n    },\n    text: function(user, url) {\n      var greeting =\n        user.profile && user.profile.name\n          ? 'Hello ' + user.profile.name + ','\n          : 'Hello,';\n      return `${greeting}\nTo login, simply click the link below.\n${url}\nThanks.\n`;\n    }\n  };\n}\n","import { Meteor } from 'meteor/meteor';\nimport { getLoginServices } from '../../helpers.js';\n\nMeteor.publish('servicesList', function() {\n  let services = getLoginServices();\n  if (Package['accounts-password']) {\n    services.push({ name: 'password' });\n  }\n  let fields = {};\n  // Publish the existing services for a user, only name or nothing else.\n  services.forEach(service => (fields[`services.${service.name}.name`] = 1));\n  return Meteor.users.find({ _id: this.userId }, { fields: fields });\n});\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Accounts } from 'meteor/accounts-base';\n\nlet Link;\ntry {\n  Link = require('react-router').Link;\n} catch (e) {}\n\nexport class Button extends React.Component {\n  render() {\n    const {\n      label,\n      href = null,\n      type,\n      disabled = false,\n      className,\n      onClick\n    } = this.props;\n    if (type == 'link') {\n      // Support React Router.\n      if (Link && href) {\n        return (\n          <Link to={href} className={className}>\n            {label}\n          </Link>\n        );\n      } else {\n        return (\n          <a href={href} className={className} onClick={onClick}>\n            {label}\n          </a>\n        );\n      }\n    }\n    return (\n      <button\n        className={className}\n        type={type}\n        disabled={disabled}\n        onClick={onClick}\n      >\n        {label}\n      </button>\n    );\n  }\n}\n\nButton.propTypes = {\n  onClick: PropTypes.func\n};\n\nAccounts.ui.Button = Button;\n","import React from 'react';\nimport './Button.jsx';\nimport { Accounts } from 'meteor/accounts-base';\n\nexport class Buttons extends React.Component {\n  render() {\n    let { buttons = {}, className = 'buttons' } = this.props;\n    return (\n      <div className={className}>\n        {Object.keys(buttons).map((id, i) => (\n          <Accounts.ui.Button {...buttons[id]} key={i} />\n        ))}\n      </div>\n    );\n  }\n}\n\nAccounts.ui.Buttons = Buttons;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Accounts } from 'meteor/accounts-base';\n\nexport class Field extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      mount: true\n    };\n  }\n\n  triggerUpdate() {\n    // Trigger an onChange on inital load, to support browser prefilled values.\n    const { onChange } = this.props;\n    if (this.input && onChange) {\n      onChange({ target: { value: this.input.value } });\n    }\n  }\n\n  componentDidMount() {\n    this.triggerUpdate();\n  }\n\n  componentDidUpdate(prevProps) {\n    // Re-mount component so that we don't expose browser prefilled passwords if the component was\n    // a password before and now something else.\n    if (prevProps.id !== this.props.id) {\n      this.setState({ mount: false });\n    } else if (!this.state.mount) {\n      this.setState({ mount: true });\n      this.triggerUpdate();\n    }\n  }\n\n  render() {\n    const {\n      id,\n      hint,\n      label,\n      type = 'text',\n      onChange,\n      required = false,\n      className = 'field',\n      defaultValue = '',\n      message\n    } = this.props;\n    const { mount = true } = this.state;\n    if (type == 'notice') {\n      return <div className={className}>{label}</div>;\n    }\n    return mount ? (\n      <div className={className}>\n        <label htmlFor={id}>{label}</label>\n        <input\n          id={id}\n          ref={ref => (this.input = ref)}\n          type={type}\n          onChange={onChange}\n          placeholder={hint}\n          defaultValue={defaultValue}\n        />\n        {message && (\n          <span className={['message', message.type].join(' ').trim()}>\n            {message.message}\n          </span>\n        )}\n      </div>\n    ) : null;\n  }\n}\n\nField.propTypes = {\n  onChange: PropTypes.func\n};\n\nAccounts.ui.Field = Field;\n","import React from 'react';\nimport { Accounts } from 'meteor/accounts-base';\nimport './Field.jsx';\n\nexport class Fields extends React.Component {\n  render() {\n    let { fields = {}, className = 'fields' } = this.props;\n    return (\n      <div className={className}>\n        {Object.keys(fields).map((id, i) => (\n          <Accounts.ui.Field {...fields[id]} key={i} />\n        ))}\n      </div>\n    );\n  }\n}\n\nAccounts.ui.Fields = Fields;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport ReactDOM from 'react-dom';\nimport { Accounts } from 'meteor/accounts-base';\n\nimport './Fields.jsx';\nimport './Buttons.jsx';\nimport './FormMessage.jsx';\nimport './PasswordOrService.jsx';\nimport './SocialButtons.jsx';\nimport './FormMessages.jsx';\n\nexport class Form extends React.Component {\n  componentDidMount() {\n    let form = this.form;\n    if (form) {\n      form.addEventListener('submit', e => {\n        e.preventDefault();\n      });\n    }\n  }\n\n  render() {\n    const {\n      hasPasswordService,\n      oauthServices,\n      fields,\n      buttons,\n      error,\n      messages,\n      translate,\n      ready = true,\n      className\n    } = this.props;\n    return (\n      <form\n        ref={ref => (this.form = ref)}\n        className={[className, ready ? 'ready' : null].join(' ')}\n        className=\"accounts-ui\"\n        noValidate\n      >\n        <Accounts.ui.Fields fields={fields} />\n        <Accounts.ui.Buttons buttons={buttons} />\n        <Accounts.ui.PasswordOrService\n          oauthServices={oauthServices}\n          translate={translate}\n        />\n        <Accounts.ui.SocialButtons oauthServices={oauthServices} />\n        <Accounts.ui.FormMessages messages={messages} />\n      </form>\n    );\n  }\n}\n\nForm.propTypes = {\n  oauthServices: PropTypes.object,\n  fields: PropTypes.object.isRequired,\n  buttons: PropTypes.object.isRequired,\n  translate: PropTypes.func.isRequired,\n  error: PropTypes.string,\n  ready: PropTypes.bool\n};\n\nAccounts.ui.Form = Form;\n","import React from 'react';\nimport { Accounts } from 'meteor/accounts-base';\n\nfunction isObject(obj) {\n  return obj === Object(obj);\n}\n\nexport class FormMessage extends React.Component {\n  render() {\n    let {\n      message,\n      type,\n      className = 'message',\n      style = {},\n      deprecated\n    } = this.props;\n    // XXX Check for deprecations.\n    if (deprecated) {\n      // Found backwords compatibility issue.\n      console.warn(\n        'You are overriding Accounts.ui.Form and using FormMessage, the use of FormMessage in Form has been depreacted in v1.2.11, update your implementation to use FormMessages: https://github.com/studiointeract/accounts-ui/#deprecations'\n      );\n    }\n    message = isObject(message) ? message.message : message; // If message is object, then try to get message from it\n    return message ? (\n      <div style={style} className={[className, type].join(' ')}>\n        {message}\n      </div>\n    ) : null;\n  }\n}\n\nAccounts.ui.FormMessage = FormMessage;\n","import React, { Component } from 'react';\nimport { Accounts } from 'meteor/accounts-base';\n\nexport class FormMessages extends Component {\n  render() {\n    const { messages = [], className = 'messages', style = {} } = this.props;\n    return (\n      messages.length > 0 && (\n        <div className=\"messages\">\n          {messages\n            .filter(message => !('field' in message))\n            .map(({ message, type }, i) => (\n              <Accounts.ui.FormMessage message={message} type={type} key={i} />\n            ))}\n        </div>\n      )\n    );\n  }\n}\n\nAccounts.ui.FormMessages = FormMessages;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport ReactDOM from 'react-dom';\nimport { withTracker } from 'meteor/react-meteor-data';\nimport { Accounts } from 'meteor/accounts-base';\nimport { T9n } from 'meteor-accounts-t9n';\nimport { KEY_PREFIX } from '../../login_session.js';\nimport './Form.jsx';\n\nimport {\n  STATES,\n  passwordSignupFields,\n  validateEmail,\n  validatePassword,\n  validateUsername,\n  loginResultCallback,\n  getLoginServices,\n  hasPasswordService,\n  capitalize\n} from '../../helpers.js';\n\nfunction indexBy(array, key) {\n  const result = {};\n  array.forEach(function(obj) {\n    result[obj[key]] = obj;\n  });\n  return result;\n}\n\nclass LoginForm extends Component {\n  constructor(props) {\n    super(props);\n    let {\n      formState,\n      loginPath,\n      signUpPath,\n      resetPasswordPath,\n      profilePath,\n      changePasswordPath\n    } = props;\n\n    if (formState === STATES.SIGN_IN && Package['accounts-password']) {\n      console.warn(\n        'Do not force the state to SIGN_IN on Accounts.ui.LoginForm, it will make it impossible to reset password in your app, this state is also the default state if logged out, so no need to force it.'\n      );\n    }\n\n    // Set inital state.\n    this.state = {\n      messages: [],\n      waiting: true,\n      formState: formState\n        ? formState\n        : Accounts.user()\n          ? STATES.PROFILE\n          : STATES.SIGN_IN,\n      onSubmitHook: props.onSubmitHook || Accounts.ui._options.onSubmitHook,\n      onSignedInHook:\n        props.onSignedInHook || Accounts.ui._options.onSignedInHook,\n      onSignedOutHook:\n        props.onSignedOutHook || Accounts.ui._options.onSignedOutHook,\n      onPreSignUpHook:\n        props.onPreSignUpHook || Accounts.ui._options.onPreSignUpHook,\n      onPostSignUpHook:\n        props.onPostSignUpHook || Accounts.ui._options.onPostSignUpHook\n    };\n    this.translate = this.translate.bind(this);\n  }\n\n  componentDidMount() {\n    this.setState(prevState => ({ waiting: false, ready: true }));\n    let changeState = Session.get(KEY_PREFIX + 'state');\n    switch (changeState) {\n      case 'enrollAccountToken':\n        this.setState(prevState => ({\n          formState: STATES.ENROLL_ACCOUNT\n        }));\n        Session.set(KEY_PREFIX + 'state', null);\n        break;\n      case 'resetPasswordToken':\n        this.setState(prevState => ({\n          formState: STATES.PASSWORD_CHANGE\n        }));\n        Session.set(KEY_PREFIX + 'state', null);\n        break;\n\n      case 'justVerifiedEmail':\n        this.setState(prevState => ({\n          formState: STATES.PROFILE\n        }));\n        Session.set(KEY_PREFIX + 'state', null);\n        break;\n    }\n\n    // Add default field values once the form did mount on the client\n    this.setState(prevState => ({\n      ...this.getDefaultFieldValues()\n    }));\n  }\n\n  componentWillReceiveProps(nextProps, nextContext) {\n    if (nextProps.formState && nextProps.formState !== this.state.formState) {\n      this.setState({\n        formState: nextProps.formState,\n        ...this.getDefaultFieldValues()\n      });\n    }\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (!prevProps.user !== !this.props.user) {\n      this.setState({\n        formState: this.props.user ? STATES.PROFILE : STATES.SIGN_IN\n      });\n    }\n  }\n\n  translate(text) {\n    // if (this.props.t) {\n    //   return this.props.t(text);\n    // }\n    return T9n.get(text);\n  }\n\n  validateField(field, value) {\n    const { formState } = this.state;\n    switch (field) {\n      case 'email':\n        return validateEmail(\n          value,\n          this.showMessage.bind(this),\n          this.clearMessage.bind(this)\n        );\n      case 'password':\n        return validatePassword(\n          value,\n          this.showMessage.bind(this),\n          this.clearMessage.bind(this)\n        );\n      case 'username':\n        return validateUsername(\n          value,\n          this.showMessage.bind(this),\n          this.clearMessage.bind(this),\n          formState\n        );\n    }\n  }\n\n  getUsernameOrEmailField() {\n    return {\n      id: 'usernameOrEmail',\n      hint: this.translate('enterUsernameOrEmail'),\n      label: this.translate('usernameOrEmail'),\n      required: true,\n      defaultValue: this.state.username || '',\n      onChange: this.handleChange.bind(this, 'usernameOrEmail'),\n      message: this.getMessageForField('usernameOrEmail')\n    };\n  }\n\n  getUsernameField() {\n    return {\n      id: 'username',\n      hint: this.translate('enterUsername'),\n      label: this.translate('username'),\n      required: true,\n      defaultValue: this.state.username || '',\n      onChange: this.handleChange.bind(this, 'username'),\n      message: this.getMessageForField('username')\n    };\n  }\n\n  getEmailField() {\n    return {\n      id: 'email',\n      hint: this.translate('enterEmail'),\n      label: this.translate('email'),\n      type: 'email',\n      required: true,\n      defaultValue: this.state.email || '',\n      onChange: this.handleChange.bind(this, 'email'),\n      message: this.getMessageForField('email')\n    };\n  }\n\n  getPasswordField() {\n    return {\n      id: 'password',\n      hint: this.translate('enterPassword'),\n      label: this.translate('password'),\n      type: 'password',\n      required: true,\n      defaultValue: this.state.password || '',\n      onChange: this.handleChange.bind(this, 'password'),\n      message: this.getMessageForField('password')\n    };\n  }\n\n  getSetPasswordField() {\n    return {\n      id: 'newPassword',\n      hint: this.translate('enterPassword'),\n      label: this.translate('choosePassword'),\n      type: 'password',\n      required: true,\n      onChange: this.handleChange.bind(this, 'newPassword')\n    };\n  }\n\n  getNewPasswordField() {\n    return {\n      id: 'newPassword',\n      hint: this.translate('enterNewPassword'),\n      label: this.translate('newPassword'),\n      type: 'password',\n      required: true,\n      onChange: this.handleChange.bind(this, 'newPassword'),\n      message: this.getMessageForField('newPassword')\n    };\n  }\n\n  handleChange(field, evt) {\n    let value = evt.target.value;\n    switch (field) {\n      case 'password':\n        break;\n      default:\n        value = value.trim();\n        break;\n    }\n    this.setState({ [field]: value });\n    this.setDefaultFieldValues({ [field]: value });\n  }\n\n  fields() {\n    const loginFields = [];\n    const { formState } = this.state;\n\n    if (!hasPasswordService() && getLoginServices().length == 0) {\n      loginFields.push({\n        label: 'No login service added, i.e. accounts-password',\n        type: 'notice'\n      });\n    }\n\n    if (hasPasswordService() && formState == STATES.SIGN_IN) {\n      if (\n        [\n          'USERNAME_AND_EMAIL',\n          'USERNAME_AND_OPTIONAL_EMAIL',\n          'USERNAME_AND_EMAIL_NO_PASSWORD'\n        ].includes(passwordSignupFields())\n      ) {\n        loginFields.push(this.getUsernameOrEmailField());\n      }\n\n      if (passwordSignupFields() === 'USERNAME_ONLY') {\n        loginFields.push(this.getUsernameField());\n      }\n\n      if (\n        ['EMAIL_ONLY', 'EMAIL_ONLY_NO_PASSWORD'].includes(\n          passwordSignupFields()\n        )\n      ) {\n        loginFields.push(this.getEmailField());\n      }\n\n      if (\n        !['EMAIL_ONLY_NO_PASSWORD', 'USERNAME_AND_EMAIL_NO_PASSWORD'].includes(\n          passwordSignupFields()\n        )\n      ) {\n        loginFields.push(this.getPasswordField());\n      }\n    }\n\n    if (hasPasswordService() && formState == STATES.SIGN_UP) {\n      if (\n        [\n          'USERNAME_AND_EMAIL',\n          'USERNAME_AND_OPTIONAL_EMAIL',\n          'USERNAME_ONLY',\n          'USERNAME_AND_EMAIL_NO_PASSWORD'\n        ].includes(passwordSignupFields())\n      ) {\n        loginFields.push(this.getUsernameField());\n      }\n\n      if (\n        [\n          'USERNAME_AND_EMAIL',\n          'EMAIL_ONLY',\n          'EMAIL_ONLY_NO_PASSWORD',\n          'USERNAME_AND_EMAIL_NO_PASSWORD'\n        ].includes(passwordSignupFields())\n      ) {\n        loginFields.push(this.getEmailField());\n      }\n\n      if (['USERNAME_AND_OPTIONAL_EMAIL'].includes(passwordSignupFields())) {\n        loginFields.push(\n          Object.assign(this.getEmailField(), { required: false })\n        );\n      }\n\n      if (\n        !['EMAIL_ONLY_NO_PASSWORD', 'USERNAME_AND_EMAIL_NO_PASSWORD'].includes(\n          passwordSignupFields()\n        )\n      ) {\n        loginFields.push(this.getPasswordField());\n      }\n    }\n\n    if (formState == STATES.PASSWORD_RESET) {\n      loginFields.push(this.getEmailField());\n    }\n\n    if (this.showPasswordChangeForm()) {\n      if (\n        Meteor.isClient &&\n        !Accounts._loginButtonsSession.get('resetPasswordToken')\n      ) {\n        loginFields.push(this.getPasswordField());\n      }\n      loginFields.push(this.getNewPasswordField());\n    }\n\n    if (this.showEnrollAccountForm()) {\n      loginFields.push(this.getSetPasswordField());\n    }\n    return indexBy(loginFields, 'id');\n  }\n\n  buttons() {\n    const {\n      loginPath = Accounts.ui._options.loginPath,\n      signUpPath = Accounts.ui._options.signUpPath,\n      resetPasswordPath = Accounts.ui._options.resetPasswordPath,\n      changePasswordPath = Accounts.ui._options.changePasswordPath,\n      profilePath = Accounts.ui._options.profilePath\n    } = this.props;\n    const { user } = this.props;\n    const { formState, waiting } = this.state;\n    let loginButtons = [];\n\n    if (user && formState == STATES.PROFILE) {\n      loginButtons.push({\n        id: 'signOut',\n        label: this.translate('signOut'),\n        disabled: waiting,\n        onClick: this.signOut.bind(this)\n      });\n    }\n\n    if (this.showCreateAccountLink()) {\n      loginButtons.push({\n        id: 'switchToSignUp',\n        label: this.translate('signUp'),\n        type: 'link',\n        href: signUpPath,\n        onClick: this.switchToSignUp.bind(this)\n      });\n    }\n\n    if (formState == STATES.SIGN_UP || formState == STATES.PASSWORD_RESET) {\n      loginButtons.push({\n        id: 'switchToSignIn',\n        label: this.translate('signIn'),\n        type: 'link',\n        href: loginPath,\n        onClick: this.switchToSignIn.bind(this)\n      });\n    }\n\n    if (this.showForgotPasswordLink()) {\n      loginButtons.push({\n        id: 'switchToPasswordReset',\n        label: this.translate('forgotPassword'),\n        type: 'link',\n        href: resetPasswordPath,\n        onClick: this.switchToPasswordReset.bind(this)\n      });\n    }\n\n    if (\n      user &&\n      !['EMAIL_ONLY_NO_PASSWORD', 'USERNAME_AND_EMAIL_NO_PASSWORD'].includes(\n        passwordSignupFields()\n      ) &&\n      formState == STATES.PROFILE &&\n      (user.services && 'password' in user.services)\n    ) {\n      loginButtons.push({\n        id: 'switchToChangePassword',\n        label: this.translate('changePassword'),\n        type: 'link',\n        href: changePasswordPath,\n        onClick: this.switchToChangePassword.bind(this)\n      });\n    }\n\n    if (formState == STATES.SIGN_UP) {\n      loginButtons.push({\n        id: 'signUp',\n        label: this.translate('signUp'),\n        type: hasPasswordService() ? 'submit' : 'link',\n        className: 'active',\n        disabled: waiting,\n        onClick: hasPasswordService() ? this.signUp.bind(this, {}) : null\n      });\n    }\n\n    if (this.showSignInLink()) {\n      loginButtons.push({\n        id: 'signIn',\n        label: this.translate('signIn'),\n        type: hasPasswordService() ? 'submit' : 'link',\n        className: 'active',\n        disabled: waiting,\n        onClick: hasPasswordService() ? this.signIn.bind(this) : null\n      });\n    }\n\n    if (formState == STATES.PASSWORD_RESET) {\n      loginButtons.push({\n        id: 'emailResetLink',\n        label: this.translate('resetYourPassword'),\n        type: 'submit',\n        disabled: waiting,\n        onClick: this.passwordReset.bind(this)\n      });\n    }\n\n    if (this.showPasswordChangeForm() || this.showEnrollAccountForm()) {\n      loginButtons.push({\n        id: 'changePassword',\n        label: this.showPasswordChangeForm()\n          ? this.translate('changePassword')\n          : this.translate('setPassword'),\n        type: 'submit',\n        disabled: waiting,\n        onClick: this.passwordChange.bind(this)\n      });\n\n      if (Accounts.user()) {\n        loginButtons.push({\n          id: 'switchToSignOut',\n          label: this.translate('cancel'),\n          type: 'link',\n          href: profilePath,\n          onClick: this.switchToSignOut.bind(this)\n        });\n      } else {\n        loginButtons.push({\n          id: 'cancelResetPassword',\n          label: this.translate('cancel'),\n          type: 'link',\n          onClick: this.cancelResetPassword.bind(this)\n        });\n      }\n    }\n\n    // Sort the button array so that the submit button always comes first, and\n    // buttons should also come before links.\n    loginButtons.sort((a, b) => {\n      return (\n        (b.type == 'submit' && a.type != undefined) -\n        (a.type == 'submit' && b.type != undefined)\n      );\n    });\n\n    return indexBy(loginButtons, 'id');\n  }\n\n  showSignInLink() {\n    return (\n      this.state.formState == STATES.SIGN_IN && Package['accounts-password']\n    );\n  }\n\n  showPasswordChangeForm() {\n    return (\n      Package['accounts-password'] &&\n      this.state.formState == STATES.PASSWORD_CHANGE\n    );\n  }\n\n  showEnrollAccountForm() {\n    return (\n      Package['accounts-password'] &&\n      this.state.formState == STATES.ENROLL_ACCOUNT\n    );\n  }\n\n  showCreateAccountLink() {\n    return (\n      this.state.formState == STATES.SIGN_IN &&\n      !Accounts._options.forbidClientAccountCreation &&\n      Package['accounts-password']\n    );\n  }\n\n  showForgotPasswordLink() {\n    return (\n      !this.props.user &&\n      this.state.formState == STATES.SIGN_IN &&\n      [\n        'USERNAME_AND_EMAIL',\n        'USERNAME_AND_OPTIONAL_EMAIL',\n        'EMAIL_ONLY'\n      ].includes(passwordSignupFields())\n    );\n  }\n\n  /**\n   * Helper to store field values while using the form.\n   */\n  setDefaultFieldValues(defaults) {\n    if (typeof defaults !== 'object') {\n      throw new Error(\n        'Argument to setDefaultFieldValues is not of type object'\n      );\n    } else if (typeof localStorage !== 'undefined' && localStorage) {\n      localStorage.setItem(\n        'accounts_ui',\n        JSON.stringify({\n          passwordSignupFields: passwordSignupFields(),\n          ...this.getDefaultFieldValues(),\n          ...defaults\n        })\n      );\n    }\n  }\n\n  /**\n   * Helper to get field values when switching states in the form.\n   */\n  getDefaultFieldValues() {\n    if (typeof localStorage !== 'undefined' && localStorage) {\n      const defaultFieldValues = JSON.parse(\n        localStorage.getItem('accounts_ui') || null\n      );\n      if (\n        defaultFieldValues &&\n        defaultFieldValues.passwordSignupFields === passwordSignupFields()\n      ) {\n        return defaultFieldValues;\n      }\n    }\n  }\n\n  /**\n   * Helper to clear field values when signing in, up or out.\n   */\n  clearDefaultFieldValues() {\n    if (typeof localStorage !== 'undefined' && localStorage) {\n      localStorage.removeItem('accounts_ui');\n    }\n  }\n\n  switchToSignUp(event) {\n    event.preventDefault();\n    this.setState({\n      formState: STATES.SIGN_UP,\n      ...this.getDefaultFieldValues()\n    });\n    this.clearMessages();\n  }\n\n  switchToSignIn(event) {\n    event.preventDefault();\n    this.setState({\n      formState: STATES.SIGN_IN,\n      ...this.getDefaultFieldValues()\n    });\n    this.clearMessages();\n  }\n\n  switchToPasswordReset(event) {\n    event.preventDefault();\n    this.setState({\n      formState: STATES.PASSWORD_RESET,\n      ...this.getDefaultFieldValues()\n    });\n    this.clearMessages();\n  }\n\n  switchToChangePassword(event) {\n    event.preventDefault();\n    this.setState({\n      formState: STATES.PASSWORD_CHANGE,\n      ...this.getDefaultFieldValues()\n    });\n    this.clearMessages();\n  }\n\n  switchToSignOut(event) {\n    event.preventDefault();\n    this.setState({\n      formState: STATES.PROFILE\n    });\n    this.clearMessages();\n  }\n\n  cancelResetPassword(event) {\n    event.preventDefault();\n    Accounts._loginButtonsSession.set('resetPasswordToken', null);\n    this.setState({\n      formState: STATES.SIGN_IN,\n      messages: []\n    });\n  }\n\n  signOut() {\n    Meteor.logout(() => {\n      this.setState({\n        formState: STATES.SIGN_IN,\n        password: null\n      });\n      this.state.onSignedOutHook();\n      this.clearMessages();\n      this.clearDefaultFieldValues();\n    });\n  }\n\n  signIn() {\n    const {\n      username = null,\n      email = null,\n      usernameOrEmail = null,\n      password,\n      formState,\n      onSubmitHook\n    } = this.state;\n    let error = false;\n    let loginSelector;\n    this.clearMessages();\n\n    if (usernameOrEmail !== null) {\n      if (!this.validateField('username', usernameOrEmail)) {\n        if (this.state.formState == STATES.SIGN_UP) {\n          this.state.onSubmitHook(\n            'error.accounts.usernameRequired',\n            this.state.formState\n          );\n        }\n        error = true;\n      } else {\n        if (\n          ['USERNAME_AND_EMAIL_NO_PASSWORD'].includes(passwordSignupFields())\n        ) {\n          this.loginWithoutPassword();\n          return;\n        } else {\n          loginSelector = usernameOrEmail;\n        }\n      }\n    } else if (username !== null) {\n      if (!this.validateField('username', username)) {\n        if (this.state.formState == STATES.SIGN_UP) {\n          this.state.onSubmitHook(\n            'error.accounts.usernameRequired',\n            this.state.formState\n          );\n        }\n        error = true;\n      } else {\n        loginSelector = { username: username };\n      }\n    } else if (usernameOrEmail == null) {\n      if (!this.validateField('email', email)) {\n        error = true;\n      } else {\n        if (['EMAIL_ONLY_NO_PASSWORD'].includes(passwordSignupFields())) {\n          this.loginWithoutPassword();\n          error = true;\n        } else {\n          loginSelector = { email };\n        }\n      }\n    }\n    if (\n      !['EMAIL_ONLY_NO_PASSWORD'].includes(passwordSignupFields()) &&\n      !this.validateField('password', password)\n    ) {\n      error = true;\n    }\n\n    if (!error) {\n      Meteor.loginWithPassword(loginSelector, password, (error, result) => {\n        onSubmitHook(error, formState);\n        if (error) {\n          this.showMessage(\n            `error.accounts.${error.reason}` || 'unknown_error',\n            'error'\n          );\n        } else {\n          loginResultCallback(() => this.state.onSignedInHook());\n          this.setState({\n            formState: STATES.PROFILE,\n            password: null\n          });\n          this.clearDefaultFieldValues();\n        }\n      });\n    }\n  }\n\n  oauthButtons() {\n    const { formState, waiting } = this.state;\n    let oauthButtons = [];\n    if (formState == STATES.SIGN_IN || formState == STATES.SIGN_UP) {\n      if (Accounts.oauth) {\n        Accounts.oauth.serviceNames().map(service => {\n          oauthButtons.push({\n            id: service,\n            label: capitalize(service),\n            disabled: waiting,\n            type: 'button',\n            className: `btn-${service} ${service}`,\n            onClick: this.oauthSignIn.bind(this, service)\n          });\n        });\n      }\n    }\n    return indexBy(oauthButtons, 'id');\n  }\n\n  oauthSignIn(serviceName) {\n    const { user } = this.props;\n    const { formState, waiting, onSubmitHook } = this.state;\n    //Thanks Josh Owens for this one.\n    function capitalService() {\n      return serviceName.charAt(0).toUpperCase() + serviceName.slice(1);\n    }\n\n    if (serviceName === 'meteor-developer') {\n      serviceName = 'meteorDeveloperAccount';\n    }\n\n    const loginWithService = Meteor['loginWith' + capitalService()];\n\n    let options = {}; // use default scope unless specified\n    if (Accounts.ui._options.requestPermissions[serviceName])\n      options.requestPermissions =\n        Accounts.ui._options.requestPermissions[serviceName];\n    if (Accounts.ui._options.requestOfflineToken[serviceName])\n      options.requestOfflineToken =\n        Accounts.ui._options.requestOfflineToken[serviceName];\n    if (Accounts.ui._options.forceApprovalPrompt[serviceName])\n      options.forceApprovalPrompt =\n        Accounts.ui._options.forceApprovalPrompt[serviceName];\n\n    this.clearMessages();\n    const self = this;\n    loginWithService(options, error => {\n      onSubmitHook(error, formState);\n      if (error) {\n        this.showMessage(`error.accounts.${error.reason}` || 'unknown_error');\n      } else {\n        this.setState({ formState: STATES.PROFILE });\n        this.clearDefaultFieldValues();\n        loginResultCallback(() => {\n          Meteor.setTimeout(() => this.state.onSignedInHook(), 100);\n        });\n      }\n    });\n  }\n\n  signUp(options = {}) {\n    const {\n      username = null,\n      email = null,\n      usernameOrEmail = null,\n      password,\n      formState,\n      onSubmitHook\n    } = this.state;\n    let error = false;\n    this.clearMessages();\n\n    if (username !== null) {\n      if (!this.validateField('username', username)) {\n        if (this.state.formState == STATES.SIGN_UP) {\n          this.state.onSubmitHook(\n            'error.accounts.usernameRequired',\n            this.state.formState\n          );\n        }\n        error = true;\n      } else {\n        options.username = username;\n      }\n    } else {\n      if (\n        ['USERNAME_AND_EMAIL', 'USERNAME_AND_EMAIL_NO_PASSWORD'].includes(\n          passwordSignupFields()\n        ) &&\n        !this.validateField('username', username)\n      ) {\n        if (this.state.formState == STATES.SIGN_UP) {\n          this.state.onSubmitHook(\n            'error.accounts.usernameRequired',\n            this.state.formState\n          );\n        }\n        error = true;\n      }\n    }\n\n    if (!this.validateField('email', email)) {\n      error = true;\n    } else {\n      options.email = email;\n    }\n\n    if (\n      ['EMAIL_ONLY_NO_PASSWORD', 'USERNAME_AND_EMAIL_NO_PASSWORD'].includes(\n        passwordSignupFields()\n      )\n    ) {\n      // Generate a random password.\n      options.password = Meteor.uuid();\n    } else if (!this.validateField('password', password)) {\n      onSubmitHook('Invalid password', formState);\n      error = true;\n    } else {\n      options.password = password;\n    }\n\n    const SignUp = function(_options) {\n      Accounts.createUser(_options, error => {\n        if (error) {\n          this.showMessage(\n            `error.accounts.${error.reason}` || 'unknown_error',\n            'error'\n          );\n          if (this.translate(`error.accounts.${error.reason}`)) {\n            onSubmitHook(`error.accounts.${error.reason}`, formState);\n          } else {\n            onSubmitHook('unknown_error', formState);\n          }\n        } else {\n          onSubmitHook(null, formState);\n          this.setState({ formState: STATES.PROFILE, password: null });\n          let user = Accounts.user();\n          loginResultCallback(\n            this.state.onPostSignUpHook.bind(this, _options, user)\n          );\n          this.clearDefaultFieldValues();\n        }\n\n        this.setState({ waiting: false });\n      });\n    };\n\n    if (!error) {\n      this.setState({ waiting: true });\n      // Allow for Promises to return.\n      let promise = this.state.onPreSignUpHook(options);\n      if (promise instanceof Promise) {\n        promise.then(SignUp.bind(this, options));\n      } else {\n        SignUp(options);\n      }\n    }\n  }\n\n  loginWithoutPassword() {\n    const {\n      email = '',\n      usernameOrEmail = '',\n      waiting,\n      formState,\n      onSubmitHook\n    } = this.state;\n\n    if (waiting) {\n      return;\n    }\n\n    if (this.validateField('email', email)) {\n      this.setState({ waiting: true });\n\n      Accounts.loginWithoutPassword({ email: email }, error => {\n        if (error) {\n          this.showMessage(\n            `error.accounts.${error.reason}` || 'unknown_error',\n            'error'\n          );\n        } else {\n          this.showMessage(this.translate('info.emailSent'), 'success', 5000);\n          this.clearDefaultFieldValues();\n        }\n        onSubmitHook(error, formState);\n        this.setState({ waiting: false });\n      });\n    } else if (this.validateField('username', usernameOrEmail)) {\n      this.setState({ waiting: true });\n\n      Accounts.loginWithoutPassword(\n        { email: usernameOrEmail, username: usernameOrEmail },\n        error => {\n          if (error) {\n            this.showMessage(\n              `error.accounts.${error.reason}` || 'unknown_error',\n              'error'\n            );\n          } else {\n            this.showMessage(this.translate('info.emailSent'), 'success', 5000);\n            this.clearDefaultFieldValues();\n          }\n          onSubmitHook(error, formState);\n          this.setState({ waiting: false });\n        }\n      );\n    } else {\n      let errMsg = null;\n      if (['USERNAME_AND_EMAIL_NO_PASSWORD'].includes(passwordSignupFields())) {\n        errMsg = this.translate('error.accounts.invalid_email');\n      } else {\n        errMsg = this.translate('error.accounts.invalid_email');\n      }\n      this.showMessage(errMsg, 'warning');\n      onSubmitHook(errMsg, formState);\n    }\n  }\n\n  passwordReset() {\n    const { email = '', waiting, formState, onSubmitHook } = this.state;\n\n    if (waiting) {\n      return;\n    }\n\n    this.clearMessages();\n    if (this.validateField('email', email)) {\n      this.setState({ waiting: true });\n\n      Accounts.forgotPassword({ email: email }, error => {\n        if (error) {\n          this.showMessage(\n            `error.accounts.${error.reason}` || 'unknown_error',\n            'error'\n          );\n        } else {\n          this.showMessage(this.translate('info.emailSent'), 'success', 5000);\n          this.clearDefaultFieldValues();\n        }\n        onSubmitHook(error, formState);\n        this.setState({ waiting: false });\n      });\n    }\n  }\n\n  passwordChange() {\n    const {\n      password,\n      newPassword,\n      formState,\n      onSubmitHook,\n      onSignedInHook\n    } = this.state;\n\n    if (!this.validateField('password', newPassword)) {\n      onSubmitHook('err.minChar', formState);\n      return;\n    }\n\n    let token = Accounts._loginButtonsSession.get('resetPasswordToken');\n    if (!token) {\n      token = Accounts._loginButtonsSession.get('enrollAccountToken');\n    }\n    if (token) {\n      Accounts.resetPassword(token, newPassword, error => {\n        if (error) {\n          this.showMessage(\n            `error.accounts.${error.reason}` || 'unknown_error',\n            'error'\n          );\n          onSubmitHook(error, formState);\n        } else {\n          this.showMessage(\n            this.translate('info.passwordChanged'),\n            'success',\n            5000\n          );\n          onSubmitHook(null, formState);\n          this.setState({ formState: STATES.PROFILE });\n          Accounts._loginButtonsSession.set('resetPasswordToken', null);\n          Accounts._loginButtonsSession.set('enrollAccountToken', null);\n          onSignedInHook();\n        }\n      });\n    } else {\n      Accounts.changePassword(password, newPassword, error => {\n        if (error) {\n          this.showMessage(\n            `error.accounts.${error.reason}` || 'unknown_error',\n            'error'\n          );\n          onSubmitHook(error, formState);\n        } else {\n          this.showMessage('info.passwordChanged', 'success', 5000);\n          onSubmitHook(null, formState);\n          this.setState({ formState: STATES.PROFILE });\n          this.clearDefaultFieldValues();\n        }\n      });\n    }\n  }\n\n  showMessage(message, type, clearTimeout, field) {\n    message = this.translate(message).trim();\n    if (message) {\n      this.setState(({ messages = [] }) => {\n        messages.push({\n          message,\n          type,\n          ...(field && { field })\n        });\n        return { messages };\n      });\n      if (clearTimeout) {\n        this.hideMessageTimout = setTimeout(() => {\n          // Filter out the message that timed out.\n          this.clearMessage(message);\n        }, clearTimeout);\n      }\n    }\n  }\n\n  getMessageForField(field) {\n    const { messages = [] } = this.state;\n    return messages.find(({ field: key }) => key === field);\n  }\n\n  clearMessage(message) {\n    if (message) {\n      this.setState(({ messages = [] }) => ({\n        messages: messages.filter(({ message: a }) => a !== message)\n      }));\n    }\n  }\n\n  clearMessages() {\n    if (this.hideMessageTimout) {\n      clearTimeout(this.hideMessageTimout);\n    }\n    this.setState({ messages: [] });\n  }\n\n  componentWillMount() {\n    // XXX Check for backwards compatibility.\n    if (Meteor.isClient) {\n      const container = document.createElement('div');\n      ReactDOM.render(<Accounts.ui.Field message=\"test\" />, container);\n      if (container.getElementsByClassName('message').length == 0) {\n        // Found backwards compatibility issue with 1.3.x\n        console.warn(`Implementations of Accounts.ui.Field must render message in v1.2.11.\n          https://github.com/studiointeract/accounts-ui/#deprecations`);\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.hideMessageTimout) {\n      clearTimeout(this.hideMessageTimout);\n    }\n  }\n\n  render() {\n    this.oauthButtons();\n    // Backwords compatibility with v1.2.x.\n    const { messages = [] } = this.state;\n    const message = {\n      deprecated: true,\n      message: messages.map(({ message }) => message).join(', ')\n    };\n    return (\n      <Accounts.ui.Form\n        oauthServices={this.oauthButtons()}\n        fields={this.fields()}\n        buttons={this.buttons()}\n        {...this.state}\n        message={message}\n        translate={text => this.translate(text)}\n      />\n    );\n  }\n}\nLoginForm.propTypes = {\n  formState: PropTypes.symbol,\n  loginPath: PropTypes.string,\n  signUpPath: PropTypes.string,\n  resetPasswordPath: PropTypes.string,\n  profilePath: PropTypes.string,\n  changePasswordPath: PropTypes.string\n};\nLoginForm.defaultProps = {\n  formState: null,\n  loginPath: null,\n  signUpPath: null,\n  resetPasswordPath: null,\n  profilePath: null,\n  changePasswordPath: null\n};\n\nAccounts.ui.LoginForm = LoginForm;\n\nconst LoginFormContainer = withTracker(() => {\n  // Listen for the user to login/logout and the services list to the user.\n  Meteor.subscribe('servicesList');\n  return {\n    user: Accounts.user()\n  };\n})(LoginForm);\nAccounts.ui.LoginForm = LoginFormContainer;\nexport default LoginFormContainer;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Accounts } from 'meteor/accounts-base';\nimport { T9n } from 'meteor-accounts-t9n';\nimport { hasPasswordService } from '../../helpers.js';\n\nexport class PasswordOrService extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      hasPasswordService: hasPasswordService(),\n      services: Object.keys(props.oauthServices).map(service => {\n        return props.oauthServices[service].label;\n      })\n    };\n  }\n\n  translate(text) {\n    if (this.props.translate) {\n      return this.props.translate(text);\n    }\n    return T9n.get(text);\n  }\n\n  render() {\n    let { className = 'password-or-service', style = {} } = this.props;\n    let { hasPasswordService, services } = this.state;\n    labels = services;\n    if (services.length > 2) {\n      labels = [];\n    }\n\n    if (hasPasswordService && services.length > 0) {\n      return (\n        <div style={style} className={className}>\n          {`${this.translate('orUse')} ${labels.join(' / ')}`}\n        </div>\n      );\n    }\n    return null;\n  }\n}\n\nPasswordOrService.propTypes = {\n  oauthServices: PropTypes.object\n};\n\nAccounts.ui.PasswordOrService = PasswordOrService;\n","import React from 'react';\nimport './Button.jsx';\nimport { Accounts } from 'meteor/accounts-base';\n\nexport class SocialButtons extends React.Component {\n  render() {\n    let { oauthServices = {}, className = 'social-buttons' } = this.props;\n    return (\n      <div className={className}>\n        {Object.keys(oauthServices).map((id, i) => {\n          return <Accounts.ui.Button {...oauthServices[id]} key={i} />;\n        })}\n      </div>\n    );\n  }\n}\n\nAccounts.ui.SocialButtons = SocialButtons;\n"]}