[{"type":"js","data":"(function () {\n\n/* Imports */\nvar Meteor = Package.meteor.Meteor;\nvar global = Package.meteor.global;\nvar meteorEnv = Package.meteor.meteorEnv;\nvar ECMAScript = Package.ecmascript.ECMAScript;\nvar meteorInstall = Package.modules.meteorInstall;\nvar meteorBabelHelpers = Package['babel-runtime'].meteorBabelHelpers;\nvar Promise = Package.promise.Promise;\n\n/* Package-scope variables */\nvar mochaInstance, setupGlobals;\n\nvar require = meteorInstall({\"node_modules\":{\"meteor\":{\"meteortesting:mocha-core\":{\"server.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                     //\n// packages/meteortesting_mocha-core/server.js                                         //\n//                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////\n                                                                                       //\nmodule.export({\n  mochaInstance: () => mochaInstance,\n  setupGlobals: () => setupGlobals,\n  Mocha: () => Mocha\n});\nlet Fiber;\nmodule.link(\"fibers\", {\n  default(v) {\n    Fiber = v;\n  }\n\n}, 0);\nmodule.link(\"./setup\");\nlet Mocha;\nmodule.link(\"mocha\", {\n  default(v) {\n    Mocha = v;\n  }\n\n}, 1);\nmodule.link(\"./cleanup\");\n\nfunction setupGlobals(mocha) {\n  var mochaExports = {};\n  mocha.suite.emit('pre-require', mochaExports, undefined, mocha); // 1. patch up it and hooks functions so it plays nice w/ fibers\n  // 2. trick to allow binding the suite instance as `this` value\n  // inside of suites blocks, to allow e.g. to set custom timeouts.\n\n  var wrapRunnable = function (fn) {\n    //In Meteor, these blocks will all be invoking Meteor code and must\n    //run within a fiber. We must therefore wrap each with something like\n    //bindEnvironment. The function passed off to mocha must have length\n    //greater than zero if we want mocha to run it asynchronously. That's\n    //why it uses the Fibers\n    //We're actually having mocha run all tests asynchronously. This\n    //is because mocha cannot tell when a synchronous fiber test has\n    //finished, because the test runner runs outside a fiber.\n    //It is possible that the mocha test runner could be run from within a\n    //fiber, but it was unclear to me how that could be done without\n    //forking mocha itself.\n    const wrappedFunction = function (done) {\n      var self = this._runnable;\n\n      var run = function () {\n        try {\n          // Sync call\n          if (fn.length == 0) {\n            var result = fn.call(self);\n\n            if (result && typeof result.then === 'function') {\n              self.resetTimeout();\n              result.then(function () {\n                done(); // Return null so libraries like bluebird do not warn about\n                // subsequently constructed Promises.\n\n                return null;\n              }, function (reason) {\n                done(reason || new Error('Promise rejected with no or falsy reason'));\n              });\n            } else {\n              if (self.asyncOnly) {\n                return done(new Error('--async-only option in use without declaring `done()` or returning a promise'));\n              }\n\n              done();\n            }\n          } else {\n            fn.call(self, done);\n          }\n        } catch (error) {\n          done(error);\n        }\n      };\n\n      if (Fiber.current) return run();\n      Fiber(run).run();\n    }; // Show original function source code\n\n\n    wrappedFunction.toString = function () {\n      return fn.toString();\n    };\n\n    return wrappedFunction;\n  };\n\n  mochaExports[\"__org_it\"] = mochaExports[\"it\"];\n\n  mochaExports['it'] = function (name, func) {\n    // You can create pending tests without a function\n    // http://mochajs.org/#pending-tests\n    // i.e pending test\n    // it('this is a pending test');\n    if (func) {\n      func = wrapRunnable(func);\n    }\n\n    return mochaExports[\"__org_it\"](name, func);\n  };\n\n  mochaExports.it.skip = mochaExports[\"__org_it\"].skip;\n\n  mochaExports.it.only = (name, func) => {\n    mochaExports[\"__org_it\"].only(name, func);\n  };\n\n  let hooks = [\"before\", \"beforeEach\", \"after\", \"afterEach\"];\n  hooks.forEach(hook => {\n    mochaExports[`__org_${hook}`] = mochaExports[hook];\n\n    mochaExports[hook] = func => {\n      return mochaExports[`__org_${hook}`](wrapRunnable(func));\n    };\n  });\n  Object.keys(mochaExports).forEach(key => {\n    // We don't want original function to be export to global namespace\n    if (key.indexOf(\"__org_\") > -1 || key.indexOf(\"run\") > -1) {\n      return;\n    }\n\n    global[key] = mochaExports[key];\n  });\n}\n\n; // Initialize a new `Mocha` test runner instance that test driver packages\n// can use to ensure they work well with other test driver packages.\n\nconst options = {\n  ui: 'bdd',\n  ignoreLeaks: true\n};\n\nif (process.env.MOCHA_TIMEOUT) {\n  options.timeout = parseInt(process.env.MOCHA_TIMEOUT);\n  Meteor.settings.public[\"MOCHA_TIMEOUT\"] = process.env.MOCHA_TIMEOUT;\n}\n\nconst mochaInstance = new Mocha(options);\nsetupGlobals(mochaInstance);\n/////////////////////////////////////////////////////////////////////////////////////////\n\n},\"cleanup.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                     //\n// packages/meteortesting_mocha-core/cleanup.js                                        //\n//                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////\n                                                                                       //\n// Since setting process.browser = true is counter-intuitive and may result in strange errors with other libraries that depend on this, we have to set this to undefined. See https://goo.gl/WOFnnS\nprocess.browser = undefined;\n/////////////////////////////////////////////////////////////////////////////////////////\n\n},\"setup.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                     //\n// packages/meteortesting_mocha-core/setup.js                                          //\n//                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////\n                                                                                       //\n// Mocha it's evaluating if 'process.browser' to add some 'paths' to module using 'module.paths', the problem its that meteor's modules don't have the property 'paths' and its failing to start. See  https://goo.gl/aNO5IM and https://goo.gl/YiNBmL for more details\nprocess.browser = true;\n/////////////////////////////////////////////////////////////////////////////////////////\n\n},\"node_modules\":{\"mocha\":{\"package.json\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                     //\n// node_modules/meteor/meteortesting_mocha-core/node_modules/mocha/package.json        //\n//                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////\n                                                                                       //\nmodule.exports = {\n  \"name\": \"mocha\",\n  \"version\": \"6.2.0\"\n};\n\n/////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                     //\n// node_modules/meteor/meteortesting_mocha-core/node_modules/mocha/index.js            //\n//                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////\n                                                                                       //\nmodule.useNode();\n/////////////////////////////////////////////////////////////////////////////////////////\n\n}}}}}}},{\n  \"extensions\": [\n    \".js\",\n    \".json\"\n  ]\n});\n\nvar exports = require(\"/node_modules/meteor/meteortesting:mocha-core/server.js\");\n\n/* Exports */\nPackage._define(\"meteortesting:mocha-core\", exports, {\n  mochaInstance: mochaInstance,\n  setupGlobals: setupGlobals\n});\n\n})();\n","servePath":"/packages/meteortesting_mocha-core.js","sourceMap":{"version":3,"sources":["packages/meteortesting:mocha-core/server.js","packages/meteortesting:mocha-core/cleanup.js","packages/meteortesting:mocha-core/setup.js"],"names":["module","export","mochaInstance","setupGlobals","Mocha","Fiber","link","default","v","mocha","mochaExports","suite","emit","undefined","wrapRunnable","fn","wrappedFunction","done","self","_runnable","run","length","result","call","then","resetTimeout","reason","Error","asyncOnly","error","current","toString","name","func","it","skip","only","hooks","forEach","hook","Object","keys","key","indexOf","global","options","ui","ignoreLeaks","process","env","MOCHA_TIMEOUT","timeout","parseInt","Meteor","settings","public","browser"],"mappings":"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","file":"/packages/meteortesting_mocha-core.js","sourcesContent":["import Fiber from 'fibers';\nimport \"./setup\"\nimport Mocha from 'mocha';\nimport \"./cleanup\"\n\nfunction setupGlobals(mocha) {\n  var mochaExports = {};\n  mocha.suite.emit('pre-require', mochaExports, undefined, mocha);\n\n  // 1. patch up it and hooks functions so it plays nice w/ fibers\n  // 2. trick to allow binding the suite instance as `this` value\n  // inside of suites blocks, to allow e.g. to set custom timeouts.\n  var wrapRunnable = function (fn) {\n    //In Meteor, these blocks will all be invoking Meteor code and must\n    //run within a fiber. We must therefore wrap each with something like\n    //bindEnvironment. The function passed off to mocha must have length\n    //greater than zero if we want mocha to run it asynchronously. That's\n    //why it uses the Fibers\n\n    //We're actually having mocha run all tests asynchronously. This\n    //is because mocha cannot tell when a synchronous fiber test has\n    //finished, because the test runner runs outside a fiber.\n\n    //It is possible that the mocha test runner could be run from within a\n    //fiber, but it was unclear to me how that could be done without\n    //forking mocha itself.\n\n    const wrappedFunction = function (done) {\n      var self = this._runnable;\n      var run = function() {\n        try {\n          // Sync call\n          if (fn.length == 0) {\n            var result = fn.call(self);\n            if (result && typeof result.then === 'function') {\n              self.resetTimeout();\n              result\n                .then(function() {\n                    done();\n                    // Return null so libraries like bluebird do not warn about\n                    // subsequently constructed Promises.\n                    return null;\n                  },\n                  function(reason) {\n                    done(reason || new Error('Promise rejected with no or falsy reason'));\n                  });\n            } else {\n              if (self.asyncOnly) {\n                return done(new Error('--async-only option in use without declaring `done()` or returning a promise'));\n              }\n\n              done();\n            }\n          }\n          else {\n            fn.call(self, done);\n          }\n        } catch (error) {\n          done(error);\n        }\n      };\n\n      if (Fiber.current) return run();\n      Fiber(run).run();\n    };\n\n    // Show original function source code\n    wrappedFunction.toString = function () { return fn.toString() };\n    return wrappedFunction;\n  };\n\n  mochaExports[\"__org_it\"] = mochaExports[\"it\"];\n  mochaExports['it'] = function (name, func) {\n    // You can create pending tests without a function\n    // http://mochajs.org/#pending-tests\n    // i.e pending test\n    // it('this is a pending test');\n    if (func) {\n      func = wrapRunnable(func);\n    }\n    return mochaExports[\"__org_it\"](name, func);\n  };\n  mochaExports.it.skip = mochaExports[\"__org_it\"].skip;\n  mochaExports.it.only = (name, func) => {\n    mochaExports[\"__org_it\"].only(name, func);\n  };\n\n\n  let hooks = [\"before\", \"beforeEach\", \"after\", \"afterEach\"];\n  hooks.forEach((hook)=> {\n    mochaExports[`__org_${hook}`] = mochaExports[hook];\n    mochaExports[hook] = (func)=> {\n     return  mochaExports[`__org_${hook}`](wrapRunnable(func));\n    }\n  });\n\n  Object.keys(mochaExports).forEach((key)=>{\n    // We don't want original function to be export to global namespace\n    if(key.indexOf(\"__org_\") > -1 || key.indexOf(\"run\") > -1){\n      return;\n    }\n    global[key] = mochaExports[key];\n  })\n\n};\n\n// Initialize a new `Mocha` test runner instance that test driver packages\n// can use to ensure they work well with other test driver packages.\nconst options = {\n  ui: 'bdd',\n  ignoreLeaks: true\n};\n\nif (process.env.MOCHA_TIMEOUT) {\n  options.timeout = parseInt(process.env.MOCHA_TIMEOUT);\n  Meteor.settings.public[\"MOCHA_TIMEOUT\"] = process.env.MOCHA_TIMEOUT;\n}\n\nconst mochaInstance = new Mocha(options);\nsetupGlobals(mochaInstance);\n\nexport { mochaInstance, setupGlobals, Mocha };\n","// Since setting process.browser = true is counter-intuitive and may result in strange errors with other libraries that depend on this, we have to set this to undefined. See https://goo.gl/WOFnnS\nprocess.browser = undefined;","// Mocha it's evaluating if 'process.browser' to add some 'paths' to module using 'module.paths', the problem its that meteor's modules don't have the property 'paths' and its failing to start. See  https://goo.gl/aNO5IM and https://goo.gl/YiNBmL for more details\nprocess.browser = true;"]}}]