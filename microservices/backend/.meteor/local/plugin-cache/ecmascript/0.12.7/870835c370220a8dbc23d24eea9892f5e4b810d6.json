{"metadata":{},"options":{"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/Florian/dev/epotek/microservices/backend/imports/core/components/Financing/client/FinancingFinancing/FinancingFinancing.jsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties",["flow",{}],"dynamicImport","classProperties","classPrivateProperties","jsx",["flow",{}],"asyncGenerators","objectRestSpread","objectRestSpread",["flow",{}],"asyncGenerators"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"imports/core/components/Financing/client/FinancingFinancing/FinancingFinancing.jsx","filename":"/Users/Florian/dev/epotek/microservices/backend/imports/core/components/Financing/client/FinancingFinancing/FinancingFinancing.jsx","inputSourceMap":{"version":3,"sources":["imports/core/components/Financing/client/FinancingFinancing/FinancingFinancing.jsx"],"names":["React","OWN_FUNDS_USAGE_TYPES","T","FinancingSection","InputAndSlider","CalculatedValue","FinmaRatio","Calc","getOffer","FinancingTranchePicker","MortgageNotesPicker","getBorrowRatio","getBorrowRatioStatus","LoanPercent","Calculator","getPledgedAmount","structure","ownFunds","filter","usageType","PLEDGE","reduce","sum","value","calculateLoan","params","wantedLoan","calculateMaxLoan","data","pledgeOverride","loan","structureId","offer","selectOffer","maxAmount","selectStructure","propertyValue","selectPropertyValue","getMaxLoanBase","propertyWork","pledgedAmount","undefined","residenceType","enableOffers","oneStructureHasLoan","structures","some","FinancingFinancingProps","FinancingFinancing","props","id","label","Component","max","condition"],"mappings":"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","sourcesContent":["// @flow\nimport React from 'react';\n\nimport { OWN_FUNDS_USAGE_TYPES } from '../../../../api/constants';\nimport T from '../../../Translation';\nimport FinancingSection, {\n  InputAndSlider,\n  CalculatedValue,\n  FinmaRatio,\n} from '../FinancingSection';\nimport Calc, { getOffer } from '../FinancingCalculator';\nimport FinancingTranchePicker from './FinancingTranchePicker';\nimport MortgageNotesPicker from './MortgageNotesPicker';\nimport {\n  getBorrowRatio,\n  getBorrowRatioStatus,\n} from '../FinancingResult/financingResultHelpers';\nimport LoanPercent from './LoanPercent';\nimport Calculator from '../../../../utils/Calculator';\n\nconst getPledgedAmount = ({ structure: { ownFunds } }) =>\n  ownFunds\n    .filter(({ usageType }) => usageType === OWN_FUNDS_USAGE_TYPES.PLEDGE)\n    .reduce((sum, { value }) => sum + value, 0);\n\nexport const calculateLoan = (params) => {\n  const {\n    structure: { wantedLoan },\n  } = params;\n  return wantedLoan;\n};\n\nexport const calculateMaxLoan = (data, pledgeOverride) => {\n  const { loan, structureId } = data;\n  const offer = Calculator.selectOffer({ loan, structureId });\n  if (offer) {\n    const { maxAmount } = getOffer(data);\n    return maxAmount;\n  }\n\n  const structure = Calculator.selectStructure({ loan, structureId });\n  const propertyValue = Calculator.selectPropertyValue({ loan, structureId });\n\n  return Calc.getMaxLoanBase({\n    propertyWork: structure.propertyWork,\n    propertyValue,\n    pledgedAmount:\n      pledgeOverride !== undefined ? pledgeOverride : getPledgedAmount(data),\n    residenceType: loan.residenceType,\n  });\n};\n\nconst enableOffers = ({ loan }) => loan.enableOffers;\n\nconst oneStructureHasLoan = ({ loan: { structures } }) =>\n  structures.some(({ wantedLoan }) => wantedLoan);\n\ntype FinancingFinancingProps = {};\n\nconst FinancingFinancing = (props: FinancingFinancingProps) => (\n  <FinancingSection\n    summaryConfig={[\n      {\n        id: 'mortgageLoan',\n        label: (\n          <span className=\"section-title\">\n            <T id=\"FinancingFinancing.title\" />\n          </span>\n        ),\n        Component: props => (\n          <div className=\"mortgageLoan financing-mortgageLoan\">\n            <CalculatedValue value={calculateLoan} {...props} />\n            <FinmaRatio\n              value={getBorrowRatio}\n              status={getBorrowRatioStatus}\n              {...props}\n            />\n          </div>\n        ),\n      },\n    ]}\n    detailConfig={[\n      {\n        Component: InputAndSlider,\n        id: 'wantedLoan',\n        max: calculateMaxLoan,\n      },\n      {\n        Component: LoanPercent,\n        id: 'wantedLoanPercent',\n      },\n      {\n        Component: MortgageNotesPicker,\n        id: 'mortgageNoteIds',\n        condition: oneStructureHasLoan,\n      },\n      // TODO: To be released in the future\n      // {\n      //   Component: RadioButtons,\n      //   id: 'amortizationType',\n      //   options: Object.values(AMORTIZATION_TYPE).map(key => ({\n      //     id: key,\n      //     label: `FinancingFinancing.${key}`,\n      //   })),\n      //   condition: enableOffers,\n      // },\n      {\n        id: 'loanTranches',\n        Component: FinancingTranchePicker,\n        condition: enableOffers,\n      },\n    ]}\n  />\n);\n\nexport default FinancingFinancing;\n"]},"passPerPreset":false,"envName":"development","cwd":"/Users/Florian/dev/epotek/microservices/backend","root":"/Users/Florian/dev/epotek/microservices/backend","plugins":[{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"transform-runtime","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-modules-commonjs","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-flow","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/Florian/dev/epotek/microservices/backend/imports/core/components/Financing/client/FinancingFinancing/FinancingFinancing.jsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/core/components/Financing/client/FinancingFinancing/FinancingFinancing.jsx"}},"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nmodule.export({\n  calculateLoan: function () {\n    return calculateLoan;\n  },\n  calculateMaxLoan: function () {\n    return calculateMaxLoan;\n  }\n});\nvar React;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  }\n}, 0);\nvar OWN_FUNDS_USAGE_TYPES;\nmodule.link(\"../../../../api/constants\", {\n  OWN_FUNDS_USAGE_TYPES: function (v) {\n    OWN_FUNDS_USAGE_TYPES = v;\n  }\n}, 1);\nvar T;\nmodule.link(\"../../../Translation\", {\n  \"default\": function (v) {\n    T = v;\n  }\n}, 2);\nvar FinancingSection, InputAndSlider, CalculatedValue, FinmaRatio;\nmodule.link(\"../FinancingSection\", {\n  \"default\": function (v) {\n    FinancingSection = v;\n  },\n  InputAndSlider: function (v) {\n    InputAndSlider = v;\n  },\n  CalculatedValue: function (v) {\n    CalculatedValue = v;\n  },\n  FinmaRatio: function (v) {\n    FinmaRatio = v;\n  }\n}, 3);\nvar Calc, getOffer;\nmodule.link(\"../FinancingCalculator\", {\n  \"default\": function (v) {\n    Calc = v;\n  },\n  getOffer: function (v) {\n    getOffer = v;\n  }\n}, 4);\nvar FinancingTranchePicker;\nmodule.link(\"./FinancingTranchePicker\", {\n  \"default\": function (v) {\n    FinancingTranchePicker = v;\n  }\n}, 5);\nvar MortgageNotesPicker;\nmodule.link(\"./MortgageNotesPicker\", {\n  \"default\": function (v) {\n    MortgageNotesPicker = v;\n  }\n}, 6);\nvar getBorrowRatio, getBorrowRatioStatus;\nmodule.link(\"../FinancingResult/financingResultHelpers\", {\n  getBorrowRatio: function (v) {\n    getBorrowRatio = v;\n  },\n  getBorrowRatioStatus: function (v) {\n    getBorrowRatioStatus = v;\n  }\n}, 7);\nvar LoanPercent;\nmodule.link(\"./LoanPercent\", {\n  \"default\": function (v) {\n    LoanPercent = v;\n  }\n}, 8);\nvar Calculator;\nmodule.link(\"../../../../utils/Calculator\", {\n  \"default\": function (v) {\n    Calculator = v;\n  }\n}, 9);\n\nvar getPledgedAmount = function (_ref) {\n  var ownFunds = _ref.structure.ownFunds;\n  return ownFunds.filter(function (_ref2) {\n    var usageType = _ref2.usageType;\n    return usageType === OWN_FUNDS_USAGE_TYPES.PLEDGE;\n  }).reduce(function (sum, _ref3) {\n    var value = _ref3.value;\n    return sum + value;\n  }, 0);\n};\n\nvar calculateLoan = function (params) {\n  var wantedLoan = params.structure.wantedLoan;\n  return wantedLoan;\n};\n\nvar calculateMaxLoan = function (data, pledgeOverride) {\n  var loan = data.loan,\n      structureId = data.structureId;\n  var offer = Calculator.selectOffer({\n    loan: loan,\n    structureId: structureId\n  });\n\n  if (offer) {\n    var _getOffer = getOffer(data),\n        maxAmount = _getOffer.maxAmount;\n\n    return maxAmount;\n  }\n\n  var structure = Calculator.selectStructure({\n    loan: loan,\n    structureId: structureId\n  });\n  var propertyValue = Calculator.selectPropertyValue({\n    loan: loan,\n    structureId: structureId\n  });\n  return Calc.getMaxLoanBase({\n    propertyWork: structure.propertyWork,\n    propertyValue: propertyValue,\n    pledgedAmount: pledgeOverride !== undefined ? pledgeOverride : getPledgedAmount(data),\n    residenceType: loan.residenceType\n  });\n};\n\nvar enableOffers = function (_ref4) {\n  var loan = _ref4.loan;\n  return loan.enableOffers;\n};\n\nvar oneStructureHasLoan = function (_ref5) {\n  var structures = _ref5.loan.structures;\n  return structures.some(function (_ref6) {\n    var wantedLoan = _ref6.wantedLoan;\n    return wantedLoan;\n  });\n};\n\nvar FinancingFinancing = function (props) {\n  return React.createElement(FinancingSection, {\n    summaryConfig: [{\n      id: 'mortgageLoan',\n      label: React.createElement(\"span\", {\n        className: \"section-title\"\n      }, React.createElement(T, {\n        id: \"FinancingFinancing.title\"\n      })),\n      Component: function (props) {\n        return React.createElement(\"div\", {\n          className: \"mortgageLoan financing-mortgageLoan\"\n        }, React.createElement(CalculatedValue, (0, _extends2.default)({\n          value: calculateLoan\n        }, props)), React.createElement(FinmaRatio, (0, _extends2.default)({\n          value: getBorrowRatio,\n          status: getBorrowRatioStatus\n        }, props)));\n      }\n    }],\n    detailConfig: [{\n      Component: InputAndSlider,\n      id: 'wantedLoan',\n      max: calculateMaxLoan\n    }, {\n      Component: LoanPercent,\n      id: 'wantedLoanPercent'\n    }, {\n      Component: MortgageNotesPicker,\n      id: 'mortgageNoteIds',\n      condition: oneStructureHasLoan\n    }, // TODO: To be released in the future\n    // {\n    //   Component: RadioButtons,\n    //   id: 'amortizationType',\n    //   options: Object.values(AMORTIZATION_TYPE).map(key => ({\n    //     id: key,\n    //     label: `FinancingFinancing.${key}`,\n    //   })),\n    //   condition: enableOffers,\n    // },\n    {\n      id: 'loanTranches',\n      Component: FinancingTranchePicker,\n      condition: enableOffers\n    }]\n  });\n};\n\nmodule.exportDefault(FinancingFinancing);","map":{"version":3,"sources":["imports/core/components/Financing/client/FinancingFinancing/FinancingFinancing.jsx"],"names":["getPledgedAmount","structure","ownFunds","usageType","OWN_FUNDS_USAGE_TYPES","value","sum","calculateLoan","params","wantedLoan","calculateMaxLoan","structureId","offer","loan","maxAmount","getOffer","propertyValue","propertyWork","pledgedAmount","pledgeOverride","residenceType","enableOffers","oneStructureHasLoan","structures","FinancingFinancing","id","label","Component","props","max","condition"],"mappings":"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","sourcesContent":["// @flow\nimport React from 'react';\n\nimport { OWN_FUNDS_USAGE_TYPES } from '../../../../api/constants';\nimport T from '../../../Translation';\nimport FinancingSection, {\n  InputAndSlider,\n  CalculatedValue,\n  FinmaRatio,\n} from '../FinancingSection';\nimport Calc, { getOffer } from '../FinancingCalculator';\nimport FinancingTranchePicker from './FinancingTranchePicker';\nimport MortgageNotesPicker from './MortgageNotesPicker';\nimport {\n  getBorrowRatio,\n  getBorrowRatioStatus,\n} from '../FinancingResult/financingResultHelpers';\nimport LoanPercent from './LoanPercent';\nimport Calculator from '../../../../utils/Calculator';\n\nconst getPledgedAmount = ({ structure: { ownFunds } }) =>\n  ownFunds\n    .filter(({ usageType }) => usageType === OWN_FUNDS_USAGE_TYPES.PLEDGE)\n    .reduce((sum, { value }) => sum + value, 0);\n\nexport const calculateLoan = (params) => {\n  const {\n    structure: { wantedLoan },\n  } = params;\n  return wantedLoan;\n};\n\nexport const calculateMaxLoan = (data, pledgeOverride) => {\n  const { loan, structureId } = data;\n  const offer = Calculator.selectOffer({ loan, structureId });\n  if (offer) {\n    const { maxAmount } = getOffer(data);\n    return maxAmount;\n  }\n\n  const structure = Calculator.selectStructure({ loan, structureId });\n  const propertyValue = Calculator.selectPropertyValue({ loan, structureId });\n\n  return Calc.getMaxLoanBase({\n    propertyWork: structure.propertyWork,\n    propertyValue,\n    pledgedAmount:\n      pledgeOverride !== undefined ? pledgeOverride : getPledgedAmount(data),\n    residenceType: loan.residenceType,\n  });\n};\n\nconst enableOffers = ({ loan }) => loan.enableOffers;\n\nconst oneStructureHasLoan = ({ loan: { structures } }) =>\n  structures.some(({ wantedLoan }) => wantedLoan);\n\ntype FinancingFinancingProps = {};\n\nconst FinancingFinancing = (props: FinancingFinancingProps) => (\n  <FinancingSection\n    summaryConfig={[\n      {\n        id: 'mortgageLoan',\n        label: (\n          <span className=\"section-title\">\n            <T id=\"FinancingFinancing.title\" />\n          </span>\n        ),\n        Component: props => (\n          <div className=\"mortgageLoan financing-mortgageLoan\">\n            <CalculatedValue value={calculateLoan} {...props} />\n            <FinmaRatio\n              value={getBorrowRatio}\n              status={getBorrowRatioStatus}\n              {...props}\n            />\n          </div>\n        ),\n      },\n    ]}\n    detailConfig={[\n      {\n        Component: InputAndSlider,\n        id: 'wantedLoan',\n        max: calculateMaxLoan,\n      },\n      {\n        Component: LoanPercent,\n        id: 'wantedLoanPercent',\n      },\n      {\n        Component: MortgageNotesPicker,\n        id: 'mortgageNoteIds',\n        condition: oneStructureHasLoan,\n      },\n      // TODO: To be released in the future\n      // {\n      //   Component: RadioButtons,\n      //   id: 'amortizationType',\n      //   options: Object.values(AMORTIZATION_TYPE).map(key => ({\n      //     id: key,\n      //     label: `FinancingFinancing.${key}`,\n      //   })),\n      //   condition: enableOffers,\n      // },\n      {\n        id: 'loanTranches',\n        Component: FinancingTranchePicker,\n        condition: enableOffers,\n      },\n    ]}\n  />\n);\n\nexport default FinancingFinancing;\n"]},"sourceType":"script","hash":"870835c370220a8dbc23d24eea9892f5e4b810d6"}
