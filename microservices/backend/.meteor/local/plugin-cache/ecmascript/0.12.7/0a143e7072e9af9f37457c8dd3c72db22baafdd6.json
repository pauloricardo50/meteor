{"metadata":{},"options":{"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/Florian/dev/epotek/microservices/backend/packages/server-render/server-sink.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","jsx",["flow",{}],["flow",{}],"objectRestSpread","objectRestSpread","dynamicImport","asyncGenerators","classProperties","classPrivateProperties"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.linux.x86_64"},"sourceFileName":"packages/server-render/server-sink.js","filename":"/Users/Florian/dev/epotek/microservices/backend/packages/server-render/server-sink.js","passPerPreset":false,"envName":"production","cwd":"/Users/Florian/dev/epotek/microservices/backend","root":"/Users/Florian/dev/epotek/microservices/backend","plugins":[{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"syntax-flow","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"transform-runtime","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"transform-modules-commonjs","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}}],"presets":[],"generatorOpts":{"filename":"/Users/Florian/dev/epotek/microservices/backend/packages/server-render/server-sink.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"packages/server-render/server-sink.js"}},"code":"module.export({\n  ServerSink: () => ServerSink,\n  isReadable: () => isReadable\n});\n\nclass ServerSink {\n  constructor(request, arch) {\n    this.request = request;\n    this.arch = arch;\n    this.head = \"\";\n    this.body = \"\";\n    this.htmlById = Object.create(null);\n    this.maybeMadeChanges = false;\n    this.statusCode = null;\n    this.responseHeaders = {};\n  }\n\n  appendToHead(html) {\n    if (appendContent(this, \"head\", html)) {\n      this.maybeMadeChanges = true;\n    }\n  }\n\n  appendToBody(html) {\n    if (appendContent(this, \"body\", html)) {\n      this.maybeMadeChanges = true;\n    }\n  }\n\n  appendToElementById(id, html) {\n    if (appendContent(this.htmlById, id, html)) {\n      this.maybeMadeChanges = true;\n    }\n  }\n\n  renderIntoElementById(id, html) {\n    this.htmlById[id] = \"\";\n    this.appendToElementById(id, html);\n  }\n\n  redirect(location, code = 301) {\n    this.maybeMadeChanges = true;\n    this.statusCode = code;\n    this.responseHeaders.Location = location;\n  } // server only methods\n\n\n  setStatusCode(code) {\n    this.maybeMadeChanges = true;\n    this.statusCode = code;\n  }\n\n  setHeader(key, value) {\n    this.maybeMadeChanges = true;\n    this.responseHeaders[key] = value;\n  }\n\n  getHeaders() {\n    return this.request.headers;\n  }\n\n  getCookies() {\n    return this.request.cookies;\n  }\n\n}\n\nfunction isReadable(stream) {\n  return stream !== null && typeof stream === 'object' && typeof stream.pipe === 'function' && stream.readable !== false && typeof stream._read === 'function' && typeof stream._readableState === 'object';\n}\n\nfunction appendContent(object, property, content) {\n  let madeChanges = false;\n\n  if (Array.isArray(content)) {\n    content.forEach(elem => {\n      if (appendContent(object, property, elem)) {\n        madeChanges = true;\n      }\n    });\n  } else if (isReadable(content)) {\n    object[property] = content;\n    madeChanges = true;\n  } else if (content = content && content.toString(\"utf8\")) {\n    object[property] = (object[property] || \"\") + content;\n    madeChanges = true;\n  }\n\n  return madeChanges;\n}","map":{"version":3,"sources":["packages/server-render/server-sink.js"],"names":["module","export","ServerSink","isReadable","constructor","request","arch","head","body","htmlById","Object","create","maybeMadeChanges","statusCode","responseHeaders","appendToHead","html","appendContent","appendToBody","appendToElementById","id","renderIntoElementById","redirect","location","code","Location","setStatusCode","setHeader","key","value","getHeaders","headers","getCookies","cookies","stream","pipe","readable","_read","_readableState","object","property","content","madeChanges","Array","isArray","forEach","elem","toString"],"mappings":"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","sourcesContent":["export class ServerSink {\n  constructor(request, arch) {\n    this.request = request;\n    this.arch = arch;\n    this.head = \"\";\n    this.body = \"\";\n    this.htmlById = Object.create(null);\n    this.maybeMadeChanges = false;\n    this.statusCode = null;\n    this.responseHeaders = {};\n  }\n\n  appendToHead(html) {\n    if (appendContent(this, \"head\", html)) {\n      this.maybeMadeChanges = true;\n    }\n  }\n\n  appendToBody(html) {\n    if (appendContent(this, \"body\", html)) {\n      this.maybeMadeChanges = true;\n    }\n  }\n\n  appendToElementById(id, html) {\n    if (appendContent(this.htmlById, id, html)) {\n      this.maybeMadeChanges = true;\n    }\n  }\n\n  renderIntoElementById(id, html) {\n    this.htmlById[id] = \"\";\n    this.appendToElementById(id, html);\n  }\n\n  redirect(location, code = 301) {\n    this.maybeMadeChanges = true;\n    this.statusCode = code;\n    this.responseHeaders.Location = location;\n  }\n\n  // server only methods\n  setStatusCode(code) {\n    this.maybeMadeChanges = true;\n    this.statusCode = code;\n  }\n\n  setHeader(key, value) {\n    this.maybeMadeChanges = true;\n    this.responseHeaders[key] = value;\n  }\n\n  getHeaders() {\n    return this.request.headers;\n  }\n\n  getCookies() {\n    return this.request.cookies;\n  }\n}\n\nexport function isReadable(stream) {\n  return (\n    stream !== null &&\n    typeof stream === 'object' &&\n    typeof stream.pipe === 'function' &&\n    stream.readable !== false &&\n    typeof stream._read === 'function' &&\n    typeof stream._readableState === 'object'\n  );\n}\n\nfunction appendContent(object, property, content) {\n  let madeChanges = false;\n\n  if (Array.isArray(content)) {\n    content.forEach(elem => {\n      if (appendContent(object, property, elem)) {\n        madeChanges = true;\n      }\n    });\n  } else if (isReadable(content)) {\n    object[property] = content;\n    madeChanges = true;\n  } else if ((content = content && content.toString(\"utf8\"))) {\n    object[property] = (object[property] || \"\") + content;\n    madeChanges = true;\n  } \n  return madeChanges;\n}\n"]},"sourceType":"script","hash":"0a143e7072e9af9f37457c8dd3c72db22baafdd6"}
