{"metadata":{},"options":{"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/Florian/dev/epotek/microservices/backend/imports/core/api/files/documents.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties",["flow",{}],"dynamicImport","classProperties","classPrivateProperties","jsx",["flow",{}],"asyncGenerators","objectRestSpread","objectRestSpread",["flow",{}],"asyncGenerators"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"imports/core/api/files/documents.js","filename":"/Users/Florian/dev/epotek/microservices/backend/imports/core/api/files/documents.js","inputSourceMap":{"version":3,"sources":["imports/core/api/files/documents.js"],"names":["PROPERTIES_COLLECTION","BORROWERS_COLLECTION","LOANS_COLLECTION","DOCUMENTS","DOCUMENTS_WITH_TOOLTIP","BORROWER_DOCUMENTS","PROPERTY_DOCUMENTS","LOAN_DOCUMENTS","documentHasTooltip","documentId","some","id","makeAllObjectDocuments","documents","Object","values","map","noTooltips","allDocuments","doc","collection","s3Documents","keys","key","otherAdditionalDocuments","filter","additionalDocuments","document","legacyCustomDocuments","length","requiredByAdminOnly","requiredByAdmin","formatAdditionalDoc","additionalDoc","required","makeGetDocuments","loan","options","isLoans","find","_id","additionalDocumentsExist","OTHER","getPropertyDocuments","getBorrowerDocuments","getLoanDocuments"],"mappings":"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","sourcesContent":["import {\n  PROPERTIES_COLLECTION,\n  BORROWERS_COLLECTION,\n  LOANS_COLLECTION,\n} from '../constants';\nimport {\n  DOCUMENTS,\n  DOCUMENTS_WITH_TOOLTIP,\n  BORROWER_DOCUMENTS,\n  PROPERTY_DOCUMENTS,\n  LOAN_DOCUMENTS,\n} from './fileConstants';\n\nexport const documentHasTooltip = documentId =>\n  !DOCUMENTS_WITH_TOOLTIP.some(id => documentId === id);\n\nconst makeAllObjectDocuments = documents =>\n  Object.values(documents).map(id => ({\n    id,\n    noTooltips: documentHasTooltip(id),\n  }));\n\nexport const allDocuments = ({ doc, collection }) => {\n  const s3Documents = doc.documents\n    ? Object.keys(doc.documents).map(key => ({ id: key }))\n    : [];\n  let documents = [];\n  switch (collection) {\n  case BORROWERS_COLLECTION:\n    documents = makeAllObjectDocuments(BORROWER_DOCUMENTS);\n    break;\n  case PROPERTIES_COLLECTION:\n    documents = makeAllObjectDocuments(PROPERTY_DOCUMENTS);\n    break;\n  case LOANS_COLLECTION:\n    documents = makeAllObjectDocuments(LOAN_DOCUMENTS);\n    break;\n  default:\n    break;\n  }\n\n  const otherAdditionalDocuments = documents.filter(({ id }) => !doc.additionalDocuments.some(document => id === document.id));\n  const legacyCustomDocuments = s3Documents.filter(({ id }) =>\n    !doc.additionalDocuments.some(document => id === document.id)\n      && !documents.some(document => id === document.id));\n\n  return doc.additionalDocuments && doc.additionalDocuments.length > 0\n    ? [\n      ...doc.additionalDocuments,\n      ...otherAdditionalDocuments,\n      ...legacyCustomDocuments,\n    ]\n    : documents;\n};\n\nconst requiredByAdminOnly = ({ requiredByAdmin }) => requiredByAdmin !== false;\n\nconst formatAdditionalDoc = additionalDoc => ({\n  ...additionalDoc,\n  required: true,\n  noTooltips: documentHasTooltip(additionalDoc.id),\n});\n\nconst makeGetDocuments = collection => ({ loan, id }, options = {}) => {\n  const { doc } = options;\n\n  const isLoans = collection === LOANS_COLLECTION;\n  if (!id && !isLoans) {\n    return [];\n  }\n\n  const document = doc || (!isLoans && loan[collection].find(({ _id }) => _id === id)) || loan;\n  const additionalDocumentsExist = document\n    && document.additionalDocuments\n    && document.additionalDocuments.length > 0;\n\n  return [\n    ...(additionalDocumentsExist\n      ? document.additionalDocuments\n        .filter(requiredByAdminOnly)\n        .map(formatAdditionalDoc)\n      : []),\n    { id: DOCUMENTS.OTHER, required: false, noTooltips: true },\n  ];\n};\n\nexport const getPropertyDocuments = makeGetDocuments(PROPERTIES_COLLECTION);\nexport const getBorrowerDocuments = makeGetDocuments(BORROWERS_COLLECTION);\nexport const getLoanDocuments = makeGetDocuments(LOANS_COLLECTION);\n"]},"passPerPreset":false,"envName":"development","cwd":"/Users/Florian/dev/epotek/microservices/backend","root":"/Users/Florian/dev/epotek/microservices/backend","plugins":[{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"transform-runtime","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-modules-commonjs","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-flow","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/Florian/dev/epotek/microservices/backend/imports/core/api/files/documents.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/core/api/files/documents.js"}},"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _objectSpread2 = _interopRequireDefault(require(\"@babel/runtime/helpers/objectSpread\"));\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nmodule.export({\n  documentHasTooltip: function () {\n    return documentHasTooltip;\n  },\n  allDocuments: function () {\n    return allDocuments;\n  },\n  getPropertyDocuments: function () {\n    return getPropertyDocuments;\n  },\n  getBorrowerDocuments: function () {\n    return getBorrowerDocuments;\n  },\n  getLoanDocuments: function () {\n    return getLoanDocuments;\n  }\n});\nvar PROPERTIES_COLLECTION, BORROWERS_COLLECTION, LOANS_COLLECTION;\nmodule.link(\"../constants\", {\n  PROPERTIES_COLLECTION: function (v) {\n    PROPERTIES_COLLECTION = v;\n  },\n  BORROWERS_COLLECTION: function (v) {\n    BORROWERS_COLLECTION = v;\n  },\n  LOANS_COLLECTION: function (v) {\n    LOANS_COLLECTION = v;\n  }\n}, 0);\nvar DOCUMENTS, DOCUMENTS_WITH_TOOLTIP, BORROWER_DOCUMENTS, PROPERTY_DOCUMENTS, LOAN_DOCUMENTS;\nmodule.link(\"./fileConstants\", {\n  DOCUMENTS: function (v) {\n    DOCUMENTS = v;\n  },\n  DOCUMENTS_WITH_TOOLTIP: function (v) {\n    DOCUMENTS_WITH_TOOLTIP = v;\n  },\n  BORROWER_DOCUMENTS: function (v) {\n    BORROWER_DOCUMENTS = v;\n  },\n  PROPERTY_DOCUMENTS: function (v) {\n    PROPERTY_DOCUMENTS = v;\n  },\n  LOAN_DOCUMENTS: function (v) {\n    LOAN_DOCUMENTS = v;\n  }\n}, 1);\n\nvar documentHasTooltip = function (documentId) {\n  return !DOCUMENTS_WITH_TOOLTIP.some(function (id) {\n    return documentId === id;\n  });\n};\n\nvar makeAllObjectDocuments = function (documents) {\n  return Object.values(documents).map(function (id) {\n    return {\n      id: id,\n      noTooltips: documentHasTooltip(id)\n    };\n  });\n};\n\nvar allDocuments = function (_ref) {\n  var doc = _ref.doc,\n      collection = _ref.collection;\n  var s3Documents = doc.documents ? Object.keys(doc.documents).map(function (key) {\n    return {\n      id: key\n    };\n  }) : [];\n  var documents = [];\n\n  switch (collection) {\n    case BORROWERS_COLLECTION:\n      documents = makeAllObjectDocuments(BORROWER_DOCUMENTS);\n      break;\n\n    case PROPERTIES_COLLECTION:\n      documents = makeAllObjectDocuments(PROPERTY_DOCUMENTS);\n      break;\n\n    case LOANS_COLLECTION:\n      documents = makeAllObjectDocuments(LOAN_DOCUMENTS);\n      break;\n\n    default:\n      break;\n  }\n\n  var otherAdditionalDocuments = documents.filter(function (_ref2) {\n    var id = _ref2.id;\n    return !doc.additionalDocuments.some(function (document) {\n      return id === document.id;\n    });\n  });\n  var legacyCustomDocuments = s3Documents.filter(function (_ref3) {\n    var id = _ref3.id;\n    return !doc.additionalDocuments.some(function (document) {\n      return id === document.id;\n    }) && !documents.some(function (document) {\n      return id === document.id;\n    });\n  });\n  return doc.additionalDocuments && doc.additionalDocuments.length > 0 ? [].concat((0, _toConsumableArray2.default)(doc.additionalDocuments), (0, _toConsumableArray2.default)(otherAdditionalDocuments), (0, _toConsumableArray2.default)(legacyCustomDocuments)) : documents;\n};\n\nvar requiredByAdminOnly = function (_ref4) {\n  var requiredByAdmin = _ref4.requiredByAdmin;\n  return requiredByAdmin !== false;\n};\n\nvar formatAdditionalDoc = function (additionalDoc) {\n  return (0, _objectSpread2.default)({}, additionalDoc, {\n    required: true,\n    noTooltips: documentHasTooltip(additionalDoc.id)\n  });\n};\n\nvar makeGetDocuments = function (collection) {\n  return function (_ref5) {\n    var loan = _ref5.loan,\n        id = _ref5.id;\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var doc = options.doc;\n    var isLoans = collection === LOANS_COLLECTION;\n\n    if (!id && !isLoans) {\n      return [];\n    }\n\n    var document = doc || !isLoans && loan[collection].find(function (_ref6) {\n      var _id = _ref6._id;\n      return _id === id;\n    }) || loan;\n    var additionalDocumentsExist = document && document.additionalDocuments && document.additionalDocuments.length > 0;\n    return [].concat((0, _toConsumableArray2.default)(additionalDocumentsExist ? document.additionalDocuments.filter(requiredByAdminOnly).map(formatAdditionalDoc) : []), [{\n      id: DOCUMENTS.OTHER,\n      required: false,\n      noTooltips: true\n    }]);\n  };\n};\n\nvar getPropertyDocuments = makeGetDocuments(PROPERTIES_COLLECTION);\nvar getBorrowerDocuments = makeGetDocuments(BORROWERS_COLLECTION);\nvar getLoanDocuments = makeGetDocuments(LOANS_COLLECTION);","map":{"version":3,"sources":["imports/core/api/files/documents.js"],"names":["PROPERTIES_COLLECTION","BORROWERS_COLLECTION","LOANS_COLLECTION","documentHasTooltip","documentId","DOCUMENTS_WITH_TOOLTIP","id","makeAllObjectDocuments","documents","noTooltips","allDocuments","collection","s3Documents","doc","key","otherAdditionalDocuments","document","legacyCustomDocuments","requiredByAdminOnly","requiredByAdmin","formatAdditionalDoc","additionalDoc","required","makeGetDocuments","options","isLoans","_id","additionalDocumentsExist","DOCUMENTS","getPropertyDocuments","getBorrowerDocuments","getLoanDocuments"],"mappings":"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","sourcesContent":["import {\n  PROPERTIES_COLLECTION,\n  BORROWERS_COLLECTION,\n  LOANS_COLLECTION,\n} from '../constants';\nimport {\n  DOCUMENTS,\n  DOCUMENTS_WITH_TOOLTIP,\n  BORROWER_DOCUMENTS,\n  PROPERTY_DOCUMENTS,\n  LOAN_DOCUMENTS,\n} from './fileConstants';\n\nexport const documentHasTooltip = documentId =>\n  !DOCUMENTS_WITH_TOOLTIP.some(id => documentId === id);\n\nconst makeAllObjectDocuments = documents =>\n  Object.values(documents).map(id => ({\n    id,\n    noTooltips: documentHasTooltip(id),\n  }));\n\nexport const allDocuments = ({ doc, collection }) => {\n  const s3Documents = doc.documents\n    ? Object.keys(doc.documents).map(key => ({ id: key }))\n    : [];\n  let documents = [];\n  switch (collection) {\n  case BORROWERS_COLLECTION:\n    documents = makeAllObjectDocuments(BORROWER_DOCUMENTS);\n    break;\n  case PROPERTIES_COLLECTION:\n    documents = makeAllObjectDocuments(PROPERTY_DOCUMENTS);\n    break;\n  case LOANS_COLLECTION:\n    documents = makeAllObjectDocuments(LOAN_DOCUMENTS);\n    break;\n  default:\n    break;\n  }\n\n  const otherAdditionalDocuments = documents.filter(({ id }) => !doc.additionalDocuments.some(document => id === document.id));\n  const legacyCustomDocuments = s3Documents.filter(({ id }) =>\n    !doc.additionalDocuments.some(document => id === document.id)\n      && !documents.some(document => id === document.id));\n\n  return doc.additionalDocuments && doc.additionalDocuments.length > 0\n    ? [\n      ...doc.additionalDocuments,\n      ...otherAdditionalDocuments,\n      ...legacyCustomDocuments,\n    ]\n    : documents;\n};\n\nconst requiredByAdminOnly = ({ requiredByAdmin }) => requiredByAdmin !== false;\n\nconst formatAdditionalDoc = additionalDoc => ({\n  ...additionalDoc,\n  required: true,\n  noTooltips: documentHasTooltip(additionalDoc.id),\n});\n\nconst makeGetDocuments = collection => ({ loan, id }, options = {}) => {\n  const { doc } = options;\n\n  const isLoans = collection === LOANS_COLLECTION;\n  if (!id && !isLoans) {\n    return [];\n  }\n\n  const document = doc || (!isLoans && loan[collection].find(({ _id }) => _id === id)) || loan;\n  const additionalDocumentsExist = document\n    && document.additionalDocuments\n    && document.additionalDocuments.length > 0;\n\n  return [\n    ...(additionalDocumentsExist\n      ? document.additionalDocuments\n        .filter(requiredByAdminOnly)\n        .map(formatAdditionalDoc)\n      : []),\n    { id: DOCUMENTS.OTHER, required: false, noTooltips: true },\n  ];\n};\n\nexport const getPropertyDocuments = makeGetDocuments(PROPERTIES_COLLECTION);\nexport const getBorrowerDocuments = makeGetDocuments(BORROWERS_COLLECTION);\nexport const getLoanDocuments = makeGetDocuments(LOANS_COLLECTION);\n"]},"sourceType":"script","hash":"a67e5b5422a7cf77b263fa32fa63074045fe08f7"}
