{"metadata":{},"options":{"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/Florian/dev/epotek/microservices/backend/imports/core/components/IconLink/CollectionIconLink.jsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties",["flow",{}],"dynamicImport","classProperties","classPrivateProperties","jsx",["flow",{}],"asyncGenerators","objectRestSpread","objectRestSpread",["flow",{}],"asyncGenerators"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"imports/core/components/IconLink/CollectionIconLink.jsx","filename":"/Users/Florian/dev/epotek/microservices/backend/imports/core/components/IconLink/CollectionIconLink.jsx","inputSourceMap":{"version":3,"sources":["imports/core/components/IconLink/CollectionIconLink.jsx"],"names":["Meteor","React","Roles","getUserNameAndOrganisation","IconLink","LOANS_COLLECTION","USERS_COLLECTION","BORROWERS_COLLECTION","PROPERTIES_COLLECTION","OFFERS_COLLECTION","PROMOTIONS_COLLECTION","ORGANISATIONS_COLLECTION","CONTACTS_COLLECTION","ROLES","employeesById","collectionIcons","CollectionIconLinkPopup","getLoanLinkTitle","CollectionIconLinkProps","relatedDoc","Object","stopPropagation","Boolean","iconClassName","showIcon","showPopups","microservice","getIconConfig","collection","_id","docId","data","variant","link","icon","text","name","hasPopup","organisations","roles","includes","ADMIN","DEV","src","borderRadius","width","height","length","user","address1","organisation","isDev","userIsInRole","userId","isMain","$metadata","title","CollectionIconLink","forceOpen"],"mappings":"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","sourcesContent":["// @flow\nimport { Meteor } from 'meteor/meteor';\nimport React from 'react';\nimport { Roles } from 'meteor/alanning:roles';\n\nimport { getUserNameAndOrganisation } from '../../api/helpers';\nimport IconLink from './IconLink';\nimport {\n  LOANS_COLLECTION,\n  USERS_COLLECTION,\n  BORROWERS_COLLECTION,\n  PROPERTIES_COLLECTION,\n  OFFERS_COLLECTION,\n  PROMOTIONS_COLLECTION,\n  ORGANISATIONS_COLLECTION,\n  CONTACTS_COLLECTION,\n  ROLES,\n} from '../../api/constants';\nimport { employeesById } from '../../arrays/epotekEmployees';\nimport collectionIcons from '../../arrays/collectionIcons';\nimport CollectionIconLinkPopup from './CollectionIconLinkPopup/CollectionIconLinkPopup';\nimport { getLoanLinkTitle } from './collectionIconLinkHelpers';\n\ntype CollectionIconLinkProps = {\n  relatedDoc: Object,\n  stopPropagation?: Boolean,\n  iconClassName?: string,\n  showIcon?: Boolean,\n};\n\nconst showPopups = Meteor.microservice === 'admin';\n\nconst getIconConfig = ({ collection, _id: docId, ...data } = {}, variant) => {\n  if (!docId) {\n    return {\n      link: '/',\n      icon: 'help',\n      text: \"N'existe plus\",\n    };\n  }\n\n  switch (collection) {\n  case LOANS_COLLECTION: {\n    let text;\n\n    if (variant === 'TASKS_TABLE') {\n      text = getLoanLinkTitle(data);\n    } else {\n      text = data.name;\n    }\n\n    return {\n      link: `/loans/${docId}`,\n      text,\n      hasPopup: true,\n    };\n  }\n  case USERS_COLLECTION: {\n    let text;\n    const { organisations = [], roles = [] } = data;\n    if (\n      (roles.includes(ROLES.ADMIN) || roles.includes(ROLES.DEV))\n        && employeesById[docId]\n    ) {\n      text = (\n        <img\n          src={employeesById[docId].src}\n          alt={data.name}\n          style={{ borderRadius: '50%', width: 20, height: 20 }}\n        />\n      );\n    } else if (organisations.length) {\n      text = getUserNameAndOrganisation({ user: data });\n    } else {\n      text = data.name;\n    }\n\n    return {\n      link: `/users/${docId}`,\n      text,\n      hasPopup: true,\n    };\n  }\n  case BORROWERS_COLLECTION:\n    return {\n      link: `/borrowers/${docId}`,\n      text: data.name,\n      hasPopup: true,\n    };\n  case PROPERTIES_COLLECTION:\n    return {\n      link: `/properties/${docId}`,\n      text: data.address1,\n      hasPopup: true,\n    };\n  case OFFERS_COLLECTION:\n    return {\n      link: `/offers/${docId}`,\n      text: data.organisation.name,\n      hasPopup: true,\n    };\n  case PROMOTIONS_COLLECTION:\n    return {\n      link: `/promotions/${docId}`,\n      text: data.name,\n      hasPopup: true,\n    };\n  case ORGANISATIONS_COLLECTION: {\n    let text;\n    const isDev = Roles.userIsInRole(Meteor.userId(), 'dev');\n    const isMain = data.$metadata && data.$metadata.isMain;\n\n    if (data.$metadata && data.$metadata.title) {\n      text = `${data.$metadata.title} @ ${data.name}${\n        isDev && isMain ? ' (main)' : ''\n      }`;\n    } else {\n      text = `${data.name}${isDev && isMain ? ' (main)' : ''}`;\n    }\n\n    return {\n      link: `/organisations/${docId}`,\n      text,\n      hasPopup: true,\n    };\n  }\n  case CONTACTS_COLLECTION:\n    return {\n      link: `/contacts/${docId}`,\n      text: data.name,\n      hasPopup: true,\n    };\n  case 'NOT_FOUND':\n    return {\n      link: '/',\n      icon: 'help',\n      text: \"N'existe plus\",\n    };\n\n  default:\n    return { text: 'Unknown collection' };\n  }\n};\n\nconst CollectionIconLink = ({\n  forceOpen,\n  iconClassName,\n  relatedDoc,\n  showIcon,\n  stopPropagation,\n  variant,\n}: CollectionIconLinkProps) => {\n  const { collection, _id: docId } = relatedDoc;\n\n  if (!docId) {\n    return null;\n  }\n\n  const {\n    link,\n    icon = collectionIcons[collection],\n    text,\n    hasPopup,\n  } = getIconConfig(relatedDoc, variant);\n\n  if (showPopups && hasPopup) {\n    return (\n      <CollectionIconLinkPopup\n        {...relatedDoc}\n        key={relatedDoc._id}\n        forceOpen={forceOpen}\n      >\n        <IconLink\n          link={link}\n          icon={icon}\n          text={text}\n          className=\"collection-icon\"\n          stopPropagation={stopPropagation}\n          iconClassName={iconClassName}\n          showIcon={showIcon}\n        />\n      </CollectionIconLinkPopup>\n    );\n  }\n\n  return (\n    <IconLink\n      link={link}\n      icon={icon}\n      text={text}\n      stopPropagation={stopPropagation}\n      className=\"collection-icon\"\n      iconClassName={iconClassName}\n      showIcon={showIcon}\n      noIcon\n    />\n  );\n};\n\nexport default CollectionIconLink;\n"]},"passPerPreset":false,"envName":"development","cwd":"/Users/Florian/dev/epotek/microservices/backend","root":"/Users/Florian/dev/epotek/microservices/backend","plugins":[{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"transform-runtime","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-modules-commonjs","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-flow","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/Florian/dev/epotek/microservices/backend/imports/core/components/IconLink/CollectionIconLink.jsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/core/components/IconLink/CollectionIconLink.jsx"}},"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _objectWithoutProperties2 = _interopRequireDefault(require(\"@babel/runtime/helpers/objectWithoutProperties\"));\n\nvar Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 0);\nvar React;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  }\n}, 1);\nvar Roles;\nmodule.link(\"meteor/alanning:roles\", {\n  Roles: function (v) {\n    Roles = v;\n  }\n}, 2);\nvar getUserNameAndOrganisation;\nmodule.link(\"../../api/helpers\", {\n  getUserNameAndOrganisation: function (v) {\n    getUserNameAndOrganisation = v;\n  }\n}, 3);\nvar IconLink;\nmodule.link(\"./IconLink\", {\n  \"default\": function (v) {\n    IconLink = v;\n  }\n}, 4);\nvar LOANS_COLLECTION, USERS_COLLECTION, BORROWERS_COLLECTION, PROPERTIES_COLLECTION, OFFERS_COLLECTION, PROMOTIONS_COLLECTION, ORGANISATIONS_COLLECTION, CONTACTS_COLLECTION, ROLES;\nmodule.link(\"../../api/constants\", {\n  LOANS_COLLECTION: function (v) {\n    LOANS_COLLECTION = v;\n  },\n  USERS_COLLECTION: function (v) {\n    USERS_COLLECTION = v;\n  },\n  BORROWERS_COLLECTION: function (v) {\n    BORROWERS_COLLECTION = v;\n  },\n  PROPERTIES_COLLECTION: function (v) {\n    PROPERTIES_COLLECTION = v;\n  },\n  OFFERS_COLLECTION: function (v) {\n    OFFERS_COLLECTION = v;\n  },\n  PROMOTIONS_COLLECTION: function (v) {\n    PROMOTIONS_COLLECTION = v;\n  },\n  ORGANISATIONS_COLLECTION: function (v) {\n    ORGANISATIONS_COLLECTION = v;\n  },\n  CONTACTS_COLLECTION: function (v) {\n    CONTACTS_COLLECTION = v;\n  },\n  ROLES: function (v) {\n    ROLES = v;\n  }\n}, 5);\nvar employeesById;\nmodule.link(\"../../arrays/epotekEmployees\", {\n  employeesById: function (v) {\n    employeesById = v;\n  }\n}, 6);\nvar collectionIcons;\nmodule.link(\"../../arrays/collectionIcons\", {\n  \"default\": function (v) {\n    collectionIcons = v;\n  }\n}, 7);\nvar CollectionIconLinkPopup;\nmodule.link(\"./CollectionIconLinkPopup/CollectionIconLinkPopup\", {\n  \"default\": function (v) {\n    CollectionIconLinkPopup = v;\n  }\n}, 8);\nvar getLoanLinkTitle;\nmodule.link(\"./collectionIconLinkHelpers\", {\n  getLoanLinkTitle: function (v) {\n    getLoanLinkTitle = v;\n  }\n}, 9);\nvar showPopups = Meteor.microservice === 'admin';\n\nvar getIconConfig = function () {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      collection = _ref.collection,\n      docId = _ref._id,\n      data = (0, _objectWithoutProperties2.default)(_ref, [\"collection\", \"_id\"]);\n\n  var variant = arguments.length > 1 ? arguments[1] : undefined;\n\n  if (!docId) {\n    return {\n      link: '/',\n      icon: 'help',\n      text: \"N'existe plus\"\n    };\n  }\n\n  switch (collection) {\n    case LOANS_COLLECTION:\n      {\n        var text;\n\n        if (variant === 'TASKS_TABLE') {\n          text = getLoanLinkTitle(data);\n        } else {\n          text = data.name;\n        }\n\n        return {\n          link: \"/loans/\" + docId,\n          text: text,\n          hasPopup: true\n        };\n      }\n\n    case USERS_COLLECTION:\n      {\n        var _text;\n\n        var _data$organisations = data.organisations,\n            organisations = _data$organisations === void 0 ? [] : _data$organisations,\n            _data$roles = data.roles,\n            roles = _data$roles === void 0 ? [] : _data$roles;\n\n        if ((roles.includes(ROLES.ADMIN) || roles.includes(ROLES.DEV)) && employeesById[docId]) {\n          _text = React.createElement(\"img\", {\n            src: employeesById[docId].src,\n            alt: data.name,\n            style: {\n              borderRadius: '50%',\n              width: 20,\n              height: 20\n            }\n          });\n        } else if (organisations.length) {\n          _text = getUserNameAndOrganisation({\n            user: data\n          });\n        } else {\n          _text = data.name;\n        }\n\n        return {\n          link: \"/users/\" + docId,\n          text: _text,\n          hasPopup: true\n        };\n      }\n\n    case BORROWERS_COLLECTION:\n      return {\n        link: \"/borrowers/\" + docId,\n        text: data.name,\n        hasPopup: true\n      };\n\n    case PROPERTIES_COLLECTION:\n      return {\n        link: \"/properties/\" + docId,\n        text: data.address1,\n        hasPopup: true\n      };\n\n    case OFFERS_COLLECTION:\n      return {\n        link: \"/offers/\" + docId,\n        text: data.organisation.name,\n        hasPopup: true\n      };\n\n    case PROMOTIONS_COLLECTION:\n      return {\n        link: \"/promotions/\" + docId,\n        text: data.name,\n        hasPopup: true\n      };\n\n    case ORGANISATIONS_COLLECTION:\n      {\n        var _text2;\n\n        var isDev = Roles.userIsInRole(Meteor.userId(), 'dev');\n        var isMain = data.$metadata && data.$metadata.isMain;\n\n        if (data.$metadata && data.$metadata.title) {\n          _text2 = data.$metadata.title + \" @ \" + data.name + (isDev && isMain ? ' (main)' : '');\n        } else {\n          _text2 = \"\" + data.name + (isDev && isMain ? ' (main)' : '');\n        }\n\n        return {\n          link: \"/organisations/\" + docId,\n          text: _text2,\n          hasPopup: true\n        };\n      }\n\n    case CONTACTS_COLLECTION:\n      return {\n        link: \"/contacts/\" + docId,\n        text: data.name,\n        hasPopup: true\n      };\n\n    case 'NOT_FOUND':\n      return {\n        link: '/',\n        icon: 'help',\n        text: \"N'existe plus\"\n      };\n\n    default:\n      return {\n        text: 'Unknown collection'\n      };\n  }\n};\n\nvar CollectionIconLink = function (_ref2) {\n  var forceOpen = _ref2.forceOpen,\n      iconClassName = _ref2.iconClassName,\n      relatedDoc = _ref2.relatedDoc,\n      showIcon = _ref2.showIcon,\n      stopPropagation = _ref2.stopPropagation,\n      variant = _ref2.variant;\n  var collection = relatedDoc.collection,\n      docId = relatedDoc._id;\n\n  if (!docId) {\n    return null;\n  }\n\n  var _getIconConfig = getIconConfig(relatedDoc, variant),\n      link = _getIconConfig.link,\n      _getIconConfig$icon = _getIconConfig.icon,\n      icon = _getIconConfig$icon === void 0 ? collectionIcons[collection] : _getIconConfig$icon,\n      text = _getIconConfig.text,\n      hasPopup = _getIconConfig.hasPopup;\n\n  if (showPopups && hasPopup) {\n    return React.createElement(CollectionIconLinkPopup, (0, _extends2.default)({}, relatedDoc, {\n      key: relatedDoc._id,\n      forceOpen: forceOpen\n    }), React.createElement(IconLink, {\n      link: link,\n      icon: icon,\n      text: text,\n      className: \"collection-icon\",\n      stopPropagation: stopPropagation,\n      iconClassName: iconClassName,\n      showIcon: showIcon\n    }));\n  }\n\n  return React.createElement(IconLink, {\n    link: link,\n    icon: icon,\n    text: text,\n    stopPropagation: stopPropagation,\n    className: \"collection-icon\",\n    iconClassName: iconClassName,\n    showIcon: showIcon,\n    noIcon: true\n  });\n};\n\nmodule.exportDefault(CollectionIconLink);","map":{"version":3,"sources":["imports/core/components/IconLink/CollectionIconLink.jsx"],"names":["showPopups","Meteor","getIconConfig","_id","data","link","icon","text","variant","getLoanLinkTitle","hasPopup","organisations","roles","ROLES","employeesById","borderRadius","width","height","getUserNameAndOrganisation","user","isDev","Roles","isMain","title","name","CollectionIconLink","docId","collectionIcons","relatedDoc"],"mappings":"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","sourcesContent":["// @flow\nimport { Meteor } from 'meteor/meteor';\nimport React from 'react';\nimport { Roles } from 'meteor/alanning:roles';\n\nimport { getUserNameAndOrganisation } from '../../api/helpers';\nimport IconLink from './IconLink';\nimport {\n  LOANS_COLLECTION,\n  USERS_COLLECTION,\n  BORROWERS_COLLECTION,\n  PROPERTIES_COLLECTION,\n  OFFERS_COLLECTION,\n  PROMOTIONS_COLLECTION,\n  ORGANISATIONS_COLLECTION,\n  CONTACTS_COLLECTION,\n  ROLES,\n} from '../../api/constants';\nimport { employeesById } from '../../arrays/epotekEmployees';\nimport collectionIcons from '../../arrays/collectionIcons';\nimport CollectionIconLinkPopup from './CollectionIconLinkPopup/CollectionIconLinkPopup';\nimport { getLoanLinkTitle } from './collectionIconLinkHelpers';\n\ntype CollectionIconLinkProps = {\n  relatedDoc: Object,\n  stopPropagation?: Boolean,\n  iconClassName?: string,\n  showIcon?: Boolean,\n};\n\nconst showPopups = Meteor.microservice === 'admin';\n\nconst getIconConfig = ({ collection, _id: docId, ...data } = {}, variant) => {\n  if (!docId) {\n    return {\n      link: '/',\n      icon: 'help',\n      text: \"N'existe plus\",\n    };\n  }\n\n  switch (collection) {\n  case LOANS_COLLECTION: {\n    let text;\n\n    if (variant === 'TASKS_TABLE') {\n      text = getLoanLinkTitle(data);\n    } else {\n      text = data.name;\n    }\n\n    return {\n      link: `/loans/${docId}`,\n      text,\n      hasPopup: true,\n    };\n  }\n  case USERS_COLLECTION: {\n    let text;\n    const { organisations = [], roles = [] } = data;\n    if (\n      (roles.includes(ROLES.ADMIN) || roles.includes(ROLES.DEV))\n        && employeesById[docId]\n    ) {\n      text = (\n        <img\n          src={employeesById[docId].src}\n          alt={data.name}\n          style={{ borderRadius: '50%', width: 20, height: 20 }}\n        />\n      );\n    } else if (organisations.length) {\n      text = getUserNameAndOrganisation({ user: data });\n    } else {\n      text = data.name;\n    }\n\n    return {\n      link: `/users/${docId}`,\n      text,\n      hasPopup: true,\n    };\n  }\n  case BORROWERS_COLLECTION:\n    return {\n      link: `/borrowers/${docId}`,\n      text: data.name,\n      hasPopup: true,\n    };\n  case PROPERTIES_COLLECTION:\n    return {\n      link: `/properties/${docId}`,\n      text: data.address1,\n      hasPopup: true,\n    };\n  case OFFERS_COLLECTION:\n    return {\n      link: `/offers/${docId}`,\n      text: data.organisation.name,\n      hasPopup: true,\n    };\n  case PROMOTIONS_COLLECTION:\n    return {\n      link: `/promotions/${docId}`,\n      text: data.name,\n      hasPopup: true,\n    };\n  case ORGANISATIONS_COLLECTION: {\n    let text;\n    const isDev = Roles.userIsInRole(Meteor.userId(), 'dev');\n    const isMain = data.$metadata && data.$metadata.isMain;\n\n    if (data.$metadata && data.$metadata.title) {\n      text = `${data.$metadata.title} @ ${data.name}${\n        isDev && isMain ? ' (main)' : ''\n      }`;\n    } else {\n      text = `${data.name}${isDev && isMain ? ' (main)' : ''}`;\n    }\n\n    return {\n      link: `/organisations/${docId}`,\n      text,\n      hasPopup: true,\n    };\n  }\n  case CONTACTS_COLLECTION:\n    return {\n      link: `/contacts/${docId}`,\n      text: data.name,\n      hasPopup: true,\n    };\n  case 'NOT_FOUND':\n    return {\n      link: '/',\n      icon: 'help',\n      text: \"N'existe plus\",\n    };\n\n  default:\n    return { text: 'Unknown collection' };\n  }\n};\n\nconst CollectionIconLink = ({\n  forceOpen,\n  iconClassName,\n  relatedDoc,\n  showIcon,\n  stopPropagation,\n  variant,\n}: CollectionIconLinkProps) => {\n  const { collection, _id: docId } = relatedDoc;\n\n  if (!docId) {\n    return null;\n  }\n\n  const {\n    link,\n    icon = collectionIcons[collection],\n    text,\n    hasPopup,\n  } = getIconConfig(relatedDoc, variant);\n\n  if (showPopups && hasPopup) {\n    return (\n      <CollectionIconLinkPopup\n        {...relatedDoc}\n        key={relatedDoc._id}\n        forceOpen={forceOpen}\n      >\n        <IconLink\n          link={link}\n          icon={icon}\n          text={text}\n          className=\"collection-icon\"\n          stopPropagation={stopPropagation}\n          iconClassName={iconClassName}\n          showIcon={showIcon}\n        />\n      </CollectionIconLinkPopup>\n    );\n  }\n\n  return (\n    <IconLink\n      link={link}\n      icon={icon}\n      text={text}\n      stopPropagation={stopPropagation}\n      className=\"collection-icon\"\n      iconClassName={iconClassName}\n      showIcon={showIcon}\n      noIcon\n    />\n  );\n};\n\nexport default CollectionIconLink;\n"]},"sourceType":"script","hash":"9b6a20086133ca1a789736ebd52bc4ed6d0f0750"}
