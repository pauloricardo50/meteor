{"metadata":{},"options":{"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/Florian/dev/epotek/microservices/backend/imports/core/components/Financing/client/FinancingOwnFunds/FinancingOwnFundsPicker/OwnFundsCompleterContainer.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties",["flow",{}],"dynamicImport","classProperties","classPrivateProperties","jsx",["flow",{}],"asyncGenerators","objectRestSpread","objectRestSpread",["flow",{}],"asyncGenerators"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"imports/core/components/Financing/client/FinancingOwnFunds/FinancingOwnFundsPicker/OwnFundsCompleterContainer.js","filename":"/Users/Florian/dev/epotek/microservices/backend/imports/core/components/Financing/client/FinancingOwnFunds/FinancingOwnFundsPicker/OwnFundsCompleterContainer.js","inputSourceMap":{"version":3,"sources":["imports/core/components/Financing/client/FinancingOwnFunds/FinancingOwnFundsPicker/OwnFundsCompleterContainer.js"],"names":["compose","withProps","OWN_FUNDS_USAGE_TYPES","FinancingDataContainer","SingleStructureContainer","getCurrentPledgedFunds","getMaxPledge","Calculator","removePreviousValueEffect","props","ownFundsIndex","ownFunds","requiredChange","currentChange","previousIsPledged","usageType","PLEDGE","maxPledge","previousPledgedValue","value","Math","min","removePledgingEffect","currentPledgedFunds","getRequiredAndCurrentFunds","structure","required","getRequiredOwnFunds","previousNonPledgedFunds","filter","uT","reduce","sum","v","current","isEditing","OwnFundsCompleterContainer"],"mappings":"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","sourcesContent":["import { compose, withProps } from 'recompose';\n\nimport { OWN_FUNDS_USAGE_TYPES } from 'core/api/constants';\nimport FinancingDataContainer from '../../containers/FinancingDataContainer';\nimport SingleStructureContainer from '../../containers/SingleStructureContainer';\nimport {\n  getCurrentPledgedFunds,\n  getMaxPledge,\n} from './FinancingOwnFundsPickerHelpers';\nimport Calculator from '../../../../../utils/Calculator';\n\nconst removePreviousValueEffect = ({ props, ownFundsIndex, ownFunds }) => {\n  let requiredChange = 0;\n  let currentChange = 0;\n  // Editing existing value, cancel its effect\n  const previousIsPledged = ownFunds[ownFundsIndex].usageType === OWN_FUNDS_USAGE_TYPES.PLEDGE;\n\n  if (previousIsPledged) {\n    const maxPledge = getMaxPledge(props);\n    const previousPledgedValue = ownFunds[ownFundsIndex].value;\n    requiredChange = Math.min(previousPledgedValue, maxPledge);\n  } else {\n    currentChange = -ownFunds[ownFundsIndex].value;\n  }\n\n  return { requiredChange, currentChange };\n};\n\nconst removePledgingEffect = ({ props, ownFunds, ownFundsIndex, value }) => {\n  const maxPledge = getMaxPledge(props);\n  const currentPledgedFunds = getCurrentPledgedFunds({\n    ownFunds,\n    ownFundsIndex,\n  });\n\n  return {\n    requiredChange: -Math.min(currentPledgedFunds + (value || 0), maxPledge),\n    currentChange: -value || 0,\n  };\n};\n\nexport const getRequiredAndCurrentFunds = (props) => {\n  const {\n    value,\n    structure: { ownFunds },\n    ownFundsIndex,\n    usageType,\n  } = props;\n  let required = Calculator.getRequiredOwnFunds(props);\n  const previousNonPledgedFunds = ownFunds\n    .filter(({ usageType: uT }) => uT !== OWN_FUNDS_USAGE_TYPES.PLEDGE)\n    .reduce((sum, { value: v }) => sum + v, 0);\n  let current = previousNonPledgedFunds + (value || 0);\n  const isEditing = ownFundsIndex >= 0;\n\n  if (isEditing) {\n    const { requiredChange, currentChange } = removePreviousValueEffect({\n      props,\n      ownFundsIndex,\n      ownFunds,\n    });\n    required += requiredChange;\n    current += currentChange;\n  }\n\n  if (usageType === OWN_FUNDS_USAGE_TYPES.PLEDGE) {\n    const { requiredChange, currentChange } = removePledgingEffect({\n      props,\n      ownFunds,\n      ownFundsIndex,\n      value,\n    });\n    required += requiredChange;\n    current += currentChange;\n  }\n\n  return { required, current };\n};\n\nconst OwnFundsCompleterContainer = compose(\n  SingleStructureContainer,\n  FinancingDataContainer,\n  withProps(getRequiredAndCurrentFunds),\n);\n\nexport default OwnFundsCompleterContainer;\n"]},"passPerPreset":false,"envName":"development","cwd":"/Users/Florian/dev/epotek/microservices/backend","root":"/Users/Florian/dev/epotek/microservices/backend","plugins":[{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"transform-runtime","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-modules-commonjs","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-flow","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/Florian/dev/epotek/microservices/backend/imports/core/components/Financing/client/FinancingOwnFunds/FinancingOwnFundsPicker/OwnFundsCompleterContainer.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/core/components/Financing/client/FinancingOwnFunds/FinancingOwnFundsPicker/OwnFundsCompleterContainer.js"}},"code":"module.export({\n  getRequiredAndCurrentFunds: () => getRequiredAndCurrentFunds\n});\nlet compose, withProps;\nmodule.link(\"recompose\", {\n  compose(v) {\n    compose = v;\n  },\n\n  withProps(v) {\n    withProps = v;\n  }\n\n}, 0);\nlet OWN_FUNDS_USAGE_TYPES;\nmodule.link(\"../../../../../api/constants\", {\n  OWN_FUNDS_USAGE_TYPES(v) {\n    OWN_FUNDS_USAGE_TYPES = v;\n  }\n\n}, 1);\nlet FinancingDataContainer;\nmodule.link(\"../../containers/FinancingDataContainer\", {\n  default(v) {\n    FinancingDataContainer = v;\n  }\n\n}, 2);\nlet SingleStructureContainer;\nmodule.link(\"../../containers/SingleStructureContainer\", {\n  default(v) {\n    SingleStructureContainer = v;\n  }\n\n}, 3);\nlet getCurrentPledgedFunds, getMaxPledge;\nmodule.link(\"./FinancingOwnFundsPickerHelpers\", {\n  getCurrentPledgedFunds(v) {\n    getCurrentPledgedFunds = v;\n  },\n\n  getMaxPledge(v) {\n    getMaxPledge = v;\n  }\n\n}, 4);\nlet Calculator;\nmodule.link(\"../../../../../utils/Calculator\", {\n  default(v) {\n    Calculator = v;\n  }\n\n}, 5);\n\nconst removePreviousValueEffect = (_ref) => {\n  let {\n    props,\n    ownFundsIndex,\n    ownFunds\n  } = _ref;\n  let requiredChange = 0;\n  let currentChange = 0; // Editing existing value, cancel its effect\n\n  const previousIsPledged = ownFunds[ownFundsIndex].usageType === OWN_FUNDS_USAGE_TYPES.PLEDGE;\n\n  if (previousIsPledged) {\n    const maxPledge = getMaxPledge(props);\n    const previousPledgedValue = ownFunds[ownFundsIndex].value;\n    requiredChange = Math.min(previousPledgedValue, maxPledge);\n  } else {\n    currentChange = -ownFunds[ownFundsIndex].value;\n  }\n\n  return {\n    requiredChange,\n    currentChange\n  };\n};\n\nconst removePledgingEffect = (_ref2) => {\n  let {\n    props,\n    ownFunds,\n    ownFundsIndex,\n    value\n  } = _ref2;\n  const maxPledge = getMaxPledge(props);\n  const currentPledgedFunds = getCurrentPledgedFunds({\n    ownFunds,\n    ownFundsIndex\n  });\n  return {\n    requiredChange: -Math.min(currentPledgedFunds + (value || 0), maxPledge),\n    currentChange: -value || 0\n  };\n};\n\nconst getRequiredAndCurrentFunds = props => {\n  const {\n    value,\n    structure: {\n      ownFunds\n    },\n    ownFundsIndex,\n    usageType\n  } = props;\n  let required = Calculator.getRequiredOwnFunds(props);\n  const previousNonPledgedFunds = ownFunds.filter((_ref3) => {\n    let {\n      usageType: uT\n    } = _ref3;\n    return uT !== OWN_FUNDS_USAGE_TYPES.PLEDGE;\n  }).reduce((sum, _ref4) => {\n    let {\n      value: v\n    } = _ref4;\n    return sum + v;\n  }, 0);\n  let current = previousNonPledgedFunds + (value || 0);\n  const isEditing = ownFundsIndex >= 0;\n\n  if (isEditing) {\n    const {\n      requiredChange,\n      currentChange\n    } = removePreviousValueEffect({\n      props,\n      ownFundsIndex,\n      ownFunds\n    });\n    required += requiredChange;\n    current += currentChange;\n  }\n\n  if (usageType === OWN_FUNDS_USAGE_TYPES.PLEDGE) {\n    const {\n      requiredChange,\n      currentChange\n    } = removePledgingEffect({\n      props,\n      ownFunds,\n      ownFundsIndex,\n      value\n    });\n    required += requiredChange;\n    current += currentChange;\n  }\n\n  return {\n    required,\n    current\n  };\n};\n\nconst OwnFundsCompleterContainer = compose(SingleStructureContainer, FinancingDataContainer, withProps(getRequiredAndCurrentFunds));\nmodule.exportDefault(OwnFundsCompleterContainer);","map":{"version":3,"sources":["imports/core/components/Financing/client/FinancingOwnFunds/FinancingOwnFundsPicker/OwnFundsCompleterContainer.js"],"names":["compose","removePreviousValueEffect","ownFunds","requiredChange","currentChange","previousIsPledged","OWN_FUNDS_USAGE_TYPES","maxPledge","getMaxPledge","previousPledgedValue","Math","removePledgingEffect","value","currentPledgedFunds","getCurrentPledgedFunds","ownFundsIndex","getRequiredAndCurrentFunds","props","structure","usageType","required","Calculator","previousNonPledgedFunds","uT","v","sum","current","isEditing","OwnFundsCompleterContainer","withProps"],"mappings":"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","sourcesContent":["import { compose, withProps } from 'recompose';\n\nimport { OWN_FUNDS_USAGE_TYPES } from 'core/api/constants';\nimport FinancingDataContainer from '../../containers/FinancingDataContainer';\nimport SingleStructureContainer from '../../containers/SingleStructureContainer';\nimport {\n  getCurrentPledgedFunds,\n  getMaxPledge,\n} from './FinancingOwnFundsPickerHelpers';\nimport Calculator from '../../../../../utils/Calculator';\n\nconst removePreviousValueEffect = ({ props, ownFundsIndex, ownFunds }) => {\n  let requiredChange = 0;\n  let currentChange = 0;\n  // Editing existing value, cancel its effect\n  const previousIsPledged = ownFunds[ownFundsIndex].usageType === OWN_FUNDS_USAGE_TYPES.PLEDGE;\n\n  if (previousIsPledged) {\n    const maxPledge = getMaxPledge(props);\n    const previousPledgedValue = ownFunds[ownFundsIndex].value;\n    requiredChange = Math.min(previousPledgedValue, maxPledge);\n  } else {\n    currentChange = -ownFunds[ownFundsIndex].value;\n  }\n\n  return { requiredChange, currentChange };\n};\n\nconst removePledgingEffect = ({ props, ownFunds, ownFundsIndex, value }) => {\n  const maxPledge = getMaxPledge(props);\n  const currentPledgedFunds = getCurrentPledgedFunds({\n    ownFunds,\n    ownFundsIndex,\n  });\n\n  return {\n    requiredChange: -Math.min(currentPledgedFunds + (value || 0), maxPledge),\n    currentChange: -value || 0,\n  };\n};\n\nexport const getRequiredAndCurrentFunds = (props) => {\n  const {\n    value,\n    structure: { ownFunds },\n    ownFundsIndex,\n    usageType,\n  } = props;\n  let required = Calculator.getRequiredOwnFunds(props);\n  const previousNonPledgedFunds = ownFunds\n    .filter(({ usageType: uT }) => uT !== OWN_FUNDS_USAGE_TYPES.PLEDGE)\n    .reduce((sum, { value: v }) => sum + v, 0);\n  let current = previousNonPledgedFunds + (value || 0);\n  const isEditing = ownFundsIndex >= 0;\n\n  if (isEditing) {\n    const { requiredChange, currentChange } = removePreviousValueEffect({\n      props,\n      ownFundsIndex,\n      ownFunds,\n    });\n    required += requiredChange;\n    current += currentChange;\n  }\n\n  if (usageType === OWN_FUNDS_USAGE_TYPES.PLEDGE) {\n    const { requiredChange, currentChange } = removePledgingEffect({\n      props,\n      ownFunds,\n      ownFundsIndex,\n      value,\n    });\n    required += requiredChange;\n    current += currentChange;\n  }\n\n  return { required, current };\n};\n\nconst OwnFundsCompleterContainer = compose(\n  SingleStructureContainer,\n  FinancingDataContainer,\n  withProps(getRequiredAndCurrentFunds),\n);\n\nexport default OwnFundsCompleterContainer;\n"]},"sourceType":"script","hash":"2a4b79f59305626735bd3bade5594b0388f5e395"}
