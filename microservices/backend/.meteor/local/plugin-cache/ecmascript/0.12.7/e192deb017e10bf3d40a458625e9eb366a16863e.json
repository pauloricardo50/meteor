{"metadata":{},"options":{"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/Florian/dev/epotek/microservices/backend/imports/core/components/OfferList/feedbackHelpers.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties",["flow",{}],"jsx",["flow",{}],["flow",{}],"objectRestSpread","objectRestSpread","dynamicImport","asyncGenerators","classProperties","classPrivateProperties"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.osx.x86_64"},"sourceFileName":"imports/core/components/OfferList/feedbackHelpers.js","filename":"/Users/Florian/dev/epotek/microservices/backend/imports/core/components/OfferList/feedbackHelpers.js","inputSourceMap":{"version":3,"sources":["imports/core/components/OfferList/feedbackHelpers.js"],"names":["Meteor","moment","FEEDBACK_OPTIONS","POSITIVE","NEGATIVE_NOT_COMPETITIVE","NEGATIVE_WITHOUT_FOLLOW_UP","CUSTOM","FEEDBACK_OPTIONS_SETTINGS","enableComments","enableOutro","enableCustomIntro","greetings","contactName","formatMessage","id","introduction","option","borrowers","singleBorrower","address","date","borrower","name","borrower1","borrower2","outro","closing","assignee","makeFeedback","model","offer","comments","customFeedback","lender","contact","firstName","loan","user","assignedEmployee","property","createdAt","address1","zipCode","city","Error","replace","feedback","length","concat","format","filter","x","map","comment","join"],"mappings":"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","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport moment from 'moment';\n\nexport const FEEDBACK_OPTIONS = {\n  POSITIVE: 'POSITIVE',\n  NEGATIVE_NOT_COMPETITIVE: 'NEGATIVE_NOT_COMPETITIVE',\n  NEGATIVE_WITHOUT_FOLLOW_UP: 'NEGATIVE_WITHOUT_FOLLOW_UP',\n  CUSTOM: 'CUSTOM',\n};\n\nexport const FEEDBACK_OPTIONS_SETTINGS = {\n  [FEEDBACK_OPTIONS.POSITIVE]: {\n    enableComments: true,\n    enableOutro: true,\n  },\n  [FEEDBACK_OPTIONS.NEGATIVE_NOT_COMPETITIVE]: {\n    enableComments: true,\n    enableOutro: true,\n  },\n  [FEEDBACK_OPTIONS.NEGATIVE_WITHOUT_FOLLOW_UP]: {\n    enableComments: true,\n    enableCustomIntro: true,\n    enableOutro: true,\n  },\n  [FEEDBACK_OPTIONS.CUSTOM]: {\n    enableCustomIntro: false,\n    enableComments: false,\n    enableOutro: false,\n  },\n};\n\nconst greetings = ({ contactName, formatMessage }) =>\n  formatMessage({ id: 'Feedback.greetings' }, { contactName });\n\nconst introduction = ({\n  option,\n  borrowers,\n  singleBorrower,\n  address,\n  date,\n  formatMessage,\n}) => {\n  if (singleBorrower) {\n    return formatMessage(\n      {\n        id: FEEDBACK_OPTIONS_SETTINGS[option].enableCustomIntro\n          ? `Feedback.${option}.introduction.singleBorrower`\n          : 'Feedback.introduction.singleBorrower',\n      },\n      {\n        borrower: borrowers[0].name,\n        address,\n        date,\n      },\n    );\n  }\n\n  return formatMessage(\n    {\n      id: FEEDBACK_OPTIONS_SETTINGS[option].enableCustomIntro\n        ? `Feedback.${option}.introduction.twoBorrowers`\n        : 'Feedback.introduction.twoBorrowers',\n    },\n    {\n      borrower1: borrowers[0].name,\n      borrower2: borrowers[1].name,\n      address,\n      date,\n    },\n  );\n};\n\nconst outro = ({ borrowers, singleBorrower, option, formatMessage }) => {\n  if (singleBorrower) {\n    return formatMessage(\n      { id: `Feedback.${option}.outro.singleBorrower` },\n      { borrower: borrowers[0].name, singleBorrower: true },\n    );\n  }\n\n  return formatMessage(\n    { id: `Feedback.${option}.outro.twoBorrowers` },\n    {\n      borrower1: borrowers[0].name,\n      borrower2: borrowers[1].name,\n      singleBorrower: false,\n    },\n  );\n};\n\nconst closing = ({ assignee, formatMessage }) =>\n  formatMessage({ id: 'Feedback.closing' }, { assignee });\n\nexport const makeFeedback = ({ model, offer, formatMessage }) => {\n  const { option, comments = [], customFeedback = '' } = model;\n  const {\n    lender: {\n      contact: { firstName: contactName },\n      loan: {\n        borrowers,\n        user: { assignedEmployee },\n      },\n    },\n    property,\n    createdAt,\n  } = offer;\n\n  const { firstName: assignee = 'e-Potek' } = assignedEmployee || {};\n  const { address1, zipCode, city } = property || {};\n\n  if (!property || !address1 || !zipCode || !city) {\n    throw new Meteor.Error('No property or address');\n  }\n\n  const address = `${address1}, ${zipCode} ${city}`;\n\n  if (option === FEEDBACK_OPTIONS.CUSTOM) {\n    // Replace all returns into HTML\n    return customFeedback.replace(/(?:\\r\\n|\\r|\\n)/g, '<br>');\n  }\n\n  let feedback = '';\n  const singleBorrower = borrowers.length === 1;\n\n  if (option) {\n    feedback = feedback.concat(greetings({ contactName, formatMessage }));\n    feedback = feedback.concat(introduction({\n      option,\n      borrowers,\n      singleBorrower,\n      address,\n      date: moment(createdAt).format('DD.MM.YYYY'),\n      formatMessage,\n    }));\n    feedback = feedback.concat(formatMessage({ id: `Feedback.${option}.body` }, { singleBorrower }));\n\n    if (comments.length && FEEDBACK_OPTIONS_SETTINGS[option].enableComments) {\n      feedback = feedback.concat(formatMessage(\n        { id: `Feedback.${option}.comments` },\n        { singleBorrower },\n      ));\n      feedback = feedback.concat(\n        '<ul>',\n        comments\n          .filter(x => x)\n          .map(comment => `<li><b>${comment}</b></li>`)\n          .join('\\n'),\n        '</ul>',\n      );\n    }\n\n    if (FEEDBACK_OPTIONS_SETTINGS[option].enableOutro) {\n      feedback = feedback.concat(outro({ option, singleBorrower, borrowers, formatMessage }));\n    }\n\n    feedback = feedback.concat(closing({ assignee, formatMessage }));\n  }\n\n  return feedback;\n};\n"]},"passPerPreset":false,"envName":"development","cwd":"/Users/Florian/dev/epotek/microservices/backend","root":"/Users/Florian/dev/epotek/microservices/backend","plugins":[{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"syntax-flow","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"transform-runtime","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"transform-modules-commonjs","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}}],"presets":[],"generatorOpts":{"filename":"/Users/Florian/dev/epotek/microservices/backend/imports/core/components/OfferList/feedbackHelpers.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/core/components/OfferList/feedbackHelpers.js"}},"code":"module.export({\n  FEEDBACK_OPTIONS: () => FEEDBACK_OPTIONS,\n  FEEDBACK_OPTIONS_SETTINGS: () => FEEDBACK_OPTIONS_SETTINGS,\n  makeFeedback: () => makeFeedback\n});\nlet Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 0);\nlet moment;\nmodule.link(\"moment\", {\n  default(v) {\n    moment = v;\n  }\n\n}, 1);\nconst FEEDBACK_OPTIONS = {\n  POSITIVE: 'POSITIVE',\n  NEGATIVE_NOT_COMPETITIVE: 'NEGATIVE_NOT_COMPETITIVE',\n  NEGATIVE_WITHOUT_FOLLOW_UP: 'NEGATIVE_WITHOUT_FOLLOW_UP',\n  CUSTOM: 'CUSTOM'\n};\nconst FEEDBACK_OPTIONS_SETTINGS = {\n  [FEEDBACK_OPTIONS.POSITIVE]: {\n    enableComments: true,\n    enableOutro: true\n  },\n  [FEEDBACK_OPTIONS.NEGATIVE_NOT_COMPETITIVE]: {\n    enableComments: true,\n    enableOutro: true\n  },\n  [FEEDBACK_OPTIONS.NEGATIVE_WITHOUT_FOLLOW_UP]: {\n    enableComments: true,\n    enableCustomIntro: true,\n    enableOutro: true\n  },\n  [FEEDBACK_OPTIONS.CUSTOM]: {\n    enableCustomIntro: false,\n    enableComments: false,\n    enableOutro: false\n  }\n};\n\nconst greetings = ({\n  contactName,\n  formatMessage\n}) => formatMessage({\n  id: 'Feedback.greetings'\n}, {\n  contactName\n});\n\nconst introduction = ({\n  option,\n  borrowers,\n  singleBorrower,\n  address,\n  date,\n  formatMessage\n}) => {\n  if (singleBorrower) {\n    return formatMessage({\n      id: FEEDBACK_OPTIONS_SETTINGS[option].enableCustomIntro ? `Feedback.${option}.introduction.singleBorrower` : 'Feedback.introduction.singleBorrower'\n    }, {\n      borrower: borrowers[0].name,\n      address,\n      date\n    });\n  }\n\n  return formatMessage({\n    id: FEEDBACK_OPTIONS_SETTINGS[option].enableCustomIntro ? `Feedback.${option}.introduction.twoBorrowers` : 'Feedback.introduction.twoBorrowers'\n  }, {\n    borrower1: borrowers[0].name,\n    borrower2: borrowers[1].name,\n    address,\n    date\n  });\n};\n\nconst outro = ({\n  borrowers,\n  singleBorrower,\n  option,\n  formatMessage\n}) => {\n  if (singleBorrower) {\n    return formatMessage({\n      id: `Feedback.${option}.outro.singleBorrower`\n    }, {\n      borrower: borrowers[0].name,\n      singleBorrower: true\n    });\n  }\n\n  return formatMessage({\n    id: `Feedback.${option}.outro.twoBorrowers`\n  }, {\n    borrower1: borrowers[0].name,\n    borrower2: borrowers[1].name,\n    singleBorrower: false\n  });\n};\n\nconst closing = ({\n  assignee,\n  formatMessage\n}) => formatMessage({\n  id: 'Feedback.closing'\n}, {\n  assignee\n});\n\nconst makeFeedback = ({\n  model,\n  offer,\n  formatMessage\n}) => {\n  const {\n    option,\n    comments = [],\n    customFeedback = ''\n  } = model;\n  const {\n    lender: {\n      contact: {\n        firstName: contactName\n      },\n      loan: {\n        borrowers,\n        user: {\n          assignedEmployee\n        }\n      }\n    },\n    property,\n    createdAt\n  } = offer;\n  const {\n    firstName: assignee = 'e-Potek'\n  } = assignedEmployee || {};\n  const {\n    address1,\n    zipCode,\n    city\n  } = property || {};\n\n  if (!property || !address1 || !zipCode || !city) {\n    throw new Meteor.Error('No property or address');\n  }\n\n  const address = `${address1}, ${zipCode} ${city}`;\n\n  if (option === FEEDBACK_OPTIONS.CUSTOM) {\n    // Replace all returns into HTML\n    return customFeedback.replace(/(?:\\r\\n|\\r|\\n)/g, '<br>');\n  }\n\n  let feedback = '';\n  const singleBorrower = borrowers.length === 1;\n\n  if (option) {\n    feedback = feedback.concat(greetings({\n      contactName,\n      formatMessage\n    }));\n    feedback = feedback.concat(introduction({\n      option,\n      borrowers,\n      singleBorrower,\n      address,\n      date: moment(createdAt).format('DD.MM.YYYY'),\n      formatMessage\n    }));\n    feedback = feedback.concat(formatMessage({\n      id: `Feedback.${option}.body`\n    }, {\n      singleBorrower\n    }));\n\n    if (comments.length && FEEDBACK_OPTIONS_SETTINGS[option].enableComments) {\n      feedback = feedback.concat(formatMessage({\n        id: `Feedback.${option}.comments`\n      }, {\n        singleBorrower\n      }));\n      feedback = feedback.concat('<ul>', comments.filter(x => x).map(comment => `<li><b>${comment}</b></li>`).join('\\n'), '</ul>');\n    }\n\n    if (FEEDBACK_OPTIONS_SETTINGS[option].enableOutro) {\n      feedback = feedback.concat(outro({\n        option,\n        singleBorrower,\n        borrowers,\n        formatMessage\n      }));\n    }\n\n    feedback = feedback.concat(closing({\n      assignee,\n      formatMessage\n    }));\n  }\n\n  return feedback;\n};","map":{"version":3,"sources":["imports/core/components/OfferList/feedbackHelpers.js"],"names":["Meteor","FEEDBACK_OPTIONS","POSITIVE","NEGATIVE_NOT_COMPETITIVE","NEGATIVE_WITHOUT_FOLLOW_UP","CUSTOM","FEEDBACK_OPTIONS_SETTINGS","enableComments","enableOutro","enableCustomIntro","greetings","formatMessage","id","contactName","introduction","option","borrower","borrowers","date","borrower1","borrower2","outro","singleBorrower","closing","assignee","makeFeedback","comments","customFeedback","lender","contact","firstName","loan","user","assignedEmployee","createdAt","city","property","address","address1","zipCode","feedback","moment","x","comment"],"mappings":"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","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport moment from 'moment';\n\nexport const FEEDBACK_OPTIONS = {\n  POSITIVE: 'POSITIVE',\n  NEGATIVE_NOT_COMPETITIVE: 'NEGATIVE_NOT_COMPETITIVE',\n  NEGATIVE_WITHOUT_FOLLOW_UP: 'NEGATIVE_WITHOUT_FOLLOW_UP',\n  CUSTOM: 'CUSTOM',\n};\n\nexport const FEEDBACK_OPTIONS_SETTINGS = {\n  [FEEDBACK_OPTIONS.POSITIVE]: {\n    enableComments: true,\n    enableOutro: true,\n  },\n  [FEEDBACK_OPTIONS.NEGATIVE_NOT_COMPETITIVE]: {\n    enableComments: true,\n    enableOutro: true,\n  },\n  [FEEDBACK_OPTIONS.NEGATIVE_WITHOUT_FOLLOW_UP]: {\n    enableComments: true,\n    enableCustomIntro: true,\n    enableOutro: true,\n  },\n  [FEEDBACK_OPTIONS.CUSTOM]: {\n    enableCustomIntro: false,\n    enableComments: false,\n    enableOutro: false,\n  },\n};\n\nconst greetings = ({ contactName, formatMessage }) =>\n  formatMessage({ id: 'Feedback.greetings' }, { contactName });\n\nconst introduction = ({\n  option,\n  borrowers,\n  singleBorrower,\n  address,\n  date,\n  formatMessage,\n}) => {\n  if (singleBorrower) {\n    return formatMessage(\n      {\n        id: FEEDBACK_OPTIONS_SETTINGS[option].enableCustomIntro\n          ? `Feedback.${option}.introduction.singleBorrower`\n          : 'Feedback.introduction.singleBorrower',\n      },\n      {\n        borrower: borrowers[0].name,\n        address,\n        date,\n      },\n    );\n  }\n\n  return formatMessage(\n    {\n      id: FEEDBACK_OPTIONS_SETTINGS[option].enableCustomIntro\n        ? `Feedback.${option}.introduction.twoBorrowers`\n        : 'Feedback.introduction.twoBorrowers',\n    },\n    {\n      borrower1: borrowers[0].name,\n      borrower2: borrowers[1].name,\n      address,\n      date,\n    },\n  );\n};\n\nconst outro = ({ borrowers, singleBorrower, option, formatMessage }) => {\n  if (singleBorrower) {\n    return formatMessage(\n      { id: `Feedback.${option}.outro.singleBorrower` },\n      { borrower: borrowers[0].name, singleBorrower: true },\n    );\n  }\n\n  return formatMessage(\n    { id: `Feedback.${option}.outro.twoBorrowers` },\n    {\n      borrower1: borrowers[0].name,\n      borrower2: borrowers[1].name,\n      singleBorrower: false,\n    },\n  );\n};\n\nconst closing = ({ assignee, formatMessage }) =>\n  formatMessage({ id: 'Feedback.closing' }, { assignee });\n\nexport const makeFeedback = ({ model, offer, formatMessage }) => {\n  const { option, comments = [], customFeedback = '' } = model;\n  const {\n    lender: {\n      contact: { firstName: contactName },\n      loan: {\n        borrowers,\n        user: { assignedEmployee },\n      },\n    },\n    property,\n    createdAt,\n  } = offer;\n\n  const { firstName: assignee = 'e-Potek' } = assignedEmployee || {};\n  const { address1, zipCode, city } = property || {};\n\n  if (!property || !address1 || !zipCode || !city) {\n    throw new Meteor.Error('No property or address');\n  }\n\n  const address = `${address1}, ${zipCode} ${city}`;\n\n  if (option === FEEDBACK_OPTIONS.CUSTOM) {\n    // Replace all returns into HTML\n    return customFeedback.replace(/(?:\\r\\n|\\r|\\n)/g, '<br>');\n  }\n\n  let feedback = '';\n  const singleBorrower = borrowers.length === 1;\n\n  if (option) {\n    feedback = feedback.concat(greetings({ contactName, formatMessage }));\n    feedback = feedback.concat(introduction({\n      option,\n      borrowers,\n      singleBorrower,\n      address,\n      date: moment(createdAt).format('DD.MM.YYYY'),\n      formatMessage,\n    }));\n    feedback = feedback.concat(formatMessage({ id: `Feedback.${option}.body` }, { singleBorrower }));\n\n    if (comments.length && FEEDBACK_OPTIONS_SETTINGS[option].enableComments) {\n      feedback = feedback.concat(formatMessage(\n        { id: `Feedback.${option}.comments` },\n        { singleBorrower },\n      ));\n      feedback = feedback.concat(\n        '<ul>',\n        comments\n          .filter(x => x)\n          .map(comment => `<li><b>${comment}</b></li>`)\n          .join('\\n'),\n        '</ul>',\n      );\n    }\n\n    if (FEEDBACK_OPTIONS_SETTINGS[option].enableOutro) {\n      feedback = feedback.concat(outro({ option, singleBorrower, borrowers, formatMessage }));\n    }\n\n    feedback = feedback.concat(closing({ assignee, formatMessage }));\n  }\n\n  return feedback;\n};\n"]},"sourceType":"script","hash":"e192deb017e10bf3d40a458625e9eb366a16863e"}
