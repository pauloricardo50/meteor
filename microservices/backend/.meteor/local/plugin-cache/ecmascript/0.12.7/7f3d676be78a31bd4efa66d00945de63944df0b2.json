{"metadata":{},"options":{"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/Florian/dev/epotek/microservices/backend/imports/core/api/stats/stats.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties",["flow",{}],"jsx",["flow",{}],["flow",{}],"objectRestSpread","objectRestSpread","dynamicImport","asyncGenerators","classProperties","classPrivateProperties"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.linux.x86_64"},"sourceFileName":"imports/core/api/stats/stats.js","filename":"/Users/Florian/dev/epotek/microservices/backend/imports/core/api/stats/stats.js","inputSourceMap":{"version":3,"sources":["imports/core/api/stats/stats.js"],"names":["moment","LoanService","dateInPast","days","subtract","startOf","toDate","newLoansResolver","period","end1","end2","period1","count","$filters","createdAt","$gte","period2","$lte","change","loanHistogramResolver","aggregation","aggregate","$match","$project","date","$dateToString","format","$group","_id","$sum","$sort","toArray"],"mappings":"AAAA,OAAOA,MAAP,MAAmB,QAAnB;AAEA,OAAOC,WAAP;;AAEA,MAAMC,UAAU,GAAGC,IAAI,IACrBH,MAAM,GACHI,QADH,CACYD,IADZ,EACkB,MADlB,EAEGE,OAFH,CAEW,KAFX,EAGGC,MAHH,EADF;;AAMA,OAAO,MAAMC,gBAAgB,GAAG,CAAC;AAAEC,EAAAA,MAAM,GAAG;AAAX,IAAiB,EAAlB,KAAyB;AACvD,QAAMC,IAAI,GAAGP,UAAU,CAACM,MAAD,CAAvB;AACA,QAAME,IAAI,GAAGR,UAAU,CAACM,MAAM,GAAG,CAAV,CAAvB;AACA,QAAMG,OAAO,GAAGV,WAAW,CAACW,KAAZ,CAAkB;AAChCC,IAAAA,QAAQ,EAAE;AAAEC,MAAAA,SAAS,EAAE;AAAEC,QAAAA,IAAI,EAAEN;AAAR;AAAb;AADsB,GAAlB,CAAhB;AAGA,QAAMO,OAAO,GAAGf,WAAW,CAACW,KAAZ,CAAkB;AAChCC,IAAAA,QAAQ,EAAE;AAAEC,MAAAA,SAAS,EAAE;AAAEC,QAAAA,IAAI,EAAEL,IAAR;AAAcO,QAAAA,IAAI,EAAER;AAApB;AAAb;AADsB,GAAlB,CAAhB;AAIA,QAAMS,MAAM,GAAGF,OAAO,KAAK,CAAZ,GAAgB,CAAhB,GAAoB,CAACL,OAAO,GAAGK,OAAX,IAAsBA,OAAzD;AAEA,SAAO;AAAEJ,IAAAA,KAAK,EAAED,OAAT;AAAkBO,IAAAA;AAAlB,GAAP;AACD,CAbM;AAeP,OAAO,MAAMC,qBAAqB,GAAG,OAAO;AAAEX,EAAAA,MAAM,GAAG;AAAX,CAAP,KAA0B;AAC7D,QAAMY,WAAW,GAAG,MAAMnB,WAAW,CAACoB,SAAZ,CAAsB,CAC9C;AAAEC,IAAAA,MAAM,EAAE;AAAER,MAAAA,SAAS,EAAE;AAAEC,QAAAA,IAAI,EAAEb,UAAU,CAACM,MAAD;AAAlB;AAAb;AAAV,GAD8C,EAE9C;AACEe,IAAAA,QAAQ,EAAE;AACR;AACAC,MAAAA,IAAI,EAAE;AAAEC,QAAAA,aAAa,EAAE;AAAEC,UAAAA,MAAM,EAAE,UAAV;AAAsBF,UAAAA,IAAI,EAAE;AAA5B;AAAjB;AAFE;AADZ,GAF8C,EAQ9C;AAAEG,IAAAA,MAAM,EAAE;AAAEC,MAAAA,GAAG,EAAE,OAAP;AAAgBhB,MAAAA,KAAK,EAAE;AAAEiB,QAAAA,IAAI,EAAE;AAAR;AAAvB;AAAV,GAR8C,EAS9C;AAAEC,IAAAA,KAAK,EAAE;AAAEF,MAAAA,GAAG,EAAE;AAAP;AAAT,GAT8C,CAAtB,EAUvBG,OAVuB,EAA1B;AAWA,SAAOX,WAAP;AACD,CAbM","sourcesContent":["import moment from 'moment';\n\nimport LoanService from '../loans/server/LoanService';\n\nconst dateInPast = days =>\n  moment()\n    .subtract(days, 'days')\n    .startOf('day')\n    .toDate();\n\nexport const newLoansResolver = ({ period = 7 } = {}) => {\n  const end1 = dateInPast(period);\n  const end2 = dateInPast(period * 2);\n  const period1 = LoanService.count({\n    $filters: { createdAt: { $gte: end1 } },\n  });\n  const period2 = LoanService.count({\n    $filters: { createdAt: { $gte: end2, $lte: end1 } },\n  });\n\n  const change = period2 === 0 ? 1 : (period1 - period2) / period2;\n\n  return { count: period1, change };\n};\n\nexport const loanHistogramResolver = async ({ period = 7 }) => {\n  const aggregation = await LoanService.aggregate([\n    { $match: { createdAt: { $gte: dateInPast(period) } } },\n    {\n      $project: {\n        // Filter out time of day\n        date: { $dateToString: { format: '%Y-%m-%d', date: '$createdAt' } },\n      },\n    },\n    { $group: { _id: '$date', count: { $sum: 1 } } },\n    { $sort: { _id: 1 } },\n  ]).toArray();\n  return aggregation;\n};\n"]},"passPerPreset":false,"envName":"production","cwd":"/Users/Florian/dev/epotek/microservices/backend","root":"/Users/Florian/dev/epotek/microservices/backend","plugins":[{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"syntax-flow","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"transform-runtime","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"transform-modules-commonjs","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}}],"presets":[],"generatorOpts":{"filename":"/Users/Florian/dev/epotek/microservices/backend/imports/core/api/stats/stats.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/core/api/stats/stats.js"}},"code":"module.export({\n  newLoansResolver: () => newLoansResolver,\n  loanHistogramResolver: () => loanHistogramResolver\n});\nlet moment;\nmodule.link(\"moment\", {\n  default(v) {\n    moment = v;\n  }\n\n}, 0);\nlet LoanService;\nmodule.link(\"../loans/server/LoanService\", {\n  default(v) {\n    LoanService = v;\n  }\n\n}, 1);\n\nconst dateInPast = days => moment().subtract(days, 'days').startOf('day').toDate();\n\nconst newLoansResolver = ({\n  period = 7\n} = {}) => {\n  const end1 = dateInPast(period);\n  const end2 = dateInPast(period * 2);\n  const period1 = LoanService.count({\n    $filters: {\n      createdAt: {\n        $gte: end1\n      }\n    }\n  });\n  const period2 = LoanService.count({\n    $filters: {\n      createdAt: {\n        $gte: end2,\n        $lte: end1\n      }\n    }\n  });\n  const change = period2 === 0 ? 1 : (period1 - period2) / period2;\n  return {\n    count: period1,\n    change\n  };\n};\n\nconst loanHistogramResolver = ({\n  period = 7\n}) => Promise.asyncApply(() => {\n  const aggregation = Promise.await(LoanService.aggregate([{\n    $match: {\n      createdAt: {\n        $gte: dateInPast(period)\n      }\n    }\n  }, {\n    $project: {\n      // Filter out time of day\n      date: {\n        $dateToString: {\n          format: '%Y-%m-%d',\n          date: '$createdAt'\n        }\n      }\n    }\n  }, {\n    $group: {\n      _id: '$date',\n      count: {\n        $sum: 1\n      }\n    }\n  }, {\n    $sort: {\n      _id: 1\n    }\n  }]).toArray());\n  return aggregation;\n});","map":{"version":3,"sources":["imports/core/api/stats/stats.js"],"names":["dateInPast","days","moment","newLoansResolver","period","end1","end2","period1","$filters","createdAt","$gte","period2","$lte","change","count","loanHistogramResolver","aggregation","$match","$project","date","$dateToString","format","$group","_id","$sum","$sort"],"mappings":"AAAA,MAAA,CAAA,MAAA,CAAA;AAAA,EAAA,gBAAA,EAAA,MAAA,gBAAA;AAAA,EAAA,qBAAA,EAAA,MAAA;AAAA,CAAA;AAAA,IAAA,MAAA;AAAA,MAAA,CAAA,IAAA,CAAA,QAAA,EAAA;AAAA,EAAA,OAAA,CAAA,CAAA,EAAA;AAAA,IAAA,MAAA,GAAA,CAAA;AAAA;;AAAA,CAAA,EAAA,CAAA;AAAA,IAAA,WAAA;AAAA,MAAA,CAAA,IAAA,CAAA,6BAAA,EAAA;AAAA,EAAA,OAAA,CAAA,CAAA,EAAA;AAAA,IAAA,WAAA,GAAA,CAAA;AAAA;;AAAA,CAAA,EAAA,CAAA;;AAIA,MAAMA,UAAU,GAAGC,IAAI,IACrBC,MAAM,GAANA,QAAAA,CAAAA,IAAAA,EAAAA,MAAAA,EAAAA,OAAAA,CAAAA,KAAAA,EADF,MACEA,EADF;;AAMO,MAAMC,gBAAgB,GAAG,CAAC;AAAEC,EAAAA,MAAM,GAAG;AAAX,IAAD,EAAA,KAAyB;AACvD,QAAMC,IAAI,GAAGL,UAAU,CAAvB,MAAuB,CAAvB;AACA,QAAMM,IAAI,GAAGN,UAAU,CAACI,MAAM,GAA9B,CAAuB,CAAvB;AACA,QAAMG,OAAO,GAAG,WAAW,CAAX,KAAA,CAAkB;AAChCC,IAAAA,QAAQ,EAAE;AAAEC,MAAAA,SAAS,EAAE;AAAEC,QAAAA,IAAI,EAAEL;AAAR;AAAb;AADsB,GAAlB,CAAhB;AAGA,QAAMM,OAAO,GAAG,WAAW,CAAX,KAAA,CAAkB;AAChCH,IAAAA,QAAQ,EAAE;AAAEC,MAAAA,SAAS,EAAE;AAAEC,QAAAA,IAAI,EAAN,IAAA;AAAcE,QAAAA,IAAI,EAAEP;AAApB;AAAb;AADsB,GAAlB,CAAhB;AAIA,QAAMQ,MAAM,GAAGF,OAAO,KAAPA,CAAAA,GAAAA,CAAAA,GAAoB,CAACJ,OAAO,GAAR,OAAA,IAAnC,OAAA;AAEA,SAAO;AAAEO,IAAAA,KAAK,EAAP,OAAA;AAAkBD,IAAAA;AAAlB,GAAP;AAZK,CAAA;;AAeA,MAAME,qBAAqB,GAAG,CAAO;AAAEX,EAAAA,MAAM,GAAG;AAAX,CAAP,8BAA0B;AAC7D,QAAMY,WAAW,iBAAS,WAAW,CAAX,SAAA,CAAsB,CAC9C;AAAEC,IAAAA,MAAM,EAAE;AAAER,MAAAA,SAAS,EAAE;AAAEC,QAAAA,IAAI,EAAEV,UAAU,CAAA,MAAA;AAAlB;AAAb;AAAV,GAD8C,EAE9C;AACEkB,IAAAA,QAAQ,EAAE;AACR;AACAC,MAAAA,IAAI,EAAE;AAAEC,QAAAA,aAAa,EAAE;AAAEC,UAAAA,MAAM,EAAR,UAAA;AAAsBF,UAAAA,IAAI,EAAE;AAA5B;AAAjB;AAFE;AADZ,GAF8C,EAQ9C;AAAEG,IAAAA,MAAM,EAAE;AAAEC,MAAAA,GAAG,EAAL,OAAA;AAAgBT,MAAAA,KAAK,EAAE;AAAEU,QAAAA,IAAI,EAAE;AAAR;AAAvB;AAAV,GAR8C,EAS9C;AAAEC,IAAAA,KAAK,EAAE;AAAEF,MAAAA,GAAG,EAAE;AAAP;AAAT,GAT8C,CAAtB,EAA1B,OAA0B,EAAT,CAAjB;AAWA,SAAA,WAAA;AAZK,CAA8B,CAA9B","sourcesContent":["import moment from 'moment';\n\nimport LoanService from '../loans/server/LoanService';\n\nconst dateInPast = days =>\n  moment()\n    .subtract(days, 'days')\n    .startOf('day')\n    .toDate();\n\nexport const newLoansResolver = ({ period = 7 } = {}) => {\n  const end1 = dateInPast(period);\n  const end2 = dateInPast(period * 2);\n  const period1 = LoanService.count({\n    $filters: { createdAt: { $gte: end1 } },\n  });\n  const period2 = LoanService.count({\n    $filters: { createdAt: { $gte: end2, $lte: end1 } },\n  });\n\n  const change = period2 === 0 ? 1 : (period1 - period2) / period2;\n\n  return { count: period1, change };\n};\n\nexport const loanHistogramResolver = async ({ period = 7 }) => {\n  const aggregation = await LoanService.aggregate([\n    { $match: { createdAt: { $gte: dateInPast(period) } } },\n    {\n      $project: {\n        // Filter out time of day\n        date: { $dateToString: { format: '%Y-%m-%d', date: '$createdAt' } },\n      },\n    },\n    { $group: { _id: '$date', count: { $sum: 1 } } },\n    { $sort: { _id: 1 } },\n  ]).toArray();\n  return aggregation;\n};\n"]},"sourceType":"script","hash":"7f3d676be78a31bd4efa66d00945de63944df0b2"}
