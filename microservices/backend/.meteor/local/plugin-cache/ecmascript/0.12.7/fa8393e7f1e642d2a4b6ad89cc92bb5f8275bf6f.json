{"metadata":{},"options":{"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/Florian/dev/epotek/microservices/backend/imports/core/components/Financing/client/FinancingFinancing/FinancingFinancing.jsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties",["flow",{}],"dynamicImport","classProperties","classPrivateProperties","jsx",["flow",{}],"asyncGenerators","objectRestSpread","objectRestSpread",["flow",{}],"asyncGenerators"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"imports/core/components/Financing/client/FinancingFinancing/FinancingFinancing.jsx","filename":"/Users/Florian/dev/epotek/microservices/backend/imports/core/components/Financing/client/FinancingFinancing/FinancingFinancing.jsx","inputSourceMap":{"version":3,"sources":["imports/core/components/Financing/client/FinancingFinancing/FinancingFinancing.jsx"],"names":["React","OWN_FUNDS_USAGE_TYPES","T","FinancingSection","InputAndSlider","CalculatedValue","FinmaRatio","Calc","getOffer","FinancingTranchePicker","MortgageNotesPicker","getBorrowRatio","getBorrowRatioStatus","LoanPercent","Calculator","getPledgedAmount","structure","ownFunds","filter","usageType","PLEDGE","reduce","sum","value","calculateLoan","params","wantedLoan","calculateMaxLoan","data","pledgeOverride","loan","structureId","offer","selectOffer","maxAmount","selectStructure","propertyValue","selectPropertyValue","getMaxLoanBase","propertyWork","pledgedAmount","undefined","residenceType","enableOffers","oneStructureHasLoan","structures","some","FinancingFinancingProps","FinancingFinancing","props","id","label","Component","max","condition"],"mappings":"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","sourcesContent":["// @flow\nimport React from 'react';\n\nimport { OWN_FUNDS_USAGE_TYPES } from '../../../../api/constants';\nimport T from '../../../Translation';\nimport FinancingSection, {\n  InputAndSlider,\n  CalculatedValue,\n  FinmaRatio,\n} from '../FinancingSection';\nimport Calc, { getOffer } from '../FinancingCalculator';\nimport FinancingTranchePicker from './FinancingTranchePicker';\nimport MortgageNotesPicker from './MortgageNotesPicker';\nimport {\n  getBorrowRatio,\n  getBorrowRatioStatus,\n} from '../FinancingResult/financingResultHelpers';\nimport LoanPercent from './LoanPercent';\nimport Calculator from '../../../../utils/Calculator';\n\nconst getPledgedAmount = ({ structure: { ownFunds } }) =>\n  ownFunds\n    .filter(({ usageType }) => usageType === OWN_FUNDS_USAGE_TYPES.PLEDGE)\n    .reduce((sum, { value }) => sum + value, 0);\n\nexport const calculateLoan = (params) => {\n  const {\n    structure: { wantedLoan },\n  } = params;\n  return wantedLoan;\n};\n\nexport const calculateMaxLoan = (data, pledgeOverride) => {\n  const { loan, structureId } = data;\n  const offer = Calculator.selectOffer({ loan, structureId });\n  if (offer) {\n    const { maxAmount } = getOffer(data);\n    return maxAmount;\n  }\n\n  const structure = Calculator.selectStructure({ loan, structureId });\n  const propertyValue = Calculator.selectPropertyValue({ loan, structureId });\n\n  return Calc.getMaxLoanBase({\n    propertyWork: structure.propertyWork,\n    propertyValue,\n    pledgedAmount:\n      pledgeOverride !== undefined ? pledgeOverride : getPledgedAmount(data),\n    residenceType: loan.residenceType,\n  });\n};\n\nconst enableOffers = ({ loan }) => loan.enableOffers;\n\nconst oneStructureHasLoan = ({ loan: { structures } }) =>\n  structures.some(({ wantedLoan }) => wantedLoan);\n\ntype FinancingFinancingProps = {};\n\nconst FinancingFinancing = (props: FinancingFinancingProps) => (\n  <FinancingSection\n    summaryConfig={[\n      {\n        id: 'mortgageLoan',\n        label: (\n          <span className=\"section-title\">\n            <T id=\"FinancingFinancing.title\" />\n          </span>\n        ),\n        Component: props => (\n          <div className=\"mortgageLoan financing-mortgageLoan\">\n            <CalculatedValue value={calculateLoan} {...props} />\n            <FinmaRatio\n              value={getBorrowRatio}\n              status={getBorrowRatioStatus}\n              {...props}\n            />\n          </div>\n        ),\n      },\n    ]}\n    detailConfig={[\n      {\n        Component: InputAndSlider,\n        id: 'wantedLoan',\n        max: calculateMaxLoan,\n      },\n      {\n        Component: LoanPercent,\n        id: 'wantedLoanPercent',\n      },\n      {\n        Component: MortgageNotesPicker,\n        id: 'mortgageNoteIds',\n        condition: oneStructureHasLoan,\n      },\n      // TODO: To be released in the future\n      // {\n      //   Component: RadioButtons,\n      //   id: 'amortizationType',\n      //   options: Object.values(AMORTIZATION_TYPE).map(key => ({\n      //     id: key,\n      //     label: `FinancingFinancing.${key}`,\n      //   })),\n      //   condition: enableOffers,\n      // },\n      {\n        id: 'loanTranches',\n        Component: FinancingTranchePicker,\n        condition: enableOffers,\n      },\n    ]}\n  />\n);\n\nexport default FinancingFinancing;\n"]},"passPerPreset":false,"envName":"development","cwd":"/Users/Florian/dev/epotek/microservices/backend","root":"/Users/Florian/dev/epotek/microservices/backend","plugins":[{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"transform-runtime","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-modules-commonjs","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-flow","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/Florian/dev/epotek/microservices/backend/imports/core/components/Financing/client/FinancingFinancing/FinancingFinancing.jsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/core/components/Financing/client/FinancingFinancing/FinancingFinancing.jsx"}},"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nmodule.export({\n  calculateLoan: () => calculateLoan,\n  calculateMaxLoan: () => calculateMaxLoan\n});\nlet React;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  }\n\n}, 0);\nlet OWN_FUNDS_USAGE_TYPES;\nmodule.link(\"../../../../api/constants\", {\n  OWN_FUNDS_USAGE_TYPES(v) {\n    OWN_FUNDS_USAGE_TYPES = v;\n  }\n\n}, 1);\nlet T;\nmodule.link(\"../../../Translation\", {\n  default(v) {\n    T = v;\n  }\n\n}, 2);\nlet FinancingSection, InputAndSlider, CalculatedValue, FinmaRatio;\nmodule.link(\"../FinancingSection\", {\n  default(v) {\n    FinancingSection = v;\n  },\n\n  InputAndSlider(v) {\n    InputAndSlider = v;\n  },\n\n  CalculatedValue(v) {\n    CalculatedValue = v;\n  },\n\n  FinmaRatio(v) {\n    FinmaRatio = v;\n  }\n\n}, 3);\nlet Calc, getOffer;\nmodule.link(\"../FinancingCalculator\", {\n  default(v) {\n    Calc = v;\n  },\n\n  getOffer(v) {\n    getOffer = v;\n  }\n\n}, 4);\nlet FinancingTranchePicker;\nmodule.link(\"./FinancingTranchePicker\", {\n  default(v) {\n    FinancingTranchePicker = v;\n  }\n\n}, 5);\nlet MortgageNotesPicker;\nmodule.link(\"./MortgageNotesPicker\", {\n  default(v) {\n    MortgageNotesPicker = v;\n  }\n\n}, 6);\nlet getBorrowRatio, getBorrowRatioStatus;\nmodule.link(\"../FinancingResult/financingResultHelpers\", {\n  getBorrowRatio(v) {\n    getBorrowRatio = v;\n  },\n\n  getBorrowRatioStatus(v) {\n    getBorrowRatioStatus = v;\n  }\n\n}, 7);\nlet LoanPercent;\nmodule.link(\"./LoanPercent\", {\n  default(v) {\n    LoanPercent = v;\n  }\n\n}, 8);\nlet Calculator;\nmodule.link(\"../../../../utils/Calculator\", {\n  default(v) {\n    Calculator = v;\n  }\n\n}, 9);\n\nconst getPledgedAmount = (_ref) => {\n  let {\n    structure: {\n      ownFunds\n    }\n  } = _ref;\n  return ownFunds.filter((_ref2) => {\n    let {\n      usageType\n    } = _ref2;\n    return usageType === OWN_FUNDS_USAGE_TYPES.PLEDGE;\n  }).reduce((sum, _ref3) => {\n    let {\n      value\n    } = _ref3;\n    return sum + value;\n  }, 0);\n};\n\nconst calculateLoan = params => {\n  const {\n    structure: {\n      wantedLoan\n    }\n  } = params;\n  return wantedLoan;\n};\n\nconst calculateMaxLoan = (data, pledgeOverride) => {\n  const {\n    loan,\n    structureId\n  } = data;\n  const offer = Calculator.selectOffer({\n    loan,\n    structureId\n  });\n\n  if (offer) {\n    const {\n      maxAmount\n    } = getOffer(data);\n    return maxAmount;\n  }\n\n  const structure = Calculator.selectStructure({\n    loan,\n    structureId\n  });\n  const propertyValue = Calculator.selectPropertyValue({\n    loan,\n    structureId\n  });\n  return Calc.getMaxLoanBase({\n    propertyWork: structure.propertyWork,\n    propertyValue,\n    pledgedAmount: pledgeOverride !== undefined ? pledgeOverride : getPledgedAmount(data),\n    residenceType: loan.residenceType\n  });\n};\n\nconst enableOffers = (_ref4) => {\n  let {\n    loan\n  } = _ref4;\n  return loan.enableOffers;\n};\n\nconst oneStructureHasLoan = (_ref5) => {\n  let {\n    loan: {\n      structures\n    }\n  } = _ref5;\n  return structures.some((_ref6) => {\n    let {\n      wantedLoan\n    } = _ref6;\n    return wantedLoan;\n  });\n};\n\nconst FinancingFinancing = props => React.createElement(FinancingSection, {\n  summaryConfig: [{\n    id: 'mortgageLoan',\n    label: React.createElement(\"span\", {\n      className: \"section-title\"\n    }, React.createElement(T, {\n      id: \"FinancingFinancing.title\"\n    })),\n    Component: props => React.createElement(\"div\", {\n      className: \"mortgageLoan financing-mortgageLoan\"\n    }, React.createElement(CalculatedValue, (0, _extends2.default)({\n      value: calculateLoan\n    }, props)), React.createElement(FinmaRatio, (0, _extends2.default)({\n      value: getBorrowRatio,\n      status: getBorrowRatioStatus\n    }, props)))\n  }],\n  detailConfig: [{\n    Component: InputAndSlider,\n    id: 'wantedLoan',\n    max: calculateMaxLoan\n  }, {\n    Component: LoanPercent,\n    id: 'wantedLoanPercent'\n  }, {\n    Component: MortgageNotesPicker,\n    id: 'mortgageNoteIds',\n    condition: oneStructureHasLoan\n  }, // TODO: To be released in the future\n  // {\n  //   Component: RadioButtons,\n  //   id: 'amortizationType',\n  //   options: Object.values(AMORTIZATION_TYPE).map(key => ({\n  //     id: key,\n  //     label: `FinancingFinancing.${key}`,\n  //   })),\n  //   condition: enableOffers,\n  // },\n  {\n    id: 'loanTranches',\n    Component: FinancingTranchePicker,\n    condition: enableOffers\n  }]\n});\n\nmodule.exportDefault(FinancingFinancing);","map":{"version":3,"sources":["imports/core/components/Financing/client/FinancingFinancing/FinancingFinancing.jsx"],"names":["getPledgedAmount","structure","ownFunds","usageType","OWN_FUNDS_USAGE_TYPES","value","sum","calculateLoan","params","wantedLoan","calculateMaxLoan","structureId","offer","maxAmount","getOffer","propertyValue","propertyWork","pledgedAmount","pledgeOverride","residenceType","loan","enableOffers","oneStructureHasLoan","structures","FinancingFinancing","id","label","Component","props","max","condition"],"mappings":"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","sourcesContent":["// @flow\nimport React from 'react';\n\nimport { OWN_FUNDS_USAGE_TYPES } from '../../../../api/constants';\nimport T from '../../../Translation';\nimport FinancingSection, {\n  InputAndSlider,\n  CalculatedValue,\n  FinmaRatio,\n} from '../FinancingSection';\nimport Calc, { getOffer } from '../FinancingCalculator';\nimport FinancingTranchePicker from './FinancingTranchePicker';\nimport MortgageNotesPicker from './MortgageNotesPicker';\nimport {\n  getBorrowRatio,\n  getBorrowRatioStatus,\n} from '../FinancingResult/financingResultHelpers';\nimport LoanPercent from './LoanPercent';\nimport Calculator from '../../../../utils/Calculator';\n\nconst getPledgedAmount = ({ structure: { ownFunds } }) =>\n  ownFunds\n    .filter(({ usageType }) => usageType === OWN_FUNDS_USAGE_TYPES.PLEDGE)\n    .reduce((sum, { value }) => sum + value, 0);\n\nexport const calculateLoan = (params) => {\n  const {\n    structure: { wantedLoan },\n  } = params;\n  return wantedLoan;\n};\n\nexport const calculateMaxLoan = (data, pledgeOverride) => {\n  const { loan, structureId } = data;\n  const offer = Calculator.selectOffer({ loan, structureId });\n  if (offer) {\n    const { maxAmount } = getOffer(data);\n    return maxAmount;\n  }\n\n  const structure = Calculator.selectStructure({ loan, structureId });\n  const propertyValue = Calculator.selectPropertyValue({ loan, structureId });\n\n  return Calc.getMaxLoanBase({\n    propertyWork: structure.propertyWork,\n    propertyValue,\n    pledgedAmount:\n      pledgeOverride !== undefined ? pledgeOverride : getPledgedAmount(data),\n    residenceType: loan.residenceType,\n  });\n};\n\nconst enableOffers = ({ loan }) => loan.enableOffers;\n\nconst oneStructureHasLoan = ({ loan: { structures } }) =>\n  structures.some(({ wantedLoan }) => wantedLoan);\n\ntype FinancingFinancingProps = {};\n\nconst FinancingFinancing = (props: FinancingFinancingProps) => (\n  <FinancingSection\n    summaryConfig={[\n      {\n        id: 'mortgageLoan',\n        label: (\n          <span className=\"section-title\">\n            <T id=\"FinancingFinancing.title\" />\n          </span>\n        ),\n        Component: props => (\n          <div className=\"mortgageLoan financing-mortgageLoan\">\n            <CalculatedValue value={calculateLoan} {...props} />\n            <FinmaRatio\n              value={getBorrowRatio}\n              status={getBorrowRatioStatus}\n              {...props}\n            />\n          </div>\n        ),\n      },\n    ]}\n    detailConfig={[\n      {\n        Component: InputAndSlider,\n        id: 'wantedLoan',\n        max: calculateMaxLoan,\n      },\n      {\n        Component: LoanPercent,\n        id: 'wantedLoanPercent',\n      },\n      {\n        Component: MortgageNotesPicker,\n        id: 'mortgageNoteIds',\n        condition: oneStructureHasLoan,\n      },\n      // TODO: To be released in the future\n      // {\n      //   Component: RadioButtons,\n      //   id: 'amortizationType',\n      //   options: Object.values(AMORTIZATION_TYPE).map(key => ({\n      //     id: key,\n      //     label: `FinancingFinancing.${key}`,\n      //   })),\n      //   condition: enableOffers,\n      // },\n      {\n        id: 'loanTranches',\n        Component: FinancingTranchePicker,\n        condition: enableOffers,\n      },\n    ]}\n  />\n);\n\nexport default FinancingFinancing;\n"]},"sourceType":"script","hash":"fa8393e7f1e642d2a4b6ad89cc92bb5f8275bf6f"}
