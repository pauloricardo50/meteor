{"metadata":{},"options":{"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/Florian/dev/epotek/microservices/backend/imports/core/components/Financing/client/FinancingOwnFunds/FinancingOwnFundsPicker/OwnFundsCompleterContainer.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties",["flow",{}],"dynamicImport","classProperties","classPrivateProperties","jsx",["flow",{}],"asyncGenerators","objectRestSpread","objectRestSpread",["flow",{}],"asyncGenerators"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"imports/core/components/Financing/client/FinancingOwnFunds/FinancingOwnFundsPicker/OwnFundsCompleterContainer.js","filename":"/Users/Florian/dev/epotek/microservices/backend/imports/core/components/Financing/client/FinancingOwnFunds/FinancingOwnFundsPicker/OwnFundsCompleterContainer.js","inputSourceMap":{"version":3,"sources":["imports/core/components/Financing/client/FinancingOwnFunds/FinancingOwnFundsPicker/OwnFundsCompleterContainer.js"],"names":["compose","withProps","OWN_FUNDS_USAGE_TYPES","FinancingDataContainer","SingleStructureContainer","getCurrentPledgedFunds","getMaxPledge","Calculator","removePreviousValueEffect","props","ownFundsIndex","ownFunds","requiredChange","currentChange","previousIsPledged","usageType","PLEDGE","maxPledge","previousPledgedValue","value","Math","min","removePledgingEffect","currentPledgedFunds","getRequiredAndCurrentFunds","structure","required","getRequiredOwnFunds","previousNonPledgedFunds","filter","uT","reduce","sum","v","current","isEditing","OwnFundsCompleterContainer"],"mappings":"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","sourcesContent":["import { compose, withProps } from 'recompose';\n\nimport { OWN_FUNDS_USAGE_TYPES } from 'core/api/constants';\nimport FinancingDataContainer from '../../containers/FinancingDataContainer';\nimport SingleStructureContainer from '../../containers/SingleStructureContainer';\nimport {\n  getCurrentPledgedFunds,\n  getMaxPledge,\n} from './FinancingOwnFundsPickerHelpers';\nimport Calculator from '../../../../../utils/Calculator';\n\nconst removePreviousValueEffect = ({ props, ownFundsIndex, ownFunds }) => {\n  let requiredChange = 0;\n  let currentChange = 0;\n  // Editing existing value, cancel its effect\n  const previousIsPledged = ownFunds[ownFundsIndex].usageType === OWN_FUNDS_USAGE_TYPES.PLEDGE;\n\n  if (previousIsPledged) {\n    const maxPledge = getMaxPledge(props);\n    const previousPledgedValue = ownFunds[ownFundsIndex].value;\n    requiredChange = Math.min(previousPledgedValue, maxPledge);\n  } else {\n    currentChange = -ownFunds[ownFundsIndex].value;\n  }\n\n  return { requiredChange, currentChange };\n};\n\nconst removePledgingEffect = ({ props, ownFunds, ownFundsIndex, value }) => {\n  const maxPledge = getMaxPledge(props);\n  const currentPledgedFunds = getCurrentPledgedFunds({\n    ownFunds,\n    ownFundsIndex,\n  });\n\n  return {\n    requiredChange: -Math.min(currentPledgedFunds + (value || 0), maxPledge),\n    currentChange: -value || 0,\n  };\n};\n\nexport const getRequiredAndCurrentFunds = (props) => {\n  const {\n    value,\n    structure: { ownFunds },\n    ownFundsIndex,\n    usageType,\n  } = props;\n  let required = Calculator.getRequiredOwnFunds(props);\n  const previousNonPledgedFunds = ownFunds\n    .filter(({ usageType: uT }) => uT !== OWN_FUNDS_USAGE_TYPES.PLEDGE)\n    .reduce((sum, { value: v }) => sum + v, 0);\n  let current = previousNonPledgedFunds + (value || 0);\n  const isEditing = ownFundsIndex >= 0;\n\n  if (isEditing) {\n    const { requiredChange, currentChange } = removePreviousValueEffect({\n      props,\n      ownFundsIndex,\n      ownFunds,\n    });\n    required += requiredChange;\n    current += currentChange;\n  }\n\n  if (usageType === OWN_FUNDS_USAGE_TYPES.PLEDGE) {\n    const { requiredChange, currentChange } = removePledgingEffect({\n      props,\n      ownFunds,\n      ownFundsIndex,\n      value,\n    });\n    required += requiredChange;\n    current += currentChange;\n  }\n\n  return { required, current };\n};\n\nconst OwnFundsCompleterContainer = compose(\n  SingleStructureContainer,\n  FinancingDataContainer,\n  withProps(getRequiredAndCurrentFunds),\n);\n\nexport default OwnFundsCompleterContainer;\n"]},"passPerPreset":false,"envName":"development","cwd":"/Users/Florian/dev/epotek/microservices/backend","root":"/Users/Florian/dev/epotek/microservices/backend","plugins":[{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"transform-runtime","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-modules-commonjs","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-flow","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/Florian/dev/epotek/microservices/backend/imports/core/components/Financing/client/FinancingOwnFunds/FinancingOwnFundsPicker/OwnFundsCompleterContainer.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/core/components/Financing/client/FinancingOwnFunds/FinancingOwnFundsPicker/OwnFundsCompleterContainer.js"}},"code":"module.export({\n  getRequiredAndCurrentFunds: function () {\n    return getRequiredAndCurrentFunds;\n  }\n});\nvar compose, withProps;\nmodule.link(\"recompose\", {\n  compose: function (v) {\n    compose = v;\n  },\n  withProps: function (v) {\n    withProps = v;\n  }\n}, 0);\nvar OWN_FUNDS_USAGE_TYPES;\nmodule.link(\"../../../../../api/constants\", {\n  OWN_FUNDS_USAGE_TYPES: function (v) {\n    OWN_FUNDS_USAGE_TYPES = v;\n  }\n}, 1);\nvar FinancingDataContainer;\nmodule.link(\"../../containers/FinancingDataContainer\", {\n  \"default\": function (v) {\n    FinancingDataContainer = v;\n  }\n}, 2);\nvar SingleStructureContainer;\nmodule.link(\"../../containers/SingleStructureContainer\", {\n  \"default\": function (v) {\n    SingleStructureContainer = v;\n  }\n}, 3);\nvar getCurrentPledgedFunds, getMaxPledge;\nmodule.link(\"./FinancingOwnFundsPickerHelpers\", {\n  getCurrentPledgedFunds: function (v) {\n    getCurrentPledgedFunds = v;\n  },\n  getMaxPledge: function (v) {\n    getMaxPledge = v;\n  }\n}, 4);\nvar Calculator;\nmodule.link(\"../../../../../utils/Calculator\", {\n  \"default\": function (v) {\n    Calculator = v;\n  }\n}, 5);\n\nvar removePreviousValueEffect = function (_ref) {\n  var props = _ref.props,\n      ownFundsIndex = _ref.ownFundsIndex,\n      ownFunds = _ref.ownFunds;\n  var requiredChange = 0;\n  var currentChange = 0; // Editing existing value, cancel its effect\n\n  var previousIsPledged = ownFunds[ownFundsIndex].usageType === OWN_FUNDS_USAGE_TYPES.PLEDGE;\n\n  if (previousIsPledged) {\n    var maxPledge = getMaxPledge(props);\n    var previousPledgedValue = ownFunds[ownFundsIndex].value;\n    requiredChange = Math.min(previousPledgedValue, maxPledge);\n  } else {\n    currentChange = -ownFunds[ownFundsIndex].value;\n  }\n\n  return {\n    requiredChange: requiredChange,\n    currentChange: currentChange\n  };\n};\n\nvar removePledgingEffect = function (_ref2) {\n  var props = _ref2.props,\n      ownFunds = _ref2.ownFunds,\n      ownFundsIndex = _ref2.ownFundsIndex,\n      value = _ref2.value;\n  var maxPledge = getMaxPledge(props);\n  var currentPledgedFunds = getCurrentPledgedFunds({\n    ownFunds: ownFunds,\n    ownFundsIndex: ownFundsIndex\n  });\n  return {\n    requiredChange: -Math.min(currentPledgedFunds + (value || 0), maxPledge),\n    currentChange: -value || 0\n  };\n};\n\nvar getRequiredAndCurrentFunds = function (props) {\n  var value = props.value,\n      ownFunds = props.structure.ownFunds,\n      ownFundsIndex = props.ownFundsIndex,\n      usageType = props.usageType;\n  var required = Calculator.getRequiredOwnFunds(props);\n  var previousNonPledgedFunds = ownFunds.filter(function (_ref3) {\n    var uT = _ref3.usageType;\n    return uT !== OWN_FUNDS_USAGE_TYPES.PLEDGE;\n  }).reduce(function (sum, _ref4) {\n    var v = _ref4.value;\n    return sum + v;\n  }, 0);\n  var current = previousNonPledgedFunds + (value || 0);\n  var isEditing = ownFundsIndex >= 0;\n\n  if (isEditing) {\n    var _removePreviousValueE = removePreviousValueEffect({\n      props: props,\n      ownFundsIndex: ownFundsIndex,\n      ownFunds: ownFunds\n    }),\n        requiredChange = _removePreviousValueE.requiredChange,\n        currentChange = _removePreviousValueE.currentChange;\n\n    required += requiredChange;\n    current += currentChange;\n  }\n\n  if (usageType === OWN_FUNDS_USAGE_TYPES.PLEDGE) {\n    var _removePledgingEffect = removePledgingEffect({\n      props: props,\n      ownFunds: ownFunds,\n      ownFundsIndex: ownFundsIndex,\n      value: value\n    }),\n        _requiredChange = _removePledgingEffect.requiredChange,\n        _currentChange = _removePledgingEffect.currentChange;\n\n    required += _requiredChange;\n    current += _currentChange;\n  }\n\n  return {\n    required: required,\n    current: current\n  };\n};\n\nvar OwnFundsCompleterContainer = compose(SingleStructureContainer, FinancingDataContainer, withProps(getRequiredAndCurrentFunds));\nmodule.exportDefault(OwnFundsCompleterContainer);","map":{"version":3,"sources":["imports/core/components/Financing/client/FinancingOwnFunds/FinancingOwnFundsPicker/OwnFundsCompleterContainer.js"],"names":["compose","removePreviousValueEffect","ownFunds","requiredChange","currentChange","previousIsPledged","OWN_FUNDS_USAGE_TYPES","maxPledge","getMaxPledge","previousPledgedValue","Math","removePledgingEffect","value","currentPledgedFunds","getCurrentPledgedFunds","ownFundsIndex","getRequiredAndCurrentFunds","props","structure","usageType","required","Calculator","previousNonPledgedFunds","uT","v","sum","current","isEditing","OwnFundsCompleterContainer","withProps"],"mappings":"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","sourcesContent":["import { compose, withProps } from 'recompose';\n\nimport { OWN_FUNDS_USAGE_TYPES } from 'core/api/constants';\nimport FinancingDataContainer from '../../containers/FinancingDataContainer';\nimport SingleStructureContainer from '../../containers/SingleStructureContainer';\nimport {\n  getCurrentPledgedFunds,\n  getMaxPledge,\n} from './FinancingOwnFundsPickerHelpers';\nimport Calculator from '../../../../../utils/Calculator';\n\nconst removePreviousValueEffect = ({ props, ownFundsIndex, ownFunds }) => {\n  let requiredChange = 0;\n  let currentChange = 0;\n  // Editing existing value, cancel its effect\n  const previousIsPledged = ownFunds[ownFundsIndex].usageType === OWN_FUNDS_USAGE_TYPES.PLEDGE;\n\n  if (previousIsPledged) {\n    const maxPledge = getMaxPledge(props);\n    const previousPledgedValue = ownFunds[ownFundsIndex].value;\n    requiredChange = Math.min(previousPledgedValue, maxPledge);\n  } else {\n    currentChange = -ownFunds[ownFundsIndex].value;\n  }\n\n  return { requiredChange, currentChange };\n};\n\nconst removePledgingEffect = ({ props, ownFunds, ownFundsIndex, value }) => {\n  const maxPledge = getMaxPledge(props);\n  const currentPledgedFunds = getCurrentPledgedFunds({\n    ownFunds,\n    ownFundsIndex,\n  });\n\n  return {\n    requiredChange: -Math.min(currentPledgedFunds + (value || 0), maxPledge),\n    currentChange: -value || 0,\n  };\n};\n\nexport const getRequiredAndCurrentFunds = (props) => {\n  const {\n    value,\n    structure: { ownFunds },\n    ownFundsIndex,\n    usageType,\n  } = props;\n  let required = Calculator.getRequiredOwnFunds(props);\n  const previousNonPledgedFunds = ownFunds\n    .filter(({ usageType: uT }) => uT !== OWN_FUNDS_USAGE_TYPES.PLEDGE)\n    .reduce((sum, { value: v }) => sum + v, 0);\n  let current = previousNonPledgedFunds + (value || 0);\n  const isEditing = ownFundsIndex >= 0;\n\n  if (isEditing) {\n    const { requiredChange, currentChange } = removePreviousValueEffect({\n      props,\n      ownFundsIndex,\n      ownFunds,\n    });\n    required += requiredChange;\n    current += currentChange;\n  }\n\n  if (usageType === OWN_FUNDS_USAGE_TYPES.PLEDGE) {\n    const { requiredChange, currentChange } = removePledgingEffect({\n      props,\n      ownFunds,\n      ownFundsIndex,\n      value,\n    });\n    required += requiredChange;\n    current += currentChange;\n  }\n\n  return { required, current };\n};\n\nconst OwnFundsCompleterContainer = compose(\n  SingleStructureContainer,\n  FinancingDataContainer,\n  withProps(getRequiredAndCurrentFunds),\n);\n\nexport default OwnFundsCompleterContainer;\n"]},"sourceType":"script","hash":"96e45d6ca4f8a0967a06bbfa069e5aeab72ccaef"}
