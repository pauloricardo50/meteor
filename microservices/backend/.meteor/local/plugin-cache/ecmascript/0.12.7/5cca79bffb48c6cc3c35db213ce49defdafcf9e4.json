{"metadata":{},"options":{"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/Florian/dev/epotek/microservices/backend/imports/core/api/liveSync/liveSync.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties",["flow",{}],"jsx",["flow",{}],["flow",{}],"objectRestSpread","objectRestSpread","dynamicImport","asyncGenerators","classProperties","classPrivateProperties"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.osx.x86_64"},"sourceFileName":"imports/core/api/liveSync/liveSync.js","filename":"/Users/Florian/dev/epotek/microservices/backend/imports/core/api/liveSync/liveSync.js","inputSourceMap":{"version":3,"sources":["imports/core/api/liveSync/liveSync.js"],"names":["Mongo","Meteor","check","LiveSync","Collection","STALE_LIVE_SYNC_MS","methods","liveSyncStart","upsert","userId","liveSyncStop","remove","liveSyncUpdate","options","String","update","$set","updatedAt","Date","liveSyncClear","now","$lt","getTime","liveSyncs","createQuery","$filter","filters","params"],"mappings":"AAAA,SAASA,KAAT,QAAsB,cAAtB;AACA,SAASC,MAAT,QAAuB,eAAvB;AACA,SAASC,KAAT,QAAsB,cAAtB;AAEA,MAAMC,QAAQ,GAAG,IAAIH,KAAK,CAACI,UAAV,CAAqB,UAArB,CAAjB;AACA,MAAMC,kBAAkB,GAAG,IAAI,EAAJ,GAAS,IAApC;AAEAJ,MAAM,CAACK,OAAP,CAAe;AACbC,EAAAA,aAAa,GAAG;AACdJ,IAAAA,QAAQ,CAACK,MAAT,CAAgB;AAAEC,MAAAA,MAAM,EAAE,KAAKA;AAAf,KAAhB,EAAyC;AAAEA,MAAAA,MAAM,EAAE,KAAKA;AAAf,KAAzC;AACD,GAHY;;AAIbC,EAAAA,YAAY,GAAG;AACbP,IAAAA,QAAQ,CAACQ,MAAT,CAAgB;AAAEF,MAAAA,MAAM,EAAE,KAAKA;AAAf,KAAhB;AACD,GANY;;AAObG,EAAAA,cAAc,CAACC,OAAD,EAAU;AACtBX,IAAAA,KAAK,CAACW,OAAD,EAAUC,MAAV,CAAL;AACAX,IAAAA,QAAQ,CAACY,MAAT,CACE;AAAEN,MAAAA,MAAM,EAAE,KAAKA;AAAf,KADF,EAEE;AAAEO,MAAAA,IAAI,EAAE;AAAEH,QAAAA,OAAF;AAAWI,QAAAA,SAAS,EAAE,IAAIC,IAAJ;AAAtB;AAAR,KAFF;AAID,GAbY;;AAcbC,EAAAA,aAAa,GAAG;AACd,UAAMC,GAAG,GAAG,IAAIF,IAAJ,EAAZ;AACAf,IAAAA,QAAQ,CAACQ,MAAT,CAAgB;AACdM,MAAAA,SAAS,EAAE;AAAEI,QAAAA,GAAG,EAAE,IAAIH,IAAJ,CAASE,GAAG,CAACE,OAAJ,KAAgBjB,kBAAzB;AAAP;AADG,KAAhB;AAGD;;AAnBY,CAAf;AAsBA,OAAO,MAAMkB,SAAS,GAAGpB,QAAQ,CAACqB,WAAT,CAAqB,WAArB,EAAkC;AACzDC,EAAAA,OAAO,CAAC;AAAEC,IAAAA,OAAF;AAAWC,IAAAA,MAAM,EAAE;AAAElB,MAAAA;AAAF;AAAnB,GAAD,EAAkC;AACvC,QAAIA,MAAJ,EAAY;AACViB,MAAAA,OAAO,CAACjB,MAAR,GAAiBA,MAAjB;AACD;AACF,GALwD;;AAMzDA,EAAAA,MAAM,EAAE,CANiD;AAOzDI,EAAAA,OAAO,EAAE;AAPgD,CAAlC,CAAlB;AAUP,eAAeV,QAAf","sourcesContent":["import { Mongo } from 'meteor/mongo';\nimport { Meteor } from 'meteor/meteor';\nimport { check } from 'meteor/check';\n\nconst LiveSync = new Mongo.Collection('liveSync');\nconst STALE_LIVE_SYNC_MS = 2 * 60 * 1000;\n\nMeteor.methods({\n  liveSyncStart() {\n    LiveSync.upsert({ userId: this.userId }, { userId: this.userId });\n  },\n  liveSyncStop() {\n    LiveSync.remove({ userId: this.userId });\n  },\n  liveSyncUpdate(options) {\n    check(options, String);\n    LiveSync.update(\n      { userId: this.userId },\n      { $set: { options, updatedAt: new Date() } },\n    );\n  },\n  liveSyncClear() {\n    const now = new Date();\n    LiveSync.remove({\n      updatedAt: { $lt: new Date(now.getTime() - STALE_LIVE_SYNC_MS) },\n    });\n  },\n});\n\nexport const liveSyncs = LiveSync.createQuery('liveSyncs', {\n  $filter({ filters, params: { userId } }) {\n    if (userId) {\n      filters.userId = userId;\n    }\n  },\n  userId: 1,\n  options: 1,\n});\n\nexport default LiveSync;\n"]},"passPerPreset":false,"envName":"development","cwd":"/Users/Florian/dev/epotek/microservices/backend","root":"/Users/Florian/dev/epotek/microservices/backend","plugins":[{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"syntax-flow","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"transform-runtime","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"transform-modules-commonjs","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}}],"presets":[],"generatorOpts":{"filename":"/Users/Florian/dev/epotek/microservices/backend/imports/core/api/liveSync/liveSync.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/core/api/liveSync/liveSync.js"}},"code":"module.export({\n  liveSyncs: () => liveSyncs\n});\nlet Mongo;\nmodule.link(\"meteor/mongo\", {\n  Mongo(v) {\n    Mongo = v;\n  }\n\n}, 0);\nlet Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 1);\nlet check;\nmodule.link(\"meteor/check\", {\n  check(v) {\n    check = v;\n  }\n\n}, 2);\nconst LiveSync = new Mongo.Collection('liveSync');\nconst STALE_LIVE_SYNC_MS = 2 * 60 * 1000;\nMeteor.methods({\n  liveSyncStart() {\n    LiveSync.upsert({\n      userId: this.userId\n    }, {\n      userId: this.userId\n    });\n  },\n\n  liveSyncStop() {\n    LiveSync.remove({\n      userId: this.userId\n    });\n  },\n\n  liveSyncUpdate(options) {\n    check(options, String);\n    LiveSync.update({\n      userId: this.userId\n    }, {\n      $set: {\n        options,\n        updatedAt: new Date()\n      }\n    });\n  },\n\n  liveSyncClear() {\n    const now = new Date();\n    LiveSync.remove({\n      updatedAt: {\n        $lt: new Date(now.getTime() - STALE_LIVE_SYNC_MS)\n      }\n    });\n  }\n\n});\nconst liveSyncs = LiveSync.createQuery('liveSyncs', {\n  $filter({\n    filters,\n    params: {\n      userId\n    }\n  }) {\n    if (userId) {\n      filters.userId = userId;\n    }\n  },\n\n  userId: 1,\n  options: 1\n});\nmodule.exportDefault(LiveSync);","map":{"version":3,"sources":["imports/core/api/liveSync/liveSync.js"],"names":["LiveSync","Mongo","STALE_LIVE_SYNC_MS","Meteor","liveSyncStart","userId","liveSyncStop","liveSyncUpdate","check","$set","updatedAt","liveSyncClear","now","$lt","liveSyncs","$filter","params","filters","options"],"mappings":"AAAA,MAAA,CAAA,MAAA,CAAA;AAAA,EAAA,SAAsB,EAAA,MAAtB;AAAA,CAAA;AAAA,IAAA,KAAA;AAAA,MAAA,CAAA,IAAA,CAAA,cAAA,EAAA;AAAA,EAAA,KAAA,CAAA,CAAA,EAAA;AAAA,IAAA,KAAA,GAAA,CAAA;AAAA;;AAAA,CAAA,EAAA,CAAA;AAAA,IAAA,MAAA;AAAA,MAAA,CAAA,IAAA,CAAA,eAAA,EAAA;AAAA,EAAA,MAAA,CAAA,CAAA,EAAA;AAAA,IAAA,MAAA,GAAA,CAAA;AAAA;;AAAA,CAAA,EAAA,CAAA;AAAA,IAAA,KAAA;AAAA,MAAA,CAAA,IAAA,CAAA,cAAA,EAAA;AAAA,EAAA,KAAA,CAAA,CAAA,EAAA;AAAA,IAAA,KAAA,GAAA,CAAA;AAAA;;AAAA,CAAA,EAAA,CAAA;AAIA,MAAMA,QAAQ,GAAG,IAAIC,KAAK,CAAT,UAAA,CAAjB,UAAiB,CAAjB;AACA,MAAMC,kBAAkB,GAAG,IAAA,EAAA,GAA3B,IAAA;AAEAC,MAAM,CAANA,OAAAA,CAAe;AACbC,EAAAA,aAAa,GAAG;AACdJ,IAAAA,QAAQ,CAARA,MAAAA,CAAgB;AAAEK,MAAAA,MAAM,EAAE,KAAKA;AAAf,KAAhBL,EAAyC;AAAEK,MAAAA,MAAM,EAAE,KAAKA;AAAf,KAAzCL;AAFW,GAAA;;AAIbM,EAAAA,YAAY,GAAG;AACbN,IAAAA,QAAQ,CAARA,MAAAA,CAAgB;AAAEK,MAAAA,MAAM,EAAE,KAAKA;AAAf,KAAhBL;AALW,GAAA;;AAObO,EAAAA,cAAc,CAAA,OAAA,EAAU;AACtBC,IAAAA,KAAK,CAAA,OAAA,EAALA,MAAK,CAALA;AACAR,IAAAA,QAAQ,CAARA,MAAAA,CACE;AAAEK,MAAAA,MAAM,EAAE,KAAKA;AAAf,KADFL,EAEE;AAAES,MAAAA,IAAI,EAAE;AAAA,QAAA,OAAA;AAAWC,QAAAA,SAAS,EAAE,IAAA,IAAA;AAAtB;AAAR,KAFFV;AATW,GAAA;;AAcbW,EAAAA,aAAa,GAAG;AACd,UAAMC,GAAG,GAAG,IAAZ,IAAY,EAAZ;AACAZ,IAAAA,QAAQ,CAARA,MAAAA,CAAgB;AACdU,MAAAA,SAAS,EAAE;AAAEG,QAAAA,GAAG,EAAE,IAAA,IAAA,CAASD,GAAG,CAAHA,OAAAA,KAAT,kBAAA;AAAP;AADG,KAAhBZ;AAGD;;AAnBY,CAAfG;AAsBO,MAAMW,SAAS,GAAG,QAAQ,CAAR,WAAA,CAAA,WAAA,EAAkC;AACzDC,EAAAA,OAAO,CAAC;AAAA,IAAA,OAAA;AAAWC,IAAAA,MAAM,EAAE;AAAEX,MAAAA;AAAF;AAAnB,GAAD,EAAkC;AACvC,QAAA,MAAA,EAAY;AACVY,MAAAA,OAAO,CAAPA,MAAAA,GAAAA,MAAAA;AACD;AAJsD,GAAA;;AAMzDZ,EAAAA,MAAM,EANmD,CAAA;AAOzDa,EAAAA,OAAO,EAAE;AAPgD,CAAlC,CAAlB;AA7BP,MAAA,CAAA,aAAA,CAuCA,QAvCA","sourcesContent":["import { Mongo } from 'meteor/mongo';\nimport { Meteor } from 'meteor/meteor';\nimport { check } from 'meteor/check';\n\nconst LiveSync = new Mongo.Collection('liveSync');\nconst STALE_LIVE_SYNC_MS = 2 * 60 * 1000;\n\nMeteor.methods({\n  liveSyncStart() {\n    LiveSync.upsert({ userId: this.userId }, { userId: this.userId });\n  },\n  liveSyncStop() {\n    LiveSync.remove({ userId: this.userId });\n  },\n  liveSyncUpdate(options) {\n    check(options, String);\n    LiveSync.update(\n      { userId: this.userId },\n      { $set: { options, updatedAt: new Date() } },\n    );\n  },\n  liveSyncClear() {\n    const now = new Date();\n    LiveSync.remove({\n      updatedAt: { $lt: new Date(now.getTime() - STALE_LIVE_SYNC_MS) },\n    });\n  },\n});\n\nexport const liveSyncs = LiveSync.createQuery('liveSyncs', {\n  $filter({ filters, params: { userId } }) {\n    if (userId) {\n      filters.userId = userId;\n    }\n  },\n  userId: 1,\n  options: 1,\n});\n\nexport default LiveSync;\n"]},"sourceType":"script","hash":"5cca79bffb48c6cc3c35db213ce49defdafcf9e4"}
