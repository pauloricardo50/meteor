{"metadata":{},"options":{"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/Florian/dev/epotek/microservices/backend/imports/core/components/Financing/client/FinancingResult/test/FinancingResult.spec.jsx","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties",["flow",{}],"dynamicImport","classProperties","classPrivateProperties","jsx",["flow",{}],"asyncGenerators","objectRestSpread","objectRestSpread",["flow",{}],"asyncGenerators"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"imports/core/components/Financing/client/FinancingResult/test/FinancingResult.spec.jsx","filename":"/Users/Florian/dev/epotek/microservices/backend/imports/core/components/Financing/client/FinancingResult/test/FinancingResult.spec.jsx","inputSourceMap":{"version":3,"sources":["imports/core/components/Financing/client/FinancingResult/test/FinancingResult.spec.jsx"],"names":["React","expect","mount","IntlProvider","intlShape","ScrollSync","messages","OWN_FUNDS_USAGE_TYPES","FinancingResult","Provider","INTEREST_RATES","Calculator","expectResult","component","name","value","val","find","last","Number","isInteger","contains","replace","to","equal","describe","props","loan","intl","defaultLocale","getChildContext","context","childContextTypes","beforeEach","structures","borrowers","properties","structure","id","loanTranches","type","propertyId","propertyWork","wantedLoan","ownFunds","selectedStructure","_id","bankFortune","salary","insurance2","insurance3A","yearlyExpenses","currentInterestRates","YEARS_10","it","monthly","string","text","hasNonZeroNumber","test","interestsCost","offerId","notaryFees","borrowerId","usageType","PLEDGE","thirdPartyFortune","offers","interest2","interestLibor","amortizationGoal","amortizationYears","match","join","skip","exists"],"mappings":"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","sourcesContent":["// @flow\n/* eslint-env mocha */\nimport React from 'react';\nimport { expect } from 'chai';\nimport { mount } from 'core/utils/testHelpers/enzyme';\nimport { IntlProvider, intlShape } from 'react-intl';\nimport { ScrollSync } from 'react-scroll-sync';\nimport messages from 'core/lang/fr.json';\n\nimport { OWN_FUNDS_USAGE_TYPES } from 'imports/core/api/constants';\nimport FinancingResult from '../FinancingResult';\nimport { Provider } from '../../containers/loan-context';\nimport { INTEREST_RATES } from '../../../../../api/interestRates/interestRatesConstants';\nimport Calculator from '../../../../../utils/Calculator';\n\nconst expectResult = (component, name, value) => {\n  const val = component()\n    .find(name)\n    .last();\n\n  if (!Number.isInteger(value)) {\n    // On our test browsers, the comma is represented either as a , or .\n    // due to the web's \"intl\" API\n    expect(val.contains(`${value}`) || val.contains(`${value}`.replace('.', ','))).to.equal(true);\n  } else {\n    expect(val.contains(`${value}`)).to.equal(true);\n  }\n};\n\ndescribe('FinancingResult', () => {\n  let props;\n  let loan;\n  const { intl } = new IntlProvider({\n    defaultLocale: 'fr',\n    messages,\n  }).getChildContext();\n  const component = () =>\n    mount(\n      <ScrollSync>\n        <Provider value={{ loan, Calculator }}>\n          <FinancingResult {...props} />\n        </Provider>\n      </ScrollSync>,\n      {\n        context: { intl },\n        childContextTypes: { intl: intlShape },\n      },\n    );\n\n  beforeEach(() => {\n    props = {};\n    loan = {\n      structures: [],\n      borrowers: [],\n      properties: [],\n    };\n  });\n\n  context('renders the correct results for a standard structure', () => {\n    beforeEach(() => {\n      const structure = {\n        id: 'a',\n        loanTranches: [{ type: 'interest10', value: 1 }],\n        propertyId: 'house',\n        propertyWork: 0,\n        wantedLoan: 800000,\n        ownFunds: [{ type: 'bankFortune', value: 250000 }],\n      };\n      loan = {\n        selectedStructure: 'a',\n        structure,\n        structures: [structure],\n        borrowers: [\n          {\n            _id: 'john',\n            bankFortune: 250000,\n            salary: 200000,\n            insurance2: [{ value: 50 }],\n            insurance3A: [{ value: 60 }],\n          },\n        ],\n        properties: [\n          {\n            _id: 'house',\n            value: 1000000,\n            yearlyExpenses: 1200,\n          },\n        ],\n        currentInterestRates: { [INTEREST_RATES.YEARS_10]: 0.01 },\n      };\n    });\n\n    it('monthly', () => {\n      const monthly = component().find('.financing-structures-result-chart .total');\n      const string = monthly.text();\n      const hasNonZeroNumber = /[1-9]/.test(string);\n      // Interests rates change constantly, can't pin a precise value\n      expect(hasNonZeroNumber).to.equal(true);\n    });\n\n    it('interestsCost', () => {\n      const interestsCost = component()\n        .find('.interestsCost')\n        .last();\n      const string = interestsCost.text();\n      const hasNonZeroNumber = /[1-9]/.test(string);\n\n      expect(hasNonZeroNumber).to.equal(true);\n    });\n\n    it('amortizationCost', () => {\n      expectResult(component, '.amortizationCost', 833);\n    });\n\n    it('propertyCost', () => {\n      expectResult(component, '.propertyCost', 100);\n    });\n\n    it('borrowRatio', () => {\n      expectResult(component, '.borrowRatio', 0.8);\n    });\n\n    it('incomeRatio', () => {\n      expectResult(component, '.incomeRatio', 0.3);\n    });\n\n    it('remainingCash', () => {\n      expectResult(component, '.remainingCash', 0);\n    });\n\n    it('remainingInsurance2', () => {\n      expectResult(component, '.remainingInsurance2', 50);\n    });\n\n    it('remainingInsurance3A', () => {\n      expectResult(component, '.remainingInsurance3A', 60);\n    });\n  });\n\n  context('structure with an offer', () => {\n    beforeEach(() => {\n      const structure = {\n        id: 'a',\n        loanTranches: [\n          { type: 'interest2', value: 0.8 },\n          { type: 'interestLibor', value: 0.2 },\n        ],\n        propertyId: 'house',\n        offerId: 'offer',\n        propertyWork: 200000,\n        wantedLoan: 1080000,\n        notaryFees: 50000,\n        ownFunds: [\n          { type: 'bankFortune', value: 150000, borrowerId: 'John' },\n          {\n            type: 'insurance2',\n            usageType: OWN_FUNDS_USAGE_TYPES.PLEDGE,\n            value: 120000,\n            borrowerId: 'John',\n          },\n          { type: 'thirdPartyFortune', value: 20000, borrowerId: 'Mary' },\n        ],\n      };\n      loan = {\n        selectedStructure: 'a',\n        structure,\n        structures: [structure],\n        borrowers: [\n          {\n            _id: 'John',\n            bankFortune: 250000,\n            salary: 200000,\n            insurance2: [{ value: 1000 }],\n            insurance3A: [{ value: 500 }],\n          },\n          {\n            _id: 'Mary',\n            salary: 200000,\n            thirdPartyFortune: 200000,\n            insurance2: [{ value: 2000 }],\n            insurance3A: [{ value: 0 }],\n          },\n        ],\n        properties: [\n          {\n            _id: 'house',\n            value: 1000000,\n            yearlyExpenses: 1200,\n          },\n        ],\n        offers: [\n          {\n            _id: 'offer',\n            interest2: 0.02,\n            interestLibor: 0.01,\n            amortizationGoal: 0.5,\n            amortizationYears: 5,\n          },\n        ],\n        currentInterestRates: { [INTEREST_RATES.YEARS_10]: 0.01 },\n      };\n    });\n\n    it('monthly', () => {\n      const monthly = component().find('.financing-structures-result-chart .total');\n      const string = monthly.text();\n      const value = string.match(/\\d/g).join('');\n      expect(value).to.equal('9720');\n    });\n\n    it('interestsCost', () => {\n      const interestsCost = component()\n        .find('.interestsCost')\n        .last();\n      const string = interestsCost.text();\n      const value = string.match(/\\d/g).join('');\n\n      // Average of 1.8% interests\n      expect(value).to.equal('1620');\n    });\n\n    it('amortizationCost', () => {\n      // 1080k in 5 years to 600k\n      expectResult(component, '.amortizationCost', '8 000');\n    });\n\n    it('propertyCost', () => {\n      expectResult(component, '.propertyCost', 100);\n    });\n\n    it('borrowRatio', () => {\n      expectResult(component, '.borrowRatio', 0.9);\n    });\n\n    it('incomeRatio', () => {\n      // 400k income\n      // 12k maintenance, 54k interests, 20k amortization\n      expectResult(component, '.incomeRatio', 0.215);\n    });\n\n    it('remainingCash', () => {\n      expectResult(component, '.remainingCash', '100 000');\n    });\n\n    it('remainingInsurance2', () => {\n      expectResult(component, '.remainingInsurance2', '3 000');\n    });\n\n    it('remainingInsurance3A', () => {\n      expectResult(component, '.remainingInsurance3A', 500);\n    });\n  });\n\n  it.skip('renders an error if an interest rate is not defined', () => {\n    // FIXME: Enzyme does not support componentDidCatch yet\n    // https://github.com/airbnb/enzyme/issues/1553\n    loan = {\n      structures: [\n        {\n          id: 'a',\n          loanTranches: [{ type: 'unknown_rate' }],\n        },\n      ],\n      borrowers: [{}],\n      properties: [{}],\n    };\n    expect(component()\n      .find('.error')\n      .exists()).to.equal(true);\n  });\n});\n"]},"passPerPreset":false,"envName":"development","cwd":"/Users/Florian/dev/epotek/microservices/backend","root":"/Users/Florian/dev/epotek/microservices/backend","plugins":[{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"transform-runtime","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-modules-commonjs","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-flow","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/Florian/dev/epotek/microservices/backend/imports/core/components/Financing/client/FinancingResult/test/FinancingResult.spec.jsx","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/core/components/Financing/client/FinancingResult/test/FinancingResult.spec.jsx"}},"code":"var React;\nmodule.link(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  }\n}, 0);\nvar expect;\nmodule.link(\"chai\", {\n  expect: function (v) {\n    expect = v;\n  }\n}, 1);\nvar mount;\nmodule.link(\"../../../../../utils/testHelpers/enzyme\", {\n  mount: function (v) {\n    mount = v;\n  }\n}, 2);\nvar IntlProvider, intlShape;\nmodule.link(\"react-intl\", {\n  IntlProvider: function (v) {\n    IntlProvider = v;\n  },\n  intlShape: function (v) {\n    intlShape = v;\n  }\n}, 3);\nvar ScrollSync;\nmodule.link(\"react-scroll-sync\", {\n  ScrollSync: function (v) {\n    ScrollSync = v;\n  }\n}, 4);\nvar messages;\nmodule.link(\"../../../../../lang/fr.json\", {\n  \"default\": function (v) {\n    messages = v;\n  }\n}, 5);\nvar OWN_FUNDS_USAGE_TYPES;\nmodule.link(\"../../../../../api/constants\", {\n  OWN_FUNDS_USAGE_TYPES: function (v) {\n    OWN_FUNDS_USAGE_TYPES = v;\n  }\n}, 6);\nvar FinancingResult;\nmodule.link(\"../FinancingResult\", {\n  \"default\": function (v) {\n    FinancingResult = v;\n  }\n}, 7);\nvar Provider;\nmodule.link(\"../../containers/loan-context\", {\n  Provider: function (v) {\n    Provider = v;\n  }\n}, 8);\nvar INTEREST_RATES;\nmodule.link(\"../../../../../api/interestRates/interestRatesConstants\", {\n  INTEREST_RATES: function (v) {\n    INTEREST_RATES = v;\n  }\n}, 9);\nvar Calculator;\nmodule.link(\"../../../../../utils/Calculator\", {\n  \"default\": function (v) {\n    Calculator = v;\n  }\n}, 10);\n\nvar expectResult = function (component, name, value) {\n  var val = component().find(name).last();\n\n  if (!Number.isInteger(value)) {\n    // On our test browsers, the comma is represented either as a , or .\n    // due to the web's \"intl\" API\n    expect(val.contains(\"\" + value) || val.contains((\"\" + value).replace('.', ','))).to.equal(true);\n  } else {\n    expect(val.contains(\"\" + value)).to.equal(true);\n  }\n};\n\ndescribe('FinancingResult', function () {\n  var props;\n  var loan;\n\n  var _getChildContext = new IntlProvider({\n    defaultLocale: 'fr',\n    messages: messages\n  }).getChildContext(),\n      intl = _getChildContext.intl;\n\n  var component = function () {\n    return mount(React.createElement(ScrollSync, null, React.createElement(Provider, {\n      value: {\n        loan: loan,\n        Calculator: Calculator\n      }\n    }, React.createElement(FinancingResult, props))), {\n      context: {\n        intl: intl\n      },\n      childContextTypes: {\n        intl: intlShape\n      }\n    });\n  };\n\n  beforeEach(function () {\n    props = {};\n    loan = {\n      structures: [],\n      borrowers: [],\n      properties: []\n    };\n  });\n  context('renders the correct results for a standard structure', function () {\n    beforeEach(function () {\n      var _currentInterestRates;\n\n      var structure = {\n        id: 'a',\n        loanTranches: [{\n          type: 'interest10',\n          value: 1\n        }],\n        propertyId: 'house',\n        propertyWork: 0,\n        wantedLoan: 800000,\n        ownFunds: [{\n          type: 'bankFortune',\n          value: 250000\n        }]\n      };\n      loan = {\n        selectedStructure: 'a',\n        structure: structure,\n        structures: [structure],\n        borrowers: [{\n          _id: 'john',\n          bankFortune: 250000,\n          salary: 200000,\n          insurance2: [{\n            value: 50\n          }],\n          insurance3A: [{\n            value: 60\n          }]\n        }],\n        properties: [{\n          _id: 'house',\n          value: 1000000,\n          yearlyExpenses: 1200\n        }],\n        currentInterestRates: (_currentInterestRates = {}, _currentInterestRates[INTEREST_RATES.YEARS_10] = 0.01, _currentInterestRates)\n      };\n    });\n    it('monthly', function () {\n      var monthly = component().find('.financing-structures-result-chart .total');\n      var string = monthly.text();\n      var hasNonZeroNumber = /[1-9]/.test(string); // Interests rates change constantly, can't pin a precise value\n\n      expect(hasNonZeroNumber).to.equal(true);\n    });\n    it('interestsCost', function () {\n      var interestsCost = component().find('.interestsCost').last();\n      var string = interestsCost.text();\n      var hasNonZeroNumber = /[1-9]/.test(string);\n      expect(hasNonZeroNumber).to.equal(true);\n    });\n    it('amortizationCost', function () {\n      expectResult(component, '.amortizationCost', 833);\n    });\n    it('propertyCost', function () {\n      expectResult(component, '.propertyCost', 100);\n    });\n    it('borrowRatio', function () {\n      expectResult(component, '.borrowRatio', 0.8);\n    });\n    it('incomeRatio', function () {\n      expectResult(component, '.incomeRatio', 0.3);\n    });\n    it('remainingCash', function () {\n      expectResult(component, '.remainingCash', 0);\n    });\n    it('remainingInsurance2', function () {\n      expectResult(component, '.remainingInsurance2', 50);\n    });\n    it('remainingInsurance3A', function () {\n      expectResult(component, '.remainingInsurance3A', 60);\n    });\n  });\n  context('structure with an offer', function () {\n    beforeEach(function () {\n      var _currentInterestRates2;\n\n      var structure = {\n        id: 'a',\n        loanTranches: [{\n          type: 'interest2',\n          value: 0.8\n        }, {\n          type: 'interestLibor',\n          value: 0.2\n        }],\n        propertyId: 'house',\n        offerId: 'offer',\n        propertyWork: 200000,\n        wantedLoan: 1080000,\n        notaryFees: 50000,\n        ownFunds: [{\n          type: 'bankFortune',\n          value: 150000,\n          borrowerId: 'John'\n        }, {\n          type: 'insurance2',\n          usageType: OWN_FUNDS_USAGE_TYPES.PLEDGE,\n          value: 120000,\n          borrowerId: 'John'\n        }, {\n          type: 'thirdPartyFortune',\n          value: 20000,\n          borrowerId: 'Mary'\n        }]\n      };\n      loan = {\n        selectedStructure: 'a',\n        structure: structure,\n        structures: [structure],\n        borrowers: [{\n          _id: 'John',\n          bankFortune: 250000,\n          salary: 200000,\n          insurance2: [{\n            value: 1000\n          }],\n          insurance3A: [{\n            value: 500\n          }]\n        }, {\n          _id: 'Mary',\n          salary: 200000,\n          thirdPartyFortune: 200000,\n          insurance2: [{\n            value: 2000\n          }],\n          insurance3A: [{\n            value: 0\n          }]\n        }],\n        properties: [{\n          _id: 'house',\n          value: 1000000,\n          yearlyExpenses: 1200\n        }],\n        offers: [{\n          _id: 'offer',\n          interest2: 0.02,\n          interestLibor: 0.01,\n          amortizationGoal: 0.5,\n          amortizationYears: 5\n        }],\n        currentInterestRates: (_currentInterestRates2 = {}, _currentInterestRates2[INTEREST_RATES.YEARS_10] = 0.01, _currentInterestRates2)\n      };\n    });\n    it('monthly', function () {\n      var monthly = component().find('.financing-structures-result-chart .total');\n      var string = monthly.text();\n      var value = string.match(/\\d/g).join('');\n      expect(value).to.equal('9720');\n    });\n    it('interestsCost', function () {\n      var interestsCost = component().find('.interestsCost').last();\n      var string = interestsCost.text();\n      var value = string.match(/\\d/g).join(''); // Average of 1.8% interests\n\n      expect(value).to.equal('1620');\n    });\n    it('amortizationCost', function () {\n      // 1080k in 5 years to 600k\n      expectResult(component, '.amortizationCost', '8 000');\n    });\n    it('propertyCost', function () {\n      expectResult(component, '.propertyCost', 100);\n    });\n    it('borrowRatio', function () {\n      expectResult(component, '.borrowRatio', 0.9);\n    });\n    it('incomeRatio', function () {\n      // 400k income\n      // 12k maintenance, 54k interests, 20k amortization\n      expectResult(component, '.incomeRatio', 0.215);\n    });\n    it('remainingCash', function () {\n      expectResult(component, '.remainingCash', '100 000');\n    });\n    it('remainingInsurance2', function () {\n      expectResult(component, '.remainingInsurance2', '3 000');\n    });\n    it('remainingInsurance3A', function () {\n      expectResult(component, '.remainingInsurance3A', 500);\n    });\n  });\n  it.skip('renders an error if an interest rate is not defined', function () {\n    // FIXME: Enzyme does not support componentDidCatch yet\n    // https://github.com/airbnb/enzyme/issues/1553\n    loan = {\n      structures: [{\n        id: 'a',\n        loanTranches: [{\n          type: 'unknown_rate'\n        }]\n      }],\n      borrowers: [{}],\n      properties: [{}]\n    };\n    expect(component().find('.error').exists()).to.equal(true);\n  });\n});","map":{"version":3,"sources":["imports/core/components/Financing/client/FinancingResult/test/FinancingResult.spec.jsx"],"names":["expectResult","val","component","Number","expect","describe","intl","defaultLocale","messages","mount","loan","Calculator","context","childContextTypes","intlShape","beforeEach","props","structures","borrowers","properties","structure","id","loanTranches","type","value","propertyId","propertyWork","wantedLoan","ownFunds","selectedStructure","_id","bankFortune","salary","insurance2","insurance3A","yearlyExpenses","currentInterestRates","INTEREST_RATES","it","monthly","string","hasNonZeroNumber","interestsCost","offerId","notaryFees","borrowerId","usageType","OWN_FUNDS_USAGE_TYPES","thirdPartyFortune","offers","interest2","interestLibor","amortizationGoal","amortizationYears"],"mappings":"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","sourcesContent":["// @flow\n/* eslint-env mocha */\nimport React from 'react';\nimport { expect } from 'chai';\nimport { mount } from 'core/utils/testHelpers/enzyme';\nimport { IntlProvider, intlShape } from 'react-intl';\nimport { ScrollSync } from 'react-scroll-sync';\nimport messages from 'core/lang/fr.json';\n\nimport { OWN_FUNDS_USAGE_TYPES } from 'imports/core/api/constants';\nimport FinancingResult from '../FinancingResult';\nimport { Provider } from '../../containers/loan-context';\nimport { INTEREST_RATES } from '../../../../../api/interestRates/interestRatesConstants';\nimport Calculator from '../../../../../utils/Calculator';\n\nconst expectResult = (component, name, value) => {\n  const val = component()\n    .find(name)\n    .last();\n\n  if (!Number.isInteger(value)) {\n    // On our test browsers, the comma is represented either as a , or .\n    // due to the web's \"intl\" API\n    expect(val.contains(`${value}`) || val.contains(`${value}`.replace('.', ','))).to.equal(true);\n  } else {\n    expect(val.contains(`${value}`)).to.equal(true);\n  }\n};\n\ndescribe('FinancingResult', () => {\n  let props;\n  let loan;\n  const { intl } = new IntlProvider({\n    defaultLocale: 'fr',\n    messages,\n  }).getChildContext();\n  const component = () =>\n    mount(\n      <ScrollSync>\n        <Provider value={{ loan, Calculator }}>\n          <FinancingResult {...props} />\n        </Provider>\n      </ScrollSync>,\n      {\n        context: { intl },\n        childContextTypes: { intl: intlShape },\n      },\n    );\n\n  beforeEach(() => {\n    props = {};\n    loan = {\n      structures: [],\n      borrowers: [],\n      properties: [],\n    };\n  });\n\n  context('renders the correct results for a standard structure', () => {\n    beforeEach(() => {\n      const structure = {\n        id: 'a',\n        loanTranches: [{ type: 'interest10', value: 1 }],\n        propertyId: 'house',\n        propertyWork: 0,\n        wantedLoan: 800000,\n        ownFunds: [{ type: 'bankFortune', value: 250000 }],\n      };\n      loan = {\n        selectedStructure: 'a',\n        structure,\n        structures: [structure],\n        borrowers: [\n          {\n            _id: 'john',\n            bankFortune: 250000,\n            salary: 200000,\n            insurance2: [{ value: 50 }],\n            insurance3A: [{ value: 60 }],\n          },\n        ],\n        properties: [\n          {\n            _id: 'house',\n            value: 1000000,\n            yearlyExpenses: 1200,\n          },\n        ],\n        currentInterestRates: { [INTEREST_RATES.YEARS_10]: 0.01 },\n      };\n    });\n\n    it('monthly', () => {\n      const monthly = component().find('.financing-structures-result-chart .total');\n      const string = monthly.text();\n      const hasNonZeroNumber = /[1-9]/.test(string);\n      // Interests rates change constantly, can't pin a precise value\n      expect(hasNonZeroNumber).to.equal(true);\n    });\n\n    it('interestsCost', () => {\n      const interestsCost = component()\n        .find('.interestsCost')\n        .last();\n      const string = interestsCost.text();\n      const hasNonZeroNumber = /[1-9]/.test(string);\n\n      expect(hasNonZeroNumber).to.equal(true);\n    });\n\n    it('amortizationCost', () => {\n      expectResult(component, '.amortizationCost', 833);\n    });\n\n    it('propertyCost', () => {\n      expectResult(component, '.propertyCost', 100);\n    });\n\n    it('borrowRatio', () => {\n      expectResult(component, '.borrowRatio', 0.8);\n    });\n\n    it('incomeRatio', () => {\n      expectResult(component, '.incomeRatio', 0.3);\n    });\n\n    it('remainingCash', () => {\n      expectResult(component, '.remainingCash', 0);\n    });\n\n    it('remainingInsurance2', () => {\n      expectResult(component, '.remainingInsurance2', 50);\n    });\n\n    it('remainingInsurance3A', () => {\n      expectResult(component, '.remainingInsurance3A', 60);\n    });\n  });\n\n  context('structure with an offer', () => {\n    beforeEach(() => {\n      const structure = {\n        id: 'a',\n        loanTranches: [\n          { type: 'interest2', value: 0.8 },\n          { type: 'interestLibor', value: 0.2 },\n        ],\n        propertyId: 'house',\n        offerId: 'offer',\n        propertyWork: 200000,\n        wantedLoan: 1080000,\n        notaryFees: 50000,\n        ownFunds: [\n          { type: 'bankFortune', value: 150000, borrowerId: 'John' },\n          {\n            type: 'insurance2',\n            usageType: OWN_FUNDS_USAGE_TYPES.PLEDGE,\n            value: 120000,\n            borrowerId: 'John',\n          },\n          { type: 'thirdPartyFortune', value: 20000, borrowerId: 'Mary' },\n        ],\n      };\n      loan = {\n        selectedStructure: 'a',\n        structure,\n        structures: [structure],\n        borrowers: [\n          {\n            _id: 'John',\n            bankFortune: 250000,\n            salary: 200000,\n            insurance2: [{ value: 1000 }],\n            insurance3A: [{ value: 500 }],\n          },\n          {\n            _id: 'Mary',\n            salary: 200000,\n            thirdPartyFortune: 200000,\n            insurance2: [{ value: 2000 }],\n            insurance3A: [{ value: 0 }],\n          },\n        ],\n        properties: [\n          {\n            _id: 'house',\n            value: 1000000,\n            yearlyExpenses: 1200,\n          },\n        ],\n        offers: [\n          {\n            _id: 'offer',\n            interest2: 0.02,\n            interestLibor: 0.01,\n            amortizationGoal: 0.5,\n            amortizationYears: 5,\n          },\n        ],\n        currentInterestRates: { [INTEREST_RATES.YEARS_10]: 0.01 },\n      };\n    });\n\n    it('monthly', () => {\n      const monthly = component().find('.financing-structures-result-chart .total');\n      const string = monthly.text();\n      const value = string.match(/\\d/g).join('');\n      expect(value).to.equal('9720');\n    });\n\n    it('interestsCost', () => {\n      const interestsCost = component()\n        .find('.interestsCost')\n        .last();\n      const string = interestsCost.text();\n      const value = string.match(/\\d/g).join('');\n\n      // Average of 1.8% interests\n      expect(value).to.equal('1620');\n    });\n\n    it('amortizationCost', () => {\n      // 1080k in 5 years to 600k\n      expectResult(component, '.amortizationCost', '8 000');\n    });\n\n    it('propertyCost', () => {\n      expectResult(component, '.propertyCost', 100);\n    });\n\n    it('borrowRatio', () => {\n      expectResult(component, '.borrowRatio', 0.9);\n    });\n\n    it('incomeRatio', () => {\n      // 400k income\n      // 12k maintenance, 54k interests, 20k amortization\n      expectResult(component, '.incomeRatio', 0.215);\n    });\n\n    it('remainingCash', () => {\n      expectResult(component, '.remainingCash', '100 000');\n    });\n\n    it('remainingInsurance2', () => {\n      expectResult(component, '.remainingInsurance2', '3 000');\n    });\n\n    it('remainingInsurance3A', () => {\n      expectResult(component, '.remainingInsurance3A', 500);\n    });\n  });\n\n  it.skip('renders an error if an interest rate is not defined', () => {\n    // FIXME: Enzyme does not support componentDidCatch yet\n    // https://github.com/airbnb/enzyme/issues/1553\n    loan = {\n      structures: [\n        {\n          id: 'a',\n          loanTranches: [{ type: 'unknown_rate' }],\n        },\n      ],\n      borrowers: [{}],\n      properties: [{}],\n    };\n    expect(component()\n      .find('.error')\n      .exists()).to.equal(true);\n  });\n});\n"]},"sourceType":"script","hash":"d90d1468a0c094a7548b4ce66b85b18b228660fd"}
