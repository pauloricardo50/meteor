{"metadata":{},"options":{"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/Florian/dev/epotek/microservices/backend/imports/core/api/offers/offers.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","classProperties","classPrivateProperties",["flow",{}],"jsx",["flow",{}],["flow",{}],"objectRestSpread","objectRestSpread","dynamicImport","asyncGenerators","classProperties","classPrivateProperties"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.linux.x86_64"},"sourceFileName":"imports/core/api/offers/offers.js","filename":"/Users/Florian/dev/epotek/microservices/backend/imports/core/api/offers/offers.js","inputSourceMap":{"version":3,"sources":["imports/core/api/offers/offers.js"],"names":["Mongo","SimpleSchema","INTEREST_RATES","OFFERS_COLLECTION","createdAt","updatedAt","percentageField","moneyField","cacheField","Offers","Collection","deny","insert","update","remove","allow","OfferSchema","organisationLink","type","Object","optional","String","contactLink","maxAmount","amortizationGoal","amortizationYears","Integer","min","max","fees","epotekFees","values","reduce","accumulator","interestKey","conditions","Array","defaultValue","lenderLink","feedback","Date","withCounterparts","Boolean","enableOffer","lenderCache","AdminOfferSchema","omit","attachSchema"],"mappings":"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","sourcesContent":["import { Mongo } from 'meteor/mongo';\nimport SimpleSchema from 'simpl-schema';\n\nimport { INTEREST_RATES, OFFERS_COLLECTION } from '../constants';\nimport {\n  createdAt,\n  updatedAt,\n  percentageField,\n  moneyField,\n  cacheField,\n} from '../helpers/sharedSchemas';\n\nconst Offers = new Mongo.Collection(OFFERS_COLLECTION);\n\n// Prevent all client side modifications of mongoDB\nOffers.deny({\n  insert: () => true,\n  update: () => true,\n  remove: () => true,\n});\nOffers.allow({\n  insert: () => false,\n  update: () => false,\n  remove: () => false,\n});\n\nexport const OfferSchema = new SimpleSchema({\n  createdAt,\n  updatedAt,\n  organisationLink: { type: Object, optional: true },\n  'organisationLink._id': { type: String, optional: true },\n  contactLink: { type: Object, optional: true },\n  'contactLink._id': String,\n  'contactLink.feedback': { type: String, optional: true },\n  maxAmount: moneyField,\n  amortizationGoal: percentageField,\n  amortizationYears: {\n    type: SimpleSchema.Integer,\n    min: 0,\n    max: 100,\n    optional: true,\n  },\n  fees: moneyField,\n  epotekFees: moneyField,\n  // For each existing rate, insert an allowed value in the schema\n  ...Object.values(INTEREST_RATES).reduce(\n    (accumulator, interestKey) => ({\n      ...accumulator,\n      [interestKey]: percentageField,\n    }),\n    {},\n  ),\n  conditions: {\n    type: Array,\n    optional: true,\n    defaultValue: [],\n  },\n  'conditions.$': { type: String, optional: true },\n  lenderLink: { type: Object, optional: true },\n  'lenderLink._id': { type: String, optional: true },\n  feedback: { type: Object, optional: true },\n  'feedback.message': { type: String, optional: true },\n  'feedback.date': { type: Date, optional: true },\n  withCounterparts: { type: Boolean, optional: true },\n  enableOffer: { type: Boolean, defaultValue: true, optional: true },\n  lenderCache: cacheField,\n});\n\nexport const AdminOfferSchema = OfferSchema.omit(\n  'lenderLink',\n  'organisationLink',\n  'contactLink',\n  'createdAt',\n  'updatedAt',\n  'feedback',\n  'lenderCache',\n);\n\n// Attach schema\nOffers.attachSchema(OfferSchema);\nexport default Offers;\n"]},"passPerPreset":false,"envName":"production","cwd":"/Users/Florian/dev/epotek/microservices/backend","root":"/Users/Florian/dev/epotek/microservices/backend","plugins":[{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"syntax-flow","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"transform-runtime","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"transform-modules-commonjs","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}}],"presets":[],"generatorOpts":{"filename":"/Users/Florian/dev/epotek/microservices/backend/imports/core/api/offers/offers.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/core/api/offers/offers.js"}},"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _objectSpread2 = _interopRequireDefault(require(\"@babel/runtime/helpers/objectSpread\"));\n\nmodule.export({\n  OfferSchema: () => OfferSchema,\n  AdminOfferSchema: () => AdminOfferSchema\n});\nlet Mongo;\nmodule.link(\"meteor/mongo\", {\n  Mongo(v) {\n    Mongo = v;\n  }\n\n}, 0);\nlet SimpleSchema;\nmodule.link(\"simpl-schema\", {\n  default(v) {\n    SimpleSchema = v;\n  }\n\n}, 1);\nlet INTEREST_RATES, OFFERS_COLLECTION;\nmodule.link(\"../constants\", {\n  INTEREST_RATES(v) {\n    INTEREST_RATES = v;\n  },\n\n  OFFERS_COLLECTION(v) {\n    OFFERS_COLLECTION = v;\n  }\n\n}, 2);\nlet createdAt, updatedAt, percentageField, moneyField, cacheField;\nmodule.link(\"../helpers/sharedSchemas\", {\n  createdAt(v) {\n    createdAt = v;\n  },\n\n  updatedAt(v) {\n    updatedAt = v;\n  },\n\n  percentageField(v) {\n    percentageField = v;\n  },\n\n  moneyField(v) {\n    moneyField = v;\n  },\n\n  cacheField(v) {\n    cacheField = v;\n  }\n\n}, 3);\nconst Offers = new Mongo.Collection(OFFERS_COLLECTION); // Prevent all client side modifications of mongoDB\n\nOffers.deny({\n  insert: () => true,\n  update: () => true,\n  remove: () => true\n});\nOffers.allow({\n  insert: () => false,\n  update: () => false,\n  remove: () => false\n});\nconst OfferSchema = new SimpleSchema((0, _objectSpread2.default)({\n  createdAt,\n  updatedAt,\n  organisationLink: {\n    type: Object,\n    optional: true\n  },\n  'organisationLink._id': {\n    type: String,\n    optional: true\n  },\n  contactLink: {\n    type: Object,\n    optional: true\n  },\n  'contactLink._id': String,\n  'contactLink.feedback': {\n    type: String,\n    optional: true\n  },\n  maxAmount: moneyField,\n  amortizationGoal: percentageField,\n  amortizationYears: {\n    type: SimpleSchema.Integer,\n    min: 0,\n    max: 100,\n    optional: true\n  },\n  fees: moneyField,\n  epotekFees: moneyField\n}, Object.values(INTEREST_RATES).reduce((accumulator, interestKey) => (0, _objectSpread2.default)({}, accumulator, {\n  [interestKey]: percentageField\n}), {}), {\n  conditions: {\n    type: Array,\n    optional: true,\n    defaultValue: []\n  },\n  'conditions.$': {\n    type: String,\n    optional: true\n  },\n  lenderLink: {\n    type: Object,\n    optional: true\n  },\n  'lenderLink._id': {\n    type: String,\n    optional: true\n  },\n  feedback: {\n    type: Object,\n    optional: true\n  },\n  'feedback.message': {\n    type: String,\n    optional: true\n  },\n  'feedback.date': {\n    type: Date,\n    optional: true\n  },\n  withCounterparts: {\n    type: Boolean,\n    optional: true\n  },\n  enableOffer: {\n    type: Boolean,\n    defaultValue: true,\n    optional: true\n  },\n  lenderCache: cacheField\n}));\nconst AdminOfferSchema = OfferSchema.omit('lenderLink', 'organisationLink', 'contactLink', 'createdAt', 'updatedAt', 'feedback', 'lenderCache');\n// Attach schema\nOffers.attachSchema(OfferSchema);\nmodule.exportDefault(Offers);","map":{"version":3,"sources":["imports/core/api/offers/offers.js"],"names":["Offers","Mongo","insert","update","remove","OfferSchema","organisationLink","type","optional","contactLink","maxAmount","amortizationGoal","amortizationYears","SimpleSchema","min","max","fees","epotekFees","percentageField","conditions","defaultValue","lenderLink","feedback","withCounterparts","enableOffer","lenderCache","cacheField","AdminOfferSchema"],"mappings":";;;;AAAA,MAAA,CAAA,MAAA,CAAA;AAAA,EAAA,WAAsB,EAAA,MAAtB,WAAA;AAAA,EAAA,gBAAA,EAAA,MAAA;AAAA,CAAA;AAAA,IAAA,KAAA;AAAA,MAAA,CAAA,IAAA,CAAA,cAAA,EAAA;AAAA,EAAA,KAAA,CAAA,CAAA,EAAA;AAAA,IAAA,KAAA,GAAA,CAAA;AAAA;;AAAA,CAAA,EAAA,CAAA;AAAA,IAAA,YAAA;AAAA,MAAA,CAAA,IAAA,CAAA,cAAA,EAAA;AAAA,EAAA,OAAA,CAAA,CAAA,EAAA;AAAA,IAAA,YAAA,GAAA,CAAA;AAAA;;AAAA,CAAA,EAAA,CAAA;AAAA,IAAA,cAAA,EAAA,iBAAA;AAAA,MAAA,CAAA,IAAA,CAAA,cAAA,EAAA;AAAA,EAAA,cAAA,CAAA,CAAA,EAAA;AAAA,IAAA,cAAA,GAAA,CAAA;AAAA,GAAA;;AAAA,EAAA,iBAAA,CAAA,CAAA,EAAA;AAAA,IAAA,iBAAA,GAAA,CAAA;AAAA;;AAAA,CAAA,EAAA,CAAA;AAAA,IAAA,SAAA,EAAA,SAAA,EAAA,eAAA,EAAA,UAAA,EAAA,UAAA;AAAA,MAAA,CAAA,IAAA,CAAA,0BAAA,EAAA;AAAA,EAAA,SAAA,CAAA,CAAA,EAAA;AAAA,IAAA,SAAA,GAAA,CAAA;AAAA,GAAA;;AAAA,EAAA,SAAA,CAAA,CAAA,EAAA;AAAA,IAAA,SAAA,GAAA,CAAA;AAAA,GAAA;;AAAA,EAAA,eAAA,CAAA,CAAA,EAAA;AAAA,IAAA,eAAA,GAAA,CAAA;AAAA,GAAA;;AAAA,EAAA,UAAA,CAAA,CAAA,EAAA;AAAA,IAAA,UAAA,GAAA,CAAA;AAAA,GAAA;;AAAA,EAAA,UAAA,CAAA,CAAA,EAAA;AAAA,IAAA,UAAA,GAAA,CAAA;AAAA;;AAAA,CAAA,EAAA,CAAA;AAYA,MAAMA,MAAM,GAAG,IAAIC,KAAK,CAAT,UAAA,CAAf,iBAAe,CAAf,C,CAEA;;AACAD,MAAM,CAANA,IAAAA,CAAY;AACVE,EAAAA,MAAM,EAAE,MADE,IAAA;AAEVC,EAAAA,MAAM,EAAE,MAFE,IAAA;AAGVC,EAAAA,MAAM,EAAE,MAAM;AAHJ,CAAZJ;AAKAA,MAAM,CAANA,KAAAA,CAAa;AACXE,EAAAA,MAAM,EAAE,MADG,KAAA;AAEXC,EAAAA,MAAM,EAAE,MAFG,KAAA;AAGXC,EAAAA,MAAM,EAAE,MAAM;AAHH,CAAbJ;AAMO,MAAMK,WAAW,GAAG,IAAA,YAAA;AAAiB,EAAA,SAAjB;AAAiB,EAAA,SAAjB;AAGzBC,EAAAA,gBAAgB,EAAE;AAAEC,IAAAA,IAAI,EAAN,MAAA;AAAgBC,IAAAA,QAAQ,EAAE;AAA1B,GAHO;AAIzB,0BAAwB;AAAED,IAAAA,IAAI,EAAN,MAAA;AAAgBC,IAAAA,QAAQ,EAAE;AAA1B,GAJC;AAKzBC,EAAAA,WAAW,EAAE;AAAEF,IAAAA,IAAI,EAAN,MAAA;AAAgBC,IAAAA,QAAQ,EAAE;AAA1B,GALY;AAMzB,qBAN0C,MAAjB;AAOzB,0BAAwB;AAAED,IAAAA,IAAI,EAAN,MAAA;AAAgBC,IAAAA,QAAQ,EAAE;AAA1B,GAPC;AAQzBE,EAAAA,SAAS,EARiC,UAAjB;AASzBC,EAAAA,gBAAgB,EAT0B,eAAjB;AAUzBC,EAAAA,iBAAiB,EAAE;AACjBL,IAAAA,IAAI,EAAEM,YAAY,CADD,OAAA;AAEjBC,IAAAA,GAAG,EAFc,CAAA;AAGjBC,IAAAA,GAAG,EAHc,GAAA;AAIjBP,IAAAA,QAAQ,EAAE;AAJO,GAVM;AAgBzBQ,EAAAA,IAAI,EAhBsC,UAAjB;AAiBzBC,EAAAA,UAAU,EAjBgC;AAAjB,GAmBtB,MAAM,CAAN,MAAA,CAAA,cAAA,EAAA,MAAA,CACD,CAAA,WAAA,EAAA,WAAA,qCAA+B,WAA/B;AAEE,GAAA,WAAA,GAAeC;AAFjB,EADC,EAnBuC,EAmBvC,CAnBsB;AA0BzBC,EAAAA,UAAU,EAAE;AACVZ,IAAAA,IAAI,EADM,KAAA;AAEVC,IAAAA,QAAQ,EAFE,IAAA;AAGVY,IAAAA,YAAY,EAAE;AAHJ,GA1Ba;AA+BzB,kBAAgB;AAAEb,IAAAA,IAAI,EAAN,MAAA;AAAgBC,IAAAA,QAAQ,EAAE;AAA1B,GA/BS;AAgCzBa,EAAAA,UAAU,EAAE;AAAEd,IAAAA,IAAI,EAAN,MAAA;AAAgBC,IAAAA,QAAQ,EAAE;AAA1B,GAhCa;AAiCzB,oBAAkB;AAAED,IAAAA,IAAI,EAAN,MAAA;AAAgBC,IAAAA,QAAQ,EAAE;AAA1B,GAjCO;AAkCzBc,EAAAA,QAAQ,EAAE;AAAEf,IAAAA,IAAI,EAAN,MAAA;AAAgBC,IAAAA,QAAQ,EAAE;AAA1B,GAlCe;AAmCzB,sBAAoB;AAAED,IAAAA,IAAI,EAAN,MAAA;AAAgBC,IAAAA,QAAQ,EAAE;AAA1B,GAnCK;AAoCzB,mBAAiB;AAAED,IAAAA,IAAI,EAAN,IAAA;AAAcC,IAAAA,QAAQ,EAAE;AAAxB,GApCQ;AAqCzBe,EAAAA,gBAAgB,EAAE;AAAEhB,IAAAA,IAAI,EAAN,OAAA;AAAiBC,IAAAA,QAAQ,EAAE;AAA3B,GArCO;AAsCzBgB,EAAAA,WAAW,EAAE;AAAEjB,IAAAA,IAAI,EAAN,OAAA;AAAiBa,IAAAA,YAAY,EAA7B,IAAA;AAAqCZ,IAAAA,QAAQ,EAAE;AAA/C,GAtCY;AAuCzBiB,EAAAA,WAAW,EAAEC;AAvCY,GAApB;AA0CA,MAAMC,gBAAgB,GAAGtB,WAAW,CAAXA,IAAAA,CAAAA,YAAAA,EAAAA,kBAAAA,EAAAA,aAAAA,EAAAA,WAAAA,EAAAA,WAAAA,EAAAA,UAAAA,EAAzB,aAAyBA,CAAzB;AAUP;AACAL,MAAM,CAANA,YAAAA,CAAAA,WAAAA;AA/EA,MAAA,CAAA,aAAA,CAgFA,MAhFA","sourcesContent":["import { Mongo } from 'meteor/mongo';\nimport SimpleSchema from 'simpl-schema';\n\nimport { INTEREST_RATES, OFFERS_COLLECTION } from '../constants';\nimport {\n  createdAt,\n  updatedAt,\n  percentageField,\n  moneyField,\n  cacheField,\n} from '../helpers/sharedSchemas';\n\nconst Offers = new Mongo.Collection(OFFERS_COLLECTION);\n\n// Prevent all client side modifications of mongoDB\nOffers.deny({\n  insert: () => true,\n  update: () => true,\n  remove: () => true,\n});\nOffers.allow({\n  insert: () => false,\n  update: () => false,\n  remove: () => false,\n});\n\nexport const OfferSchema = new SimpleSchema({\n  createdAt,\n  updatedAt,\n  organisationLink: { type: Object, optional: true },\n  'organisationLink._id': { type: String, optional: true },\n  contactLink: { type: Object, optional: true },\n  'contactLink._id': String,\n  'contactLink.feedback': { type: String, optional: true },\n  maxAmount: moneyField,\n  amortizationGoal: percentageField,\n  amortizationYears: {\n    type: SimpleSchema.Integer,\n    min: 0,\n    max: 100,\n    optional: true,\n  },\n  fees: moneyField,\n  epotekFees: moneyField,\n  // For each existing rate, insert an allowed value in the schema\n  ...Object.values(INTEREST_RATES).reduce(\n    (accumulator, interestKey) => ({\n      ...accumulator,\n      [interestKey]: percentageField,\n    }),\n    {},\n  ),\n  conditions: {\n    type: Array,\n    optional: true,\n    defaultValue: [],\n  },\n  'conditions.$': { type: String, optional: true },\n  lenderLink: { type: Object, optional: true },\n  'lenderLink._id': { type: String, optional: true },\n  feedback: { type: Object, optional: true },\n  'feedback.message': { type: String, optional: true },\n  'feedback.date': { type: Date, optional: true },\n  withCounterparts: { type: Boolean, optional: true },\n  enableOffer: { type: Boolean, defaultValue: true, optional: true },\n  lenderCache: cacheField,\n});\n\nexport const AdminOfferSchema = OfferSchema.omit(\n  'lenderLink',\n  'organisationLink',\n  'contactLink',\n  'createdAt',\n  'updatedAt',\n  'feedback',\n  'lenderCache',\n);\n\n// Attach schema\nOffers.attachSchema(OfferSchema);\nexport default Offers;\n"]},"sourceType":"script","hash":"dfde845cedefcaf9327fea0ce25597f3f760d79f"}
