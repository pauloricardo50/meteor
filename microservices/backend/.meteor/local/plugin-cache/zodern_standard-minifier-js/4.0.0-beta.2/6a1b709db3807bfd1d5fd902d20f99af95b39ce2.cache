{"code":"!function(){var e=Package.meteor.Meteor,t=Package.meteor.global,n=Package.meteor.meteorEnv,o=Package.check.check,r=Package.check.Match,a=Package.modules.meteorInstall,c=Package[\"babel-runtime\"].meteorBabelHelpers,i=Package.promise.Promise,u=Package[\"ecmascript-runtime-client\"].Symbol,f=Package[\"ecmascript-runtime-client\"].Map,l=Package[\"ecmascript-runtime-client\"].Set,s,d=a({node_modules:{meteor:{\"cultofcoders:mutations\":{\"main.js\":function(e,t,n){var o,r;n.export({Mutation:function(){return r},wrap:function(){return o}}),n.link(\"./lib/wrap\",{default:function(e){o=e}},0),n.link(\"./lib/mutation.class\",{default:function(e){r=e}},1),n.link(\"./lib/debug\")},lib:{\"aop.js\":function(e,t,n){var r=function(){function e(){this.befores=[],this.afters=[]}var t=e.prototype;return t.addBefore=function(){function e(e){o(e,Function),this.befores.push(e)}return e}(),t.addAfter=function(){function e(e){o(e,Function),this.afters.push(e)}return e}(),t.executeBefores=function(){function e(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.befores.forEach(function(e){return e.call.apply(e,[null].concat(t))})}return e}(),t.executeAfters=function(){function e(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.afters.forEach(function(e){return e.call.apply(e,[null].concat(t))})}return e}(),e}();n.exportDefault(r)},\"debug.js\":function(t,n,o){var r;o.link(\"./mutation.class\",{default:function(e){r=e}},0),Object.assign(r,{isDebugEnabled:e.isDevelopment||process.env.MUTATION_DEBUG_ENABLED});var a=function(e){return!!r.isDebugEnabled&&(!r.isDebugEnabled.omit||!r.isDebugEnabled.omit.includes(e.name))};r.addBeforeCall(function(e){var t=e.config,n=e.params,o=e.context;a(t)&&console.log(\"[mutations][\"+t.name+\"] Calling with params:\",n)}),r.addAfterCall(function(e){var t=e.config,n=e.params,o=e.context,r=e.result,c=e.error;if(a(t)){var i=new Date;c?console.error(\"[mutations][\"+t.name+\"] Received error:\",c):console.log(\"[mutations][\"+t.name+\"] Received result:\",r)}}),r.addBeforeExecution(function(e){var t=e.config,n=e.params,o=e.context;if(a(t)){var r=new Date;console.log(\"[mutations][\"+t.name+\"] Received call with params: \"+JSON.stringify(n))}})},\"mutation.class.js\":function(e,t,n){var o,r,a,c;n.export({default:function(){return u}}),n.link(\"meteor/meteor\",{Meteor:function(e){o=e}},0),n.link(\"./aop\",{default:function(e){r=e}},1),n.link(\"meteor/check\",{check:function(e){a=e},Match:function(e){c=e}},2);var u=function(){function e(t){e.checkDefaultConfig(t),this.config=t,this.callAOP=new r,this.executionAOP=new r}e.addBeforeCall=function(){function e(e){this.callAOP.addBefore(e)}return e}(),e.addAfterCall=function(){function e(e){this.callAOP.addAfter(e)}return e}(),e.addBeforeExecution=function(){function e(e){this.executionAOP.addBefore(e)}return e}(),e.addAfterExecution=function(){function e(e){this.executionAOP.addAfter(e)}return e}(),e.checkDefaultConfig=function(){function e(e){if(a(e,Object),\"string\"!=typeof e.name)throw new o.Error(\"invalid-config\",'You must provide a \"name\" property to your mutation config.')}return e}();var t=e.prototype;return t.addBeforeCall=function(){function e(e){this.callAOP.addBefore(e)}return e}(),t.addAfterCall=function(){function e(e){this.callAOP.addAfter(e)}return e}(),t.addBeforeExecution=function(){function e(e){this.executionAOP.addBefore(e)}return e}(),t.addAfterExecution=function(){function e(e){this.executionAOP.addAfter(e)}return e}(),t.run=function(){function t(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=this.config,c={config:a,params:t};e.callAOP.executeBefores(c),this.callAOP.executeBefores(c);var u=a.name,f=a.params;return new i(function(c,i){o.apply(u,[t],r,function(o,r){var u={config:a,params:t,result:r,error:o};e.callAOP.executeAfters(u),n.callAOP.executeAfters(u),o?i(o):c(r)})})}return t}(),t.setHandler=function(){function t(t){var n,r=this.config,c=r.name,i=r.params,u=this;o.methods(((n={})[c]=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r.params&&a(n,r.params);var o={context:this,config:r,params:n},c,i;e.executionAOP.executeBefores(o),u.executionAOP.executeBefores(o);try{i=t.call(null,this,n)}catch(e){c=e}if(o={context:this,config:r,params:n,result:i,error:c},e.executionAOP.executeAfters(o),u.executionAOP.executeAfters(o),c)throw c;return i},n))}return t}(),e}();u.callAOP=new r,u.executionAOP=new r},\"wrap.js\":function(e,t,n){var o;function r(e){return new o(e)}n.export({default:function(){return r}}),n.link(\"./mutation.class\",{default:function(e){o=e}},0)}}}}}},{extensions:[\".js\",\".json\"]})(\"/node_modules/meteor/cultofcoders:mutations/main.js\");Package._define(\"cultofcoders:mutations\",d)}();","sourcemap":"{\"version\":3,\"sources\":[\"packages/cultofcoders:mutations/main.js\",\"packages/cultofcoders:mutations/lib/aop.js\",\"packages/cultofcoders:mutations/lib/debug.js\",\"packages/cultofcoders:mutations/lib/mutation.class.js\",\"packages/cultofcoders:mutations/lib/wrap.js\"],\"names\":[\"wrap\",\"Mutation\",\"module\",\"export\",\"link\",\"default\",\"v\",\"AOP\",\"befores\",\"afters\",\"addBefore\",\"fn\",\"check\",\"Function\",\"this\",\"push\",\"addAfter\",\"executeBefores\",\"_len\",\"arguments\",\"length\",\"args\",\"Array\",\"_key\",\"forEach\",\"call\",\"apply\",\"concat\",\"executeAfters\",\"_len2\",\"_key2\",\"exportDefault\",\"Object\",\"assign\",\"isDebugEnabled\",\"Meteor\",\"isDevelopment\",\"process\",\"env\",\"MUTATION_DEBUG_ENABLED\",\"shouldDebug\",\"config\",\"omit\",\"includes\",\"name\",\"addBeforeCall\",\"_ref\",\"params\",\"context\",\"console\",\"log\",\"addAfterCall\",\"_ref2\",\"result\",\"error\",\"time\",\"Date\",\"addBeforeExecution\",\"_ref3\",\"JSON\",\"stringify\",\"Match\",\"checkDefaultConfig\",\"callAOP\",\"executionAOP\",\"addAfterExecution\",\"Error\",\"run\",\"callParams\",\"_this\",\"options\",\"undefined\",\"aopData\",\"Promise\",\"resolve\",\"reject\",\"setHandler\",\"_Meteor$methods\",\"self\",\"methods\",\"e\"],\"mappings\":\"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\",\"sourcesContent\":[\"import wrap from './lib/wrap';\\nimport Mutation from './lib/mutation.class';\\nimport './lib/debug';\\n\\nexport { Mutation, wrap };\\n\",\"class AOP {\\n    befores = [];\\n    afters = [];\\n\\n    addBefore(fn) {\\n        check(fn, Function);\\n\\n        this.befores.push(fn);\\n    }\\n\\n    addAfter(fn) {\\n        check(fn, Function);\\n\\n        this.afters.push(fn);\\n    }\\n\\n    executeBefores(...args) {\\n        this.befores.forEach(fn => fn.call(null, ...args));\\n    }\\n\\n    executeAfters(...args) {\\n        this.afters.forEach(fn => fn.call(null, ...args));\\n    }\\n}\\n\\nexport default AOP;\\n\",\"import Mutation from './mutation.class';\\n\\nObject.assign(Mutation, {\\n  isDebugEnabled: Meteor.isDevelopment || process.env.MUTATION_DEBUG_ENABLED,\\n});\\n\\nconst shouldDebug = (config) => {\\n  if (!Mutation.isDebugEnabled) {\\n    return false;\\n  }\\n\\n  if (Mutation.isDebugEnabled.omit) {\\n    return !Mutation.isDebugEnabled.omit.includes(config.name);\\n  }\\n\\n  return true;\\n};\\n\\nMutation.addBeforeCall(({ config, params, context }) => {\\n  if (shouldDebug(config)) {\\n    console.log(`[mutations][${config.name}] Calling with params:`, params);\\n  }\\n});\\n\\nMutation.addAfterCall(({ config, params, context, result, error }) => {\\n  if (shouldDebug(config)) {\\n    const time = new Date();\\n\\n    if (!error) {\\n      console.log(`[mutations][${config.name}] Received result:`, result);\\n    } else {\\n      console.error(`[mutations][${config.name}] Received error:`, error);\\n    }\\n  }\\n});\\n\\nMutation.addBeforeExecution(({ config, params, context }) => {\\n  if (shouldDebug(config)) {\\n    const time = new Date();\\n    console.log(`[mutations][${\\n      config.name\\n    }] Received call with params: ${JSON.stringify(params)}`);\\n  }\\n});\\n\",\"import { Meteor } from 'meteor/meteor';\\nimport AOP from './aop';\\nimport { check, Match } from 'meteor/check';\\n\\nexport default class Mutation {\\n    static callAOP = new AOP();\\n    static executionAOP = new AOP();\\n\\n    constructor(config) {\\n        Mutation.checkDefaultConfig(config);\\n\\n        this.config = config;\\n        this.callAOP = new AOP();\\n        this.executionAOP = new AOP();\\n    }\\n\\n    /**\\n     * @param {Function} fn\\n     */\\n    static addBeforeCall(fn) {\\n        this.callAOP.addBefore(fn);\\n    }\\n\\n    /**\\n     * @param {Function} fn\\n     */\\n    static addAfterCall(fn) {\\n        this.callAOP.addAfter(fn);\\n    }\\n\\n    /**\\n     * @param {Function} fn\\n     */\\n    static addBeforeExecution(fn) {\\n        this.executionAOP.addBefore(fn);\\n    }\\n\\n    /**\\n     * @param {Function} fn\\n     */\\n    static addAfterExecution(fn) {\\n        this.executionAOP.addAfter(fn);\\n    }\\n\\n    /**\\n     * @param {Object} config\\n     */\\n    static checkDefaultConfig(config) {\\n        check(config, Object);\\n        if (typeof config.name !== 'string') {\\n            throw new Meteor.Error(\\n                'invalid-config',\\n                'You must provide a \\\"name\\\" property to your mutation config.'\\n            );\\n        }\\n    }\\n\\n    /**\\n     * @param {Function} fn\\n     */\\n    addBeforeCall(fn) {\\n        this.callAOP.addBefore(fn);\\n    }\\n\\n    /**\\n     * @param {Function} fn\\n     */\\n    addAfterCall(fn) {\\n        this.callAOP.addAfter(fn);\\n    }\\n\\n    /**\\n     * @param {Function} fn\\n     */\\n    addBeforeExecution(fn) {\\n        this.executionAOP.addBefore(fn);\\n    }\\n\\n    /**\\n     * @param {Function} fn\\n     */\\n    addAfterExecution(fn) {\\n        this.executionAOP.addAfter(fn);\\n    }\\n\\n    /**\\n     * Runs the mutation inside a promise\\n     * @param {Object} callParams\\n     * @param {Object} options Meteor options https://docs.meteor.com/api/methods.html#Meteor-apply\\n     * @returns {Promise}\\n     */\\n    run(callParams, options = {}) {\\n        const config = this.config;\\n\\n        const aopData = { config, params: callParams };\\n        Mutation.callAOP.executeBefores(aopData);\\n        this.callAOP.executeBefores(aopData);\\n\\n        const { name, params } = config;\\n\\n        return new Promise((resolve, reject) => {\\n            Meteor.apply(name, [callParams], options, (error, result) => {\\n                const aopData = {\\n                    config,\\n                    params: callParams,\\n                    result,\\n                    error,\\n                };\\n\\n                Mutation.callAOP.executeAfters(aopData);\\n                this.callAOP.executeAfters(aopData);\\n\\n                if (error) {\\n                    reject(error);\\n                } else {\\n                    resolve(result);\\n                }\\n            });\\n        });\\n    }\\n\\n    /**\\n     * Creates the Meteor Method and the handler for it\\n     * @param {Function} fn\\n     */\\n    setHandler(fn) {\\n        const config = this.config;\\n        const { name, params } = config;\\n        const self = this;\\n\\n        Meteor.methods({\\n            [name](params = {}) {\\n                if (config.params) {\\n                    check(params, config.params);\\n                }\\n\\n                let aopData = {\\n                    context: this,\\n                    config,\\n                    params,\\n                };\\n\\n                Mutation.executionAOP.executeBefores(aopData);\\n                self.executionAOP.executeBefores(aopData);\\n\\n                let error, result;\\n                try {\\n                    result = fn.call(null, this, params);\\n                } catch (e) {\\n                    error = e;\\n                }\\n\\n                aopData = {\\n                    context: this,\\n                    config,\\n                    params,\\n                    result,\\n                    error,\\n                };\\n\\n                Mutation.executionAOP.executeAfters(aopData);\\n                self.executionAOP.executeAfters(aopData);\\n\\n                if (error) {\\n                    throw error;\\n                }\\n\\n                return result;\\n            },\\n        });\\n    }\\n}\\n\",\"import Mutation from './mutation.class';\\n\\nexport default function wrap(config) {\\n    return new Mutation(config);\\n}\\n\"]}","minifier":"terser"}