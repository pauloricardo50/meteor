{"code":"!function(){var e=Package.meteor.Meteor,t=Package.meteor.global,n=Package.meteor.meteorEnv,r=Package.underscore._,i=Package.check.check,o=Package.check.Match,a=Package.tracker.Tracker,s=Package.tracker.Deps,u=Package[\"reactive-var\"].ReactiveVar,c,l;(function(){(function(){c={},l=o.OneOf(String,[String],RegExp,null),c._restrictions={},c.fileRestrictions=function(t,n){if(i(n,{authorize:o.Optional(Function),maxSize:o.Optional(o.OneOf(Number,null)),allowedFileTypes:o.Optional(l)}),e.isServer){var a=c.getDirective(t);a&&r.extend(a._directive,n)}return c._restrictions[t]=r.extend(c._restrictions[t]||{},n)},c.getRestrictions=function(e){return this._restrictions[e]||{}}}).call(this),function(){function t(e){for(var t=[\"Bytes\",\"KB\",\"MB\",\"GB\",\"TB\"],n=t.shift();e>=1024&&t.length;)e/=1024,n=t.shift();return Math.round(100*e)/100+\" \"+n}c.Validators={checkAll:function(e,t,n,r){return this.checkFileSize(t.size,r.maxSize)&&this.checkFileType(t.type,r.allowedFileTypes)&&(\"function\"!=typeof r.authorize||r.authorize.call(e,t,n))},checkFileSize:function(n,r){if((r=Math.min(r,1/0))&&n>r)throw new e.Error(\"Upload denied\",\"File exceeds allowed size of \"+t(r));return!0},checkFileType:function(t,n){if(n instanceof RegExp){if(!n.test(t))throw new e.Error(\"Upload denied\",t+\" is not an allowed file type\");return!0}if(r.isArray(n)){if(n.indexOf(t)<0)throw new e.Error(\"Upload denied\",t+\" is not one of the followed allowed file types: \"+n.join(\", \"));return!0}if(n&&n!==t)throw new e.Error(\"Upload denied\",\"Only files of type \"+n+\" can be uploaded\");return!0}}}.call(this),function(){function t(e,t){var n=new window.Image;n.onload=t,n.src=e}function n(e,t){var n=new window.FileReader;n.onloadend=function(){t(n.result)},n.readAsDataURL(e)}c.Upload=function(i,o){if(!window.File||!window.FormData)throw new Error(\"Browser does not support HTML5 uploads\");var s=this,l=new u,d=new u,f=new u(\"idle\"),w,p;function h(){var e=new window.FormData;return r.each(s.instructions.postData,function(t){e.append(t.name,t.value)}),e.append(\"file\",s.file),e}r.extend(s,{status:function(){return f.get()},progress:function(){return s.uploaded()/d.get()},uploaded:function(){return l.get()},validate:function(t){var n={userId:e.userId&&e.userId()};try{var r=c.Validators,a=c.getRestrictions(i);r.checkAll(n,t,o,a)}catch(e){return e}},send:function(e,t){if(!(e instanceof window.File||e instanceof window.Blob))throw new Error(\"Not a file\");return s.file=e,s.request(function(e,n){if(e)return t(e);s.instructions=n,s.transfer(t)}),s},request:function(t){s.file||t(new Error(\"No file to request upload for\"));var n=r.pick(s.file,\"name\",\"size\",\"type\");f.set(\"authorizing\");var a=this.validate(n);return a?(f.set(\"failed\"),t(a),s):(e.call(\"slingshot/uploadRequest\",i,n,o,function(e,n){f.set(e?\"failed\":\"authorized\"),t(e,n)}),s)},transfer:function(t){if(\"authorized\"!==f.curValue)throw new Error(\"Cannot transfer file at upload status: \"+f.curValue);f.set(\"transferring\"),l.set(0);var n=new XMLHttpRequest;function i(){return new e.Error(n.statusText+\" - \"+n.status,\"Failed to upload file to cloud storage\")}return n.upload.addEventListener(\"progress\",function(e){e.lengthComputable&&(l.set(e.loaded),d.set(e.total))},!1),n.addEventListener(\"load\",function(){n.status<400?(f.set(\"done\"),l.set(d.get()),t(null,s.instructions.download)):(f.set(\"failed\"),t(i()))}),n.addEventListener(\"error\",function(){f.set(\"failed\"),t(i())}),n.addEventListener(\"abort\",function(){f.set(\"aborted\"),t(new e.Error(\"Aborted\",\"The upload has been aborted by the user\"))}),n.open(\"POST\",s.instructions.upload,!0),r.each(s.instructions.headers,function(e,t){n.setRequestHeader(t,e)}),n.send(h()),s.xhr=n,s},isImage:function(){return s.status(),Boolean(s.file&&\"image\"===s.file.type.split(\"/\")[0])},url:function(e){if(!w){var r=new u,i=window.URL||window.webkitURL;w=new u,a.nonreactive(function(){var e=new a.Dependency;a.autorun(function(t){s.file?i?(r.set(i.createObjectURL(s.file)),t.stop()):a.active&&window.FileReader&&n(s.file,function(e){r.set(e),t.stop()}):e.depend()}),a.autorun(function(t){var n=s.status();s.instructions&&\"done\"===n?(t.stop(),w.set(s.instructions.download)):\"failed\"===n||\"aborted\"===n?t.stop():s.file&&!w.curValue&&(e.changed(),w.set(r.get()))})})}if(e){if(s.file&&!s.isImage())throw new Error(\"Cannot pre-load anything other than images\");return p||a.nonreactive(function(){p=new u,a.autorun(function(e){var n=w.get();s.instructions?t(n,function(){e.stop(),p.set(n)}):p.set(n)})}),p.get()}return w.get()},param:function(e){s.status();var t=s.instructions&&s.instructions.postData,n=t&&r.findWhere(t,{name:e});return n&&n.value}})}}.call(this)}).call(this),Package._define(\"edgee:slingshot\",{Slingshot:c})}();","sourcemap":"{\"version\":3,\"sources\":[\"packages/edgee_slingshot.js\"],\"names\":[\"Meteor\",\"Package\",\"meteor\",\"global\",\"meteorEnv\",\"_\",\"underscore\",\"check\",\"Match\",\"Tracker\",\"tracker\",\"Deps\",\"ReactiveVar\",\"Slingshot\",\"matchAllowedFileTypes\",\"OneOf\",\"String\",\"RegExp\",\"_restrictions\",\"fileRestrictions\",\"name\",\"restrictions\",\"authorize\",\"Optional\",\"Function\",\"maxSize\",\"Number\",\"allowedFileTypes\",\"isServer\",\"directive\",\"getDirective\",\"extend\",\"_directive\",\"getRestrictions\",\"this\",\"call\",\"formatBytes\",\"size\",\"units\",\"unit\",\"shift\",\"length\",\"Math\",\"round\",\"Validators\",\"checkAll\",\"context\",\"file\",\"meta\",\"checkFileSize\",\"checkFileType\",\"type\",\"min\",\"Infinity\",\"Error\",\"allowed\",\"test\",\"isArray\",\"indexOf\",\"join\",\"preloadImage\",\"image\",\"callback\",\"preloader\",\"window\",\"Image\",\"onload\",\"src\",\"readDataUrl\",\"reader\",\"FileReader\",\"onloadend\",\"result\",\"readAsDataURL\",\"Upload\",\"metaData\",\"File\",\"FormData\",\"self\",\"loaded\",\"total\",\"status\",\"dataUri\",\"preloaded\",\"buildFormData\",\"formData\",\"each\",\"instructions\",\"postData\",\"field\",\"append\",\"value\",\"get\",\"progress\",\"uploaded\",\"validate\",\"userId\",\"validators\",\"error\",\"send\",\"Blob\",\"request\",\"transfer\",\"pick\",\"set\",\"curValue\",\"xhr\",\"XMLHttpRequest\",\"getError\",\"statusText\",\"upload\",\"addEventListener\",\"event\",\"lengthComputable\",\"download\",\"open\",\"headers\",\"key\",\"setRequestHeader\",\"isImage\",\"Boolean\",\"split\",\"url\",\"preload\",\"localUrl\",\"URL\",\"webkitURL\",\"nonreactive\",\"previewRequirement\",\"Dependency\",\"autorun\",\"computation\",\"createObjectURL\",\"stop\",\"active\",\"depend\",\"changed\",\"param\",\"data\",\"findWhere\",\"_define\"],\"mappings\":\"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\"}","minifier":"terser"}