[{"type":"js","data":"/* Imports for global scope */\n\nMongoInternals = Package.mongo.MongoInternals;\nMongo = Package.mongo.Mongo;\nReactiveVar = Package['reactive-var'].ReactiveVar;\nTracker = Package.tracker.Tracker;\nDeps = Package.tracker.Deps;\nECMAScript = Package.ecmascript.ECMAScript;\nFactory = Package['dburles:factory'].Factory;\nRoles = Package['alanning:roles'].Roles;\nEmail = Package.email.Email;\nEmailInternals = Package.email.EmailInternals;\nValidatedMethod = Package['mdg:validated-method'].ValidatedMethod;\nCallPromiseMixin = Package['didericis:callpromise-mixin'].CallPromiseMixin;\ncheck = Package.check.check;\nMatch = Package.check.Match;\nCollection2 = Package['aldeed:collection2-core'].Collection2;\nSlingshot = Package['edgee:slingshot'].Slingshot;\nJob = Package['vsivsi:job-collection'].Job;\nJobCollection = Package['vsivsi:job-collection'].JobCollection;\nDocHead = Package['kadira:dochead'].DocHead;\nBert = Package['themeteorchef:bert'].Bert;\nInject = Package['meteorhacks:inject-initial'].Inject;\nMandrill = Package['wylio:mandrill'].Mandrill;\nKadira = Package['meteorhacks:kadira'].Kadira;\nanalytics = Package['okgrow:analytics'].analytics;\nT9n = Package['softwarerero:accounts-t9n'].T9n;\nMeteor = Package.meteor.Meteor;\nglobal = Package.meteor.global;\nmeteorEnv = Package.meteor.meteorEnv;\nWebApp = Package.webapp.WebApp;\nWebAppInternals = Package.webapp.WebAppInternals;\nmain = Package.webapp.main;\n_ = Package.underscore._;\nDDP = Package['ddp-client'].DDP;\nDDPServer = Package['ddp-server'].DDPServer;\nmeteorInstall = Package.modules.meteorInstall;\nmeteorBabelHelpers = Package['babel-runtime'].meteorBabelHelpers;\nPromise = Package.promise.Promise;\nAccounts = Package['accounts-base'].Accounts;\nAutoupdate = Package.autoupdate.Autoupdate;\n\n","servePath":"/packages/global-imports.js"},{"type":"js","data":"var require = meteorInstall({\"imports\":{\"core\":{\"api\":{\"adminActions\":{\"server\":{\"methods.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/adminActions/server/methods.js                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  insertAdminAction: function insertAdminAction() {\n    return _insertAdminAction;\n  },\n  completeAction: function completeAction() {\n    return _completeAction;\n  },\n  completeActionByType: function completeActionByType() {\n    return _completeActionByType;\n  },\n  removeParentLoan: function removeParentLoan() {\n    return _removeParentLoan;\n  }\n});\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _ValidatedMethod = void 0;\n\nmodule.watch(require(\"meteor/mdg:validated-method\"), {\n  ValidatedMethod: function ValidatedMethod(v) {\n    _ValidatedMethod = v;\n  }\n}, 1);\n\nvar _Roles = void 0;\n\nmodule.watch(require(\"meteor/alanning:roles\"), {\n  Roles: function Roles(v) {\n    _Roles = v;\n  }\n}, 2);\n\nvar _check = void 0,\n    _Match = void 0;\n\nmodule.watch(require(\"meteor/check\"), {\n  check: function check(v) {\n    _check = v;\n  },\n  Match: function Match(v) {\n    _Match = v;\n  }\n}, 3);\nexports.insertAdminAction = _insertAdminAction;\n\nvar _CallPromiseMixin = void 0;\n\nmodule.watch(require(\"meteor/didericis:callpromise-mixin\"), {\n  CallPromiseMixin: function CallPromiseMixin(v) {\n    _CallPromiseMixin = v;\n  }\n}, 4);\nvar rateLimit = void 0;\nmodule.watch(require(\"../../../utils/rate-limit.js\"), {\n  default: function _default(v) {\n    rateLimit = v;\n  }\n}, 5);\nvar AdminActions = void 0;\nmodule.watch(require(\"../adminActions\"), {\n  default: function _default(v) {\n    AdminActions = v;\n  }\n}, 6);\n\nvar _ADMIN_ACTION_STATUS = void 0;\n\nmodule.watch(require(\"../adminActionConstants\"), {\n  ADMIN_ACTION_STATUS: function ADMIN_ACTION_STATUS(v) {\n    _ADMIN_ACTION_STATUS = v;\n  }\n}, 7);\n\nvar _insertAdminAction = new _ValidatedMethod({\n  name: 'insertAdminAction',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref) {\n    var loanId = _ref.loanId,\n        type = _ref.type;\n\n    _check(loanId, String);\n\n    _check(type, String);\n  },\n  run: function run(_ref2) {\n    var loanId = _ref2.loanId,\n        type = _ref2.type;\n    // Make sure there isn't an action active with the same ID\n    var existingAction = AdminActions.findOne({\n      type: type,\n      loanId: loanId,\n      status: _ADMIN_ACTION_STATUS.ACTIVE\n    });\n\n    if (existingAction) {\n      throw new _Meteor.Error('duplicate active admin action');\n    }\n\n    return AdminActions.insert({\n      type: type,\n      loanId: loanId\n    });\n  }\n});\n\nvar _completeAction = new _ValidatedMethod({\n  name: 'completeAction',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref3) {\n    var id = _ref3.id;\n\n    _check(id, String);\n  },\n  run: function run(_ref4) {\n    var id = _ref4.id;\n    var action = AdminActions.findOne(id);\n\n    if (action.status === _ADMIN_ACTION_STATUS.COMPLETED) {\n      throw new _Meteor.Error('action is already completed');\n    }\n\n    return AdminActions.update(id, {\n      $set: {\n        status: _ADMIN_ACTION_STATUS.COMPLETED,\n        completedAt: new Date()\n      }\n    });\n  }\n});\n\nvar _completeActionByType = new _ValidatedMethod({\n  name: 'completeActionByType',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref5) {\n    var loanId = _ref5.loanId,\n        type = _ref5.type,\n        newStatus = _ref5.newStatus;\n\n    _check(loanId, String);\n\n    _check(type, String);\n\n    _check(newStatus, _Match.Optional(String));\n  },\n  run: function run(_ref6) {\n    var loanId = _ref6.loanId,\n        type = _ref6.type,\n        newStatus = _ref6.newStatus;\n    var action = AdminActions.findOne({\n      loanId: loanId,\n      type: type,\n      status: _ADMIN_ACTION_STATUS.ACTIVE\n    });\n\n    if (!action) {\n      throw new _Meteor.Error(\"action couldn't be found\");\n    }\n\n    return AdminActions.update(action._id, {\n      $set: {\n        status: newStatus || _ADMIN_ACTION_STATUS.COMPLETED,\n        completedAt: new Date()\n      }\n    });\n  }\n});\n\nvar _removeParentLoan = new _ValidatedMethod({\n  name: 'removeParentLoan',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref7) {\n    var loanId = _ref7.loanId;\n\n    _check(loanId, String);\n  },\n  run: function run(_ref8) {\n    var loanId = _ref8.loanId;\n    return AdminActions.update({\n      loanId: loanId\n    }, {\n      $set: {\n        status: _ADMIN_ACTION_STATUS.PARENT_DELETED\n      }\n    }, {\n      multi: true\n    });\n  }\n});\n\nrateLimit({\n  methods: [_insertAdminAction, _completeAction]\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"publications.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/adminActions/server/publications.js                                                                //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _check = void 0;\n\nmodule.watch(require(\"meteor/check\"), {\n  check: function check(v) {\n    _check = v;\n  }\n}, 1);\nvar AdminActions = void 0;\nmodule.watch(require(\"../adminActions\"), {\n  default: function _default(v) {\n    AdminActions = v;\n  }\n}, 2);\n\nvar _Roles = void 0;\n\nmodule.watch(require(\"meteor/alanning:roles\"), {\n  Roles: function Roles(v) {\n    _Roles = v;\n  }\n}, 3);\n\n_Meteor.publish('allAdminActions', function publish() {\n  // Verify if user is an admin\n  if (_Roles.userIsInRole(_Meteor.userId(), 'admin') || _Roles.userIsInRole(_Meteor.userId(), 'dev')) {\n    // Return all\n    return AdminActions.find();\n  }\n\n  return this.ready();\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"adminActionConstants.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/adminActions/adminActionConstants.js                                                               //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  ADMIN_ACTION_TYPE: function ADMIN_ACTION_TYPE() {\n    return _ADMIN_ACTION_TYPE;\n  },\n  ADMIN_ACTION_STATUS: function ADMIN_ACTION_STATUS() {\n    return _ADMIN_ACTION_STATUS;\n  }\n});\nexports.ADMIN_ACTION_TYPE = _ADMIN_ACTION_TYPE;\nvar _ADMIN_ACTION_TYPE = {\n  VERIFY: 'VERIFY',\n  AUCTION: 'AUCTION',\n  LENDER_CHOSEN: 'LENDER_CHOSEN'\n};\nvar _ADMIN_ACTION_STATUS = {\n  ACTIVE: 'ACTIVE',\n  COMPLETED: 'COMPLETED',\n  PARENT_DELETED: 'PARENT_DELETED',\n  CANCELLED: 'CANCELLED'\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"adminActions.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/adminActions/adminActions.js                                                                       //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Mongo = void 0;\n\nmodule.watch(require(\"meteor/mongo\"), {\n  Mongo: function Mongo(v) {\n    _Mongo = v;\n  }\n}, 0);\nvar SimpleSchema = void 0;\nmodule.watch(require(\"simpl-schema\"), {\n  default: function _default(v) {\n    SimpleSchema = v;\n  }\n}, 1);\n\nvar _ADMIN_ACTION_TYPE = void 0,\n    _ADMIN_ACTION_STATUS = void 0;\n\nmodule.watch(require(\"./adminActionConstants\"), {\n  ADMIN_ACTION_TYPE: function ADMIN_ACTION_TYPE(v) {\n    _ADMIN_ACTION_TYPE = v;\n  },\n  ADMIN_ACTION_STATUS: function ADMIN_ACTION_STATUS(v) {\n    _ADMIN_ACTION_STATUS = v;\n  }\n}, 2);\nvar AdminActions = new _Mongo.Collection('adminActions'); // Action types\n// 'verify'\n// 'auction'\n// 'lenderChosen'\n// Prevent all client side modifications of mongoDB\n\nAdminActions.deny({\n  insert: function insert() {\n    return true;\n  },\n  update: function update() {\n    return true;\n  },\n  remove: function remove() {\n    return true;\n  }\n});\nAdminActions.allow({\n  insert: function insert() {\n    return false;\n  },\n  update: function update() {\n    return false;\n  },\n  remove: function remove() {\n    return false;\n  }\n});\nvar AdminActionSchema = new SimpleSchema({\n  createdAt: {\n    type: Date,\n    autoValue: function autoValue() {\n      if (this.isInsert) {\n        return new Date();\n      }\n    }\n  },\n  status: {\n    type: String,\n    defaultValue: _ADMIN_ACTION_STATUS.ACTIVE,\n    allowedValues: Object.values(_ADMIN_ACTION_STATUS)\n  },\n  completedAt: {\n    type: Date,\n    optional: true\n  },\n  type: {\n    type: String,\n    allowedValues: Object.values(_ADMIN_ACTION_TYPE)\n  },\n  loanId: String,\n  staffId: {\n    type: String,\n    optional: true\n  },\n  extra: {\n    type: Object,\n    optional: true,\n    blackbox: true\n  },\n  notes: {\n    type: String,\n    optional: true\n  }\n});\nAdminActions.attachSchema(AdminActionSchema);\nmodule.exportDefault(AdminActions);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/adminActions/index.js                                                                              //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nmodule.watch(require(\"./adminActions\"), {\n  default: function _default(v) {\n    exports.default = v;\n  }\n}, 0);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"borrowers\":{\"queries\":{\"borrowerAssignedTo.expose.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/borrowers/queries/borrowerAssignedTo.expose.js                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar Security = void 0;\nmodule.watch(require(\"../../security\"), {\n  default: function _default(v) {\n    Security = v;\n  }\n}, 0);\nvar query = void 0;\nmodule.watch(require(\"./borrowerAssignedTo\"), {\n  default: function _default(v) {\n    query = v;\n  }\n}, 1);\nquery.expose({\n  firewall: function firewall(userId) {\n    Security.checkCurrentUserIsAdmin(userId);\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"borrowerAssignedTo.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/borrowers/queries/borrowerAssignedTo.js                                                            //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar Borrowers = void 0;\nmodule.watch(require(\"..\"), {\n  default: function _default(v) {\n    Borrowers = v;\n  }\n}, 0);\n\nvar _BORROWER_QUERIES = void 0;\n\nmodule.watch(require(\"../borrowerConstants\"), {\n  BORROWER_QUERIES: function BORROWER_QUERIES(v) {\n    _BORROWER_QUERIES = v;\n  }\n}, 1);\nmodule.exportDefault(Borrowers.createQuery(_BORROWER_QUERIES.BORROWER_ASSIGNED_TO, {\n  $filter: function $filter(_ref) {\n    var filters = _ref.filters,\n        params = _ref.params;\n    filters.userId = params.userId;\n  },\n  assignedTo: 1\n}));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"borrowersList.expose.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/borrowers/queries/borrowersList.expose.js                                                          //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar Security = void 0;\nmodule.watch(require(\"../../security\"), {\n  default: function _default(v) {\n    Security = v;\n  }\n}, 0);\nvar query = void 0;\nmodule.watch(require(\"./borrowersList\"), {\n  default: function _default(v) {\n    query = v;\n  }\n}, 1);\nquery.expose({\n  firewall: function firewall(userId) {\n    Security.checkCurrentUserIsAdmin(userId);\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"borrowersList.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/borrowers/queries/borrowersList.js                                                                 //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar Borrowers = void 0;\nmodule.watch(require(\"..\"), {\n  default: function _default(v) {\n    Borrowers = v;\n  }\n}, 0);\n\nvar _BORROWER_QUERIES = void 0;\n\nmodule.watch(require(\"../borrowerConstants\"), {\n  BORROWER_QUERIES: function BORROWER_QUERIES(v) {\n    _BORROWER_QUERIES = v;\n  }\n}, 1);\nmodule.exportDefault(Borrowers.createQuery(_BORROWER_QUERIES.ADMIN_BORROWERS, {\n  $options: {\n    sort: {\n      createdAt: -1\n    }\n  },\n  firstName: 1,\n  lastName: 1,\n  createdAt: 1,\n  updatedAt: 1\n}));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"exposures.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/borrowers/queries/exposures.js                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nmodule.watch(require(\"./borrowersList.expose\"));\nmodule.watch(require(\"./borrowerAssignedTo.expose\"));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"server\":{\"methods.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/borrowers/server/methods.js                                                                        //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.insertBorrower = undefined;\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.export({\n  insertBorrower: function insertBorrower() {\n    return _insertBorrower;\n  },\n  updateBorrower: function updateBorrower() {\n    return _updateBorrower;\n  },\n  pushBorrowerValue: function pushBorrowerValue() {\n    return _pushBorrowerValue;\n  },\n  popBorrowerValue: function popBorrowerValue() {\n    return _popBorrowerValue;\n  },\n  deleteBorrower: function deleteBorrower() {\n    return _deleteBorrower;\n  }\n});\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _ValidatedMethod = void 0;\n\nmodule.watch(require(\"meteor/mdg:validated-method\"), {\n  ValidatedMethod: function ValidatedMethod(v) {\n    _ValidatedMethod = v;\n  }\n}, 1);\n\nvar _check = void 0;\n\nmodule.watch(require(\"meteor/check\"), {\n  check: function check(v) {\n    _check = v;\n  }\n}, 2);\n\nvar _Roles = void 0;\n\nexports.insertBorrower = _insertBorrower;\nmodule.watch(require(\"meteor/alanning:roles\"), {\n  Roles: function Roles(v) {\n    _Roles = v;\n  }\n}, 3);\n\nvar _CallPromiseMixin = void 0;\n\nmodule.watch(require(\"meteor/didericis:callpromise-mixin\"), {\n  CallPromiseMixin: function CallPromiseMixin(v) {\n    _CallPromiseMixin = v;\n  }\n}, 4);\nvar rateLimit = void 0;\nmodule.watch(require(\"../../../utils/rate-limit.js\"), {\n  default: function _default(v) {\n    rateLimit = v;\n  }\n}, 5);\nvar Borrowers = void 0;\nmodule.watch(require(\"../borrowers\"), {\n  default: function _default(v) {\n    Borrowers = v;\n  }\n}, 6);\n\nvar _insertBorrower = new _ValidatedMethod({\n  name: 'insertBorrower',\n  mixins: [_CallPromiseMixin],\n  validate: function validate() {},\n  run: function run(_ref) {\n    var object = _ref.object,\n        userId = _ref.userId;\n    return Borrowers.insert((0, _extends3.default)({}, object, {\n      // Allow null as userId\n      userId: userId === undefined ? _Meteor.userId() : userId\n    }));\n  }\n}); // Lets you set an entire object in the document\n\n\nvar _updateBorrower = new _ValidatedMethod({\n  name: 'updateBorrower',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref2) {\n    var id = _ref2.id;\n\n    _check(id, String);\n  },\n  run: function run(_ref3) {\n    var object = _ref3.object,\n        id = _ref3.id;\n    return Borrowers.update(id, {\n      $set: object\n    });\n  }\n});\n\nvar _pushBorrowerValue = new _ValidatedMethod({\n  name: 'pushBorrowerValue',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref4) {\n    var id = _ref4.id;\n\n    _check(id, String);\n  },\n  run: function run(_ref5) {\n    var object = _ref5.object,\n        id = _ref5.id;\n    return Borrowers.update(id, {\n      $push: object\n    });\n  }\n});\n\nvar _popBorrowerValue = new _ValidatedMethod({\n  name: 'popBorrowerValue',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref6) {\n    var id = _ref6.id;\n\n    _check(id, String);\n  },\n  run: function run(_ref7) {\n    var object = _ref7.object,\n        id = _ref7.id;\n    return Borrowers.update(id, {\n      $pop: object\n    }, {\n      getAutoValues: false\n    });\n  }\n});\n\nvar _deleteBorrower = new _ValidatedMethod({\n  name: 'deleteBorrower',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref8) {\n    var id = _ref8.id;\n\n    _check(id, String);\n  },\n  run: function run(_ref9) {\n    var id = _ref9.id;\n\n    if (_Roles.userIsInRole(_Meteor.userId(), 'dev')) {\n      return Borrowers.remove(id);\n    }\n\n    return false;\n  }\n});\n\nrateLimit({\n  methods: [_insertBorrower, _updateBorrower, _pushBorrowerValue, _popBorrowerValue, _deleteBorrower]\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"mutations.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/borrowers/server/mutations.js                                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _SecurityService = void 0,\n    _createMutator = void 0;\n\nmodule.watch(require(\"../..\"), {\n  SecurityService: function SecurityService(v) {\n    _SecurityService = v;\n  },\n  createMutator: function createMutator(v) {\n    _createMutator = v;\n  }\n}, 1);\nvar BorrowerService = void 0;\nmodule.watch(require(\"../BorrowerService\"), {\n  default: function _default(v) {\n    BorrowerService = v;\n  }\n}, 2);\nvar defs = void 0;\nmodule.watch(require(\"../mutationDefinitions\"), {\n  \"*\": function _(v) {\n    defs = v;\n  }\n}, 3);\n\n_createMutator(defs.BORROWER_INSERT, function (_ref) {\n  var borrower = _ref.borrower,\n      userId = _ref.userId;\n  var userIdIsDefined = userId !== undefined;\n\n  if (userIdIsDefined) {\n    _SecurityService.checkCurrentUserIsAdmin();\n  } else {\n    _SecurityService.borrowers.isAllowedToInsert();\n  }\n\n  return BorrowerService.insert({\n    borrower: borrower,\n    userId: userIdIsDefined ? userId : _Meteor.userId()\n  });\n});\n\n_createMutator(defs.BORROWER_UPDATE, function (_ref2) {\n  var borrowerId = _ref2.borrowerId,\n      borrower = _ref2.borrower;\n\n  _SecurityService.borrowers.isAllowedToUpdate(borrowerId);\n\n  return BorrowerService.update({\n    borrowerId: borrowerId,\n    borrower: borrower\n  });\n});\n\n_createMutator(defs.BORROWER_DELETE, function (_ref3) {\n  var borrowerId = _ref3.borrowerId;\n\n  _SecurityService.borrowers.isAllowedToDelete(borrowerId);\n\n  return BorrowerService.remove({\n    borrowerId: borrowerId\n  });\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"publications.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/borrowers/server/publications.js                                                                   //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _check = void 0;\n\nmodule.watch(require(\"meteor/check\"), {\n  check: function check(v) {\n    _check = v;\n  }\n}, 1);\n\nvar _Roles = void 0;\n\nmodule.watch(require(\"meteor/alanning:roles\"), {\n  Roles: function Roles(v) {\n    _Roles = v;\n  }\n}, 2);\nvar Borrowers = void 0;\nmodule.watch(require(\"../borrowers\"), {\n  default: function _default(v) {\n    Borrowers = v;\n  }\n}, 3);\n\n// Publish a specific loan with an ID\n_Meteor.publish('borrower', function publish(id) {\n  // Verify if user is logged In\n  if (!_Meteor.userId()) {\n    return this.ready();\n  }\n\n  _check(id, String);\n\n  if (_Roles.userIsInRole(_Meteor.userId(), 'admin') || _Roles.userIsInRole(_Meteor.userId(), 'dev')) {\n    return Borrowers.find({\n      _id: id\n    });\n  }\n\n  return Borrowers.find({\n    userId: _Meteor.userId(),\n    _id: id\n  });\n}); // Publish all borrowers from the current user\n\n\n_Meteor.publish('borrowers', function publish() {\n  // Verify if user is logged In\n  if (!_Meteor.userId()) {\n    return this.ready();\n  }\n\n  var borrowers = Borrowers.find({\n    userId: _Meteor.userId()\n  });\n  return borrowers;\n}); // Publish all borrowers for a user\n\n\n_Meteor.publish('userBorrowers', function publish(userId) {\n  _check(userId, String); // Verify if user is logged In\n\n\n  if (_Roles.userIsInRole(_Meteor.userId(), 'admin') || _Roles.userIsInRole(_Meteor.userId(), 'dev')) {\n    // Return all users\n    return Borrowers.find({\n      userId: userId\n    });\n  }\n\n  return this.ready();\n}); // Publish all borrowers in the database for admins\n\n\n_Meteor.publish('allBorrowers', function publish() {\n  // Verify if user is logged In\n  if (_Roles.userIsInRole(_Meteor.userId(), 'admin') || _Roles.userIsInRole(_Meteor.userId(), 'dev')) {\n    // Return all users\n    return Borrowers.find();\n  }\n\n  return this.ready();\n}); // Publish all borrowers for a loan for admins\n\n\n_Meteor.publish('loanBorrowers', function publish(borrowerIds) {\n  _check(borrowerIds, [String]); // Verify if user is an admin\n\n\n  if (_Roles.userIsInRole(_Meteor.userId(), 'admin') || _Roles.userIsInRole(_Meteor.userId(), 'dev')) {\n    // Return all borrowers\n    return Borrowers.find({\n      _id: {\n        $in: borrowerIds\n      }\n    });\n  }\n\n  return this.ready();\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"BorrowerService.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/borrowers/BorrowerService.js                                                                       //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.export({\n  default: function _default() {\n    return _class;\n  }\n});\nvar Borrowers = void 0;\nmodule.watch(require(\"../borrowers\"), {\n  default: function _default(v) {\n    Borrowers = v;\n  }\n}, 0);\n\nvar _class = function _class() {\n  (0, _classCallCheck3.default)(this, _class);\n};\n\n_class.update = function (_ref) {\n  var borrowerId = _ref.borrowerId,\n      borrower = _ref.borrower;\n  return Borrowers.update(borrowerId, {\n    $set: borrower\n  });\n};\n\n_class.insert = function (_ref2) {\n  var borrower = _ref2.borrower,\n      userId = _ref2.userId;\n  return Borrowers.insert((0, _extends3.default)({}, borrower, {\n    userId: userId\n  }));\n};\n\n_class.remove = function (_ref3) {\n  var borrowerId = _ref3.borrowerId;\n  return Borrowers.remove(borrowerId);\n};\n\n_class.pushValue = function (_ref4) {\n  var borrowerId = _ref4.borrowerId,\n      borrower = _ref4.borrower;\n  return Borrowers.update(borrowerId, {\n    $push: borrower\n  });\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"borrowerConstants.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/borrowers/borrowerConstants.js                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  RESIDENCY_PERMIT: function RESIDENCY_PERMIT() {\n    return _RESIDENCY_PERMIT;\n  },\n  GENDER: function GENDER() {\n    return _GENDER;\n  },\n  CIVIL_STATUS: function CIVIL_STATUS() {\n    return _CIVIL_STATUS;\n  },\n  OTHER_FORTUNE: function OTHER_FORTUNE() {\n    return _OTHER_FORTUNE;\n  },\n  OTHER_INCOME: function OTHER_INCOME() {\n    return _OTHER_INCOME;\n  },\n  EXPENSES: function EXPENSES() {\n    return _EXPENSES;\n  },\n  REAL_ESTATE: function REAL_ESTATE() {\n    return _REAL_ESTATE;\n  },\n  BORROWER_QUERIES: function BORROWER_QUERIES() {\n    return _BORROWER_QUERIES;\n  }\n});\nexports.RESIDENCY_PERMIT = _RESIDENCY_PERMIT;\nvar _RESIDENCY_PERMIT = {\n  B: 'b',\n  C: 'c',\n  CI: 'ci',\n  F: 'f',\n  G: 'g',\n  L: 'l',\n  N: 'n',\n  S: 's',\n  NONE: 'none'\n};\nvar _GENDER = {\n  M: 'M',\n  F: 'F',\n  OTHER: 'OTHER'\n};\nvar _CIVIL_STATUS = {\n  MARRIED: 'MARRIED',\n  SINGLE: 'SINGLE',\n  PACSED: 'PACSED',\n  DIVORCED: 'DIVORCED'\n};\nvar _OTHER_FORTUNE = {\n  ART: 'ART',\n  CARS: 'CARS',\n  BOATS: 'BOATS',\n  AIRPLANES: 'AIRPLANES',\n  JEWELRY: 'JEWELRY'\n};\nvar _OTHER_INCOME = {\n  WELFARE: 'WELFARE',\n  PENSION: 'PENSION',\n  RENT: 'RENT',\n  REAL_ESTATE: 'REAL_ESTATE',\n  INVESTMENT: 'INVESTMENT',\n  OTHER: 'OTHER'\n};\nvar _EXPENSES = {\n  LEASING: 'LEASING',\n  RENT: 'RENT',\n  PERSONAL_LOAN: 'PERSONAL_LOAN',\n  MORTGAGE_LOAN: 'MORTGAGE_LOAN',\n  PENSIONS: 'PENSIONS',\n  OTHER: 'OTHER'\n};\nvar _REAL_ESTATE = {\n  PRIMARY: 'PRIMARY',\n  SECONDARY: 'SECONDARY',\n  INVESTMENT: 'INVESTMENT'\n};\nvar _BORROWER_QUERIES = {\n  ADMIN_BORROWERS: 'ADMIN_BORROWERS',\n  BORROWER_ASSIGNED_TO: 'BORROWER_ASSIGNED_TO'\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"borrowers.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/borrowers/borrowers.js                                                                             //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  BorrowerSchema: function BorrowerSchema() {\n    return _BorrowerSchema;\n  }\n});\n\nvar _Mongo = void 0;\n\nmodule.watch(require(\"meteor/mongo\"), {\n  Mongo: function Mongo(v) {\n    _Mongo = v;\n  }\n}, 0);\nvar SimpleSchema = void 0;\nmodule.watch(require(\"simpl-schema\"), {\n  default: function _default(v) {\n    SimpleSchema = v;\n  }\n}, 1);\n\nvar _getFileSchema = void 0;\n\nmodule.watch(require(\"../files/files\"), {\n  getFileSchema: function getFileSchema(v) {\n    _getFileSchema = v;\n  }\n}, 2);\n\nvar _RESIDENCY_PERMIT = void 0,\n    _GENDER = void 0,\n    _CIVIL_STATUS = void 0,\n    _OTHER_FORTUNE = void 0,\n    _OTHER_INCOME = void 0,\n    _EXPENSES = void 0,\n    _REAL_ESTATE = void 0;\n\nmodule.watch(require(\"./borrowerConstants\"), {\n  RESIDENCY_PERMIT: function RESIDENCY_PERMIT(v) {\n    _RESIDENCY_PERMIT = v;\n  },\n  GENDER: function GENDER(v) {\n    _GENDER = v;\n  },\n  CIVIL_STATUS: function CIVIL_STATUS(v) {\n    _CIVIL_STATUS = v;\n  },\n  OTHER_FORTUNE: function OTHER_FORTUNE(v) {\n    _OTHER_FORTUNE = v;\n  },\n  OTHER_INCOME: function OTHER_INCOME(v) {\n    _OTHER_INCOME = v;\n  },\n  EXPENSES: function EXPENSES(v) {\n    _EXPENSES = v;\n  },\n  REAL_ESTATE: function REAL_ESTATE(v) {\n    _REAL_ESTATE = v;\n  }\n}, 3);\nvar Borrowers = new _Mongo.Collection('borrowers'); // Prevent all client side modifications of mongoDB\n\nexports.BorrowerSchema = _BorrowerSchema;\nBorrowers.deny({\n  insert: function insert() {\n    return true;\n  },\n  update: function update() {\n    return true;\n  },\n  remove: function remove() {\n    return true;\n  }\n});\nBorrowers.allow({\n  insert: function insert() {\n    return false;\n  },\n  update: function update() {\n    return false;\n  },\n  remove: function remove() {\n    return false;\n  }\n});\nvar BorrowerFilesSchema = new SimpleSchema(_getFileSchema('borrower'));\nvar LogicSchema = new SimpleSchema({\n  financeEthics: {\n    type: Boolean,\n    defaultValue: false,\n    optional: true\n  },\n  hasValidatedFinances: {\n    type: Boolean,\n    defaultValue: false,\n    optional: true\n  },\n  adminValidated: {\n    type: Boolean,\n    defaultValue: false\n  }\n}); // Documentation is in the google drive dev/MongoDB Schemas\n\nvar _BorrowerSchema = new SimpleSchema({\n  userId: {\n    type: String,\n    optional: true\n  },\n  createdAt: {\n    type: Date,\n    autoValue: function autoValue() {\n      if (this.isInsert) {\n        return new Date();\n      }\n    }\n  },\n  updatedAt: {\n    type: Date,\n    autoValue: function autoValue() {\n      // Verify the update is from the user owning this doc, ignoring admin/partner updates\n      var doc = Borrowers.findOne(this.docId, {\n        fields: {\n          userId: 1\n        }\n      });\n\n      if (this.isInsert) {\n        return new Date();\n      } else if (this.isUpdate && doc && this.userId === doc.userId) {\n        return new Date();\n      }\n    }\n  },\n  // Personal Information\n  firstName: {\n    type: String,\n    optional: true\n  },\n  lastName: {\n    type: String,\n    optional: true\n  },\n  gender: {\n    type: String,\n    optional: true,\n    allowedValues: Object.values(_GENDER)\n  },\n  age: {\n    type: SimpleSchema.Integer,\n    optional: true,\n    min: 18,\n    max: 120\n  },\n  address1: {\n    type: String,\n    optional: true\n  },\n  address2: {\n    type: String,\n    optional: true\n  },\n  zipCode: {\n    type: Number,\n    optional: true,\n    min: 1000,\n    max: 9999\n  },\n  city: {\n    type: String,\n    optional: true\n  },\n  sameAddress: {\n    type: Boolean,\n    optional: true\n  },\n  isSwiss: {\n    type: Boolean,\n    optional: true\n  },\n  residencyPermit: {\n    type: String,\n    optional: true,\n    allowedValues: Object.values(_RESIDENCY_PERMIT)\n  },\n  birthDate: {\n    type: String,\n    optional: true,\n    regEx: '/^d{4}[/-](0?[1-9]|1[012])[/-](0?[1-9]|[12][0-9]|3[01])$/' // YYYY-MM-DD\n\n  },\n  birthPlace: {\n    type: String,\n    optional: true\n  },\n  citizenship: {\n    type: String,\n    optional: true\n  },\n  isUSPerson: {\n    type: Boolean,\n    optional: true\n  },\n  civilStatus: {\n    type: String,\n    defaultValue: _CIVIL_STATUS.SINGLE,\n    allowedValues: Object.values(_CIVIL_STATUS)\n  },\n  childrenCount: {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 20\n  },\n  company: {\n    type: String,\n    optional: true\n  },\n  worksForOwnCompany: {\n    type: Boolean,\n    optional: true\n  },\n  salary: {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 100000000\n  },\n  bonusExists: {\n    type: Boolean,\n    defaultValue: false\n  },\n  bonus: {\n    type: Object,\n    defaultValue: {}\n  },\n  'bonus.bonus2014': {\n    // oldest\n    type: Number,\n    min: 0,\n    max: 100000000,\n    optional: true\n  },\n  'bonus.bonus2015': {\n    type: Number,\n    min: 0,\n    max: 100000000,\n    optional: true\n  },\n  'bonus.bonus2016': {\n    type: Number,\n    min: 0,\n    max: 100000000,\n    optional: true\n  },\n  'bonus.bonus2017': {\n    // most recent\n    type: Number,\n    min: 0,\n    max: 100000000,\n    optional: true\n  },\n  otherIncome: {\n    type: Array,\n    optional: true,\n    defaultValue: []\n  },\n  'otherIncome.$': Object,\n  'otherIncome.$.value': {\n    type: Number,\n    min: 0,\n    max: 100000000\n  },\n  'otherIncome.$.description': {\n    type: String,\n    allowedValues: Object.values(_OTHER_INCOME)\n  },\n  otherFortune: {\n    type: Array,\n    optional: true,\n    defaultValue: []\n  },\n  'otherFortune.$': Object,\n  'otherFortune.$.value': {\n    type: Number,\n    min: 0,\n    max: 100000000\n  },\n  'otherFortune.$.description': {\n    type: String,\n    allowedValues: Object.values(_OTHER_FORTUNE)\n  },\n  expenses: {\n    type: Array,\n    optional: true,\n    defaultValue: []\n  },\n  'expenses.$': Object,\n  'expenses.$.value': {\n    type: Number,\n    min: 0,\n    max: 100000000\n  },\n  'expenses.$.description': {\n    type: String,\n    allowedValues: Object.values(_EXPENSES)\n  },\n  bankFortune: {\n    type: Number,\n    min: 0,\n    max: 100000000,\n    optional: true\n  },\n  realEstate: {\n    type: Array,\n    optional: true,\n    defaultValue: []\n  },\n  'realEstate.$': Object,\n  'realEstate.$.value': {\n    type: Number,\n    min: 0,\n    max: 100000000\n  },\n  'realEstate.$.loan': {\n    type: Number,\n    min: 0,\n    max: 100000000\n  },\n  'realEstate.$.description': {\n    type: String,\n    allowedValues: Object.values(_REAL_ESTATE)\n  },\n  personalBank: {\n    type: String,\n    optional: true\n  },\n  corporateBankExists: {\n    type: Boolean,\n    defaultValue: false\n  },\n  corporateBank: {\n    type: String,\n    optional: true\n  },\n  insuranceSecondPillar: {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 100000000\n  },\n  insuranceThirdPillar: {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 100000000\n  },\n  insurance3B: {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 100000000\n  },\n  files: {\n    type: BorrowerFilesSchema,\n    defaultValue: {}\n  },\n  // business logic and admin\n  logic: {\n    type: LogicSchema,\n    defaultValue: {}\n  },\n  admin: {\n    // TODO\n    type: Object,\n    optional: true\n  },\n  adminValidation: {\n    type: Object,\n    defaultValue: {},\n    blackbox: true\n  }\n});\n\nBorrowers.attachSchema(_BorrowerSchema);\nmodule.exportDefault(Borrowers);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/borrowers/index.js                                                                                 //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  borrowerMutations: function borrowerMutations() {\n    return _borrowerMutations;\n  }\n});\nmodule.watch(require(\"./borrowers\"), {\n  default: function _default(v) {\n    exports.default = v;\n  }\n}, 1);\nvar mutationDefinitions = void 0;\nexports.borrowerMutations = _borrowerMutations;\nmodule.watch(require(\"./mutationDefinitions\"), {\n  \"*\": function _(v) {\n    mutationDefinitions = v;\n  }\n}, 0);\nvar _borrowerMutations = mutationDefinitions;\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"links.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/borrowers/links.js                                                                                 //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Borrowers = void 0,\n    _Users = void 0;\n\nmodule.watch(require(\"../\"), {\n  Borrowers: function Borrowers(v) {\n    _Borrowers = v;\n  },\n  Users: function Users(v) {\n    _Users = v;\n  }\n}, 0);\n\n_Borrowers.addLinks({\n  asignee: {\n    field: 'userId',\n    collection: _Users,\n    type: 'one'\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"mutationDefinitions.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/borrowers/mutationDefinitions.js                                                                   //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  BORROWER_INSERT: function BORROWER_INSERT() {\n    return _BORROWER_INSERT;\n  },\n  BORROWER_UPDATE: function BORROWER_UPDATE() {\n    return _BORROWER_UPDATE;\n  },\n  BORROWER_DELETE: function BORROWER_DELETE() {\n    return _BORROWER_DELETE;\n  }\n});\nexports.BORROWER_INSERT = _BORROWER_INSERT;\nvar _BORROWER_INSERT = {\n  name: 'BORROWER_INSERT',\n  params: {\n    borrower: {\n      type: Object\n    },\n    userId: {\n      type: String,\n      optional: true\n    }\n  }\n};\nvar _BORROWER_UPDATE = {\n  name: 'BORROWER_UPDATE',\n  params: {\n    borrowerId: {\n      type: String\n    },\n    object: {\n      type: Object\n    }\n  }\n};\nvar _BORROWER_DELETE = {\n  name: 'BORROWER_DELETE',\n  params: {\n    borrowerId: {\n      type: String\n    }\n  }\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"comparators\":{\"server\":{\"methods.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/comparators/server/methods.js                                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  insertComparator: function insertComparator() {\n    return _insertComparator;\n  },\n  updateComparator: function updateComparator() {\n    return _updateComparator;\n  },\n  addComparatorField: function addComparatorField() {\n    return _addComparatorField;\n  },\n  removeComparatorField: function removeComparatorField() {\n    return _removeComparatorField;\n  },\n  toggleHiddenField: function toggleHiddenField() {\n    return _toggleHiddenField;\n  }\n});\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _ValidatedMethod = void 0;\n\nmodule.watch(require(\"meteor/mdg:validated-method\"), {\n  ValidatedMethod: function ValidatedMethod(v) {\n    _ValidatedMethod = v;\n  }\n}, 1);\n\nvar _check = void 0,\n    _Match = void 0;\n\nmodule.watch(require(\"meteor/check\"), {\n  check: function check(v) {\n    _check = v;\n  },\n  Match: function Match(v) {\n    _Match = v;\n  }\n}, 2);\n\nvar _Roles = void 0;\n\nexports.insertComparator = _insertComparator;\nmodule.watch(require(\"meteor/alanning:roles\"), {\n  Roles: function Roles(v) {\n    _Roles = v;\n  }\n}, 3);\n\nvar _CallPromiseMixin = void 0;\n\nmodule.watch(require(\"meteor/didericis:callpromise-mixin\"), {\n  CallPromiseMixin: function CallPromiseMixin(v) {\n    _CallPromiseMixin = v;\n  }\n}, 4);\nvar rateLimit = void 0;\nmodule.watch(require(\"../../../utils/rate-limit.js\"), {\n  default: function _default(v) {\n    rateLimit = v;\n  }\n}, 5);\nvar Comparators = void 0;\nmodule.watch(require(\"../comparators\"), {\n  default: function _default(v) {\n    Comparators = v;\n  }\n}, 6);\n\nvar _insertComparator = new _ValidatedMethod({\n  name: 'insertComparator',\n  mixins: [_CallPromiseMixin],\n  validate: function validate() {},\n  run: function run() {\n    var userId = _Meteor.userId();\n\n    var userComparators = Comparators.find({\n      userId: userId\n    }).count();\n\n    if (userComparators > 0) {\n      throw new _Meteor.Error(\"Can't have more than one comparator per user\");\n    }\n\n    return Comparators.insert({\n      userId: userId\n    });\n  }\n});\n\nvar _updateComparator = new _ValidatedMethod({\n  name: 'updateComparator',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref) {\n    var object = _ref.object,\n        id = _ref.id;\n\n    _check(object, Object);\n\n    _check(id, String);\n  },\n  run: function run(_ref2) {\n    var object = _ref2.object,\n        id = _ref2.id;\n    return Comparators.update(id, {\n      $set: object\n    });\n  }\n});\n\nvar _addComparatorField = new _ValidatedMethod({\n  name: 'addComparatorField',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref3) {\n    var object = _ref3.object,\n        id = _ref3.id;\n    var name = object.name,\n        type = object.type;\n\n    _check(id, String);\n\n    _check(name, String);\n\n    _check(type, String);\n  },\n  run: function run(_ref4) {\n    var object = _ref4.object,\n        id = _ref4.id;\n    var name = object.name,\n        type = object.type;\n    var comparator = Comparators.findOne(id);\n    return Comparators.update(id, {\n      $inc: {\n        customFieldCount: 1\n      },\n      $push: {\n        customFields: {\n          id: \"custom\" + comparator.customFieldCount,\n          name: name,\n          type: type\n        }\n      }\n    });\n  }\n});\n\nvar _removeComparatorField = new _ValidatedMethod({\n  name: 'removeComparatorField',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref5) {\n    var object = _ref5.object,\n        id = _ref5.id;\n\n    _check(id, String);\n\n    _check(object, Object);\n\n    _check(object.fieldId, String);\n  },\n  run: function run(_ref6) {\n    var object = _ref6.object,\n        id = _ref6.id;\n    var fieldId = object.fieldId;\n    return Comparators.update(id, {\n      $pull: {\n        customFields: {\n          id: fieldId\n        }\n      }\n    });\n  }\n});\n\nvar _toggleHiddenField = new _ValidatedMethod({\n  name: 'toggleHiddenField',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref7) {\n    var object = _ref7.object,\n        id = _ref7.id;\n\n    _check(id, String);\n\n    _check(object, Object);\n\n    _check(object.fieldId, String);\n  },\n  run: function run(_ref8) {\n    var object = _ref8.object,\n        id = _ref8.id;\n    var fieldId = object.fieldId;\n    var comparator = Comparators.findOne(id);\n\n    if (comparator.hiddenFields.indexOf(fieldId) >= 0) {\n      // Field is currently hidden\n      return Comparators.update(id, {\n        $pull: {\n          hiddenFields: fieldId\n        }\n      });\n    }\n\n    return Comparators.update(id, {\n      $push: {\n        hiddenFields: fieldId\n      }\n    });\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"publications.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/comparators/server/publications.js                                                                 //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\nvar Comparators = void 0;\nmodule.watch(require(\"../comparators\"), {\n  default: function _default(v) {\n    Comparators = v;\n  }\n}, 1);\n\n// Get all comparators for the current user\n_Meteor.publish('userComparators', function publish() {\n  // Verify if user is logged In\n  if (!_Meteor.userId()) {\n    return this.ready();\n  }\n\n  return Comparators.find({\n    userId: _Meteor.userId()\n  });\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"comparators.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/comparators/comparators.js                                                                         //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  ComparatorSchema: function ComparatorSchema() {\n    return _ComparatorSchema;\n  }\n});\n\nvar _Mongo = void 0;\n\nmodule.watch(require(\"meteor/mongo\"), {\n  Mongo: function Mongo(v) {\n    _Mongo = v;\n  }\n}, 0);\nvar SimpleSchema = void 0;\nmodule.watch(require(\"simpl-schema\"), {\n  default: function _default(v) {\n    SimpleSchema = v;\n  }\n}, 1);\nvar Comparators = new _Mongo.Collection('comparators'); // Prevent all client side modifications of mongoDB\n\nexports.ComparatorSchema = _ComparatorSchema;\nComparators.deny({\n  insert: function insert() {\n    return true;\n  },\n  update: function update() {\n    return true;\n  },\n  remove: function remove() {\n    return true;\n  }\n});\nComparators.allow({\n  insert: function insert() {\n    return false;\n  },\n  update: function update() {\n    return false;\n  },\n  remove: function remove() {\n    return false;\n  }\n});\n\nvar _ComparatorSchema = new SimpleSchema({\n  userId: {\n    type: String\n  },\n  createdAt: {\n    type: Date,\n    autoValue: function autoValue() {\n      if (this.isInsert) {\n        return new Date();\n      }\n    }\n  },\n  updatedAt: {\n    type: Date,\n    autoValue: function autoValue() {\n      if (this.isInsert || this.isUpdate) {\n        return new Date();\n      }\n    }\n  },\n  useBorrowers: {\n    type: Boolean,\n    defaultValue: false\n  },\n  income: {\n    type: Number,\n    defaultValue: 100000,\n    optional: true\n  },\n  fortune: {\n    type: Number,\n    defaultValue: 100000,\n    optional: true\n  },\n  interestRate: {\n    type: Number,\n    defaultValue: 0.0125,\n    optional: true\n  },\n  borrowRatio: {\n    type: Number,\n    defaultValue: 0.8,\n    optional: true\n  },\n  usageType: {\n    type: String,\n    defaultValue: 'primary'\n  },\n  customFields: {\n    type: Array,\n    defaultValue: []\n  },\n  'customFields.$': Object,\n  'customFields.$.id': String,\n  'customFields.$.name': String,\n  'customFields.$.type': String,\n  customFieldCount: {\n    type: Number,\n    defaultValue: 0\n  },\n  hiddenFields: {\n    type: Array,\n    defaultValue: ['realBorrowRatio', 'incomeRatio', 'theoreticalMonthly']\n  },\n  'hiddenFields.$': String,\n  borrowers: {\n    type: Array,\n    defaultValue: []\n  },\n  'borrowers.$': String\n}); // Attach schema\n\n\nComparators.attachSchema(_ComparatorSchema);\nmodule.exportDefault(Comparators);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/comparators/index.js                                                                               //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nmodule.watch(require(\"./comparators\"), {\n  default: function _default(v) {\n    exports.default = v;\n  }\n}, 0);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"email\":{\"server\":{\"EmailService.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/email/server/EmailService.js                                                                       //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\nvar emailConfigs = void 0;\nmodule.watch(require(\"./emailConfigs\"), {\n  default: function _default(v) {\n    emailConfigs = v;\n  }\n}, 1);\n\nvar _getEmailContent = void 0,\n    _getEmailPart = void 0;\n\nmodule.watch(require(\"./emailHelpers\"), {\n  getEmailContent: function getEmailContent(v) {\n    _getEmailContent = v;\n  },\n  getEmailPart: function getEmailPart(v) {\n    _getEmailPart = v;\n  }\n}, 2);\n\nvar _sendMandrillTemplate = void 0,\n    _getMandrillTemplate = void 0,\n    _getSimpleMandrillTemplate = void 0,\n    _renderMandrillTemplate = void 0;\n\nmodule.watch(require(\"./mandrill\"), {\n  sendMandrillTemplate: function sendMandrillTemplate(v) {\n    _sendMandrillTemplate = v;\n  },\n  getMandrillTemplate: function getMandrillTemplate(v) {\n    _getMandrillTemplate = v;\n  },\n  getSimpleMandrillTemplate: function getSimpleMandrillTemplate(v) {\n    _getSimpleMandrillTemplate = v;\n  },\n  renderMandrillTemplate: function renderMandrillTemplate(v) {\n    _renderMandrillTemplate = v;\n  }\n}, 3);\n\nvar _FROM_NAME = void 0,\n    _FROM_EMAIL = void 0;\n\nmodule.watch(require(\"../emailConstants\"), {\n  FROM_NAME: function FROM_NAME(v) {\n    _FROM_NAME = v;\n  },\n  FROM_EMAIL: function FROM_EMAIL(v) {\n    _FROM_EMAIL = v;\n  }\n}, 4);\n\nvar EmailService = function EmailService() {\n  var _this = this;\n\n  (0, _classCallCheck3.default)(this, EmailService);\n\n  this.sendEmail = function (emailId, address, params) {\n    var templateOptions = _this.createTemplateOptions({\n      emailId: emailId,\n      address: address,\n      params: params\n    });\n\n    var template = _this.getTemplate(templateOptions);\n\n    if (_Meteor.isDevelopment || _Meteor.isTest) {\n      _this.emailLogger({\n        emailId: emailId,\n        address: address,\n        template: template\n      });\n    } else {\n      _sendMandrillTemplate(template);\n    }\n  };\n\n  this.sendEmailToUser = function (emailId, userId, params) {\n    var user = _Meteor.users.findOne(userId);\n\n    var emailAddress = user && user.emails[0].address;\n\n    _this.sendEmail(emailId, emailAddress, params);\n  };\n\n  this.sendEmailToLoggedInUser = function (emailId, params) {\n    _this.sendEmailToUser(emailId, _Meteor.userId(), params);\n  };\n\n  this.getEmailConfig = function (emailId) {\n    return emailConfigs[emailId];\n  };\n\n  this.createTemplateOptions = function (_ref) {\n    var emailId = _ref.emailId,\n        address = _ref.address,\n        params = _ref.params;\n\n    var emailConfig = _this.getEmailConfig(emailId);\n\n    var mandrillId = emailConfig.template.mandrillId,\n        createIntlValues = emailConfig.createIntlValues;\n    var intlValues = createIntlValues(params);\n\n    var emailContent = _getEmailContent(emailId, intlValues); // Make sure you call `createOverrides` from emailConfig, to preserve `this`\n    // See: https://github.com/Microsoft/vscode/issues/43930\n\n\n    var _emailConfig$createOv = emailConfig.createOverrides(params, emailContent),\n        variables = _emailConfig$createOv.variables,\n        allowUnsubscribe = _emailConfig$createOv.allowUnsubscribe;\n\n    return {\n      templateName: mandrillId,\n      allowUnsubscribe: allowUnsubscribe,\n      variables: variables,\n      recipientAddress: address,\n      senderAddress: _FROM_EMAIL,\n      senderName: _FROM_NAME,\n      subject: emailContent.subject,\n      sendAt: undefined\n    };\n  };\n\n  this.getAccountsTemplate = function (emailId) {\n    var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    var templateOptions = _this.createTemplateOptions({\n      emailId: emailId,\n      params: params\n    });\n\n    return _getSimpleMandrillTemplate(templateOptions);\n  };\n\n  this.getTemplate = function (templateOptions) {\n    return _getMandrillTemplate(templateOptions);\n  };\n\n  this.getEmailPart = function (emailId, part) {\n    return _getEmailPart({\n      emailId: emailId,\n      part: part\n    });\n  };\n\n  this.renderTemplate = function (templateOptions, emailId) {\n    var result = void 0;\n\n    _this.emailLogger({\n      emailId: emailId,\n      template: templateOptions\n    });\n\n    try {\n      result = _renderMandrillTemplate(templateOptions);\n    } catch (error) {\n      throw new _Meteor.Error('MANDRILL_ERROR', \"Error while rendering mandrill template for \" + emailId, error.reason || error.message || error);\n    }\n\n    return result;\n  };\n\n  this.emailLogger = function (_ref2) {\n    var emailId = _ref2.emailId,\n        address = _ref2.address,\n        template = _ref2.template;\n\n    if (_Meteor.isDevelopment || _Meteor.isTest) {\n      if (address) {\n        console.log(\"EmailService dev: Would've sent \" + emailId + \" to \" + address + \" with this template:\");\n      } else {\n        console.log(\"EmailService dev: Would've sent \" + emailId + \" with this template:\");\n      }\n\n      console.log(JSON.stringify(template, null, 2));\n    }\n  };\n};\n\nmodule.exportDefault(new EmailService());\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"accountsEmails.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/email/server/accountsEmails.js                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Accounts = void 0;\n\nmodule.watch(require(\"meteor/accounts-base\"), {\n  Accounts: function Accounts(v) {\n    _Accounts = v;\n  }\n}, 0);\n\nvar _FROM_DEFAULT = void 0,\n    _EMAIL_IDS = void 0,\n    _EMAIL_PARTS = void 0;\n\nmodule.watch(require(\"../emailConstants\"), {\n  FROM_DEFAULT: function FROM_DEFAULT(v) {\n    _FROM_DEFAULT = v;\n  },\n  EMAIL_IDS: function EMAIL_IDS(v) {\n    _EMAIL_IDS = v;\n  },\n  EMAIL_PARTS: function EMAIL_PARTS(v) {\n    _EMAIL_PARTS = v;\n  }\n}, 1);\nvar EmailService = void 0;\nmodule.watch(require(\"./EmailService\"), {\n  default: function _default(v) {\n    EmailService = v;\n  }\n}, 2);\n// Meteor default emails\n// https://themeteorchef.com/tutorials/sign-up-with-email-verification\n_Accounts.emailTemplates.siteName = 'e-Potek';\n_Accounts.emailTemplates.from = _FROM_DEFAULT;\n\n_Accounts.emailTemplates.verifyEmail = function () {\n  var emailId = _EMAIL_IDS.VERIFY_EMAIL;\n  return {\n    subject: function subject() {\n      return EmailService.getEmailPart(emailId, _EMAIL_PARTS.SUBJECT);\n    },\n    html: function html(user, url) {\n      // TODO: Make sure this doesn't block\n      var template = EmailService.getAccountsTemplate(emailId, {\n        user: user,\n        url: url\n      });\n      var result = EmailService.renderTemplate(template, emailId);\n      return result.data.html;\n    }\n  };\n}();\n\n_Accounts.emailTemplates.resetPassword = function () {\n  var emailId = _EMAIL_IDS.RESET_PASSWORD;\n  return {\n    subject: function subject() {\n      return EmailService.getEmailPart(emailId, _EMAIL_PARTS.SUBJECT);\n    },\n    html: function html(user, url) {\n      // TODO: Make sure this doesn't block\n      var template = EmailService.getAccountsTemplate(emailId, {\n        user: user,\n        url: url\n      });\n      var result = EmailService.renderTemplate(template, emailId);\n      return result.data.html;\n    }\n  };\n}();\n\n_Accounts.emailTemplates.enrollAccount = function () {\n  var emailId = _EMAIL_IDS.ENROLL_ACCOUNT;\n  return {\n    subject: function subject() {\n      return EmailService.getEmailPart(emailId, _EMAIL_PARTS.SUBJECT);\n    },\n    html: function html(user, url) {\n      // TODO: Make sure this doesn't block\n      var template = EmailService.getAccountsTemplate(emailId, {\n        user: user,\n        url: url\n      });\n      var result = EmailService.renderTemplate(template, emailId);\n      return result.data.html;\n    }\n  };\n}();\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"email-methods.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/email/server/email-methods.js                                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n// import { Meteor } from 'meteor/meteor';\n// import { Mandrill } from 'meteor/wylio:mandrill';\n// import { ValidatedMethod } from 'meteor/mdg:validated-method';\n// import { check, Match } from 'meteor/check';\n// import { CallPromiseMixin } from 'meteor/didericis:callpromise-mixin';\n// import rateLimit from 'core/utils/rate-limit.js';\n// import {\n//   from,\n//   fromEmail,\n//   defaultCTA_URL,\n//   emailFooter,\n//   getEmailContent,\n// } from '../email-defaults';\n// import { addEmail, modifyEmail } from 'core/api/loans/server/methods';\n// export const sendEmail = new ValidatedMethod({\n//   name: 'sendEmail',\n//   mixins: [CallPromiseMixin],\n//   validate({\n//     emailId,\n//     loanId,\n//     template = 'notification',\n//     CTA_URL,\n//     sendAt,\n//     userId,\n//     intlValues,\n//   }) {\n//     check(emailId, String);\n//     check(loanId, String);\n//     check(template, Match.Optional(String));\n//     check(CTA_URL, Match.Optional(String));\n//     check(sendAt, Match.Optional(Date));\n//     check(userId, Match.Optional(String));\n//     check(intlValues, Match.Optional(Object));\n//   },\n//   run({\n//     emailId,\n//     loanId,\n//     template = 'notification',\n//     CTA_URL,\n//     sendAt,\n//     userId,\n//     intlValues,\n//   }) {\n//     const { email, subject, title, body, CTA } = getEmailContent(\n//       emailId,\n//       intlValues,\n//     );\n//     let toEmail;\n//     // When this is sent by an admin, use the userId to find the email to whom this should be sent to\n//     if (userId) {\n//       toEmail = Meteor.users.findOne(userId).emails[0].address;\n//     }\n//     toEmail = toEmail || email;\n//     // If this is a demo site, do not send emails\n//     if (\n//       this.connection &&\n//       this.connection.httpHeaders &&\n//       this.connection.httpHeaders.host.indexOf('demo') !== -1\n//     ) {\n//       return false;\n//     }\n//     const options = {\n//       template_name: template,\n//       template_content: [{ name: 'footer', content: emailFooter() }],\n//       message: {\n//         from_email: fromEmail,\n//         from_name: from,\n//         subject,\n//         to: [\n//           {\n//             email: toEmail,\n//             // name: 'Jon Snow',\n//             type: 'to',\n//           },\n//         ],\n//         merge_vars: [\n//           {\n//             rcpt: toEmail,\n//             vars: [\n//               { name: 'title', content: title },\n//               { name: 'body', content: body },\n//               { name: 'CTA', content: CTA },\n//               { name: 'CTA_URL', content: CTA_URL || defaultCTA_URL }, // overrides the global_merge_vars if it is set}\n//             ],\n//           },\n//         ],\n//         metadata: [{ userId: Meteor.userId(), loanId }],\n//       },\n//     };\n//     if (sendAt) {\n//       options.send_at = sendAt.toISOString();\n//     }\n//     // FIXME Mandrill can't be tested currently\n//     // https://github.com/Wylio/meteor-mandrill/issues/23\n//     if (Meteor.isTest) {\n//       return;\n//     }\n//     this.unblock();\n//     Mandrill.messages.sendTemplate(options, (error, result) => {\n//       if (error) {\n//         throw new Meteor.Error(error);\n//       }\n//       const content = JSON.parse(result.content)[0];\n//       return addEmail.call(\n//         {\n//           loanId,\n//           emailId,\n//           _id: content._id,\n//           status: content.status,\n//           sendAt,\n//         },\n//         (err) => {\n//           throw new Meteor.Error(err);\n//         },\n//       );\n//     });\n//   },\n// });\n// export const cancelScheduledEmail = new ValidatedMethod({\n//   name: 'cancelScheduledEmail',\n//   mixins: [CallPromiseMixin],\n//   validate({ id, loanId }) {\n//     check(id, String);\n//     check(loanId, String);\n//   },\n//   run({ id, loanId }) {\n//     this.unblock();\n//     Mandrill.messages.cancelScheduled({ id }, (error, result) => {\n//       if (error) {\n//         throw new Meteor.Error(error);\n//       }\n//       const content = JSON.parse(result.content);\n//       return modifyEmail.call(\n//         { loanId, _id: content._id, status: 'cancelled' },\n//         (err) => {\n//           throw new Meteor.Error(err);\n//         },\n//       );\n//     });\n//   },\n// });\n// export const rescheduleEmail = new ValidatedMethod({\n//   name: 'rescheduleEmail',\n//   mixins: [CallPromiseMixin],\n//   validate({ id, loanId, date }) {\n//     check(id, String);\n//     check(loanId, String);\n//     check(date, Date);\n//   },\n//   run({ id, loanId, date }) {\n//     this.unblock();\n//     Mandrill.messages.reschedule(\n//       { id, send_at: date.toISOString() },\n//       (error, result) => {\n//         if (error) {\n//           throw new Meteor.Error(error);\n//         }\n//         const content = JSON.parse(result.content);\n//         return modifyEmail.call({ loanId, _id: content._id, sendAt }, (err) => {\n//           throw new Meteor.Error(err);\n//         });\n//       },\n//     );\n//   },\n// });\n// // Send max 1 email per second\n// rateLimit({\n//   methods: [sendEmail, cancelScheduledEmail, rescheduleEmail],\n//   limit: 1,\n//   timeRange: 1000,\n// });\n\"use strict\";\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"emailConfigs.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/email/server/emailConfigs.js                                                                       //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar _EMAIL_TEMPLATES = void 0,\n    _EMAIL_IDS = void 0,\n    _CTA_URL_DEFAULT = void 0;\n\nmodule.watch(require(\"../emailConstants\"), {\n  EMAIL_TEMPLATES: function EMAIL_TEMPLATES(v) {\n    _EMAIL_TEMPLATES = v;\n  },\n  EMAIL_IDS: function EMAIL_IDS(v) {\n    _EMAIL_IDS = v;\n  },\n  CTA_URL_DEFAULT: function CTA_URL_DEFAULT(v) {\n    _CTA_URL_DEFAULT = v;\n  }\n}, 0);\n\nvar _getEnrollmentUrl = void 0,\n    _notificationTemplateDefaultOverride = void 0,\n    _notificationAndCtaTemplateDefaultOverride = void 0;\n\nmodule.watch(require(\"./emailHelpers\"), {\n  getEnrollmentUrl: function getEnrollmentUrl(v) {\n    _getEnrollmentUrl = v;\n  },\n  notificationTemplateDefaultOverride: function notificationTemplateDefaultOverride(v) {\n    _notificationTemplateDefaultOverride = v;\n  },\n  notificationAndCtaTemplateDefaultOverride: function notificationAndCtaTemplateDefaultOverride(v) {\n    _notificationAndCtaTemplateDefaultOverride = v;\n  }\n}, 1);\nvar emailConfigs = {};\nvar emailDefaults = {\n  allowUnsubscribe: false,\n  createIntlValues: function createIntlValues() {\n    return {\n      variables: []\n    };\n  }\n}; /**\n    * addEmailConfig - A function that creates a config for a given emailId\n    *\n    * @param {String} emailId A unique id representing the email, from EMAIL_IDS\n    * @param {Object} config A config object that can have the following keys:\n    * {Object} template A template object from EMAIL_TEMPLATES\n    * {Boolean} allowUnsubscribe Defines whether the email will be rendered with\n    * a footer that allows the user to unsubscribe to notifications.\n    * default is `false`\n    * {Function} createOverrides A function that takes the user's values and\n    * returns an object with overrides for the email template\n    * {Function} createIntlValues A function that takes the user's values and\n    * returns an object with intl values that need to be injected inside of the\n    * i18n strings\n    */\n\nvar addEmailConfig = function addEmailConfig(emailId, config) {\n  if (config.template === _EMAIL_TEMPLATES.NOTIFICATION) {\n    emailConfigs[emailId] = (0, _extends3.default)({\n      createOverrides: _notificationTemplateDefaultOverride\n    }, emailDefaults, config);\n  } else if (config.template === _EMAIL_TEMPLATES.NOTIFICATION_AND_CTA) {\n    emailConfigs[emailId] = (0, _extends3.default)({\n      createOverrides: _notificationAndCtaTemplateDefaultOverride\n    }, emailDefaults, config);\n  } else {\n    emailConfigs[emailId] = (0, _extends3.default)({}, emailDefaults, config);\n  }\n};\n\nvar verifyConfig = {\n  template: _EMAIL_TEMPLATES.WELCOME,\n  createOverrides: function createOverrides(_ref) {\n    var user = _ref.user,\n        url = _ref.url;\n    var variables = this.template.variables;\n    var urlWithoutHash = url.replace('#/', '');\n    return {\n      variables: [{\n        name: variables.VERIFICATION_URL,\n        content: urlWithoutHash\n      }]\n    };\n  }\n};\naddEmailConfig(_EMAIL_IDS.VERIFY_EMAIL, verifyConfig);\naddEmailConfig(_EMAIL_IDS.RESET_PASSWORD, {\n  template: _EMAIL_TEMPLATES.NOTIFICATION_AND_CTA,\n  createOverrides: function createOverrides(_ref2, _ref3) {\n    var user = _ref2.user,\n        url = _ref2.url;\n    var title = _ref3.title,\n        body = _ref3.body,\n        cta = _ref3.cta;\n    var variables = this.template.variables;\n    var urlWithoutHash = url.replace('#/', '');\n    return {\n      variables: [{\n        name: variables.TITLE,\n        content: title\n      }, {\n        name: variables.BODY,\n        content: body\n      }, {\n        name: variables.CTA,\n        content: cta\n      }, {\n        name: variables.CTA_URL,\n        content: urlWithoutHash || _CTA_URL_DEFAULT\n      }]\n    };\n  }\n});\naddEmailConfig(_EMAIL_IDS.ENROLL_ACCOUNT, {\n  template: _EMAIL_TEMPLATES.NOTIFICATION_AND_CTA,\n  createOverrides: function createOverrides(_ref4, _ref5) {\n    var user = _ref4.user,\n        url = _ref4.url;\n    var title = _ref5.title,\n        body = _ref5.body,\n        cta = _ref5.cta;\n    var variables = this.template.variables;\n\n    var enrollUrl = _getEnrollmentUrl(user, url);\n\n    return {\n      variables: [{\n        name: variables.TITLE,\n        content: title\n      }, {\n        name: variables.BODY,\n        content: body\n      }, {\n        name: variables.CTA,\n        content: cta\n      }, {\n        name: variables.CTA_URL,\n        content: enrollUrl || _CTA_URL_DEFAULT\n      }]\n    };\n  }\n});\naddEmailConfig(_EMAIL_IDS.VERIFICATION_REQUESTED, {\n  template: _EMAIL_TEMPLATES.NOTIFICATION\n});\naddEmailConfig(_EMAIL_IDS.VERIFICATION_ERROR, {\n  template: _EMAIL_TEMPLATES.NOTIFICATION_AND_CTA\n});\naddEmailConfig(_EMAIL_IDS.VERIFICATION_PASSED, {\n  template: _EMAIL_TEMPLATES.NOTIFICATION_AND_CTA\n});\naddEmailConfig(_EMAIL_IDS.AUCTION_STARTED, {\n  template: _EMAIL_TEMPLATES.NOTIFICATION_AND_CTA,\n  createIntlValues: function createIntlValues(_ref6) {\n    var auctionEndTime = _ref6.auctionEndTime;\n    return {\n      date: auctionEndTime\n    };\n  }\n});\naddEmailConfig(_EMAIL_IDS.AUCTION_ENDED, {\n  template: _EMAIL_TEMPLATES.NOTIFICATION_AND_CTA\n});\naddEmailConfig(_EMAIL_IDS.AUCTION_CANCELLED, {\n  template: _EMAIL_TEMPLATES.NOTIFICATION_AND_CTA\n});\nmodule.exportDefault(emailConfigs);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"emailHelpers.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/email/server/emailHelpers.js                                                                       //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.notificationAndCtaTemplateDefaultOverride = exports.notificationTemplateDefaultOverride = exports.getEmailFooter = undefined;\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.export({\n  getEmailFooter: function getEmailFooter() {\n    return _getEmailFooter;\n  },\n  getEmailPart: function getEmailPart() {\n    return _getEmailPart;\n  },\n  getEmailContent: function getEmailContent() {\n    return _getEmailContent;\n  },\n  getEnrollmentUrl: function getEnrollmentUrl() {\n    return _getEnrollmentUrl;\n  },\n  notificationTemplateDefaultOverride: function notificationTemplateDefaultOverride() {\n    return _notificationTemplateDefaultOverride;\n  },\n  notificationAndCtaTemplateDefaultOverride: function notificationAndCtaTemplateDefaultOverride() {\n    return _notificationAndCtaTemplateDefaultOverride;\n  }\n});\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\nvar formatMessage = void 0;\nmodule.watch(require(\"../../../utils/intl\"), {\n  default: function _default(v) {\n    formatMessage = v;\n  }\n}, 1);\n\nvar _FROM_DEFAULT = void 0,\n    _CTA_URL_DEFAULT = void 0,\n    _EMAIL_I18N_NAMESPACE = void 0,\n    _EMAIL_PARTS = void 0;\n\nexports.getEmailFooter = _getEmailFooter;\nmodule.watch(require(\"../emailConstants\"), {\n  FROM_DEFAULT: function FROM_DEFAULT(v) {\n    _FROM_DEFAULT = v;\n  },\n  CTA_URL_DEFAULT: function CTA_URL_DEFAULT(v) {\n    _CTA_URL_DEFAULT = v;\n  },\n  EMAIL_I18N_NAMESPACE: function EMAIL_I18N_NAMESPACE(v) {\n    _EMAIL_I18N_NAMESPACE = v;\n  },\n  EMAIL_PARTS: function EMAIL_PARTS(v) {\n    _EMAIL_PARTS = v;\n  }\n}, 2);\nvar WWW_URL = _Meteor.settings.public.subdomains.www;\nvar APP_URL = _Meteor.settings.public.subdomains.app; /**\n                                                       * emailFooter - Returns the default email footer for all emails\n                                                       *\n                                                       * @param {boolean} [unsubscribe=true] Whether to show an unsubscribe line or not\n                                                       *\n                                                       * @return {type} a HTML string\n                                                       */\n\nvar _getEmailFooter = function _getEmailFooter() {\n  var allowUnsubscribe = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n  return formatMessage('emails.footer', {\n    copyright: '<em>&copy; *|CURRENT_YEAR|* e-Potek</em><br /><br />',\n    url: \"<a href=\\\"\" + WWW_URL + \"\\\" target=\\\"_blank\\\">e-potek.ch</a><br />\",\n    unsubscribe: allowUnsubscribe ? \"<a href=\\\"*|UNSUB|*\\\">\" + formatMessage('emails.unsubscribe') + \"</a>\" : ''\n  });\n};\n\nexports.notificationTemplateDefaultOverride = _notificationTemplateDefaultOverride;\n\nvar _getEmailPart = function _getEmailPart(_ref) {\n  var emailId = _ref.emailId,\n      part = _ref.part,\n      _ref$intlValues = _ref.intlValues,\n      intlValues = _ref$intlValues === undefined ? {} : _ref$intlValues,\n      _ref$intlFallback = _ref.intlFallback,\n      intlFallback = _ref$intlFallback === undefined ? '' : _ref$intlFallback;\n  return formatMessage(_EMAIL_I18N_NAMESPACE + \".\" + emailId + \".\" + part, intlValues, intlFallback);\n};\n\nexports.notificationAndCtaTemplateDefaultOverride = _notificationAndCtaTemplateDefaultOverride;\n\nvar _getEmailContent = function _getEmailContent(emailId, intlValues) {\n  var subject = _getEmailPart({\n    emailId: emailId,\n    part: _EMAIL_PARTS.SUBJECT\n  });\n\n  var title = _getEmailPart({\n    emailId: emailId,\n    part: _EMAIL_PARTS.TITLE\n  });\n\n  var body = _getEmailPart({\n    emailId: emailId,\n    part: _EMAIL_PARTS.BODY,\n    intlValues: (0, _extends3.default)({\n      verticalSpace: '<span><br/><br/></span>'\n    }, intlValues)\n  });\n\n  var cta = _getEmailPart({\n    emailId: emailId,\n    part: _EMAIL_PARTS.CTA,\n    intlValues: intlValues,\n    intlFallback: _CTA_URL_DEFAULT\n  });\n\n  var customFrom = _getEmailPart({\n    emailId: emailId,\n    part: _EMAIL_PARTS.FROM,\n    intlValues: intlValues,\n    intlFallback: _FROM_DEFAULT\n  });\n\n  return {\n    subject: subject,\n    title: title,\n    body: body,\n    cta: cta,\n    from: customFrom\n  };\n};\n\nvar _getEnrollmentUrl = function _getEnrollmentUrl(user, url) {\n  if (user.roles === 'user' || user.roles.indexOf('user') >= 0) {\n    var enrollToken = url.split('/enroll-account/')[1];\n    return APP_URL + \"/enroll-account/\" + enrollToken;\n  }\n\n  return url;\n};\n\n/**\n * This is a default override function for the NOTIFICATION template\n *\n * @export\n * @param {Object} params The params passed by the mutation\n * @param {Object} { title, body } The strings extracted from i18n files\n * @returns a template override object\n */function _notificationTemplateDefaultOverride(params, _ref2) {\n  var title = _ref2.title,\n      body = _ref2.body;\n  var variables = this.template.variables;\n  return {\n    variables: [{\n      name: variables.TITLE,\n      content: title\n    }, {\n      name: variables.BODY,\n      content: body\n    }]\n  };\n} /**\n   * This is a default override function for the NOTIFICATION_AND_CTA template\n   *\n   * @export\n   * @param {Object} params The params passed by the mutation\n   * @param {Object} { title, body, cta } The strings extracted from i18n files\n   * @returns a template override object\n   */\n\nfunction _notificationAndCtaTemplateDefaultOverride(params, _ref3) {\n  var title = _ref3.title,\n      body = _ref3.body,\n      cta = _ref3.cta;\n  var variables = this.template.variables;\n  return {\n    variables: [{\n      name: variables.TITLE,\n      content: title\n    }, {\n      name: variables.BODY,\n      content: body\n    }, {\n      name: variables.CTA,\n      content: cta\n    }, {\n      name: variables.CTA_URL,\n      content: _CTA_URL_DEFAULT\n    }]\n  };\n}\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"emailListeners.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/email/server/emailListeners.js                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar moment = void 0;\nmodule.watch(require(\"moment\"), {\n  default: function _default(v) {\n    moment = v;\n  }\n}, 0);\nvar EventService = void 0;\nmodule.watch(require(\"../../events\"), {\n  default: function _default(v) {\n    EventService = v;\n  }\n}, 1);\n\nvar _mutations = void 0;\n\nmodule.watch(require(\"../../mutations\"), {\n  mutations: function mutations(v) {\n    _mutations = v;\n  }\n}, 2);\n\nvar _Loans = void 0;\n\nmodule.watch(require(\"../..\"), {\n  Loans: function Loans(v) {\n    _Loans = v;\n  }\n}, 3);\n\nvar _EMAIL_IDS = void 0;\n\nmodule.watch(require(\"../emailConstants\"), {\n  EMAIL_IDS: function EMAIL_IDS(v) {\n    _EMAIL_IDS = v;\n  }\n}, 4);\n\nvar _sendEmail = void 0;\n\nmodule.watch(require(\"./emailMethods\"), {\n  sendEmail: function sendEmail(v) {\n    _sendEmail = v;\n  }\n}, 5);\n\nvar _getAuctionEndTime = void 0;\n\nmodule.watch(require(\"../../../utils/loanFunctions\"), {\n  getAuctionEndTime: function getAuctionEndTime(v) {\n    _getAuctionEndTime = v;\n  }\n}, 6);\nEventService.addMutationListener(_mutations.REQUEST_LOAN_VERIFICATION, function (params) {\n  var loanId = params.loanId;\n\n  var _Loans$findOne = _Loans.findOne(loanId),\n      userId = _Loans$findOne.userId;\n\n  return _sendEmail({\n    emailId: _EMAIL_IDS.VERIFICATION_REQUESTED,\n    userId: userId,\n    params: params\n  });\n});\nEventService.addMutationListener(_mutations.START_AUCTION, function (params) {\n  var loanId = params.loanId;\n\n  var _Loans$findOne2 = _Loans.findOne(loanId),\n      userId = _Loans$findOne2.userId;\n\n  return _sendEmail({\n    emailId: _EMAIL_IDS.AUCTION_STARTED,\n    userId: userId,\n    params: (0, _extends3.default)({}, params, {\n      auctionEndTime: _getAuctionEndTime(moment())\n    })\n  });\n});\nEventService.addMutationListener(_mutations.END_AUCTION, function (params) {\n  var loanId = params.loanId;\n\n  var _Loans$findOne3 = _Loans.findOne(loanId),\n      userId = _Loans$findOne3.userId;\n\n  return _sendEmail({\n    emailId: _EMAIL_IDS.AUCTION_ENDED,\n    userId: userId,\n    params: params\n  });\n});\nEventService.addMutationListener(_mutations.CANCEL_AUCTION, function (params) {\n  var loanId = params.loanId;\n\n  var _Loans$findOne4 = _Loans.findOne(loanId),\n      userId = _Loans$findOne4.userId;\n\n  return _sendEmail({\n    emailId: _EMAIL_IDS.AUCTION_CANCELLED,\n    userId: userId,\n    params: params\n  });\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"emailMethods.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/email/server/emailMethods.js                                                                       //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.sendEmail = undefined;\n\nvar _defineProperty2 = require(\"babel-runtime/helpers/defineProperty\");\n\nvar _defineProperty3 = _interopRequireDefault(_defineProperty2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.export({\n  sendEmail: function sendEmail() {\n    return _sendEmail;\n  }\n});\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\nvar EmailService = void 0;\nmodule.watch(require(\"./EmailService\"), {\n  default: function _default(v) {\n    EmailService = v;\n  }\n}, 1);\nexports.sendEmail = _sendEmail;\nvar SEND_EMAIL = 'SEND_EMAIL';\n\n_Meteor.methods((0, _defineProperty3.default)({}, SEND_EMAIL, function (_ref) {\n  var emailId = _ref.emailId,\n      userId = _ref.userId,\n      params = _ref.params;\n  this.unblock();\n\n  try {\n    EmailService.sendEmailToUser(emailId, userId, params);\n  } catch (error) {\n    throw error;\n  }\n}));\n\nvar _sendEmail = function _sendEmail(params) {\n  return _Meteor.call(SEND_EMAIL, params);\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/email/server/index.js                                                                              //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nmodule.watch(require(\"./accountsEmails\"));\nmodule.watch(require(\"./emailMethods\"));\n\nvar _setupMandrill = void 0;\n\nmodule.watch(require(\"./mandrill\"), {\n  setupMandrill: function setupMandrill(v) {\n    _setupMandrill = v;\n  }\n}, 0);\n\n_setupMandrill();\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"mandrill.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/email/server/mandrill.js                                                                           //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  setupMandrill: function setupMandrill() {\n    return _setupMandrill;\n  },\n  getSimpleMandrillTemplate: function getSimpleMandrillTemplate() {\n    return _getSimpleMandrillTemplate;\n  },\n  getMandrillTemplate: function getMandrillTemplate() {\n    return _getMandrillTemplate;\n  },\n  renderMandrillTemplate: function renderMandrillTemplate() {\n    return _renderMandrillTemplate;\n  },\n  sendMandrillTemplate: function sendMandrillTemplate() {\n    return _sendMandrillTemplate;\n  }\n});\n\nvar _Mandrill = void 0;\n\nmodule.watch(require(\"meteor/wylio:mandrill\"), {\n  Mandrill: function Mandrill(v) {\n    _Mandrill = v;\n  }\n}, 0);\n\nvar _Meteor = void 0;\n\nexports.setupMandrill = _setupMandrill;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 1);\n\nvar _getEmailFooter = void 0;\n\nmodule.watch(require(\"./emailHelpers\"), {\n  getEmailFooter: function getEmailFooter(v) {\n    _getEmailFooter = v;\n  }\n}, 2);\n\nvar _setupMandrill = function _setupMandrill() {\n  var key = '';\n\n  if (_Meteor.isTest) {\n    key = _Meteor.settings.MANDRILL_API_KEY_TEST;\n  } else {\n    key = _Meteor.settings.MANDRILL_API_KEY;\n  }\n\n  _Mandrill.config({\n    username: _Meteor.settings.MANDRILL_LOGIN,\n    // the email address you log into Mandrill with. Only used to set MAIL_URL.\n    key: key,\n    // get your Mandrill key from https://mandrillapp.com/settings/index\n    port: 587,\n    // defaults to 465 for SMTP over TLS\n    host: 'smtps.mandrillapp.com' // the SMTP host\n    // baseUrl: 'https://mandrillapp.com/api/1.0/'  // update this in case Mandrill changes its API endpoint URL or version\n\n  });\n}; // Used for Meteor Accounts emails\n\n\nvar _getSimpleMandrillTemplate = function _getSimpleMandrillTemplate(options) {\n  var templateName = options.templateName,\n      allowUnsubscribe = options.allowUnsubscribe,\n      variables = options.variables;\n  return {\n    template_name: templateName,\n    template_content: [{\n      name: 'footer',\n      content: _getEmailFooter(allowUnsubscribe)\n    }],\n    merge_vars: variables\n  };\n};\n\nvar _getMandrillTemplate = function _getMandrillTemplate(_ref) {\n  var templateName = _ref.templateName,\n      allowUnsubscribe = _ref.allowUnsubscribe,\n      variables = _ref.variables,\n      recipientAddress = _ref.recipientAddress,\n      senderAddress = _ref.senderAddress,\n      senderName = _ref.senderName,\n      subject = _ref.subject,\n      sendAt = _ref.sendAt;\n  return {\n    template_name: templateName,\n    template_content: [{\n      name: 'footer',\n      content: _getEmailFooter(allowUnsubscribe)\n    }],\n    message: {\n      from_email: senderAddress,\n      from_name: senderName,\n      subject: subject,\n      to: [{\n        email: recipientAddress,\n        type: 'to'\n      }],\n      merge_vars: [{\n        rcpt: recipientAddress,\n        vars: variables\n      }]\n    },\n    send_at: sendAt ? sendAt.toISOString() : undefined\n  };\n};\n\nvar _renderMandrillTemplate = function _renderMandrillTemplate(mandrillTemplate) {\n  return _Mandrill.templates.render(mandrillTemplate);\n};\n\nvar _sendMandrillTemplate = function _sendMandrillTemplate(mandrillTemplate) {\n  return new Promise(function (resolve, reject) {\n    _Mandrill.messages.sendTemplate(mandrillTemplate, function (error, result) {\n      if (error) {\n        reject(error);\n      }\n\n      var content = JSON.parse(result.content)[0];\n      resolve(content);\n    });\n  });\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"emailConstants.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/email/emailConstants.js                                                                            //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  FROM_NAME: function FROM_NAME() {\n    return _FROM_NAME;\n  },\n  FROM_EMAIL: function FROM_EMAIL() {\n    return _FROM_EMAIL;\n  },\n  FROM_DEFAULT: function FROM_DEFAULT() {\n    return _FROM_DEFAULT;\n  },\n  CTA_URL_DEFAULT: function CTA_URL_DEFAULT() {\n    return _CTA_URL_DEFAULT;\n  },\n  EMAIL_I18N_NAMESPACE: function EMAIL_I18N_NAMESPACE() {\n    return _EMAIL_I18N_NAMESPACE;\n  },\n  EMAIL_PARTS: function EMAIL_PARTS() {\n    return _EMAIL_PARTS;\n  },\n  EMAIL_TEMPLATES: function EMAIL_TEMPLATES() {\n    return _EMAIL_TEMPLATES;\n  },\n  EMAIL_IDS: function EMAIL_IDS() {\n    return _EMAIL_IDS;\n  }\n});\n\nvar _Meteor = void 0;\n\nexports.FROM_NAME = _FROM_NAME;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\nvar _FROM_NAME = \"Yannis d'e-Potek\";\nvar _FROM_EMAIL = 'info@e-potek.ch';\n\nvar _FROM_DEFAULT = _FROM_NAME + \" <\" + _FROM_EMAIL + \">\";\n\nvar _CTA_URL_DEFAULT = _Meteor.settings.public.subdomains.app;\nvar _EMAIL_I18N_NAMESPACE = 'emails';\nvar _EMAIL_PARTS = {\n  SUBJECT: 'SUBJECT',\n  TITLE: 'TITLE',\n  BODY: 'BODY',\n  CTA: 'CTA',\n  FROM: 'FROM'\n};\nvar _EMAIL_TEMPLATES = {\n  WELCOME: {\n    name: 'WELCOME',\n    mandrillId: 'welcome',\n    variables: {\n      VERIFICATION_URL: 'VERIFICATION_URL'\n    }\n  },\n  NOTIFICATION: {\n    name: 'NOTIFICATION',\n    mandrillId: 'notification',\n    variables: {\n      TITLE: 'TITLE',\n      BODY: 'BODY'\n    }\n  },\n  NOTIFICATION_AND_CTA: {\n    name: 'NOTIFICATION_AND_CTA',\n    mandrillId: 'notification-cta',\n    variables: {\n      TITLE: 'TITLE',\n      BODY: 'BODY',\n      CTA: 'CTA',\n      CTA_URL: 'CTA_URL'\n    }\n  }\n};\nvar _EMAIL_IDS = {\n  VERIFY_EMAIL: 'VERIFY_EMAIL',\n  RESET_PASSWORD: 'RESET_PASSWORD',\n  ENROLL_ACCOUNT: 'ENROLL_ACCOUNT',\n  VERIFICATION_REQUESTED: 'VERIFICATION_REQUESTED',\n  VERIFICATION_ERROR: 'VERIFICATION_ERROR',\n  VERIFICATION_PASSED: 'VERIFICATION_PASSED',\n  AUCTION_STARTED: 'AUCTION_STARTED',\n  AUCTION_ENDED: 'AUCTION_ENDED',\n  AUCTION_CANCELLED: 'AUCTION_CANCELLED'\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"files\":{\"server\":{\"methods.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/files/server/methods.js                                                                            //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  isAllowed: function isAllowed() {\n    return _isAllowed;\n  }\n});\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\nvar AWS = void 0;\nmodule.watch(require(\"aws-sdk\"), {\n  default: function _default(v) {\n    AWS = v;\n  }\n}, 1);\n\nvar _check = void 0;\n\nmodule.watch(require(\"meteor/check\"), {\n  check: function check(v) {\n    _check = v;\n  }\n}, 2);\n\nvar _Roles = void 0;\n\nexports.isAllowed = _isAllowed;\nmodule.watch(require(\"meteor/alanning:roles\"), {\n  Roles: function Roles(v) {\n    _Roles = v;\n  }\n}, 3);\nvar rateLimit = void 0;\nmodule.watch(require(\"../../../utils/rate-limit.js\"), {\n  default: function _default(v) {\n    rateLimit = v;\n  }\n}, 4);\nvar Loans = void 0;\nmodule.watch(require(\"../../loans/loans\"), {\n  default: function _default(v) {\n    Loans = v;\n  }\n}, 5);\nvar Borrowers = void 0;\nmodule.watch(require(\"../../borrowers/borrowers\"), {\n  default: function _default(v) {\n    Borrowers = v;\n  }\n}, 6);\n\n/* eslint import/prefer-default-export: 0 */var _isAllowed = function _isAllowed(key) {\n  // Check if this user is the owner of the document he's trying to delete a\n  // file from\n  var keyId = key.split('/')[0];\n  var loanFound = !!Loans.findOne({\n    _id: keyId,\n    userId: _Meteor.userId()\n  });\n  var borrowerFound = !!Borrowers.findOne({\n    _id: keyId,\n    userId: _Meteor.userId()\n  });\n\n  if (_Roles.userIsInRole(_Meteor.userId(), 'admin') || _Roles.userIsInRole(_Meteor.userId(), 'dev')) {\n    return true;\n  } else if (!(loanFound || borrowerFound)) {\n    throw new _Meteor.Error('unauthorized email');\n  }\n\n  return true;\n};\n\nvar setupS3 = function setupS3() {\n  AWS.config.update({\n    accessKeyId: _Meteor.settings.AWS.users.accessKeyId,\n    secretAccessKey: _Meteor.settings.AWS.users.secretAccesskey\n  });\n  return new AWS.S3({\n    signatureVersion: 'v4'\n  });\n};\n\n_Meteor.methods({\n  deleteFile: function deleteFile(key) {\n    _check(key, String);\n\n    _isAllowed(key);\n\n    var s3 = setupS3();\n    var params = {\n      Bucket: _Meteor.settings.S3Bucket,\n      Key: key\n    }; // bind s3 to avoid an error of context 'makeLoan is not a function'\n\n    var async = _Meteor.wrapAsync(s3.deleteObject.bind(s3));\n\n    return async(params);\n  },\n  downloadFile: function downloadFile(key) {\n    _check(key, String);\n\n    _isAllowed(key);\n\n    var s3 = setupS3();\n    var params = {\n      Bucket: _Meteor.settings.S3Bucket,\n      Key: key\n    }; // Don't ask me why this works...\n    // https://gist.github.com/rclai/b9331afd2fbabadb0074\n\n    var async = _Meteor.wrapAsync(function (parameters, callback) {\n      return s3.getObject(parameters, function (error, data) {\n        callback(error, data);\n      });\n    });\n\n    return async(params);\n  }\n});\n\nrateLimit({\n  methods: ['deleteFile', 'downloadFile']\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"fileConstants.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/files/fileConstants.js                                                                             //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  FILE_STATUS: function FILE_STATUS() {\n    return _FILE_STATUS;\n  }\n});\nexports.FILE_STATUS = _FILE_STATUS;\nvar _FILE_STATUS = {\n  UNVERIFIED: 'UNVERIFIED',\n  VALID: 'VALID',\n  ERROR: 'ERROR'\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"files.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/files/files.js                                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nmodule.export({\n  borrowerFiles: function borrowerFiles() {\n    return _borrowerFiles;\n  },\n  loanFiles: function loanFiles() {\n    return _loanFiles;\n  },\n  propertyFiles: function propertyFiles() {\n    return _propertyFiles;\n  },\n  getFileIDs: function getFileIDs() {\n    return _getFileIDs;\n  },\n  FileSchema: function FileSchema() {\n    return _FileSchema;\n  },\n  getFileSchema: function getFileSchema() {\n    return _getFileSchema;\n  },\n  fakeFile: function fakeFile() {\n    return _fakeFile;\n  },\n  getFileCount: function getFileCount() {\n    return _getFileCount;\n  }\n});\nvar SimpleSchema = void 0;\nmodule.watch(require(\"simpl-schema\"), {\n  default: function _default(v) {\n    SimpleSchema = v;\n  }\n}, 0);\nexports.borrowerFiles = _borrowerFiles;\n\nvar _FILE_STATUS = void 0,\n    _PURCHASE_TYPE = void 0,\n    _USAGE_TYPE = void 0;\n\nmodule.watch(require(\"../constants\"), {\n  FILE_STATUS: function FILE_STATUS(v) {\n    _FILE_STATUS = v;\n  },\n  PURCHASE_TYPE: function PURCHASE_TYPE(v) {\n    _PURCHASE_TYPE = v;\n  },\n  USAGE_TYPE: function USAGE_TYPE(v) {\n    _USAGE_TYPE = v;\n  }\n}, 1);\n\nvar _borrowerFiles = function _borrowerFiles() {\n  var b = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return {\n    auction: [{\n      id: 'identity'\n    }, {\n      id: 'residencyPermit',\n      condition: !b.isSwiss\n    }, {\n      id: 'taxes' // condition: true, //TODO: implement married couple logic\n\n    }, {\n      id: 'salaryCertificate'\n    }, {\n      id: 'bonus',\n      condition: !!b.bonus && Object.keys(b.bonus).length > 0\n    }, {\n      id: 'otherIncome',\n      condition: b.otherIncome && !!(b.otherIncome.length > 0)\n    }, {\n      id: 'ownCompanyFinancialStatements',\n      condition: !!b.worksForOwnCompany\n    }, {\n      id: 'divorceJudgment',\n      condition: !b.civilStatus === 'divorced',\n      noTooltips: true\n    }, {\n      id: 'expenses',\n      condition: !!b.otherIncome && !!(b.otherIncome.length > 0)\n    }],\n    contract: [{\n      id: 'nonPursuitExtract',\n      doubleTooltip: true\n    }, {\n      id: 'lastSalaries',\n      noTooltips: true\n    }, {\n      id: 'currentMortgages',\n      condition: !!b.realEstate && !!b.realEstate.length > 0\n    }, {\n      id: 'bankAssetsChange',\n      condition: b.fortuneChange\n    }, {\n      id: 'pensionFundYearlyStatement',\n      condition: b.insuranceSecondPillar > 0,\n      doubleTooltip: true\n    }, {\n      id: 'retirementInsurancePlan',\n      condition: b.insuranceThirdPillar > 0,\n      // TODO, separate from insurance and other below\n      doubleTooltip: true\n    }, {\n      id: 'retirementPlanOther',\n      // condition: true, TODO\n      condition: false,\n      doubleTooltip: true\n    }],\n    closing: [],\n    all: function all() {\n      return [].concat(_toConsumableArray(this.auction), _toConsumableArray(this.contract), _toConsumableArray(this.closing));\n    }\n  };\n};\n\nvar _loanFiles = function _loanFiles() {\n  var r = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return {\n    auction: [// {\n      //   id: 'plans',\n      // },\n      // {\n      //   id: 'cubage',\n      //   doubleTooltip: true,\n      //   condition: r.propertyId && r.propertyId.style === 'villa',\n      // },\n      // {\n      //   id: 'pictures',\n      // },\n      // {\n      //   id: 'marketingBrochure',\n      //   condition: !!r.general && r.general.purchaseType === 'acquisition',\n      //   required: false,\n      // },\n    ],\n    contract: [{\n      id: 'buyersContract',\n      tooltipSuffix: !!r.general && r.general.purchaseType === 'refinancing' ? 'a' : 'b'\n    }, {\n      id: 'reimbursementStatement',\n      condition: !!r.general && r.general.purchaseType === 'refinancing'\n    }, {\n      id: 'rent',\n      condition: !!r.general && r.general.usageType === 'investment',\n      doubleTooltip: true\n    }, {\n      id: 'coownershipAllocationAgreement',\n      condition: !!r.propertyId && !!r.propertyId.isCoproperty,\n      doubleTooltip: true\n    }, {\n      id: 'coownershipAgreement',\n      condition: !!r.propertyId && !!r.propertyId.isCoproperty,\n      doubleTooltip: true\n    }, {\n      id: 'fireAndWaterInsurance',\n      condition: !!(r.propertyId && r.propertyId.isNew)\n    }],\n    closing: [],\n    // closing: [\n    //   {\n    //     id: 'retirementWithdrawalStatement',\n    //     label: 'Attestation LPP - après retrait',\n    //     help1: 'Certificat émis sur votre demande par votre caisse de pension démontrant votre situation LPP après retrait',\n    //     help2: 'Vous pouvez obtenir ce document, sur demande, auprès de votre caisse de pension',\n    //     condition: !!r.logic && r.insuranceUsePreset === 'withdrawal',\n    //   },\n    // ],\n    other: [{\n      id: 'upload0'\n    }, {\n      id: 'upload1'\n    }, {\n      id: 'upload2'\n    }, {\n      id: 'upload3'\n    }, {\n      id: 'upload4'\n    }],\n    admin: [{\n      id: 'contract'\n    }, {\n      id: 'signedContract'\n    }],\n    all: function all() {\n      return [].concat(_toConsumableArray(this.auction), _toConsumableArray(this.contract), _toConsumableArray(this.closing), _toConsumableArray(this.admin), _toConsumableArray(this.other));\n    }\n  };\n};\n\nvar _propertyFiles = function _propertyFiles() {\n  var property = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var loan = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return {\n    auction: [{\n      id: 'plans'\n    }, {\n      id: 'cubage',\n      doubleTooltip: true,\n      condition: property.style === 'villa'\n    }, {\n      id: 'pictures'\n    }, {\n      id: 'marketingBrochure',\n      condition: !!(loan && loan.general && loan.general.purchaseType === _PURCHASE_TYPE.ACQUISITION),\n      required: false\n    }],\n    contract: [{\n      id: 'rent',\n      condition: !!loan.general && loan.general.usageType === _USAGE_TYPE.INVESTMENT,\n      doubleTooltip: true\n    }, {\n      id: 'landRegisterExtract',\n      doubleTooltip: true\n    }],\n    all: function all() {\n      return [].concat(_toConsumableArray(this.auction), _toConsumableArray(this.contract));\n    }\n  };\n};\n\nvar _getFileIDs = function _getFileIDs(list) {\n  var files = void 0;\n  var ids = [];\n\n  switch (list) {\n    case 'borrower':\n      files = _borrowerFiles();\n      break;\n\n    case 'loan':\n      files = _loanFiles();\n      break;\n\n    case 'property':\n      files = _propertyFiles();\n      break;\n\n    default:\n      throw new Error('invalid file list');\n  }\n\n  files.all().forEach(function (f) {\n    return ids.push(f.id);\n  });\n  return ids;\n};\n\nvar _FileSchema = new SimpleSchema({\n  name: String,\n  initialName: String,\n  size: Number,\n  type: String,\n  url: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Url\n  },\n  key: String,\n  fileCount: Number,\n  status: {\n    type: String,\n    allowedValues: Object.values(_FILE_STATUS)\n  },\n  error: {\n    optional: true,\n    type: String\n  }\n});\n\nvar _getFileSchema = function _getFileSchema(list) {\n  var schema = {};\n\n  var arr = _getFileIDs(list);\n\n  arr.forEach(function (id) {\n    schema[id] = {\n      type: Array,\n      optional: true,\n      maxCount: 100\n    };\n    schema[id + \".$\"] = _FileSchema;\n  });\n  return schema;\n};\n\nvar _fakeFile = {\n  name: 'fakeFile.pdf',\n  initialName: 'fakeFile.pdf',\n  size: 10000,\n  type: 'application/pdf',\n  url: 'https://www.fake-url.com',\n  key: 'asdf/fakeKey/fakeFile.pdf',\n  fileCount: 0,\n  status: _FILE_STATUS.VALID,\n  error: ''\n};\n\nvar _getFileCount = function _getFileCount(currentValue) {\n  var fileCountString = '00';\n  var fileCount = 0;\n\n  if (currentValue && currentValue.length > 0) {\n    // If something goes wrong, minimum should be -1 + 1 = 0\n    fileCount = Math.max.apply(Math, _toConsumableArray(currentValue.map(function (f) {\n      return f.fileCount;\n    })).concat([-1])) + 1;\n    fileCountString = fileCount < 10 ? \"0\" + fileCount : \"\" + fileCount;\n  }\n\n  return {\n    fileCount: fileCount,\n    fileCountString: fileCountString\n  };\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"meteor-slingshot-server.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/files/meteor-slingshot-server.js                                                                   //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _Slingshot = void 0;\n\nmodule.watch(require(\"meteor/edgee:slingshot\"), {\n  Slingshot: function Slingshot(v) {\n    _Slingshot = v;\n  }\n}, 1);\n\nvar _Roles = void 0;\n\nmodule.watch(require(\"meteor/alanning:roles\"), {\n  Roles: function Roles(v) {\n    _Roles = v;\n  }\n}, 2);\nvar Loans = void 0;\nmodule.watch(require(\"../loans/loans\"), {\n  default: function _default(v) {\n    Loans = v;\n  }\n}, 3);\nvar Borrowers = void 0;\nmodule.watch(require(\"../borrowers/borrowers\"), {\n  default: function _default(v) {\n    Borrowers = v;\n  }\n}, 4);\n\nvar _getFileCount = void 0;\n\nmodule.watch(require(\"./files\"), {\n  getFileCount: function getFileCount(v) {\n    _getFileCount = v;\n  }\n}, 5);\nmodule.watch(require(\"./meteor-slingshot\"));\n\n_Slingshot.createDirective('myFileUploads', _Slingshot.S3Storage, {\n  authorize: function authorize(file, _ref) {\n    var collection = _ref.collection,\n        docId = _ref.docId;\n\n    // Don't use arrow function, this is the current object here\n    // Check for devs and admins\n    if (_Roles.userIsInRole(this.userId, 'admin') || _Roles.userIsInRole(this.userId, 'dev')) {\n      return true;\n    } // Deny uploads if user is not logged in.\n\n\n    if (!this.userId) {\n      throw new _Meteor.Error('Login Required', 'Please login before uploading files');\n    } // Make sure this user is the owner of the document\n\n\n    if (collection === 'borrowers') {\n      var doc = Borrowers.findOne(docId);\n\n      if (doc.userId !== this.userId) {\n        throw new _Meteor.Error('Invalid user', \"You're not allowed to do this\");\n      }\n    } else if (collection === 'loans') {\n      var _doc = Loans.findOne(docId);\n\n      if (_doc.userId !== this.userId) {\n        throw new _Meteor.Error('Invalid user', \"You're not allowed to do this\");\n      }\n    } else {\n      throw new _Meteor.Error('Invalid collection', \"Collection doesn't exist\");\n    }\n\n    return true;\n  },\n  key: function key(file, _ref2) {\n    var currentValue = _ref2.currentValue,\n        docId = _ref2.docId,\n        id = _ref2.id;\n\n    var _getFileCount2 = _getFileCount(currentValue),\n        fileCountString = _getFileCount2.fileCountString;\n\n    return docId + \"/\" + id + \"/\" + fileCountString + file.name;\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"meteor-slingshot.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/files/meteor-slingshot.js                                                                          //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  allowedFileTypes: function allowedFileTypes() {\n    return _allowedFileTypes;\n  },\n  maxSize: function maxSize() {\n    return _maxSize;\n  }\n});\n\nvar _Slingshot = void 0;\n\nexports.allowedFileTypes = _allowedFileTypes;\nmodule.watch(require(\"meteor/edgee:slingshot\"), {\n  Slingshot: function Slingshot(v) {\n    _Slingshot = v;\n  }\n}, 0);\nvar _allowedFileTypes = ['image/png', 'image/jpeg', 'application/pdf'];\n\nvar _maxSize = 50 * 1024 * 1024;\n\n// 50 MB (use null for unlimited).\n_Slingshot.fileRestrictions('myFileUploads', {\n  allowedFileTypes: _allowedFileTypes,\n  maxSize: _maxSize\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"jobs\":{\"server\":{\"JobService.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/jobs/server/JobService.js                                                                          //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar _Job = void 0;\n\nmodule.watch(require(\"meteor/vsivsi:job-collection\"), {\n  Job: function Job(v) {\n    _Job = v;\n  }\n}, 0);\nvar Jobs = void 0;\nmodule.watch(require(\"./jobs\"), {\n  default: function _default(v) {\n    Jobs = v;\n  }\n}, 1);\n\nvar _SCHEDULE_METHOD = void 0;\n\nmodule.watch(require(\"./jobConstants\"), {\n  SCHEDULE_METHOD: function SCHEDULE_METHOD(v) {\n    _SCHEDULE_METHOD = v;\n  }\n}, 2);\n\nvar JobService = function JobService() {\n  var _this = this;\n\n  (0, _classCallCheck3.default)(this, JobService);\n\n  this.scheduleMethod = function (_ref) {\n    var method = _ref.method,\n        params = _ref.params,\n        date = _ref.date;\n    var jobId = new _Job(Jobs, _SCHEDULE_METHOD, {\n      method: method,\n      params: params\n    }).after(date).save();\n    return jobId;\n  };\n\n  this.scheduleMutation = function (_ref2) {\n    var name = _ref2.mutation.name,\n        params = _ref2.params,\n        date = _ref2.date;\n    return _this.scheduleMethod({\n      method: name,\n      params: params,\n      date: date\n    });\n  };\n\n  this.cancelJob = function (_ref3) {\n    var jobId = _ref3.jobId;\n    return Jobs.cancelJobs([jobId]);\n  };\n\n  this.removeJob = function (_ref4) {\n    var jobId = _ref4.jobId;\n    return Jobs.removeJobs([jobId]);\n  };\n\n  this.cancelExistingJob = function (_ref5) {\n    var method = _ref5.method,\n        params = _ref5.params;\n    var job = Jobs.findOne({\n      'data.method': method,\n      'data.params': params\n    });\n\n    if (job && job._id) {\n      _this.cancelJob({\n        jobId: job._id\n      });\n    }\n  };\n\n  this.cancelExistingMutationJob = function (_ref6) {\n    var name = _ref6.mutation.name,\n        params = _ref6.params;\n\n    _this.cancelExistingJob({\n      method: name,\n      params: params\n    });\n  };\n};\n\nmodule.exportDefault(new JobService());\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/jobs/server/index.js                                                                               //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nmodule.watch(require(\"./jobs\"), {\n  default: function _default(v) {\n    exports.default = v;\n  }\n}, 0);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"jobConstants.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/jobs/server/jobConstants.js                                                                        //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  SCHEDULE_METHOD: function SCHEDULE_METHOD() {\n    return _SCHEDULE_METHOD;\n  },\n  CANCEL_JOB: function CANCEL_JOB() {\n    return _CANCEL_JOB;\n  },\n  REMOVE_JOB: function REMOVE_JOB() {\n    return _REMOVE_JOB;\n  }\n});\nexports.SCHEDULE_METHOD = _SCHEDULE_METHOD;\nvar _SCHEDULE_METHOD = 'SCHEDULE_METHOD';\nvar _CANCEL_JOB = 'CANCEL_JOB';\nvar _REMOVE_JOB = 'REMOVE_JOB';\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"jobListeners.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/jobs/server/jobListeners.js                                                                        //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar moment = void 0;\nmodule.watch(require(\"moment\"), {\n  default: function _default(v) {\n    moment = v;\n  }\n}, 0);\nvar EventService = void 0;\nmodule.watch(require(\"../../events\"), {\n  default: function _default(v) {\n    EventService = v;\n  }\n}, 1);\n\nvar _mutations = void 0;\n\nmodule.watch(require(\"../../mutations\"), {\n  mutations: function mutations(v) {\n    _mutations = v;\n  }\n}, 2);\nvar JobService = void 0;\nmodule.watch(require(\"./JobService\"), {\n  default: function _default(v) {\n    JobService = v;\n  }\n}, 3);\n\nvar _getAuctionEndTime = void 0;\n\nmodule.watch(require(\"../../../utils/loanFunctions\"), {\n  getAuctionEndTime: function getAuctionEndTime(v) {\n    _getAuctionEndTime = v;\n  }\n}, 4);\nEventService.addMutationListener(_mutations.START_AUCTION, function (params) {\n  JobService.cancelExistingMutationJob({\n    mutation: _mutations.END_AUCTION,\n    params: params\n  });\n  JobService.scheduleMutation({\n    mutation: _mutations.END_AUCTION,\n    params: params,\n    date: _getAuctionEndTime(moment())\n  });\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"jobs.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/jobs/server/jobs.js                                                                                //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _JobCollection = void 0;\n\nmodule.watch(require(\"meteor/vsivsi:job-collection\"), {\n  JobCollection: function JobCollection(v) {\n    _JobCollection = v;\n  }\n}, 1);\n\nvar _SCHEDULE_METHOD = void 0;\n\nmodule.watch(require(\"./jobConstants\"), {\n  SCHEDULE_METHOD: function SCHEDULE_METHOD(v) {\n    _SCHEDULE_METHOD = v;\n  }\n}, 2);\nvar Jobs = new _JobCollection('jobs');\nvar jobList = [{\n  type: _SCHEDULE_METHOD,\n  options: {\n    pollInterval: 5000\n  },\n  run: function run(data, callback) {\n    var _Meteor2;\n\n    console.log('calling scheduled method..');\n    var method = data.method,\n        params = data.params;\n\n    if (typeof method !== 'string') {\n      throw new Error('invalid method name');\n    }\n\n    (_Meteor2 = _Meteor).call.apply(_Meteor2, [method].concat(_toConsumableArray(params), [function (err, result) {\n      if (err) {\n        callback(err, undefined);\n      } else {\n        callback(err, result);\n      }\n    }]));\n  }\n}];\njobList.forEach(function (jobObject) {\n  Jobs.processJobs(jobObject.type, (0, _extends3.default)({\n    pollInterval: 5000\n  }, jobObject.options), function (job, callback) {\n    var type = job.type,\n        data = job.data,\n        done = job.done,\n        fail = job.fail;\n\n    try {\n      jobObject.run(data, function (err, result) {\n        if (err) {\n          fail(err);\n        } else {\n          done(result);\n        }\n\n        callback();\n      });\n    } catch (error) {\n      fail(error);\n      callback();\n    }\n  });\n});\nmodule.exportDefault(Jobs);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}}},\"loans\":{\"queries\":{\"adminLoanView.expose.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/loans/queries/adminLoanView.expose.js                                                              //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar Security = void 0;\nmodule.watch(require(\"../../security\"), {\n  default: function _default(v) {\n    Security = v;\n  }\n}, 0);\nvar query = void 0;\nmodule.watch(require(\"./adminLoanView\"), {\n  default: function _default(v) {\n    query = v;\n  }\n}, 1);\nquery.expose({\n  firewall: function firewall(userId, params) {\n    Security.checkCurrentUserIsAdmin(userId);\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"adminLoanView.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/loans/queries/adminLoanView.js                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Loans = void 0;\n\nmodule.watch(require(\"../../\"), {\n  Loans: function Loans(v) {\n    _Loans = v;\n  }\n}, 0);\n\nvar _LOAN_QUERIES = void 0;\n\nmodule.watch(require(\"../loanConstants\"), {\n  LOAN_QUERIES: function LOAN_QUERIES(v) {\n    _LOAN_QUERIES = v;\n  }\n}, 1);\nmodule.exportDefault(_Loans.createQuery(_LOAN_QUERIES.ADMIN_LOAN, {\n  $filter: function $filter(_ref) {\n    var filters = _ref.filters,\n        params = _ref.params;\n    filters._id = params._id;\n  },\n  name: 1,\n  logic: 1,\n  general: 1,\n  createdAt: 1,\n  updatedAt: 1,\n  files: 1,\n  property: {\n    userId: 1,\n    createdAt: 1,\n    updatedAt: 1,\n    status: 1,\n    value: 1,\n    propertyWork: 1,\n    usageType: 1,\n    investmentRent: 1,\n    style: 1,\n    address: 1,\n    address1: 1,\n    address2: 1,\n    zipCode: 1,\n    city: 1,\n    constructionYear: 1,\n    renovationYear: 1,\n    insideArea: 1,\n    landArea: 1,\n    balconyArea: 1,\n    terraceArea: 1,\n    roomCount: 1,\n    bathroomCount: 1,\n    toiletCount: 1,\n    volume: 1,\n    volumeNorm: 1,\n    parking: 1,\n    minergie: 1,\n    isCoproperty: 1,\n    isNew: 1,\n    copropertyPercentage: 1,\n    cityPlacementQuality: 1,\n    buildingPlacementQuality: 1,\n    buildingQuality: 1,\n    flatQuality: 1,\n    materialsQuality: 1,\n    otherNotes: 1,\n    pictures: 1,\n    name: 1,\n    latitude: 1,\n    longitude: 1,\n    nearestBusStation: 1,\n    nearestTrainStation: 1,\n    customFields: 1,\n    adminValidation: 1,\n    files: 1\n  },\n  borrowers: {\n    firstName: 1,\n    lastName: 1,\n    gender: 1,\n    address1: 1,\n    zipCode: 1,\n    city: 1,\n    age: 1,\n    birthPlace: 1,\n    civilStatus: 1,\n    childrenCount: 1,\n    company: 1,\n    personalBank: 1,\n    isSwiss: 1,\n    isUSPerson: 1,\n    worksForOwnCompany: 1,\n    sameAddress: 1,\n    salary: 1,\n    bonusExists: 1,\n    bonus: 1,\n    otherIncome: 1,\n    expenses: 1,\n    realEstate: 1,\n    bankFortune: 1,\n    insuranceSecondPillar: 1,\n    insuranceThirdPillar: 1,\n    files: 1,\n    logic: 1,\n    otherFortune: 1,\n    corporateBankExists: 1,\n    adminValidation: 1\n  },\n  tasks: {\n    status: 1,\n    createdAt: 1,\n    updatedAt: 1,\n    dueAt: 1,\n    assignedUser: {\n      emails: 1,\n      roles: 1\n    }\n  }\n}));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"adminLoansList.expose.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/loans/queries/adminLoansList.expose.js                                                             //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar Security = void 0;\nmodule.watch(require(\"../../security\"), {\n  default: function _default(v) {\n    Security = v;\n  }\n}, 0);\nvar query = void 0;\nmodule.watch(require(\"./adminLoansList\"), {\n  default: function _default(v) {\n    query = v;\n  }\n}, 1);\nquery.expose({\n  firewall: function firewall(userId) {\n    Security.checkCurrentUserIsAdmin(userId);\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"adminLoansList.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/loans/queries/adminLoansList.js                                                                    //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar Loans = void 0;\nmodule.watch(require(\"..\"), {\n  default: function _default(v) {\n    Loans = v;\n  }\n}, 0);\n\nvar _LOAN_QUERIES = void 0;\n\nmodule.watch(require(\"../loanConstants\"), {\n  LOAN_QUERIES: function LOAN_QUERIES(v) {\n    _LOAN_QUERIES = v;\n  }\n}, 1);\nmodule.exportDefault(Loans.createQuery(_LOAN_QUERIES.ADMIN_LOANS, {\n  $options: {\n    sort: {\n      createdAt: -1\n    }\n  },\n  name: 1,\n  logic: 1,\n  general: 1,\n  createdAt: 1,\n  updatedAt: 1,\n  property: {\n    value: 1\n  }\n}));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"exposures.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/loans/queries/exposures.js                                                                         //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nmodule.watch(require(\"./adminLoansList.expose\"));\nmodule.watch(require(\"./adminLoanView.expose\"));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"server\":{\"methods.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/loans/server/methods.js                                                                            //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.insertLoan = undefined;\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _this = undefined;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.export({\n  insertLoan: function insertLoan() {\n    return _insertLoan;\n  },\n  updateLoan: function updateLoan() {\n    return _updateLoan;\n  },\n  incrementStep: function incrementStep() {\n    return _incrementStep;\n  },\n  startAuction: function startAuction() {\n    return _startAuction;\n  },\n  pushLoanValue: function pushLoanValue() {\n    return _pushLoanValue;\n  },\n  popLoanValue: function popLoanValue() {\n    return _popLoanValue;\n  },\n  loanVerification: function loanVerification() {\n    return _loanVerification;\n  },\n  deleteLoan: function deleteLoan() {\n    return _deleteLoan;\n  },\n  endAuction: function endAuction() {\n    return _endAuction;\n  },\n  cancelAuction: function cancelAuction() {\n    return _cancelAuction;\n  },\n  confirmClosing: function confirmClosing() {\n    return _confirmClosing;\n  },\n  addEmail: function addEmail() {\n    return _addEmail;\n  },\n  modifyEmail: function modifyEmail() {\n    return _modifyEmail;\n  }\n});\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _ValidatedMethod = void 0;\n\nmodule.watch(require(\"meteor/mdg:validated-method\"), {\n  ValidatedMethod: function ValidatedMethod(v) {\n    _ValidatedMethod = v;\n  }\n}, 1);\n\nvar _check = void 0,\n    _Match = void 0;\n\nmodule.watch(require(\"meteor/check\"), {\n  check: function check(v) {\n    _check = v;\n  },\n  Match: function Match(v) {\n    _Match = v;\n  }\n}, 2);\nvar moment = void 0;\nmodule.watch(require(\"moment\"), {\n  default: function _default(v) {\n    moment = v;\n  }\n}, 3);\n\nvar _Roles = void 0;\n\nmodule.watch(require(\"meteor/alanning:roles\"), {\n  Roles: function Roles(v) {\n    _Roles = v;\n  }\n}, 4);\n\nvar _CallPromiseMixin = void 0;\n\nmodule.watch(require(\"meteor/didericis:callpromise-mixin\"), {\n  CallPromiseMixin: function CallPromiseMixin(v) {\n    _CallPromiseMixin = v;\n  }\n}, 5);\nvar rateLimit = void 0;\nexports.insertLoan = _insertLoan;\nmodule.watch(require(\"../../../utils/rate-limit.js\"), {\n  default: function _default(v) {\n    rateLimit = v;\n  }\n}, 6);\n\nvar _getAuctionEndTime = void 0;\n\nmodule.watch(require(\"../../../utils/loanFunctions\"), {\n  getAuctionEndTime: function getAuctionEndTime(v) {\n    _getAuctionEndTime = v;\n  }\n}, 7);\n\nvar _insertAdminAction = void 0,\n    _completeActionByType = void 0,\n    _removeParentLoan = void 0;\n\nmodule.watch(require(\"../../adminActions/server/methods\"), {\n  insertAdminAction: function insertAdminAction(v) {\n    _insertAdminAction = v;\n  },\n  completeActionByType: function completeActionByType(v) {\n    _completeActionByType = v;\n  },\n  removeParentLoan: function removeParentLoan(v) {\n    _removeParentLoan = v;\n  }\n}, 8);\nvar Loans = void 0;\nmodule.watch(require(\"../loans\"), {\n  default: function _default(v) {\n    Loans = v;\n  }\n}, 9);\n\nvar _ADMIN_ACTION_TYPE = void 0,\n    _ADMIN_ACTION_STATUS = void 0,\n    _LOAN_STATUS = void 0,\n    _AUCTION_STATUS = void 0;\n\nmodule.watch(require(\"../../constants\"), {\n  ADMIN_ACTION_TYPE: function ADMIN_ACTION_TYPE(v) {\n    _ADMIN_ACTION_TYPE = v;\n  },\n  ADMIN_ACTION_STATUS: function ADMIN_ACTION_STATUS(v) {\n    _ADMIN_ACTION_STATUS = v;\n  },\n  LOAN_STATUS: function LOAN_STATUS(v) {\n    _LOAN_STATUS = v;\n  },\n  AUCTION_STATUS: function AUCTION_STATUS(v) {\n    _AUCTION_STATUS = v;\n  }\n}, 10);\n\nvar importServerMethods = function importServerMethods() {\n  if (_Meteor.isServer || !!_this && !_this.isSimulation) {\n    var _require = require(\"../../jobs/server/methods\"),\n        scheduleMethod = _require.scheduleMethod,\n        rescheduleJob = _require.rescheduleJob;\n\n    var _require2 = require(\"../../email/server/email-methods\"),\n        sendEmail = _require2.sendEmail,\n        cancelScheduledEmail = _require2.cancelScheduledEmail,\n        rescheduleEmail = _require2.rescheduleEmail;\n\n    return {\n      scheduleMethod: scheduleMethod,\n      sendEmail: sendEmail,\n      cancelScheduledEmail: cancelScheduledEmail,\n      rescheduleEmail: rescheduleEmail\n    };\n  }\n};\n\nvar _insertLoan = new _ValidatedMethod({\n  name: 'insertLoan',\n  mixins: [_CallPromiseMixin],\n  validate: function validate() {},\n  run: function run(_ref) {\n    var object = _ref.object,\n        userId = _ref.userId;\n    // const loanCount = Loans.find({ userId: Meteor.userId() }).count();\n    //\n    // if (loanCount > 3) {\n    //   throw new Meteor.Error(\n    //     'maxLoans',\n    //     'Vous ne pouvez pas avoir plus de 3 requêtes à la fois',\n    //   );\n    // }\n    //\n    // console.log(object);\n    // Allow adding a userId for testing purposes\n    return Loans.insert((0, _extends3.default)({}, object, {\n      // Do this to allow userId to be null\n      userId: userId === undefined ? _Meteor.userId() : userId\n    }));\n  }\n}); // Lets you set an entire object in the document\n\n\nvar _updateLoan = new _ValidatedMethod({\n  name: 'updateLoan',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref2) {\n    var id = _ref2.id;\n\n    _check(id, String);\n  },\n  run: function run(_ref3) {\n    var object = _ref3.object,\n        id = _ref3.id;\n    return Loans.update(id, {\n      $set: object\n    });\n  }\n});\n\nvar _incrementStep = new _ValidatedMethod({\n  name: 'incrementStep',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref4) {\n    var id = _ref4.id;\n\n    _check(id, String);\n  },\n  run: function run(_ref5) {\n    var id = _ref5.id;\n    var loan = Loans.findOne(id);\n    var currentStep = loan.logic.step;\n    return Loans.update(id, {\n      $set: {\n        'logic.step': currentStep + 1\n      }\n    });\n  }\n});\n\nvar _startAuction = new _ValidatedMethod({\n  name: 'startAuction',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref6) {\n    var id = _ref6.id,\n        object = _ref6.object;\n\n    _check(id, String);\n\n    _check(object, _Match.Optional(Object));\n  },\n  run: function run(_ref7) {\n    var object = _ref7.object,\n        id = _ref7.id;\n    var auctionEndTime = void 0; // object parameter only contains the isDemo value\n\n    if (object.isDemo) {\n      auctionEndTime = moment().add(30, 's').toDate();\n      console.log(\"Temps de fin r\\xE9el: \" + _getAuctionEndTime(moment()));\n    } else {\n      auctionEndTime = _getAuctionEndTime(moment());\n    }\n\n    var auctionObject = {\n      'logic.auction.status': _AUCTION_STATUS.STARTED,\n      'logic.auction.startTime': moment().toDate(),\n      'logic.auction.endTime': auctionEndTime\n    };\n\n    if (_Meteor.isServer) {\n      var _importServerMethods = importServerMethods(),\n          scheduleMethod = _importServerMethods.scheduleMethod,\n          sendEmail = _importServerMethods.sendEmail;\n\n      Loans.update(id, {\n        $set: auctionObject\n      });\n      return _insertAdminAction.callPromise({\n        loanId: id,\n        type: _ADMIN_ACTION_TYPE.AUCTION,\n        extra: {\n          auctionEndTime: auctionEndTime\n        }\n      }).then(function () {\n        return sendEmail.callPromise({\n          emailId: 'auctionStarted',\n          loanId: id,\n          intlValues: {\n            date: auctionEndTime\n          }\n        });\n      }).then(function () {\n        return scheduleMethod.callPromise({\n          method: 'loans.endAuction',\n          params: [{\n            id: id\n          }],\n          date: auctionEndTime\n        });\n      }).then(function () {\n        return 'success';\n      }).catch(function (e) {\n        throw e;\n      });\n    }\n  }\n});\n\nvar _pushLoanValue = new _ValidatedMethod({\n  name: 'pushLoanValue',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref8) {\n    var id = _ref8.id;\n\n    _check(id, String);\n  },\n  run: function run(_ref9) {\n    var object = _ref9.object,\n        id = _ref9.id;\n    var result = Loans.update(id, {\n      $push: object\n    });\n    return result;\n  }\n});\n\nvar _popLoanValue = new _ValidatedMethod({\n  name: 'popLoanValue',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref10) {\n    var id = _ref10.id;\n\n    _check(id, String);\n  },\n  run: function run(_ref11) {\n    var object = _ref11.object,\n        id = _ref11.id;\n    return Loans.update(id, {\n      $pop: object\n    });\n  }\n});\n\nvar _loanVerification = new _ValidatedMethod({\n  name: 'loanVerification',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref12) {\n    var id = _ref12.id;\n\n    _check(id, String);\n  },\n  run: function run(_ref13) {\n    var id = _ref13.id;\n    var loan = Loans.findOne(id);\n\n    if (loan.logic.verification.requested) {\n      // Don't do anything if this loan is already in requested mode\n      return false;\n    } // Insert an admin action and set the proper keys in the loan\n\n\n    Loans.update(id, {\n      $set: {\n        'logic.verification.requested': true,\n        'logic.verification.requestedTime': new Date()\n      }\n    }, function (err) {\n      if (!err && _Meteor.isServer) {\n        var _importServerMethods2 = importServerMethods(),\n            scheduleMethod = _importServerMethods2.scheduleMethod,\n            sendEmail = _importServerMethods2.sendEmail,\n            cancelScheduledEmail = _importServerMethods2.cancelScheduledEmail,\n            rescheduleEmail = _importServerMethods2.rescheduleEmail;\n\n        sendEmail.call({\n          emailId: 'verificationRequested',\n          loanId: id\n        });\n      }\n    });\n    return _Meteor.wrapAsync(_insertAdminAction.call({\n      type: _ADMIN_ACTION_TYPE.VERIFY,\n      loanId: id\n    }));\n  }\n});\n\nvar _deleteLoan = new _ValidatedMethod({\n  name: 'deleteLoan',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref14) {\n    var id = _ref14.id;\n\n    _check(id, String);\n  },\n  run: function run(_ref15) {\n    var id = _ref15.id;\n\n    if (_Roles.userIsInRole(_Meteor.userId(), 'dev') || _Roles.userIsInRole(_Meteor.userId(), 'admin')) {\n      return Loans.remove(id, function (err) {\n        if (!err) {\n          _removeParentLoan.call({\n            loanId: id\n          });\n        }\n      });\n    }\n\n    throw new _Meteor.Error('not authorized');\n  }\n});\n\nvar _endAuction = new _ValidatedMethod({\n  name: 'endAuction',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref16) {\n    var id = _ref16.id;\n\n    _check(id, String);\n  },\n  run: function run(_ref17) {\n    var id = _ref17.id;\n    console.log('ending loan..');\n    var loan = Loans.findOne(id); // This method is called in the future, so make sure that it isn't\n    // executed again if this has already been done\n\n    if (!loan || loan.logic.auction.status === _AUCTION_STATUS.ENDED) {\n      return;\n    }\n\n    Loans.update(id, {\n      $set: {\n        'logic.auction.status': _AUCTION_STATUS.ENDED,\n        'logic.auction.endTime': new Date()\n      }\n    });\n\n    _completeActionByType.call({\n      loanId: id,\n      type: _ADMIN_ACTION_TYPE.AUCTION\n    });\n\n    if (_Meteor.isServer) {\n      var _importServerMethods3 = importServerMethods(),\n          scheduleMethod = _importServerMethods3.scheduleMethod,\n          sendEmail = _importServerMethods3.sendEmail,\n          cancelScheduledEmail = _importServerMethods3.cancelScheduledEmail,\n          rescheduleEmail = _importServerMethods3.rescheduleEmail;\n\n      var _loan = Loans.findOne(id);\n\n      var email = _loan.emails.find(function (e) {\n        return e && e.emailId === 'auctionEnded' && e.scheduledAt >= new Date();\n      });\n\n      if (email) {\n        cancelScheduledEmail.call('email.cancelScheduled', {\n          id: email._id,\n          loanId: id,\n          template: 'notification+CTA'\n        });\n      }\n    }\n  }\n});\n\nvar _cancelAuction = new _ValidatedMethod({\n  name: 'cancelAuction',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref18) {\n    var id = _ref18.id;\n\n    _check(id, String);\n  },\n  run: function run(_ref19) {\n    var id = _ref19.id;\n\n    if (_Roles.userIsInRole(_Meteor.userId(), 'admin') || _Roles.userIsInRole(_Meteor.userId(), 'dev')) {\n      return Loans.update(id, {\n        $set: {\n          'logic.auction.endTime': undefined,\n          'logic.auction.status': '',\n          'logic.auction.startTime': undefined\n        }\n      }, function (error) {\n        if (!error && _Meteor.isServer) {\n          var _importServerMethods4 = importServerMethods(),\n              scheduleMethod = _importServerMethods4.scheduleMethod,\n              sendEmail = _importServerMethods4.sendEmail,\n              cancelScheduledEmail = _importServerMethods4.cancelScheduledEmail,\n              rescheduleEmail = _importServerMethods4.rescheduleEmail;\n\n          var loan = Loans.findOne(id);\n          var email = loan.emails.find(function (e) {\n            return e && e.emailId === 'auctionEnded' && e.scheduledAt >= new Date();\n          });\n\n          if (email) {\n            cancelScheduledEmail.call('email.cancelScheduled', {\n              id: email._id,\n              loanId: id\n            });\n          }\n        }\n\n        _completeActionByType.call({\n          loanId: id,\n          type: _ADMIN_ACTION_TYPE.AUCTION,\n          newStatus: _ADMIN_ACTION_STATUS.CANCELLED\n        });\n      });\n    }\n\n    throw new _Meteor.Error('not authorized');\n  }\n});\n\nvar _confirmClosing = new _ValidatedMethod({\n  name: 'confirmClosing',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref20) {\n    var id = _ref20.id;\n\n    _check(id, String);\n  },\n  run: function run(_ref21) {\n    var id = _ref21.id,\n        object = _ref21.object;\n\n    // TODO: Send email to user, clean up, etc.\n    if (_Roles.userIsInRole(_Meteor.userId(), 'admin') || _Roles.userIsInRole(_Meteor.userId(), 'dev')) {\n      return Loans.update(id, {\n        $set: (0, _extends3.default)({\n          status: _LOAN_STATUS.DONE\n        }, object)\n      });\n    }\n\n    throw new _Meteor.Error('not authorized');\n  }\n});\n\nvar _addEmail = new _ValidatedMethod({\n  name: 'addEmail',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref22) {\n    var loanId = _ref22.loanId,\n        emailId = _ref22.emailId,\n        _id = _ref22._id,\n        status = _ref22.status,\n        sendAt = _ref22.sendAt;\n\n    _check(loanId, String);\n\n    _check(emailId, String);\n\n    _check(_id, String);\n\n    _check(status, String);\n\n    _check(sendAt, _Match.Optional(Date));\n  },\n  run: function run(_ref23) {\n    var loanId = _ref23.loanId,\n        emailId = _ref23.emailId,\n        _id = _ref23._id,\n        status = _ref23.status,\n        sendAt = _ref23.sendAt;\n    var object = {\n      emailId: emailId,\n      _id: _id,\n      status: status,\n      updatedAt: new Date()\n    };\n\n    if (sendAt) {\n      object.scheduledAt = sendAt;\n    }\n\n    return Loans.update(loanId, {\n      $push: {\n        emails: object\n      }\n    });\n  }\n});\n\nvar _modifyEmail = new _ValidatedMethod({\n  name: 'modifyEmail',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref24) {\n    var loanId = _ref24.loanId,\n        _id = _ref24._id,\n        status = _ref24.status,\n        sendAt = _ref24.sendAt;\n\n    _check(loanId, String);\n\n    _check(_id, String);\n\n    _check(status, _Match.Optional(String));\n\n    _check(sendAt, _Match.Optional(Date));\n  },\n  run: function run(_ref25) {\n    var loanId = _ref25.loanId,\n        _id = _ref25._id,\n        status = _ref25.status,\n        sendAt = _ref25.sendAt;\n    var object = {\n      'emails.$.status': status,\n      'emails.$.updatedAt': new Date()\n    };\n\n    if (sendAt) {\n      object['emails.$.scheduledAt'] = sendAt;\n    }\n\n    return Loans.update({\n      _id: loanId,\n      'emails._id': _id\n    }, {\n      $set: object\n    });\n  }\n});\n\nrateLimit({\n  methods: [_insertLoan, _updateLoan, _incrementStep, _startAuction, _pushLoanValue, _popLoanValue, _loanVerification, // deleteLoan,\n  _cancelAuction, _confirmClosing, _addEmail, _modifyEmail]\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"mutations.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/loans/server/mutations.js                                                                          //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\nvar SecurityService = void 0;\nmodule.watch(require(\"../../security\"), {\n  default: function _default(v) {\n    SecurityService = v;\n  }\n}, 1);\n\nvar _createMutator = void 0;\n\nmodule.watch(require(\"../../mutations\"), {\n  createMutator: function createMutator(v) {\n    _createMutator = v;\n  }\n}, 2);\nvar LoanService = void 0;\nmodule.watch(require(\"../LoanService\"), {\n  default: function _default(v) {\n    LoanService = v;\n  }\n}, 3);\nvar defs = void 0;\nmodule.watch(require(\"../mutationDefinitions\"), {\n  \"*\": function _(v) {\n    defs = v;\n  }\n}, 4);\n\n_createMutator(defs.LOAN_INSERT, function (_ref) {\n  var object = _ref.object,\n      userId = _ref.userId;\n  var userIdIsDefined = userId !== undefined;\n\n  if (userIdIsDefined) {\n    SecurityService.checkCurrentUserIsAdmin();\n  } else {\n    SecurityService.loans.isAllowedToInsert();\n  }\n\n  return LoanService.insert({\n    object: object,\n    userId: userIdIsDefined ? userId : _Meteor.userId()\n  });\n});\n\n_createMutator(defs.LOAN_UPDATE, function (_ref2) {\n  var loanId = _ref2.loanId,\n      object = _ref2.object;\n  SecurityService.loans.isAllowedToUpdate(loanId);\n  return LoanService.update({\n    loanId: loanId,\n    object: object\n  });\n});\n\n_createMutator(defs.LOAN_DELETE, function (_ref3) {\n  var loanId = _ref3.loanId;\n  SecurityService.loans.isAllowedToDelete(loanId);\n  return LoanService.delete({\n    loanId: loanId\n  });\n});\n\n_createMutator(defs.INCREMENT_LOAN_STEP, function (_ref4) {\n  var loanId = _ref4.loanId;\n  SecurityService.loans.isAllowedToUpdate(loanId);\n  return LoanService.incrementStep({\n    loanId: loanId\n  });\n});\n\n_createMutator(defs.REQUEST_LOAN_VERIFICATION, function (_ref5) {\n  var loanId = _ref5.loanId;\n  SecurityService.loans.isAllowedToUpdate(loanId);\n  return LoanService.askVerification({\n    loanId: loanId\n  });\n});\n\n_createMutator(defs.START_AUCTION, function (_ref6) {\n  var loanId = _ref6.loanId;\n  SecurityService.loans.isAllowedToUpdate(loanId);\n  return LoanService.startAuction({\n    loanId: loanId\n  });\n});\n\n_createMutator(defs.END_AUCTION, function (_ref7) {\n  var loanId = _ref7.loanId;\n  SecurityService.checkCurrentUserIsAdmin();\n  return LoanService.startAuction({\n    loanId: loanId\n  });\n});\n\n_createMutator(defs.CANCEL_AUCTION, function (_ref8) {\n  var loanId = _ref8.loanId;\n  SecurityService.checkCurrentUserIsAdmin();\n  return LoanService.startAuction({\n    loanId: loanId\n  });\n});\n\n_createMutator(defs.CONFIRM_CLOSING, function (_ref9) {\n  var loanId = _ref9.loanId,\n      object = _ref9.object;\n  SecurityService.checkCurrentUserIsAdmin();\n  return LoanService.confirmClosing({\n    loanId: loanId,\n    object: object\n  });\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"publications.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/loans/server/publications.js                                                                       //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _this = undefined;\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _check = void 0;\n\nmodule.watch(require(\"meteor/check\"), {\n  check: function check(v) {\n    _check = v;\n  }\n}, 1);\nvar Loans = void 0;\nmodule.watch(require(\"../loans\"), {\n  default: function _default(v) {\n    Loans = v;\n  }\n}, 2);\n\nvar _Roles = void 0;\n\nmodule.watch(require(\"meteor/alanning:roles\"), {\n  Roles: function Roles(v) {\n    _Roles = v;\n  }\n}, 3);\n\n// Publish a specific loan with an ID\n_Meteor.publish('loan', function publish(id) {\n  // Verify if user is logged In\n  if (!_Meteor.userId()) {\n    return this.ready();\n  }\n\n  _check(id, String);\n\n  if (_Roles.userIsInRole(_Meteor.userId(), 'admin') || _Roles.userIsInRole(_Meteor.userId(), 'dev')) {\n    return Loans.find({\n      _id: id\n    });\n  }\n\n  return Loans.find({\n    userId: _Meteor.userId(),\n    _id: id\n  }); // Throw unauthorized error\n}); // Publish all loans from the current user\n\n\n_Meteor.publish('loans', function publish() {\n  // Verify if user is logged In\n  if (!_Meteor.userId()) {\n    return this.ready();\n  }\n\n  return Loans.find({\n    userId: _Meteor.userId()\n  });\n}); // Publish all loans for a user\n\n\n_Meteor.publish('userLoans', function (userId) {\n  _check(userId, String); // Verify if user is logged In\n\n\n  if (_Roles.userIsInRole(_Meteor.userId(), 'admin') || _Roles.userIsInRole(_Meteor.userId(), 'dev')) {\n    // Return all users\n    return Loans.find({\n      userId: userId\n    });\n  }\n\n  return _this.ready();\n}); // Publish all loans in the database for admins\n\n\n_Meteor.publish('allLoans', function publish() {\n  // Verify if user is logged In\n  if (_Roles.userIsInRole(_Meteor.userId(), 'admin') || _Roles.userIsInRole(_Meteor.userId(), 'dev')) {\n    // Return all users\n    return Loans.find();\n  }\n\n  return this.ready();\n}); // The fields visible to partners\n\n\nvar partnerVisibleFields = function partnerVisibleFields(organization) {\n  return {\n    // TODO: Complete this\n    'general.purchaseType': 1,\n    'general.usageType': 1,\n    'general.fortuneUsed': 1,\n    'general.insuranceFortuneUsed': 1,\n    'general.incomeUsed': 1,\n    'borrowers.age': 1,\n    'borrowers.gender': 1,\n    'borrowers.birthDate': 1,\n    'borrowers.grossIncome': 1,\n    'borrowers.bonusExists': 1,\n    'borrowers.bonus': 1,\n    'borrowers.otherIncome': 1,\n    'borrowers.currentRentExists': 1,\n    'borrowers.currentRent': 1,\n    'borrowers.realEstateFortune': 1,\n    'borrowers.cashAndSecurities': 1,\n    'borrowers.existingDebt': 1,\n    'borrowers.otherFortune': 1,\n    'borrowers.insuranceLpp': 1,\n    'borrowers.insurance3A': 1,\n    'borrowers.insurance3B': 1,\n    'borrowers.insurancePureRisk': 1,\n    property: 1,\n    // partnerOffers: {\n    //   $elemMatch: { $eq: { name: organization } },\n    // },\n    'logic.step': 1,\n    'logic.uploadTaxesLater': 1,\n    'logic.auction.status': 1,\n    'logic.auction.startTime': 1,\n    'logic.auction.endTime': 1\n  };\n}; // Publish all loans this partner has access to\n\n\n_Meteor.publish('partnerLoansAuction', function publish() {\n  if (_Roles.userIsInRole(_Meteor.userId(), 'partner')) {\n    var user = _Meteor.users.findOne(_Meteor.userId()); // Show loans where the canton matches this partner's cantons\n    // and the auction has started\n    // and the auctionEndTime is greater than this date\n    // and this partner's organization is not in the partnersToAvoid\n\n\n    return Loans.find({\n      $and: [{\n        'general.canton': {\n          $in: user.profile.cantons\n        }\n      }, {\n        'logic.auction.status': 'started'\n      }, {\n        $or: [{\n          'general.partnersToAvoidExists': false\n        }, {\n          'general.partnersToAvoid.0': {\n            $ne: user.profile.organization\n          }\n        }]\n      }]\n    }, {\n      fields: partnerVisibleFields(user.profile.organization)\n    });\n  }\n\n  return this.ready();\n}); // Publish all loans this partner has access to\n\n\n_Meteor.publish('partnerLoansCompleted', function publish() {\n  if (_Roles.userIsInRole(_Meteor.userId(), 'partner')) {\n    // Get the current partner user\n    var user = _Meteor.users.findOne(_Meteor.userId()); // Return the loans where this partner has been selected\n\n\n    return Loans.find({\n      'general.selectedPartner': user.profile.organization\n    }, {\n      fields: partnerVisibleFields(user.profile.organization)\n    });\n  }\n\n  return this.ready();\n}); // Publish the loan with a specific ID, and only show the fields for an anonymous offer\n\n\n_Meteor.publish('partnerSingleLoan', function publish(id) {\n  _check(id, String); // Verify if this is a partner account\n\n\n  if (_Roles.userIsInRole(_Meteor.userId(), 'partner')) {\n    var user = _Meteor.users.findOne(_Meteor.userId());\n\n    return Loans.find({\n      $and: [{\n        _id: id\n      }, {\n        'general.canton': {\n          $in: user.profile.cantons\n        }\n      }, {\n        'logic.auction.status': 'started'\n      }, {\n        $or: [{\n          'general.partnersToAvoidExists': false\n        }, {\n          'general.partnersToAvoid.0': {\n            $ne: user.profile.organization\n          }\n        }]\n      }]\n    }, {\n      fields: partnerVisibleFields(user.profile.organization)\n    });\n  }\n\n  return this.ready();\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"LoanService.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/loans/LoanService.js                                                                               //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.export({\n  LoanServiceModel: function LoanServiceModel() {\n    return _LoanServiceModel;\n  }\n});\nvar moment = void 0;\nmodule.watch(require(\"moment\"), {\n  default: function _default(v) {\n    moment = v;\n  }\n}, 0);\nvar Loans = void 0;\nmodule.watch(require(\"../loans\"), {\n  default: function _default(v) {\n    Loans = v;\n  }\n}, 1);\n\nvar _LOAN_STATUS = void 0,\n    _AUCTION_STATUS = void 0;\n\nmodule.watch(require(\"../constants\"), {\n  LOAN_STATUS: function LOAN_STATUS(v) {\n    _LOAN_STATUS = v;\n  },\n  AUCTION_STATUS: function AUCTION_STATUS(v) {\n    _AUCTION_STATUS = v;\n  }\n}, 2);\n\nvar _getAuctionEndTime = void 0;\n\nmodule.watch(require(\"../../utils/loanFunctions\"), {\n  getAuctionEndTime: function getAuctionEndTime(v) {\n    _getAuctionEndTime = v;\n  }\n}, 3);\n\nvar _LoanServiceModel = function _LoanServiceModel() {\n  var _this = this;\n\n  (0, _classCallCheck3.default)(this, _LoanServiceModel);\n\n  this.insert = function (_ref) {\n    var loan = _ref.loan,\n        userId = _ref.userId;\n    return Loans.insert((0, _extends3.default)({}, loan, {\n      // Do this to allow userId to be null\n      userId: userId\n    }));\n  };\n\n  this.update = function (_ref2) {\n    var loanId = _ref2.loanId,\n        object = _ref2.object;\n    return Loans.update(loanId, {\n      $set: object\n    });\n  };\n\n  this.remove = function (_ref3) {\n    var loanId = _ref3.loanId;\n    return Loans.remove(loanId);\n  };\n\n  this.incrementStep = function (_ref4) {\n    var loanId = _ref4.loanId;\n    return Loans.update(loanId, {\n      $inc: {\n        'logic.step': 1\n      }\n    });\n  };\n\n  this.askVerification = function (_ref5) {\n    var loanId = _ref5.loanId;\n    var loan = Loans.findOne(loanId);\n\n    if (loan.logic.verification.requested) {\n      // Don't do anything if this loan is already in requested mode\n      return false;\n    }\n\n    return Loans.update(loanId, {\n      $set: {\n        'logic.verification.requested': true,\n        'logic.verification.requestedTime': new Date()\n      }\n    });\n  };\n\n  this.startAuction = function (_ref6) {\n    var loanId = _ref6.loanId;\n    var loan = Loans.findOne(loanId);\n\n    if (loan.logic.auction.status !== _AUCTION_STATUS.NONE) {\n      // Don't do anything if this auction has already started or ended\n      return false;\n    }\n\n    return Loans.update(loanId, {\n      $set: {\n        'logic.auction.status': _AUCTION_STATUS.STARTED,\n        'logic.auction.startTime': moment().toDate(),\n        'logic.auction.endTime': _getAuctionEndTime(moment())\n      }\n    });\n  };\n\n  this.endAuction = function (_ref7) {\n    var loanId = _ref7.loanId;\n    var loan = Loans.findOne(loanId); // This method is called in the future (through a job),\n    // so only call this if the auction is ongoing\n\n    if (!loan || loan.logic.auction.status !== _AUCTION_STATUS.STARTED) {\n      return false;\n    }\n\n    return Loans.update(id, {\n      $set: {\n        'logic.auction.status': _AUCTION_STATUS.ENDED,\n        'logic.auction.endTime': new Date()\n      }\n    });\n  };\n\n  this.cancelAuction = function (_ref8) {\n    var loanId = _ref8.loanId;\n    return _this.update(loanId, {\n      $set: {\n        'logic.auction.endTime': undefined,\n        'logic.auction.status': '',\n        'logic.auction.startTime': undefined\n      }\n    });\n  };\n\n  this.confirmClosing = function (_ref9) {\n    var loanId = _ref9.loanId,\n        object = _ref9.object;\n    return Loans.update(loanId, {\n      $set: (0, _extends3.default)({\n        status: _LOAN_STATUS.DONE\n      }, object)\n    });\n  };\n} // TODO: make sure step is really done\n;\n\nvar LoanService = new _LoanServiceModel({});\nmodule.exportDefault(LoanService);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"additionalSchemas.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/loans/additionalSchemas.js                                                                         //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  GeneralSchema: function GeneralSchema() {\n    return _GeneralSchema;\n  },\n  LogicSchema: function LogicSchema() {\n    return _LogicSchema;\n  }\n});\nvar SimpleSchema = void 0;\nmodule.watch(require(\"simpl-schema\"), {\n  default: function _default(v) {\n    SimpleSchema = v;\n  }\n}, 0);\nexports.GeneralSchema = _GeneralSchema;\n\nvar _PURCHASE_TYPE = void 0,\n    _INTEREST_RATES = void 0,\n    _OWNER = void 0,\n    _CANTONS = void 0,\n    _AUCTION_STATUS = void 0,\n    _OFFER_TYPE = void 0,\n    _CLOSING_STEPS_TYPE = void 0,\n    _CLOSING_STEPS_STATUS = void 0,\n    _AUCTION_MOST_IMPORTANT = void 0,\n    _INSURANCE_USE_PRESET = void 0,\n    _LOAN_STRATEGY_PRESET = void 0,\n    _AMORTIZATION_STRATEGY_PRESET = void 0,\n    _PAYMENT_SCHEDULES = void 0,\n    _GENDER = void 0,\n    _USAGE_TYPE = void 0;\n\nmodule.watch(require(\"../constants\"), {\n  PURCHASE_TYPE: function PURCHASE_TYPE(v) {\n    _PURCHASE_TYPE = v;\n  },\n  INTEREST_RATES: function INTEREST_RATES(v) {\n    _INTEREST_RATES = v;\n  },\n  OWNER: function OWNER(v) {\n    _OWNER = v;\n  },\n  CANTONS: function CANTONS(v) {\n    _CANTONS = v;\n  },\n  AUCTION_STATUS: function AUCTION_STATUS(v) {\n    _AUCTION_STATUS = v;\n  },\n  OFFER_TYPE: function OFFER_TYPE(v) {\n    _OFFER_TYPE = v;\n  },\n  CLOSING_STEPS_TYPE: function CLOSING_STEPS_TYPE(v) {\n    _CLOSING_STEPS_TYPE = v;\n  },\n  CLOSING_STEPS_STATUS: function CLOSING_STEPS_STATUS(v) {\n    _CLOSING_STEPS_STATUS = v;\n  },\n  AUCTION_MOST_IMPORTANT: function AUCTION_MOST_IMPORTANT(v) {\n    _AUCTION_MOST_IMPORTANT = v;\n  },\n  INSURANCE_USE_PRESET: function INSURANCE_USE_PRESET(v) {\n    _INSURANCE_USE_PRESET = v;\n  },\n  LOAN_STRATEGY_PRESET: function LOAN_STRATEGY_PRESET(v) {\n    _LOAN_STRATEGY_PRESET = v;\n  },\n  AMORTIZATION_STRATEGY_PRESET: function AMORTIZATION_STRATEGY_PRESET(v) {\n    _AMORTIZATION_STRATEGY_PRESET = v;\n  },\n  PAYMENT_SCHEDULES: function PAYMENT_SCHEDULES(v) {\n    _PAYMENT_SCHEDULES = v;\n  },\n  GENDER: function GENDER(v) {\n    _GENDER = v;\n  },\n  USAGE_TYPE: function USAGE_TYPE(v) {\n    _USAGE_TYPE = v;\n  }\n}, 1);\n\nvar _GeneralSchema = new SimpleSchema({\n  purchaseType: {\n    type: String,\n    defaultValue: _PURCHASE_TYPE.ACQUISITION,\n    allowedValues: Object.values(_PURCHASE_TYPE)\n  },\n  usageType: {\n    type: String,\n    defaultValue: _USAGE_TYPE.PRIMARY,\n    allowedValues: Object.values(_USAGE_TYPE)\n  },\n  fortuneUsed: {\n    type: Number,\n    min: 0,\n    max: 100000000,\n    defaultValue: 0\n  },\n  insuranceFortuneUsed: {\n    type: Number,\n    min: 0,\n    max: 100000000,\n    optional: true\n  },\n  propertyWork: {\n    type: Number,\n    min: 0,\n    max: 100000000,\n    defaultValue: 0\n  },\n  oldestAge: {\n    type: SimpleSchema.Integer,\n    optional: true,\n    min: 18,\n    max: 120\n  },\n  oldestGender: {\n    type: String,\n    optional: true,\n    allowedValues: Object.values(_GENDER)\n  },\n  partnersToAvoidExists: {\n    type: Boolean,\n    defaultValue: false\n  },\n  partnersToAvoid: {\n    type: Array,\n    defaultValue: []\n  },\n  'partnersToAvoid.$': String,\n  selectedPartner: {\n    type: String,\n    optional: true\n  },\n  canton: {\n    type: String,\n    optional: true,\n    allowedValues: Object.keys(_CANTONS)\n  },\n  loanTranches: {\n    type: Array,\n    // minCount: 1,\n    defaultValue: [{\n      type: _INTEREST_RATES.LIBOR,\n      value: 100000\n    }]\n  },\n  'loanTranches.$': Object,\n  'loanTranches.$.type': {\n    type: String,\n    optional: true,\n    allowedValues: Object.values(_INTEREST_RATES)\n  },\n  'loanTranches.$.value': {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 100000000\n  },\n  currentOwner: {\n    type: String,\n    defaultValue: _OWNER.FIRST,\n    allowedValues: Object.values(_OWNER)\n  },\n  futureOwner: {\n    type: String,\n    defaultValue: _OWNER.FIRST,\n    allowedValues: Object.values(_OWNER)\n  },\n  otherOwner: {\n    type: String,\n    optional: true\n  },\n  wantedClosingDate: {\n    type: Date,\n    optional: true\n  },\n  auctionMostImportant: {\n    type: String,\n    optional: true,\n    allowedValues: Object.values(_AUCTION_MOST_IMPORTANT)\n  }\n}); // All logic fields required by the app to trigger the right things at the right time\n\n\nvar _LogicSchema = new SimpleSchema({\n  step: {\n    type: Number,\n    defaultValue: 1,\n    min: 1,\n    max: 5\n  },\n  verification: {\n    type: Object,\n    defaultValue: {}\n  },\n  'verification.requested': {\n    type: Boolean,\n    optional: true\n  },\n  'verification.requestedTime': {\n    type: Date,\n    optional: true\n  },\n  'verification.validated': {\n    type: Boolean,\n    optional: true\n  },\n  'verification.comments': {\n    type: Array,\n    defaultValue: []\n  },\n  'verification.comments.$': String,\n  expertiseRequired: {\n    type: Boolean,\n    defaultValue: true\n  },\n  expertiseDone: {\n    type: Boolean,\n    defaultValue: false\n  },\n  expertiseValid: {\n    type: Boolean,\n    defaultValue: false\n  },\n  auction: {\n    type: Object,\n    defaultValue: {}\n  },\n  'auction.status': {\n    type: String,\n    optional: true,\n    defaultValue: _AUCTION_STATUS.NONE,\n    allowedValues: Object.values(_AUCTION_STATUS)\n  },\n  'auction.startTime': {\n    type: Date,\n    optional: true\n  },\n  'auction.endTime': {\n    type: Date,\n    optional: true\n  },\n  hasValidatedStructure: {\n    type: Boolean,\n    defaultValue: false,\n    optional: true\n  },\n  insuranceUsePreset: {\n    type: String,\n    // defaultValue: '',\n    optional: true,\n    allowedValues: Object.values(_INSURANCE_USE_PRESET)\n  },\n  loanStrategyPreset: {\n    type: String,\n    // defaultValue: '',\n    optional: true,\n    allowedValues: Object.values(_LOAN_STRATEGY_PRESET)\n  },\n  amortizationStrategyPreset: {\n    type: String,\n    // defaultValue: '',\n    optional: true,\n    allowedValues: Object.values(_AMORTIZATION_STRATEGY_PRESET)\n  },\n  lender: {\n    type: Object,\n    defaultValue: {}\n  },\n  'lender.type': {\n    type: String,\n    optional: true,\n    allowedValues: Object.values(_OFFER_TYPE)\n  },\n  'lender.offerId': {\n    type: String,\n    optional: true\n  },\n  'lender.chosenTime': {\n    type: Date,\n    optional: true\n  },\n  'lender.contacted': {\n    type: Boolean,\n    defaultValue: false\n  },\n  'lender.nextSteps': {\n    type: Array,\n    defaultValue: []\n  },\n  'lender.nextSteps.$': String,\n  'lender.contractRequested': {\n    type: Boolean,\n    defaultValue: false\n  },\n  'lender.contractLoanSent': {\n    type: Boolean,\n    defaultValue: false\n  },\n  'lender.contract': {\n    type: String,\n    defaultValue: '',\n    optional: true\n  },\n  acceptedClosing: {\n    type: Boolean,\n    defaultValue: false\n  },\n  recommendationCode: {\n    type: String,\n    defaultValue: '',\n    optional: true\n  },\n  firstPaymentDate: {\n    type: Date,\n    optional: true\n  },\n  paymentSchedule: {\n    type: String,\n    optional: true,\n    allowedValues: Object.values(_PAYMENT_SCHEDULES)\n  },\n  closingSteps: {\n    type: Array,\n    defaultValue: []\n  },\n  'closingSteps.$': Object,\n  'closingSteps.$.id': String,\n  'closingSteps.$.type': {\n    type: String,\n    allowedValues: Object.values(_CLOSING_STEPS_TYPE)\n  },\n  'closingSteps.$.title': String,\n  'closingSteps.$.description': {\n    type: String,\n    optional: true\n  },\n  'closingSteps.$.status': {\n    type: String,\n    optional: true,\n    allowedValues: Object.values(_CLOSING_STEPS_STATUS)\n  },\n  'closingSteps.$.error': {\n    type: String,\n    optional: true\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/loans/index.js                                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  loanMutations: function loanMutations() {\n    return _loanMutations;\n  }\n});\nmodule.watch(require(\"./loans\"), {\n  default: function _default(v) {\n    exports.default = v;\n  }\n}, 1);\nvar mutations = void 0;\nexports.loanMutations = _loanMutations;\nmodule.watch(require(\"./mutationDefinitions\"), {\n  \"*\": function _(v) {\n    mutations = v;\n  }\n}, 0);\nvar _loanMutations = mutations;\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"links.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/loans/links.js                                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Loans = void 0,\n    _Properties = void 0,\n    _Borrowers = void 0,\n    _Users = void 0,\n    _Tasks = void 0;\n\nmodule.watch(require(\"../\"), {\n  Loans: function Loans(v) {\n    _Loans = v;\n  },\n  Properties: function Properties(v) {\n    _Properties = v;\n  },\n  Borrowers: function Borrowers(v) {\n    _Borrowers = v;\n  },\n  Users: function Users(v) {\n    _Users = v;\n  },\n  Tasks: function Tasks(v) {\n    _Tasks = v;\n  }\n}, 0);\n\n_Loans.addLinks({\n  property: {\n    field: 'propertyId',\n    collection: _Properties,\n    type: 'one'\n  },\n  borrowers: {\n    field: 'borrowerIds',\n    collection: _Borrowers,\n    type: 'many'\n  },\n  user: {\n    field: 'userId',\n    collection: _Users,\n    type: 'one'\n  },\n  tasks: {\n    collection: _Tasks,\n    inversedBy: 'loan'\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"loanConstants.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/loans/loanConstants.js                                                                             //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  LOAN_STATUS: function LOAN_STATUS() {\n    return _LOAN_STATUS;\n  },\n  PURCHASE_TYPE: function PURCHASE_TYPE() {\n    return _PURCHASE_TYPE;\n  },\n  CANTONS: function CANTONS() {\n    return _CANTONS;\n  },\n  INTEREST_RATES: function INTEREST_RATES() {\n    return _INTEREST_RATES;\n  },\n  OWNER: function OWNER() {\n    return _OWNER;\n  },\n  AUCTION_STATUS: function AUCTION_STATUS() {\n    return _AUCTION_STATUS;\n  },\n  CLOSING_STEPS_TYPE: function CLOSING_STEPS_TYPE() {\n    return _CLOSING_STEPS_TYPE;\n  },\n  CLOSING_STEPS_STATUS: function CLOSING_STEPS_STATUS() {\n    return _CLOSING_STEPS_STATUS;\n  },\n  AUCTION_MOST_IMPORTANT: function AUCTION_MOST_IMPORTANT() {\n    return _AUCTION_MOST_IMPORTANT;\n  },\n  INSURANCE_USE_PRESET: function INSURANCE_USE_PRESET() {\n    return _INSURANCE_USE_PRESET;\n  },\n  LOAN_STRATEGY_PRESET: function LOAN_STRATEGY_PRESET() {\n    return _LOAN_STRATEGY_PRESET;\n  },\n  AMORTIZATION_STRATEGY_PRESET: function AMORTIZATION_STRATEGY_PRESET() {\n    return _AMORTIZATION_STRATEGY_PRESET;\n  },\n  PAYMENT_SCHEDULES: function PAYMENT_SCHEDULES() {\n    return _PAYMENT_SCHEDULES;\n  },\n  LOAN_QUERIES: function LOAN_QUERIES() {\n    return _LOAN_QUERIES;\n  }\n});\nexports.LOAN_STATUS = _LOAN_STATUS;\nvar _LOAN_STATUS = {\n  ACTIVE: 'ACTIVE',\n  DONE: 'DONE'\n};\nvar _PURCHASE_TYPE = {\n  ACQUISITION: 'ACQUISITION',\n  REFINANCING: 'REFINANCING',\n  CONSTRUCTION: 'CONSTRUCTION'\n};\nvar _CANTONS = {\n  AG: 'Aargau',\n  AR: 'Appenzell Ausserrhoden',\n  AI: 'Appenzell Innerrhoden',\n  BL: 'Basel-Land',\n  BS: 'Basel-Stadt',\n  BE: 'Bern',\n  FR: 'Fribourg',\n  GE: 'Genève',\n  GL: 'Glarus',\n  GR: 'Graubünden',\n  JU: 'Jura',\n  LU: 'Luzern',\n  NE: 'Neuchâtel',\n  NW: 'Nidwalden',\n  OW: 'Obwalden',\n  SG: 'St. Gallen',\n  SH: 'Schaffhausen',\n  SZ: 'Schwyz',\n  SO: 'Solothurn',\n  TG: 'Thurgau',\n  TI: 'Ticino',\n  UR: 'Uri',\n  VD: 'Vaud',\n  VS: 'Valais',\n  ZG: 'Zug',\n  ZH: 'Zürich'\n};\nvar _INTEREST_RATES = {\n  LIBOR: 'interestLibor',\n  YEARS_1: 'interest1',\n  YEARS_2: 'interest2',\n  YEARS_5: 'interest5',\n  YEARS_10: 'interest10',\n  YEARS_15: 'interest15'\n};\nvar _OWNER = {\n  FIRST: '0',\n  SECOND: '1',\n  BOTH: 'BOTH',\n  OTHER: 'OTHER'\n};\nvar _AUCTION_STATUS = {\n  NONE: '',\n  STARTED: 'STARTED',\n  ENDED: 'ENDED'\n};\nvar _CLOSING_STEPS_TYPE = {\n  TODO: 'TODO',\n  UPLOAD: 'UPLOAD'\n};\nvar _CLOSING_STEPS_STATUS = {\n  UNVERIFIED: 'UNVERIFIED',\n  VALID: 'VALID',\n  ERROR: 'ERROR'\n};\nvar _AUCTION_MOST_IMPORTANT = {\n  SPEED: 'SPEED',\n  PRICE: 'PRICE',\n  NOTHING: 'NOTHING'\n};\nvar _INSURANCE_USE_PRESET = {\n  WITHDRAWAL: 'WITHDRAWAL',\n  COLLATERAL: 'COLLATERAL'\n};\nvar _LOAN_STRATEGY_PRESET = {\n  FIXED: 'FIXED',\n  MANUAL: 'MANUAL'\n};\nvar _AMORTIZATION_STRATEGY_PRESET = {\n  INDIRECT: 'INDIRECT',\n  DIRECT: 'DIRECT'\n};\nvar _PAYMENT_SCHEDULES = {\n  MONTHLY: 'MONTHLY',\n  YEARLY: 'YEARLY',\n  SEMESTERLY: 'SEMESTERLY'\n};\nvar _LOAN_QUERIES = {\n  ADMIN_LOAN: 'ADMIN_LOAN',\n  ADMIN_LOANS: 'ADMIN_LOANS',\n  ASSIGNED_TO: 'ASSIGNED_TO'\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"loans.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/loans/loans.js                                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Mongo = void 0;\n\nmodule.watch(require(\"meteor/mongo\"), {\n  Mongo: function Mongo(v) {\n    _Mongo = v;\n  }\n}, 0);\nvar SimpleSchema = void 0;\nmodule.watch(require(\"simpl-schema\"), {\n  default: function _default(v) {\n    SimpleSchema = v;\n  }\n}, 1);\n\nvar _getFileSchema = void 0;\n\nmodule.watch(require(\"../files/files\"), {\n  getFileSchema: function getFileSchema(v) {\n    _getFileSchema = v;\n  }\n}, 2);\n\nvar _GeneralSchema = void 0,\n    _PropertySchema = void 0,\n    _LogicSchema = void 0;\n\nmodule.watch(require(\"./additionalSchemas\"), {\n  GeneralSchema: function GeneralSchema(v) {\n    _GeneralSchema = v;\n  },\n  PropertySchema: function PropertySchema(v) {\n    _PropertySchema = v;\n  },\n  LogicSchema: function LogicSchema(v) {\n    _LogicSchema = v;\n  }\n}, 3);\n\nvar _LOAN_STATUS = void 0;\n\nmodule.watch(require(\"./loanConstants\"), {\n  LOAN_STATUS: function LOAN_STATUS(v) {\n    _LOAN_STATUS = v;\n  }\n}, 4);\nvar Loans = new _Mongo.Collection('loans');\nvar LoanFilesSchema = new SimpleSchema(_getFileSchema('loan')); // Prevent all client side modifications of mongoDB\n\nLoans.deny({\n  insert: function insert() {\n    return true;\n  },\n  update: function update() {\n    return true;\n  },\n  remove: function remove() {\n    return true;\n  }\n});\nLoans.allow({\n  insert: function insert() {\n    return true;\n  },\n  update: function update() {\n    return false;\n  },\n  remove: function remove() {\n    return false;\n  }\n}); // Documentation is in the google drive dev/MongoDB Schemas\n\nvar LoanSchema = new SimpleSchema({\n  userId: {\n    type: String,\n    optional: true\n  },\n  createdAt: {\n    type: Date,\n    autoValue: function autoValue() {\n      if (this.isInsert) {\n        return new Date();\n      }\n    }\n  },\n  updatedAt: {\n    type: Date,\n    autoValue: function autoValue() {\n      // Verify the update is from the user owning this doc, ignoring admin/partner updates\n      var doc = Loans.findOne({\n        _id: this.docId\n      }, {\n        fields: {\n          userId: 1\n        }\n      });\n\n      if (this.isInsert) {\n        return new Date();\n      } else if (this.isUpdate && doc && this.userId === doc.userId) {\n        return new Date();\n      }\n    }\n  },\n  status: {\n    type: String,\n    defaultValue: _LOAN_STATUS.ACTIVE,\n    allowedValues: Object.values(_LOAN_STATUS)\n  },\n  name: {\n    type: String,\n    optional: true,\n    defaultValue: ''\n  },\n  general: {\n    type: _GeneralSchema,\n    defaultValue: {}\n  },\n  borrowerIds: {\n    type: Array,\n    defaultValue: []\n  },\n  'borrowerIds.$': String,\n  // property: PropertySchema,\n  propertyId: {\n    type: String\n  },\n  files: {\n    type: LoanFilesSchema,\n    defaultValue: {}\n  },\n  logic: {\n    type: _LogicSchema,\n    defaultValue: {}\n  },\n  adminValidation: {\n    type: Object,\n    defaultValue: {},\n    blackbox: true\n  },\n  emails: {\n    type: Array,\n    defaultValue: []\n  },\n  'emails.$': Object,\n  'emails.$._id': String,\n  'emails.$.emailId': String,\n  'emails.$.status': String,\n  'emails.$.updatedAt': Date,\n  'emails.$.scheduledAt': {\n    type: Date,\n    optional: true\n  }\n}); // Finally, attach schema to the Mongo collection and export\n\nLoans.attachSchema(LoanSchema);\nmodule.exportDefault(Loans);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"mutationDefinitions.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/loans/mutationDefinitions.js                                                                       //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  LOAN_INSERT: function LOAN_INSERT() {\n    return _LOAN_INSERT;\n  },\n  LOAN_UPDATE: function LOAN_UPDATE() {\n    return _LOAN_UPDATE;\n  },\n  LOAN_DELETE: function LOAN_DELETE() {\n    return _LOAN_DELETE;\n  },\n  INCREMENT_LOAN_STEP: function INCREMENT_LOAN_STEP() {\n    return _INCREMENT_LOAN_STEP;\n  },\n  REQUEST_LOAN_VERIFICATION: function REQUEST_LOAN_VERIFICATION() {\n    return _REQUEST_LOAN_VERIFICATION;\n  },\n  START_AUCTION: function START_AUCTION() {\n    return _START_AUCTION;\n  },\n  END_AUCTION: function END_AUCTION() {\n    return _END_AUCTION;\n  },\n  CANCEL_AUCTION: function CANCEL_AUCTION() {\n    return _CANCEL_AUCTION;\n  },\n  CONFIRM_CLOSING: function CONFIRM_CLOSING() {\n    return _CONFIRM_CLOSING;\n  }\n});\nexports.LOAN_INSERT = _LOAN_INSERT;\nvar _LOAN_INSERT = {\n  name: 'LOAN_INSERT',\n  params: {\n    loan: {\n      type: Object\n    },\n    userId: {\n      type: String,\n      optional: true\n    }\n  }\n};\nvar _LOAN_UPDATE = {\n  name: 'LOAN_UPDATE',\n  params: {\n    loanId: {\n      type: String\n    },\n    object: {\n      type: Object\n    }\n  }\n};\nvar _LOAN_DELETE = {\n  name: 'LOAN_DELETE',\n  params: {\n    loanId: {\n      type: String\n    }\n  }\n};\nvar _INCREMENT_LOAN_STEP = {\n  name: 'INCREMENT_LOAN_STEP',\n  params: {\n    loanId: {\n      type: String\n    }\n  }\n};\nvar _REQUEST_LOAN_VERIFICATION = {\n  name: 'REQUEST_LOAN_VERIFICATION',\n  params: {\n    loanId: {\n      type: String\n    }\n  }\n};\nvar _START_AUCTION = {\n  name: 'START_AUCTION',\n  params: {\n    loanId: {\n      type: String\n    }\n  }\n};\nvar _END_AUCTION = {\n  name: 'END_AUCTION',\n  params: {\n    loanId: {\n      type: String\n    }\n  }\n};\nvar _CANCEL_AUCTION = {\n  name: 'CANCEL_AUCTION',\n  params: {\n    loanId: {\n      type: String\n    }\n  }\n};\nvar _CONFIRM_CLOSING = {\n  name: 'CONFIRM_CLOSING',\n  params: {\n    loanId: {\n      type: String\n    },\n    object: {\n      type: Object\n    }\n  }\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"pdf.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/loans/pdf.js                                                                                       //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  AnonymousLoanPDF: function AnonymousLoanPDF() {\n    return _AnonymousLoanPDF;\n  },\n  LoanPDF: function LoanPDF() {\n    return _LoanPDF;\n  }\n});\nvar React = void 0;\nmodule.watch(require(\"react\"), {\n  default: function _default(v) {\n    React = v;\n  }\n}, 0);\nexports.AnonymousLoanPDF = _AnonymousLoanPDF;\nvar InlineCss = void 0;\nmodule.watch(require(\"react-inline-css\"), {\n  default: function _default(v) {\n    InlineCss = v;\n  }\n}, 1);\n\nvar _AnonymousLoanPDF = function _AnonymousLoanPDF(loan, borrowers) {\n  return React.createElement(\n    InlineCss,\n    {\n      stylesheet: \"\\n      .Document {\\n        font-family: \\\"Helvetica Neue\\\", \\\"Helvetica\\\", \\\"Arial\\\", sans-serif;\\n      }\\n\\n      h1 {\\n        color: red;\\n      }\"\n    },\n    React.createElement(\n      \"div\",\n      {\n        className: \"Document\"\n      },\n      React.createElement(\n        \"h1\",\n        null,\n        \"Hello Yannis! (Anonymis\\xE9)\"\n      )\n    )\n  );\n};\n\nvar _LoanPDF = function _LoanPDF(loan, borrowers) {\n  return React.createElement(\n    InlineCss,\n    {\n      stylesheet: \"\\n      .Document {\\n        font-family: \\\"Helvetica Neue\\\", \\\"Helvetica\\\", \\\"Arial\\\", sans-serif;\\n      }\\n\\n      h1 {\\n        color: red;\\n      }\"\n    },\n    React.createElement(\n      \"div\",\n      {\n        className: \"Document\"\n      },\n      React.createElement(\n        \"h1\",\n        null,\n        \"Hello Yannis!\"\n      )\n    )\n  );\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"methods\":{\"server\":{\"compoundMethods.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/methods/server/compoundMethods.js                                                                  //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _check = void 0;\n\nmodule.watch(require(\"meteor/check\"), {\n  check: function check(v) {\n    _check = v;\n  }\n}, 1);\nvar Loans = void 0;\nmodule.watch(require(\"../../loans/loans\"), {\n  default: function _default(v) {\n    Loans = v;\n  }\n}, 2);\nvar Borrowers = void 0;\nmodule.watch(require(\"../../borrowers/borrowers\"), {\n  default: function _default(v) {\n    Borrowers = v;\n  }\n}, 3);\n\n_Meteor.methods({\n  setUserToLoan: function setUserToLoan(_ref) {\n    var loanId = _ref.loanId;\n\n    _check(loanId, String);\n\n    if (!_Meteor.userId()) {\n      throw new _Meteor.Error('not authorized');\n    }\n\n    var loan = Loans.findOne(loanId);\n    var borrowers = loan.borrowers;\n    Loans.update(loanId, {\n      $set: {\n        userId: _Meteor.userId()\n      }\n    });\n    borrowers.forEach(function (borrowerId) {\n      Borrowers.update(borrowerId, {\n        $set: {\n          userId: _Meteor.userId()\n        }\n      });\n    });\n    return true;\n  },\n  addBorrower: function addBorrower(_ref2) {\n    var loanId = _ref2.loanId;\n    // TODO: Secure this\n    var loan = Loans.findOne(loanId); // A loan can't have more than 2 borrowers at the moment\n\n    if (loan.borrowerIds.length >= 2) {\n      return false;\n    }\n\n    var newBorrowerId = Borrowers.insert({\n      userId: _Meteor.userId()\n    });\n    return Loans.update(loanId, {\n      $push: {\n        borrowerIds: newBorrowerId\n      }\n    });\n  },\n  removeBorrower: function removeBorrower(_ref3) {\n    var loanId = _ref3.loanId,\n        borrowerId = _ref3.borrowerId;\n    // TODO: Secure this\n    var loan = Loans.findOne(loanId); // A loan has to have at least 1 borrower\n\n    if (loan.borrowerIds.length <= 1) {\n      return false;\n    }\n\n    Borrowers.remove(borrowerId);\n    return Loans.update(loanId, {\n      $pull: {\n        borrowerIds: borrowerId\n      }\n    });\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"createUserAndLoan.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/methods/server/createUserAndLoan.js                                                                //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _Accounts = void 0;\n\nmodule.watch(require(\"meteor/accounts-base\"), {\n  Accounts: function Accounts(v) {\n    _Accounts = v;\n  }\n}, 1);\nvar saveStartForm = void 0;\nmodule.watch(require(\"../../../utils/saveStartForm\"), {\n  default: function _default(v) {\n    saveStartForm = v;\n  }\n}, 2);\n\nvar _addUserTracking = void 0;\n\nmodule.watch(require(\"../../../utils/analytics\"), {\n  addUserTracking: function addUserTracking(v) {\n    _addUserTracking = v;\n  }\n}, 3);\n\n_Meteor.methods({\n  createUserAndLoan: function createUserAndLoan(_ref) {\n    var email = _ref.email,\n        formState = _ref.formState;\n    console.log('creating user and loan...', email, formState); // Create the new user without a password\n\n    var newUserId = void 0;\n\n    try {\n      newUserId = _Accounts.createUser({\n        email: email\n      });\n    } catch (e) {\n      throw new _Meteor.Error(\"Couldn't create new user\", e);\n    } // Send an enrollment email\n\n\n    _Accounts.sendEnrollmentEmail(newUserId); // Insert the formdata to loan and borrower(s)\n\n\n    return saveStartForm(formState, newUserId);\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/methods/server/index.js                                                                            //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nmodule.watch(require(\"./compoundMethods\"), {\n  \"*\": module.makeNsSetter()\n}, 0);\nmodule.watch(require(\"./createUserAndLoan\"), {\n  \"*\": module.makeNsSetter()\n}, 1);\nmodule.watch(require(\"./miscellaneous\"), {\n  \"*\": module.makeNsSetter()\n}, 2);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"miscellaneous.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/methods/server/miscellaneous.js                                                                    //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  downloadPDF: function downloadPDF() {\n    return _downloadPDF;\n  }\n});\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _Roles = void 0;\n\nmodule.watch(require(\"meteor/alanning:roles\"), {\n  Roles: function Roles(v) {\n    _Roles = v;\n  }\n}, 1);\n\nvar _check = void 0;\n\nmodule.watch(require(\"meteor/check\"), {\n  check: function check(v) {\n    _check = v;\n  }\n}, 2);\n\nvar _ValidatedMethod = void 0;\n\nmodule.watch(require(\"meteor/mdg:validated-method\"), {\n  ValidatedMethod: function ValidatedMethod(v) {\n    _ValidatedMethod = v;\n  }\n}, 3);\nvar Loans = void 0;\nmodule.watch(require(\"../../loans/loans\"), {\n  default: function _default(v) {\n    Loans = v;\n  }\n}, 4);\nexports.downloadPDF = _downloadPDF;\nvar Borrowers = void 0;\nmodule.watch(require(\"../../borrowers/borrowers\"), {\n  default: function _default(v) {\n    Borrowers = v;\n  }\n}, 5);\n\nvar _generateComponentAsPDF = void 0;\n\nmodule.watch(require(\"../../../utils/generate-pdf\"), {\n  generateComponentAsPDF: function generateComponentAsPDF(v) {\n    _generateComponentAsPDF = v;\n  }\n}, 6);\n\nvar _LoanPDF = void 0,\n    _AnonymousLoanPDF = void 0;\n\nmodule.watch(require(\"../../loans/pdf.js\"), {\n  LoanPDF: function LoanPDF(v) {\n    _LoanPDF = v;\n  },\n  AnonymousLoanPDF: function AnonymousLoanPDF(v) {\n    _AnonymousLoanPDF = v;\n  }\n}, 7);\nvar rateLimit = void 0;\nmodule.watch(require(\"../../../utils/rate-limit.js\"), {\n  default: function _default(v) {\n    rateLimit = v;\n  }\n}, 8);\n\n_Meteor.methods({\n  getServerTime: function getServerTime() {\n    return new Date();\n  },\n  getMixpanelAuthorization: function getMixpanelAuthorization() {\n    if (_Roles.userIsInRole(_Meteor.userId(), 'dev') || _Roles.userIsInRole(_Meteor.userId(), 'admin')) {\n      var btoa = require('btoa');\n\n      var API_KEY = _Meteor.settings.MIXPANEL_API_KEY;\n      var API_SECRET = _Meteor.settings.MIXPANEL_API_SECRET;\n      return \"Basic \" + btoa(API_SECRET + \":\" + API_KEY);\n    }\n\n    throw new _Meteor.Error('Unauthorized access to getMixpanelAuthorization');\n  }\n});\n\nvar _downloadPDF = new _ValidatedMethod({\n  name: 'downloadPDF',\n  validate: function validate(_ref) {\n    var loanId = _ref.loanId,\n        type = _ref.type;\n\n    _check(loanId, String);\n\n    _check(type, String);\n  },\n  run: function run(_ref2) {\n    var loanId = _ref2.loanId,\n        type = _ref2.type;\n    var loan = Loans.findOne(loanId);\n    var borrowers = Borrowers.find({\n      _id: {\n        $in: loan.borrowerIds\n      }\n    });\n    var prefix = type === 'anonymous' ? 'Anonyme' : 'Complet';\n    var fileName = prefix + \" \" + loan.propertyId.address1 + \".pdf\"; // If type is anonymous, loan the anonymous pdf\n\n    var component = type === 'anonymous' ? _AnonymousLoanPDF : _LoanPDF;\n    return _generateComponentAsPDF({\n      component: component,\n      props: {\n        loan: loan,\n        borrowers: borrowers\n      },\n      fileName: fileName\n    }).then(function (result) {\n      return result;\n    }).catch(function (error) {\n      throw new _Meteor.Error('500', error);\n    });\n  }\n});\n\nrateLimit({\n  methods: [_downloadPDF]\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}}},\"mutations\":{\"server\":{\"index.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/mutations/server/index.js                                                                          //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nmodule.watch(require(\"../../users/server/mutations\"));\nmodule.watch(require(\"../../loans/server/mutations\"));\nmodule.watch(require(\"../../offers/server/mutations\"));\nmodule.watch(require(\"../../properties/server/mutations\"));\nmodule.watch(require(\"../../borrowers/server/mutations\"));\nmodule.watch(require(\"../../tasks/server/mutations\"));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"callMutation.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/mutations/callMutation.js                                                                          //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar module1 = module;\n\nvar _Meteor = void 0;\n\nmodule1.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _Bert = void 0;\n\nmodule1.watch(require(\"meteor/themeteorchef:bert\"), {\n  Bert: function Bert(v) {\n    _Bert = v;\n  }\n}, 1);\n\nvar _checkParams = void 0;\n\nmodule1.watch(require(\"./createMutator\"), {\n  checkParams: function checkParams(v) {\n    _checkParams = v;\n  }\n}, 2);\n\nvar handleError = function handleError(error, mutationName) {\n  if (_Meteor.isClient) {\n    _Bert.defaults.hideDelay = 7500;\n\n    _Bert.alert({\n      title: 'Misère, une erreur!',\n      message: \"<h3 class=\\\"bert\\\">\" + error.message + \" in \" + mutationName + \"</h3>\",\n      type: 'danger',\n      style: 'fixed-top'\n    });\n  }\n\n  console.log('callMutation error:', error); // Throw the error again so that it can be catched again via promise chaining\n  // All uses of this module should catch and implement proper fail-safe logic\n\n  throw error;\n};\n\nvar callMutation = function callMutation(mutationOptions) {\n  var callParams = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var name = mutationOptions.name,\n      params = mutationOptions.params;\n\n  _checkParams(callParams, params);\n\n  return new Promise(function (resolve, reject) {\n    _Meteor.call(name, callParams, function (error, result) {\n      if (error) {\n        reject(handleError(error, name));\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n\nmodule1.exportDefault(callMutation);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"createMutator.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/mutations/createMutator.js                                                                         //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.beforeLogger = undefined;\n\nvar _defineProperty2 = require(\"babel-runtime/helpers/defineProperty\");\n\nvar _defineProperty3 = _interopRequireDefault(_defineProperty2);\n\nvar _extends3 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends4 = _interopRequireDefault(_extends3);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.export({\n  beforeLogger: function beforeLogger() {\n    return _beforeLogger;\n  },\n  afterLogger: function afterLogger() {\n    return _afterLogger;\n  },\n  validateMutationOptions: function validateMutationOptions() {\n    return _validateMutationOptions;\n  },\n  checkParams: function checkParams() {\n    return _checkParams;\n  }\n});\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _check = void 0,\n    _Match = void 0;\n\nmodule.watch(require(\"meteor/check\"), {\n  check: function check(v) {\n    _check = v;\n  },\n  Match: function Match(v) {\n    _Match = v;\n  }\n}, 1);\nvar EventService = void 0;\nexports.beforeLogger = _beforeLogger;\nmodule.watch(require(\"../events\"), {\n  default: function _default(v) {\n    EventService = v;\n  }\n}, 2);\nvar INVALID_MUTATION_OPTIONS = 'INVALID_MUTATION_OPTIONS';\nvar MUTATION_ERROR = 'MUTATION_ERROR';\n\nvar _beforeLogger = function _beforeLogger(callParameters, name) {\n  if (_Meteor.isDevelopment && !_Meteor.isTest) {\n    console.log(\"Executing method \" + name + \" with the following params:\");\n    console.log(callParameters);\n  }\n};\n\nvar _afterLogger = function _afterLogger(result, name) {\n  if (_Meteor.isDevelopment && !_Meteor.isTest) {\n    console.log(\"Executed \" + name + \" and got result:\");\n    console.log(result);\n  }\n};\n\nvar _validateMutationOptions = function _validateMutationOptions(_ref) {\n  var name = _ref.name,\n      params = _ref.params;\n\n  if (!name || typeof name !== 'string') {\n    throw new _Meteor.Error(INVALID_MUTATION_OPTIONS, 'name has to be a string');\n  }\n\n  if (params) {\n    Object.keys(params).forEach(function (param) {\n      var type = params[param].type;\n\n      if (!type) {\n        throw new _Meteor.Error(INVALID_MUTATION_OPTIONS, \"you have to provide a type for parameter: \\\"\" + param + \"\\\" in \" + name);\n      }\n    });\n  }\n};\n\nvar _checkParams = function _checkParams(callParameters, params) {\n  _check(callParameters, Object.keys(params).reduce(function (matchPattern, param) {\n    var _params$param = params[param],\n        optional = _params$param.optional,\n        type = _params$param.type; // Return a Match Pattern and check for optionals\n\n    return (0, _extends4.default)({}, matchPattern, (0, _defineProperty3.default)({}, param, optional ? _Match.Optional(type) : type));\n  }, {}));\n};\n\nvar createMutator = function createMutator(options, functionBody) {\n  _validateMutationOptions(options);\n\n  var name = options.name,\n      params = options.params;\n\n  _Meteor.methods((0, _defineProperty3.default)({}, name, function (callParameters) {\n    _beforeLogger(callParameters, name);\n\n    _checkParams(callParameters, params, name);\n\n    var result = void 0;\n\n    try {\n      result = functionBody(callParameters);\n      EventService.emitMutation(options, callParameters);\n    } catch (error) {\n      throw error;\n    }\n\n    _afterLogger(result, name);\n\n    return result;\n  }));\n};\n\nmodule.exportDefault(createMutator);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/mutations/index.js                                                                                 //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.mutations = undefined;\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.export({\n  mutations: function mutations() {\n    return _mutations;\n  }\n});\nmodule.watch(require(\"./createMutator\"), {\n  default: function _default(v) {\n    exports.createMutator = v;\n  }\n}, 6);\nmodule.watch(require(\"./callMutation\"), {\n  default: function _default(v) {\n    exports.callMutation = v;\n  }\n}, 7);\n\nvar _userMutations = void 0;\n\nmodule.watch(require(\"../users\"), {\n  userMutations: function userMutations(v) {\n    _userMutations = v;\n  }\n}, 0);\n\nvar _loanMutations = void 0;\n\nmodule.watch(require(\"../loans\"), {\n  loanMutations: function loanMutations(v) {\n    _loanMutations = v;\n  }\n}, 1);\n\nvar _borrowerMutations = void 0;\n\nmodule.watch(require(\"../borrowers\"), {\n  borrowerMutations: function borrowerMutations(v) {\n    _borrowerMutations = v;\n  }\n}, 2);\nexports.mutations = _mutations;\n\nvar _offerMutations = void 0;\n\nmodule.watch(require(\"../offers\"), {\n  offerMutations: function offerMutations(v) {\n    _offerMutations = v;\n  }\n}, 3);\n\nvar _propertyMutations = void 0;\n\nmodule.watch(require(\"../properties\"), {\n  propertyMutations: function propertyMutations(v) {\n    _propertyMutations = v;\n  }\n}, 4);\n\nvar _taskMutations = void 0;\n\nmodule.watch(require(\"../tasks\"), {\n  taskMutations: function taskMutations(v) {\n    _taskMutations = v;\n  }\n}, 5);\n\n// Export all mutation definitions here\nvar _mutations = (0, _extends3.default)({}, _loanMutations, _borrowerMutations, _offerMutations, _propertyMutations, _userMutations, _taskMutations);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"offers\":{\"server\":{\"methods.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/offers/server/methods.js                                                                           //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.insertOffer = undefined;\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.export({\n  insertOffer: function insertOffer() {\n    return _insertOffer;\n  },\n  insertAdminOffer: function insertAdminOffer() {\n    return _insertAdminOffer;\n  },\n  updateOffer: function updateOffer() {\n    return _updateOffer;\n  },\n  insertFakeOffer: function insertFakeOffer() {\n    return _insertFakeOffer;\n  },\n  deleteOffer: function deleteOffer() {\n    return _deleteOffer;\n  }\n});\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _ValidatedMethod = void 0;\n\nmodule.watch(require(\"meteor/mdg:validated-method\"), {\n  ValidatedMethod: function ValidatedMethod(v) {\n    _ValidatedMethod = v;\n  }\n}, 1);\n\nvar _Roles = void 0;\n\nmodule.watch(require(\"meteor/alanning:roles\"), {\n  Roles: function Roles(v) {\n    _Roles = v;\n  }\n}, 2);\n\nvar _check = void 0,\n    _Match = void 0;\n\nmodule.watch(require(\"meteor/check\"), {\n  check: function check(v) {\n    _check = v;\n  },\n  Match: function Match(v) {\n    _Match = v;\n  }\n}, 3);\nexports.insertOffer = _insertOffer;\n\nvar _CallPromiseMixin = void 0;\n\nmodule.watch(require(\"meteor/didericis:callpromise-mixin\"), {\n  CallPromiseMixin: function CallPromiseMixin(v) {\n    _CallPromiseMixin = v;\n  }\n}, 4);\nvar rateLimit = void 0;\nmodule.watch(require(\"../../../utils/rate-limit.js\"), {\n  default: function _default(v) {\n    rateLimit = v;\n  }\n}, 5);\nvar Loans = void 0;\nmodule.watch(require(\"../../loans\"), {\n  default: function _default(v) {\n    Loans = v;\n  }\n}, 6);\nvar Offers = void 0;\nmodule.watch(require(\"../offers\"), {\n  default: function _default(v) {\n    Offers = v;\n  }\n}, 7);\n\n// Insert a new offer\nvar _insertOffer = new _ValidatedMethod({\n  name: 'insertOffer',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref) {\n    var object = _ref.object,\n        userId = _ref.userId;\n\n    _check(object, Object);\n\n    _check(userId, _Match.Optional(String));\n  },\n  run: function run(_ref2) {\n    var object = _ref2.object,\n        userId = _ref2.userId;\n\n    // Make sure there isn't already an offer for this loan\n    var user = _Meteor.user();\n\n    var offer = Offers.findOne({\n      loanId: object.loanId,\n      organization: user.profile.organization\n    });\n\n    if (offer) {\n      throw new _Meteor.Error('noTwoOffers', 'Your organization has already made an offer on this loan');\n    }\n\n    var loan = Loans.findOne(object.loanId);\n    object.userId = userId || _Meteor.userId();\n    object.organization = user.profile.organization;\n    object.canton = user.profile.cantons[0];\n    object.auctionEndTime = loan.logic.auction.endTime;\n    return Offers.insert(object);\n  }\n});\n\nvar _insertAdminOffer = new _ValidatedMethod({\n  name: 'insertAdminOffer',\n  mixins: [_CallPromiseMixin],\n  validate: null,\n  run: function run(_ref3) {\n    var object = _ref3.object;\n\n    if (!(_Roles.userIsInRole(_Meteor.userId(), 'admin') || _Roles.userIsInRole(_Meteor.userId(), 'dev'))) {\n      return false;\n    }\n\n    var loan = Loans.findOne(object.loanId);\n    return Offers.insert((0, _extends3.default)({}, object, {\n      userId: _Meteor.userId(),\n      isAdmin: true,\n      auctionEndTime: loan.logic.auction.endTime,\n      // this doesn't update when the loan is ended prematurely by an admin\n      canton: 'GE'\n    }));\n  }\n});\n\nvar _updateOffer = new _ValidatedMethod({\n  name: 'updateOffer',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref4) {\n    var id = _ref4.id,\n        object = _ref4.object;\n\n    _check(id, String);\n\n    _check(object, Object);\n  },\n  run: function run(_ref5) {\n    var id = _ref5.id,\n        object = _ref5.object;\n    return Offers.update(id, {\n      $set: object\n    });\n  }\n});\n\nvar _insertFakeOffer = new _ValidatedMethod({\n  name: 'insertFakeOffer',\n  mixins: [_CallPromiseMixin],\n  validate: null,\n  run: function run(_ref6) {\n    var object = _ref6.object;\n    return Offers.insert((0, _extends3.default)({}, object, {\n      userId: _Meteor.userId()\n    }));\n  }\n});\n\nvar _deleteOffer = new _ValidatedMethod({\n  name: 'deleteOffer',\n  mixins: [_CallPromiseMixin],\n  validate: function validate() {},\n  run: function run(_ref7) {\n    var id = _ref7.id;\n\n    if (_Roles.userIsInRole(_Meteor.userId(), 'dev') || _Roles.userIsInRole(_Meteor.userId(), 'admin')) {\n      return Offers.remove(id);\n    }\n\n    return false;\n  }\n});\n\nrateLimit({\n  methods: [_insertOffer, _insertAdminOffer, _updateOffer, _insertFakeOffer]\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"mutations.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/offers/server/mutations.js                                                                         //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _SecurityService = void 0,\n    _createMutator = void 0;\n\nmodule.watch(require(\"../..\"), {\n  SecurityService: function SecurityService(v) {\n    _SecurityService = v;\n  },\n  createMutator: function createMutator(v) {\n    _createMutator = v;\n  }\n}, 1);\nvar OfferService = void 0;\nmodule.watch(require(\"../OfferService\"), {\n  default: function _default(v) {\n    OfferService = v;\n  }\n}, 2);\nvar defs = void 0;\nmodule.watch(require(\"../mutationDefinitions\"), {\n  \"*\": function _(v) {\n    defs = v;\n  }\n}, 3);\n\n_createMutator(defs.OFFER_INSERT, function (_ref) {\n  var offer = _ref.offer,\n      userId = _ref.userId;\n  var userIdIsDefined = userId !== undefined;\n\n  if (userIdIsDefined) {\n    _SecurityService.checkCurrentUserIsAdmin();\n  } else {\n    _SecurityService.offers.isAllowedToInsert();\n  }\n\n  return OfferService.insert({\n    offer: offer,\n    userId: userIdIsDefined ? userId : _Meteor.userId()\n  });\n});\n\n_createMutator(defs.OFFER_INSERT_ADMIN, function (_ref2) {\n  var offer = _ref2.offer,\n      loan = _ref2.loan;\n\n  _SecurityService.checkLoggedIn();\n\n  if (_SecurityService.currentUserIsAdmin()) {\n    return OfferService.insertAdminOffer({\n      offer: offer,\n      loan: loan\n    });\n  }\n\n  return null;\n});\n\n_createMutator(defs.OFFER_UPDATE, function (_ref3) {\n  var offerId = _ref3.offerId,\n      offer = _ref3.offer;\n\n  _SecurityService.offers.isAllowedToUpdate(offerId);\n\n  return OfferService.update({\n    offerId: offerId,\n    offer: offer\n  });\n});\n\n_createMutator(defs.OFFER_DELETE, function (_ref4) {\n  var offerId = _ref4.offerId;\n\n  _SecurityService.offers.isAllowedToDelete(offerId);\n\n  return OfferService.remove({\n    offerId: offerId\n  });\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"publications.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/offers/server/publications.js                                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _check = void 0;\n\nmodule.watch(require(\"meteor/check\"), {\n  check: function check(v) {\n    _check = v;\n  }\n}, 1);\n\nvar _Roles = void 0;\n\nmodule.watch(require(\"meteor/alanning:roles\"), {\n  Roles: function Roles(v) {\n    _Roles = v;\n  }\n}, 2);\nvar Offers = void 0;\nmodule.watch(require(\"../offers\"), {\n  default: function _default(v) {\n    Offers = v;\n  }\n}, 3);\nvar Loans = void 0;\nmodule.watch(require(\"../../loans/loans\"), {\n  default: function _default(v) {\n    Loans = v;\n  }\n}, 4);\n\n// Get all offers for the currently active loan\n_Meteor.publish('activeOffers', function () {\n  var activeLoan = Loans.findOne({\n    userId: _Meteor.userId(),\n    active: true\n  });\n  return Offers.find({\n    loanId: activeLoan._id\n  });\n}); // Get all offers for the currently active loan\n\n\n_Meteor.publish('userOffers', function () {\n  var loans = Loans.find({\n    userId: _Meteor.userId()\n  });\n  var IDs = loans.map(function (r) {\n    return r._id;\n  });\n  return Offers.find({\n    loanId: {\n      $in: IDs\n    }\n  });\n}); // Get all offers the partner has made\n\n\n_Meteor.publish('partnerOffers', function publish() {\n  var user = _Meteor.users.findOne(_Meteor.userId());\n\n  if (_Roles.userIsInRole(_Meteor.userId(), 'partner')) {\n    return Offers.find({\n      organization: user.profile && user.profile.organization // auctionEndTime: { $lt: new Date() },\n\n    });\n  }\n\n  return this.ready();\n}); // Publish all offers in the database for admins\n\n\n_Meteor.publish('allOffers', function publish() {\n  // Verify if user is logged In\n  if (_Roles.userIsInRole(_Meteor.userId(), 'admin') || _Roles.userIsInRole(_Meteor.userId(), 'dev')) {\n    // Return all users\n    return Offers.find();\n  }\n\n  return this.ready();\n}); // Publish all offers for a loan for admins\n\n\n_Meteor.publish('loanOffers', function publish(loanId) {\n  _check(loanId, String); // Verify if user is logged In\n\n\n  if (_Roles.userIsInRole(_Meteor.userId(), 'admin') || _Roles.userIsInRole(_Meteor.userId(), 'dev')) {\n    return Offers.find({\n      loanId: loanId\n    });\n  }\n\n  return this.ready();\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"OfferService.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/offers/OfferService.js                                                                             //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.export({\n  default: function _default() {\n    return _class;\n  }\n});\n\nvar _Offers = void 0;\n\nmodule.watch(require(\"..\"), {\n  Offers: function Offers(v) {\n    _Offers = v;\n  }\n}, 0);\nvar Security = void 0;\nmodule.watch(require(\"../security\"), {\n  default: function _default(v) {\n    Security = v;\n  }\n}, 1);\n\nvar _class = function _class() {\n  (0, _classCallCheck3.default)(this, _class);\n};\n\n_class.update = function (_ref) {\n  var offerId = _ref.offerId,\n      offer = _ref.offer;\n  return _Offers.update(offerId, {\n    $set: offer\n  });\n};\n\n_class.insert = function (_ref2) {\n  var offer = _ref2.offer,\n      userId = _ref2.userId;\n  return _Offers.insert((0, _extends3.default)({}, offer, {\n    userId: userId\n  }));\n};\n\n_class.insertAdminOffer = function (_ref3) {\n  var offer = _ref3.offer,\n      loan = _ref3.loan,\n      userId = _ref3.userId;\n  return _Offers.insert((0, _extends3.default)({}, offer, {\n    userId: userId,\n    isAdmin: true,\n    auctionEndTime: loan.logic.auction.endTime,\n    // this doesn't update when the loan is ended prematurely by an admin\n    canton: 'GE',\n    loanId: loan._id\n  }));\n};\n\n_class.remove = function (_ref4) {\n  var offerId = _ref4.offerId;\n  return _Offers.remove(offerId);\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"fakes.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/offers/fakes.js                                                                                    //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  getRandomOffer: function getRandomOffer() {\n    return _getRandomOffer;\n  }\n});\n\nvar _getLoanValue = void 0,\n    _getPropAndWork = void 0;\n\nmodule.watch(require(\"../../utils/loanFunctions\"), {\n  getLoanValue: function getLoanValue(v) {\n    _getLoanValue = v;\n  },\n  getPropAndWork: function getPropAndWork(v) {\n    _getPropAndWork = v;\n  }\n}, 0);\n\nvar getRandomCondition = function getRandomCondition() {\n  var conditions = ['Expertise additionelle requise', '', '', '', '', '', '', '', ''];\n  return conditions[Math.floor(Math.random() * conditions.length)];\n};\n\nvar getRandomCounterpart = function getRandomCounterpart() {\n  var counterparts = ['Gestion de toute la fortune', 'Souscrire à une assurance vie', \"Gestion de CHF 100'000 de patrimoine minimum\", 'Souscrire à une assurance voiture', '', '', '', '', '', '', '', ''];\n  return counterparts[Math.floor(Math.random() * counterparts.length)];\n};\n\nvar round = function round(v) {\n  return Math.round(v * 10000) / 10000;\n};\n\nexports.getRandomOffer = _getRandomOffer;\n\nvar rand = function rand(min, max) {\n  return round(Math.random() * (max - min) + min);\n};\n\nvar _getRandomOffer = function _getRandomOffer(_ref) {\n  var loan = _ref.loan,\n      property = _ref.property;\n  var matchLoanWanted = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  var rate1 = rand(0.007, 0.012);\n  var rate2 = rand(0.005, 0.009); // Randomly add rank 1 offers 25% of the time\n\n  var loanWanted = Math.random() > 0.75 && !matchLoanWanted ? 0.65 * _getPropAndWork({\n    loan: loan,\n    property: property\n  }) : _getLoanValue({\n    loan: loan,\n    property: property\n  });\n  var maxAmoutLimited = loanWanted > 100000000 ? 100000000 : loanWanted;\n  var counterpart = getRandomCounterpart();\n  var condition = getRandomCondition();\n  return {\n    organization: 'fake',\n    canton: 'GE',\n    loanId: loan._id,\n    auctionEndTime: new Date(),\n    isSwiss: true,\n    worksForOwnCompany: true,\n    standardOffer: {\n      maxAmount: maxAmoutLimited,\n      amortization: 0.01,\n      interestLibor: rate1,\n      interest1: round(rate1 + rand(0.0004, 0.0016)),\n      interest2: round(rate1 + rand(0.0016, 0.004)),\n      interest5: round(rate1 + rand(0.004, 0.006)),\n      interest10: round(rate1 + rand(0.006, 0.01))\n    },\n    counterpartOffer: {\n      maxAmount: maxAmoutLimited,\n      amortization: 0.01,\n      interestLibor: rate2,\n      interest1: round(rate2 + rand(0.0004, 0.0016)),\n      interest2: round(rate2 + rand(0.0016, 0.004)),\n      interest5: round(rate2 + rand(0.004, 0.006)),\n      interest10: round(rate2 + rand(0.006, 0.01))\n    },\n    counterparts: counterpart ? [counterpart] : [],\n    conditions: condition ? [condition] : []\n  };\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/offers/index.js                                                                                    //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  offerMutations: function offerMutations() {\n    return _offerMutations;\n  }\n});\nmodule.watch(require(\"./offers\"), {\n  default: function _default(v) {\n    exports.default = v;\n  }\n}, 1);\nvar mutationDefinitions = void 0;\nexports.offerMutations = _offerMutations;\nmodule.watch(require(\"./mutationDefinitions\"), {\n  \"*\": function _(v) {\n    mutationDefinitions = v;\n  }\n}, 0);\nvar _offerMutations = mutationDefinitions;\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"mutationDefinitions.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/offers/mutationDefinitions.js                                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  OFFER_INSERT: function OFFER_INSERT() {\n    return _OFFER_INSERT;\n  },\n  OFFER_INSERT_ADMIN: function OFFER_INSERT_ADMIN() {\n    return _OFFER_INSERT_ADMIN;\n  },\n  OFFER_UPDATE: function OFFER_UPDATE() {\n    return _OFFER_UPDATE;\n  },\n  OFFER_DELETE: function OFFER_DELETE() {\n    return _OFFER_DELETE;\n  }\n});\nexports.OFFER_INSERT = _OFFER_INSERT;\nvar _OFFER_INSERT = {\n  name: 'OFFER_INSERT',\n  params: {\n    offer: {\n      type: Object\n    },\n    userId: {\n      type: String,\n      optional: true\n    },\n    loanId: {\n      type: String\n    }\n  }\n};\nvar _OFFER_INSERT_ADMIN = {\n  name: 'OFFER_INSERT_ADMIN',\n  params: {\n    offer: {\n      type: Object\n    },\n    loan: {\n      type: Object\n    }\n  }\n};\nvar _OFFER_UPDATE = {\n  name: 'OFFER_UPDATE',\n  params: {\n    offerId: {\n      type: String\n    },\n    offer: {\n      type: Object\n    }\n  }\n};\nvar _OFFER_DELETE = {\n  name: 'OFFER_DELETE',\n  params: {\n    offerId: {\n      type: String\n    }\n  }\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"offerConstants.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/offers/offerConstants.js                                                                           //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  OFFER_TYPE: function OFFER_TYPE() {\n    return _OFFER_TYPE;\n  }\n});\nexports.OFFER_TYPE = _OFFER_TYPE;\nvar _OFFER_TYPE = {\n  STANDARD: 'STANDARD',\n  COUNTERPARTS: 'COUNTERPARTS'\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"offers.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/offers/offers.js                                                                                   //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.OfferSchema = undefined;\n\nvar _defineProperty2 = require(\"babel-runtime/helpers/defineProperty\");\n\nvar _defineProperty3 = _interopRequireDefault(_defineProperty2);\n\nvar _extends3 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends4 = _interopRequireDefault(_extends3);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.export({\n  OfferSchema: function OfferSchema() {\n    return _OfferSchema;\n  }\n});\n\nvar _Mongo = void 0;\n\nmodule.watch(require(\"meteor/mongo\"), {\n  Mongo: function Mongo(v) {\n    _Mongo = v;\n  }\n}, 0);\nvar SimpleSchema = void 0;\nmodule.watch(require(\"simpl-schema\"), {\n  default: function _default(v) {\n    SimpleSchema = v;\n  }\n}, 1);\n\nvar _INTEREST_RATES = void 0,\n    _CANTONS = void 0;\n\nmodule.watch(require(\"../constants\"), {\n  INTEREST_RATES: function INTEREST_RATES(v) {\n    _INTEREST_RATES = v;\n  },\n  CANTONS: function CANTONS(v) {\n    _CANTONS = v;\n  }\n}, 2);\nvar Offers = new _Mongo.Collection('offers'); // Prevent all client side modifications of mongoDB\n\nexports.OfferSchema = _OfferSchema;\nOffers.deny({\n  insert: function insert() {\n    return true;\n  },\n  update: function update() {\n    return true;\n  },\n  remove: function remove() {\n    return true;\n  }\n});\nOffers.allow({\n  insert: function insert() {\n    return false;\n  },\n  update: function update() {\n    return false;\n  },\n  remove: function remove() {\n    return false;\n  }\n});\nvar singleOffer = new SimpleSchema((0, _extends4.default)({\n  maxAmount: {\n    type: Number,\n    min: 0,\n    max: 100000000\n  },\n  amortization: {\n    type: Number\n  }\n}, Object.values(_INTEREST_RATES).reduce(function (object, interestKey) {\n  return (0, _extends4.default)({}, object, (0, _defineProperty3.default)({}, interestKey, {\n    type: Number,\n    min: 0,\n    max: 100,\n    optional: true\n  }));\n}, {})));\n\nvar _OfferSchema = new SimpleSchema({\n  loanId: {\n    type: String\n  },\n  userId: {\n    type: String\n  },\n  createdAt: {\n    type: Date,\n    autoValue: function autoValue() {\n      if (this.isInsert) {\n        return new Date();\n      }\n    }\n  },\n  updatedAt: {\n    type: Date,\n    autoValue: function autoValue() {\n      if (this.isInsert || this.isUpdate) {\n        return new Date();\n      }\n    }\n  },\n  isAdmin: {\n    type: Boolean,\n    defaultValue: false\n  },\n  organization: String,\n  canton: {\n    type: String,\n    allowedValues: Object.keys(_CANTONS)\n  },\n  auctionEndTime: {\n    type: Date,\n    optional: true\n  },\n  standardOffer: {\n    type: singleOffer\n  },\n  counterpartOffer: {\n    type: singleOffer,\n    optional: true\n  },\n  counterparts: {\n    type: Array,\n    defaultValue: [],\n    optional: true\n  },\n  'counterparts.$': String,\n  conditions: {\n    type: Array,\n    defaultValue: []\n  },\n  'conditions.$': String\n}); // Attach schema\n\n\nOffers.attachSchema(_OfferSchema);\nmodule.exportDefault(Offers);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"properties\":{\"queries\":{\"exposures.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/properties/queries/exposures.js                                                                    //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nmodule.watch(require(\"./propertyAsignee.expose\"));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"propertyAsignee.expose.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/properties/queries/propertyAsignee.expose.js                                                       //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar Security = void 0;\nmodule.watch(require(\"../../security\"), {\n  default: function _default(v) {\n    Security = v;\n  }\n}, 0);\nvar query = void 0;\nmodule.watch(require(\"./propertyAsignee\"), {\n  default: function _default(v) {\n    query = v;\n  }\n}, 1);\nquery.expose({\n  firewall: function firewall(userId) {\n    Security.checkCurrentUserIsAdmin(userId);\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"propertyAsignee.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/properties/queries/propertyAsignee.js                                                              //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar Property = void 0;\nmodule.watch(require(\"..\"), {\n  default: function _default(v) {\n    Property = v;\n  }\n}, 0);\n\nvar _PROPERTY_QUERIES = void 0;\n\nmodule.watch(require(\"../propertyConstants\"), {\n  PROPERTY_QUERIES: function PROPERTY_QUERIES(v) {\n    _PROPERTY_QUERIES = v;\n  }\n}, 1);\nmodule.exportDefault(Property.createQuery(_PROPERTY_QUERIES.PROPERTY_ASSIGNED_TO, {\n  $filter: function $filter(_ref) {\n    var filters = _ref.filters,\n        params = _ref.params;\n    filters.userId = params.userId;\n  },\n  assignedTo: 1\n}));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"server\":{\"methods.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/properties/server/methods.js                                                                       //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.insertProperty = undefined;\n\nvar _defineProperty2 = require(\"babel-runtime/helpers/defineProperty\");\n\nvar _defineProperty3 = _interopRequireDefault(_defineProperty2);\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.export({\n  insertProperty: function insertProperty() {\n    return _insertProperty;\n  },\n  deleteProperty: function deleteProperty() {\n    return _deleteProperty;\n  },\n  updateProperty: function updateProperty() {\n    return _updateProperty;\n  },\n  pushPropertyValue: function pushPropertyValue() {\n    return _pushPropertyValue;\n  },\n  popPropertyValue: function popPropertyValue() {\n    return _popPropertyValue;\n  },\n  setPropertyField: function setPropertyField() {\n    return _setPropertyField;\n  }\n});\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _ValidatedMethod = void 0;\n\nmodule.watch(require(\"meteor/mdg:validated-method\"), {\n  ValidatedMethod: function ValidatedMethod(v) {\n    _ValidatedMethod = v;\n  }\n}, 1);\n\nvar _check = void 0,\n    _Match = void 0;\n\nmodule.watch(require(\"meteor/check\"), {\n  check: function check(v) {\n    _check = v;\n  },\n  Match: function Match(v) {\n    _Match = v;\n  }\n}, 2);\nexports.insertProperty = _insertProperty;\n\nvar _Roles = void 0;\n\nmodule.watch(require(\"meteor/alanning:roles\"), {\n  Roles: function Roles(v) {\n    _Roles = v;\n  }\n}, 3);\n\nvar _CallPromiseMixin = void 0;\n\nmodule.watch(require(\"meteor/didericis:callpromise-mixin\"), {\n  CallPromiseMixin: function CallPromiseMixin(v) {\n    _CallPromiseMixin = v;\n  }\n}, 4);\nvar Properties = void 0;\nmodule.watch(require(\"../properties\"), {\n  default: function _default(v) {\n    Properties = v;\n  }\n}, 5);\n\nvar _insertProperty = new _ValidatedMethod({\n  name: 'insertProperty',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref) {\n    var object = _ref.object,\n        userId = _ref.userId;\n\n    _check(object, Object);\n\n    if (userId) {\n      _check(userId, String);\n    }\n  },\n  run: function run(_ref2) {\n    var object = _ref2.object,\n        userId = _ref2.userId;\n    return Properties.insert((0, _extends3.default)({}, object, {\n      userId: userId === undefined ? _Meteor.userId() : userId\n    }));\n  }\n});\n\nvar _deleteProperty = new _ValidatedMethod({\n  name: 'deleteProperty',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref3) {\n    var id = _ref3.id;\n\n    _check(id, String);\n  },\n  run: function run(_ref4) {\n    var id = _ref4.id;\n    return Properties.remove(id);\n  }\n});\n\nvar _updateProperty = new _ValidatedMethod({\n  name: 'updateProperty',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref5) {\n    var id = _ref5.id,\n        object = _ref5.object;\n\n    _check(id, String);\n\n    _check(object, Object);\n  },\n  run: function run(_ref6) {\n    var id = _ref6.id,\n        object = _ref6.object;\n    return Properties.update(id, {\n      $set: object\n    });\n  }\n});\n\nvar _pushPropertyValue = new _ValidatedMethod({\n  name: 'pushPropertyValue',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref7) {\n    var id = _ref7.id;\n\n    _check(id, String);\n  },\n  run: function run(_ref8) {\n    var object = _ref8.object,\n        id = _ref8.id;\n    return Properties.update(id, {\n      $push: object\n    });\n  }\n});\n\nvar _popPropertyValue = new _ValidatedMethod({\n  name: 'popPropertyValue',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref9) {\n    var id = _ref9.id;\n\n    _check(id, String);\n  },\n  run: function run(_ref10) {\n    var object = _ref10.object,\n        id = _ref10.id;\n    return Properties.update(id, {\n      $pop: object\n    }, {\n      getAutoValues: false\n    });\n  }\n});\n\nvar _setPropertyField = new _ValidatedMethod({\n  name: 'setPropertyField',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref11) {\n    var id = _ref11.id,\n        key = _ref11.key;\n\n    _check(id, String);\n\n    _check(key, String);\n  },\n  run: function run(_ref12) {\n    var id = _ref12.id,\n        key = _ref12.key,\n        value = _ref12.value;\n    return Properties.update(id, {\n      $set: (0, _defineProperty3.default)({}, \"fields.\" + key, value)\n    });\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"mutations.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/properties/server/mutations.js                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\nvar SecurityService = void 0;\nmodule.watch(require(\"../../security\"), {\n  default: function _default(v) {\n    SecurityService = v;\n  }\n}, 1);\n\nvar _createMutator = void 0;\n\nmodule.watch(require(\"../../mutations\"), {\n  createMutator: function createMutator(v) {\n    _createMutator = v;\n  }\n}, 2);\nvar PropertyService = void 0;\nmodule.watch(require(\"../PropertyService\"), {\n  default: function _default(v) {\n    PropertyService = v;\n  }\n}, 3);\nvar defs = void 0;\nmodule.watch(require(\"../mutationDefinitions\"), {\n  \"*\": function _(v) {\n    defs = v;\n  }\n}, 4);\n\n_createMutator(defs.PROPERTY_INSERT, function (_ref) {\n  var object = _ref.object,\n      userId = _ref.userId;\n  var userIdIsDefined = userId !== undefined;\n\n  if (userIdIsDefined) {\n    SecurityService.checkCurrentUserIsAdmin();\n  } else {\n    SecurityService.properties.isAllowedToInsert();\n  }\n\n  return PropertyService.insert({\n    object: object,\n    userId: userIdIsDefined ? userId : _Meteor.userId()\n  });\n});\n\n_createMutator(defs.PROPERTY_UPDATE, function (_ref2) {\n  var propertyId = _ref2.propertyId,\n      object = _ref2.object;\n  SecurityService.properties.isAllowedToUpdate(propertyId);\n  return PropertyService.update({\n    propertyId: propertyId,\n    object: object\n  });\n});\n\n_createMutator(defs.PROPERTY_DELETE, function (_ref3) {\n  var propertyId = _ref3.propertyId;\n  SecurityService.properties.isAllowedToDelete(propertyId);\n  return PropertyService.remove({\n    propertyId: propertyId\n  });\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"publications.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/properties/server/publications.js                                                                  //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _Roles = void 0;\n\nmodule.watch(require(\"meteor/alanning:roles\"), {\n  Roles: function Roles(v) {\n    _Roles = v;\n  }\n}, 1);\n\nvar _check = void 0;\n\nmodule.watch(require(\"meteor/check\"), {\n  check: function check(v) {\n    _check = v;\n  }\n}, 2);\nvar Properties = void 0;\nmodule.watch(require(\"../properties\"), {\n  default: function _default(v) {\n    Properties = v;\n  }\n}, 3);\n\n// Get all properties for the current user\n_Meteor.publish('properties', function publish() {\n  // Verify if user is logged In\n  if (!_Meteor.userId()) {\n    return this.ready();\n  }\n\n  return Properties.find({\n    userId: _Meteor.userId()\n  });\n}); // Get all properties for the current user\n\n\n_Meteor.publish('userProperties', function publish(userId, propertyIds) {\n  _check(userId, String);\n\n  _check(propertyIds, [String]);\n\n  if (_Roles.userIsInRole(_Meteor.userId(), 'admin') || _Roles.userIsInRole(_Meteor.userId(), 'dev')) {\n    // Return all properties owned by this user, or pointed at by a loan\n    return Properties.find({\n      $or: [{\n        userId: userId\n      }, {\n        _id: {\n          $in: propertyIds\n        }\n      }]\n    });\n  } // Return an empy cursor if not logged in\n\n\n  return this.ready();\n}); // Get a property\n\n\n_Meteor.publish('property', function publish(propertyId) {\n  _check(propertyId, String);\n\n  if (_Roles.userIsInRole(_Meteor.userId(), 'admin') || _Roles.userIsInRole(_Meteor.userId(), 'dev')) {\n    return Properties.find({\n      _id: propertyId\n    });\n  } // Return an empy cursor if not logged in\n\n\n  return this.ready();\n});\n\n_Meteor.publish('allProperties', function publish() {\n  // Verify if user is an admin\n  if (_Roles.userIsInRole(_Meteor.userId(), 'admin') || _Roles.userIsInRole(_Meteor.userId(), 'dev')) {\n    // Return all\n    return Properties.find();\n  }\n\n  return this.ready();\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"PropertyService.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/properties/PropertyService.js                                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.export({\n  default: function _default() {\n    return _class;\n  }\n});\nvar Properties = void 0;\nmodule.watch(require(\"../properties\"), {\n  default: function _default(v) {\n    Properties = v;\n  }\n}, 0);\n\nvar _class = function _class() {\n  (0, _classCallCheck3.default)(this, _class);\n};\n\n_class.update = function (_ref) {\n  var propertyId = _ref.propertyId,\n      property = _ref.property;\n  return Properties.update(propertyId, {\n    $set: property\n  });\n};\n\n_class.insert = function (_ref2) {\n  var property = _ref2.property,\n      userId = _ref2.userId;\n  return Properties.insert((0, _extends3.default)({}, property, {\n    userId: userId\n  }));\n};\n\n_class.remove = function (_ref3) {\n  var propertyId = _ref3.propertyId;\n  return Properties.remove(propertyId);\n};\n\n_class.pushValue = function (_ref4) {\n  var propertyId = _ref4.propertyId,\n      property = _ref4.property;\n  return Properties.update(propertyId, {\n    $push: property\n  });\n};\n\n_class.popValue = function (_ref5) {\n  var propertyId = _ref5.propertyId,\n      property = _ref5.property;\n  return Properties.update(propertyId, {\n    $pop: property\n  });\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/properties/index.js                                                                                //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  propertyMutations: function propertyMutations() {\n    return _propertyMutations;\n  }\n});\nmodule.watch(require(\"./properties\"), {\n  default: function _default(v) {\n    exports.default = v;\n  }\n}, 1);\nvar mutations = void 0;\nexports.propertyMutations = _propertyMutations;\nmodule.watch(require(\"./mutationDefinitions\"), {\n  \"*\": function _(v) {\n    mutations = v;\n  }\n}, 0);\nvar _propertyMutations = mutations;\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"links.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/properties/links.js                                                                                //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Properties = void 0,\n    _Users = void 0;\n\nmodule.watch(require(\"../\"), {\n  Properties: function Properties(v) {\n    _Properties = v;\n  },\n  Users: function Users(v) {\n    _Users = v;\n  }\n}, 0);\n\n_Properties.addLinks({\n  asignee: {\n    field: 'userId',\n    collection: _Users,\n    type: 'one'\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"mutationDefinitions.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/properties/mutationDefinitions.js                                                                  //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  PROPERTY_INSERT: function PROPERTY_INSERT() {\n    return _PROPERTY_INSERT;\n  },\n  PROPERTY_UPDATE: function PROPERTY_UPDATE() {\n    return _PROPERTY_UPDATE;\n  },\n  PROPERTY_DELETE: function PROPERTY_DELETE() {\n    return _PROPERTY_DELETE;\n  }\n});\nexports.PROPERTY_INSERT = _PROPERTY_INSERT;\nvar _PROPERTY_INSERT = {\n  name: 'PROPERTY_INSERT',\n  params: {\n    property: {\n      type: Object\n    },\n    userId: {\n      type: String,\n      optional: true\n    }\n  }\n};\nvar _PROPERTY_UPDATE = {\n  name: 'PROPERTY_UPDATE',\n  params: {\n    propertyId: {\n      type: String\n    },\n    property: {\n      type: Object\n    }\n  }\n};\nvar _PROPERTY_DELETE = {\n  name: 'PROPERTY_DELETE',\n  params: {\n    propertyId: {\n      type: String\n    }\n  }\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"properties.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/properties/properties.js                                                                           //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  PropertySchema: function PropertySchema() {\n    return _PropertySchema;\n  }\n});\n\nvar _Mongo = void 0;\n\nmodule.watch(require(\"meteor/mongo\"), {\n  Mongo: function Mongo(v) {\n    _Mongo = v;\n  }\n}, 0);\nvar SimpleSchema = void 0;\nmodule.watch(require(\"simpl-schema\"), {\n  default: function _default(v) {\n    SimpleSchema = v;\n  }\n}, 1);\n\nvar _getFileSchema = void 0;\n\nmodule.watch(require(\"../files/files\"), {\n  getFileSchema: function getFileSchema(v) {\n    _getFileSchema = v;\n  }\n}, 2);\n\nvar _PROPERTY_STATUS = void 0,\n    _USAGE_TYPE = void 0,\n    _PROPERTY_STYLE = void 0,\n    _VOLUME_NORM = void 0;\n\nmodule.watch(require(\"./propertyConstants\"), {\n  PROPERTY_STATUS: function PROPERTY_STATUS(v) {\n    _PROPERTY_STATUS = v;\n  },\n  USAGE_TYPE: function USAGE_TYPE(v) {\n    _USAGE_TYPE = v;\n  },\n  PROPERTY_STYLE: function PROPERTY_STYLE(v) {\n    _PROPERTY_STYLE = v;\n  },\n  VOLUME_NORM: function VOLUME_NORM(v) {\n    _VOLUME_NORM = v;\n  }\n}, 3);\nexports.PropertySchema = _PropertySchema;\nvar Properties = new _Mongo.Collection('properties'); // Prevent all client side modifications of mongoDB\n\nProperties.deny({\n  insert: function insert() {\n    return true;\n  },\n  update: function update() {\n    return true;\n  },\n  remove: function remove() {\n    return true;\n  }\n});\nProperties.allow({\n  insert: function insert() {\n    return false;\n  },\n  update: function update() {\n    return false;\n  },\n  remove: function remove() {\n    return false;\n  }\n});\nvar PropertyFilesSchema = new SimpleSchema(_getFileSchema('property'));\n\nvar _PropertySchema = new SimpleSchema({\n  userId: {\n    type: String,\n    optional: true\n  },\n  createdAt: {\n    type: Date,\n    autoValue: function autoValue() {\n      if (this.isInsert) {\n        return new Date();\n      }\n    }\n  },\n  updatedAt: {\n    type: Date,\n    autoValue: function autoValue() {\n      if (this.isInsert || this.isUpdate) {\n        return new Date();\n      }\n    }\n  },\n  status: {\n    type: String,\n    defaultValue: _PROPERTY_STATUS.FOR_SALE,\n    allowedValues: Object.values(_PROPERTY_STATUS)\n  },\n  value: {\n    // Cost of the property\n    type: Number,\n    min: 0,\n    max: 100000000,\n    optional: true\n  },\n  propertyWork: {\n    // Additional work on property\n    type: Number,\n    min: 0,\n    max: 100000000,\n    optional: true\n  },\n  usageType: {\n    type: String,\n    defaultValue: _USAGE_TYPE.PRIMARY,\n    allowedValues: Object.values(_USAGE_TYPE)\n  },\n  investmentRent: {\n    // Rent of property if investment\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 100000000\n  },\n  style: {\n    type: String,\n    optional: true,\n    defaultValue: _PROPERTY_STYLE.FLAT,\n    allowedValues: Object.values(_PROPERTY_STYLE)\n  },\n  address: {\n    // For condensed, google places addresses\n    type: String,\n    optional: true\n  },\n  address1: {\n    type: String,\n    optional: true\n  },\n  address2: {\n    type: String,\n    optional: true\n  },\n  zipCode: {\n    type: Number,\n    optional: true,\n    min: 1000,\n    max: 9999\n  },\n  city: {\n    type: String,\n    optional: true\n  },\n  constructionYear: {\n    type: Number,\n    min: 0,\n    max: 2030,\n    optional: true\n  },\n  renovationYear: {\n    type: Number,\n    min: 0,\n    max: 2030,\n    optional: true\n  },\n  insideArea: {\n    type: Number,\n    optional: true,\n    min: 0\n  },\n  landArea: {\n    type: Number,\n    optional: true,\n    min: 0\n  },\n  balconyArea: {\n    type: Number,\n    optional: true,\n    min: 0\n  },\n  terraceArea: {\n    type: Number,\n    optional: true,\n    min: 0\n  },\n  roomCount: {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 100\n  },\n  bathroomCount: {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 100\n  },\n  toiletCount: {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 100\n  },\n  volume: {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 5000\n  },\n  volumeNorm: {\n    type: String,\n    defaultValue: _VOLUME_NORM.SIA,\n    allowedValues: Object.keys(_VOLUME_NORM)\n  },\n  parking: {\n    type: Object,\n    defaultValue: {}\n  },\n  'parking.box': {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 100\n  },\n  'parking.inside': {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 100\n  },\n  'parking.outside': {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 100\n  },\n  minergie: {\n    type: Boolean,\n    defaultValue: false\n  },\n  isCoproperty: {\n    type: Boolean,\n    defaultValue: false\n  },\n  isNew: {\n    type: Boolean,\n    defaultValue: false\n  },\n  copropertyPercentage: {\n    type: Number,\n    min: 0,\n    max: 1000,\n    optional: true\n  },\n  cityPlacementQuality: {\n    type: Number,\n    min: 0,\n    max: 5,\n    optional: true\n  },\n  buildingPlacementQuality: {\n    type: Number,\n    min: 0,\n    max: 5,\n    optional: true\n  },\n  buildingQuality: {\n    type: Number,\n    min: 0,\n    max: 5,\n    optional: true\n  },\n  flatQuality: {\n    type: Number,\n    min: 0,\n    max: 5,\n    optional: true\n  },\n  materialsQuality: {\n    type: Number,\n    min: 0,\n    max: 5,\n    optional: true\n  },\n  otherNotes: {\n    type: String,\n    optional: true\n  },\n  name: {\n    type: String,\n    optional: true\n  },\n  latitude: {\n    type: Number,\n    optional: true,\n    min: -90,\n    max: 90\n  },\n  longitude: {\n    type: Number,\n    optional: true,\n    min: -180,\n    max: 180\n  },\n  nearestBusStation: {\n    type: Object,\n    blackbox: true,\n    optional: true\n  },\n  nearestTrainStation: {\n    type: Object,\n    blackbox: true,\n    optional: true\n  },\n  customFields: {\n    // Allows storing custom fields that aren't allowed by the default schema\n    type: Object,\n    blackbox: true,\n    defaultValue: {}\n  },\n  adminValidation: {\n    type: Object,\n    defaultValue: {},\n    blackbox: true\n  },\n  files: {\n    type: PropertyFilesSchema,\n    defaultValue: {}\n  }\n}); // Attach schema\n\n\nProperties.attachSchema(_PropertySchema);\nmodule.exportDefault(Properties);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"propertyConstants.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/properties/propertyConstants.js                                                                    //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  PROPERTY_STATUS: function PROPERTY_STATUS() {\n    return _PROPERTY_STATUS;\n  },\n  USAGE_TYPE: function USAGE_TYPE() {\n    return _USAGE_TYPE;\n  },\n  PROPERTY_STYLE: function PROPERTY_STYLE() {\n    return _PROPERTY_STYLE;\n  },\n  VOLUME_NORM: function VOLUME_NORM() {\n    return _VOLUME_NORM;\n  },\n  EXPERTISE_RATING: function EXPERTISE_RATING() {\n    return _EXPERTISE_RATING;\n  },\n  PROPERTY_QUERIES: function PROPERTY_QUERIES() {\n    return _PROPERTY_QUERIES;\n  }\n});\nexports.PROPERTY_STATUS = _PROPERTY_STATUS;\nvar _PROPERTY_STATUS = {\n  SOLD: 'SOLD',\n  FOR_SALE: 'FOR_SALE'\n};\nvar _USAGE_TYPE = {\n  PRIMARY: 'PRIMARY',\n  SECONDARY: 'SECONDARY',\n  INVESTMENT: 'INVESTMENT'\n};\nvar _PROPERTY_STYLE = {\n  FLAT: 'FLAT',\n  VILLA: 'VILLA'\n};\nvar _VOLUME_NORM = {\n  SIA: 'SIA'\n};\nvar _EXPERTISE_RATING = {\n  0: 0,\n  1: 1,\n  2: 2,\n  3: 3\n};\nvar _PROPERTY_QUERIES = {\n  PROPERTY_ASSIGNED_TO: 'PROPERTY_ASSIGNED_TO'\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"security\":{\"collections\":{\"BorrowerSecurity.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/security/collections/BorrowerSecurity.js                                                           //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require(\"babel-runtime/helpers/createClass\");\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Security = void 0;\nmodule.watch(require(\"../Security\"), {\n  default: function _default(v) {\n    Security = v;\n  }\n}, 0);\n\nvar _Borrowers = void 0;\n\nmodule.watch(require(\"../..\"), {\n  Borrowers: function Borrowers(v) {\n    _Borrowers = v;\n  }\n}, 1);\n\nvar BorrowerSecurity = function () {\n  function BorrowerSecurity() {\n    (0, _classCallCheck3.default)(this, BorrowerSecurity);\n  }\n\n  (0, _createClass3.default)(BorrowerSecurity, null, [{\n    key: \"isAllowedToInsert\",\n    value: function isAllowedToInsert() {\n      Security.checkLoggedIn();\n    }\n  }, {\n    key: \"isAllowedToUpdate\",\n    value: function isAllowedToUpdate(loanId) {\n      if (Security.currentUserIsAdmin()) {\n        return;\n      }\n\n      var loan = _Borrowers.findOne(loanId);\n\n      Security.checkOwnership(loan);\n    }\n  }, {\n    key: \"isAllowedToDelete\",\n    value: function isAllowedToDelete() {\n      Security.checkCurrentUserIsAdmin();\n    }\n  }]);\n  return BorrowerSecurity;\n}();\n\nmodule.exportDefault(BorrowerSecurity);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"LoanSecurity.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/security/collections/LoanSecurity.js                                                               //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require(\"babel-runtime/helpers/createClass\");\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Security = void 0;\nmodule.watch(require(\"../Security\"), {\n  default: function _default(v) {\n    Security = v;\n  }\n}, 0);\n\nvar _Loans = void 0;\n\nmodule.watch(require(\"../..\"), {\n  Loans: function Loans(v) {\n    _Loans = v;\n  }\n}, 1);\n\nvar LoanSecurity = function () {\n  function LoanSecurity() {\n    (0, _classCallCheck3.default)(this, LoanSecurity);\n  }\n\n  (0, _createClass3.default)(LoanSecurity, null, [{\n    key: \"isAllowedToInsert\",\n    value: function isAllowedToInsert() {\n      Security.checkLoggedIn();\n    }\n  }, {\n    key: \"isAllowedToUpdate\",\n    value: function isAllowedToUpdate(loanId) {\n      if (Security.currentUserIsAdmin()) {\n        return;\n      }\n\n      var loan = _Loans.findOne(loanId);\n\n      Security.checkOwnership(loan);\n    }\n  }, {\n    key: \"isAllowedToDelete\",\n    value: function isAllowedToDelete() {\n      Security.checkCurrentUserIsAdmin();\n    }\n  }]);\n  return LoanSecurity;\n}();\n\nmodule.exportDefault(LoanSecurity);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"OfferSecurity.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/security/collections/OfferSecurity.js                                                              //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require(\"babel-runtime/helpers/createClass\");\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Security = void 0;\nmodule.watch(require(\"../Security\"), {\n  default: function _default(v) {\n    Security = v;\n  }\n}, 0);\n\nvar _Offers = void 0;\n\nmodule.watch(require(\"../..\"), {\n  Offers: function Offers(v) {\n    _Offers = v;\n  }\n}, 1);\n\nvar OfferSecurity = function () {\n  function OfferSecurity() {\n    (0, _classCallCheck3.default)(this, OfferSecurity);\n  }\n\n  (0, _createClass3.default)(OfferSecurity, null, [{\n    key: \"isAllowedToInsert\",\n    value: function isAllowedToInsert() {\n      Security.checkLoggedIn();\n    }\n  }, {\n    key: \"isAllowedToUpdate\",\n    value: function isAllowedToUpdate(loanId) {\n      if (Security.currentUserIsAdmin()) {\n        return;\n      }\n\n      var loan = _Offers.findOne(loanId);\n\n      Security.checkOwnership(loan);\n    }\n  }, {\n    key: \"isAllowedToDelete\",\n    value: function isAllowedToDelete() {\n      Security.checkCurrentUserIsAdmin();\n    }\n  }]);\n  return OfferSecurity;\n}();\n\nmodule.exportDefault(OfferSecurity);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"PropertySecurity.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/security/collections/PropertySecurity.js                                                           //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require(\"babel-runtime/helpers/createClass\");\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Security = void 0;\nmodule.watch(require(\"../Security\"), {\n  default: function _default(v) {\n    Security = v;\n  }\n}, 0);\n\nvar _Properties = void 0;\n\nmodule.watch(require(\"../..\"), {\n  Properties: function Properties(v) {\n    _Properties = v;\n  }\n}, 1);\n\nvar PropertySecurity = function () {\n  function PropertySecurity() {\n    (0, _classCallCheck3.default)(this, PropertySecurity);\n  }\n\n  (0, _createClass3.default)(PropertySecurity, null, [{\n    key: \"isAllowedToInsert\",\n    value: function isAllowedToInsert() {\n      Security.checkLoggedIn();\n    }\n  }, {\n    key: \"isAllowedToUpdate\",\n    value: function isAllowedToUpdate(loanId) {\n      if (Security.currentUserIsAdmin()) {\n        return;\n      }\n\n      var loan = _Properties.findOne(loanId);\n\n      Security.checkOwnership(loan);\n    }\n  }, {\n    key: \"isAllowedToDelete\",\n    value: function isAllowedToDelete() {\n      Security.checkCurrentUserIsAdmin();\n    }\n  }]);\n  return PropertySecurity;\n}();\n\nmodule.exportDefault(PropertySecurity);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"TaskSecurity.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/security/collections/TaskSecurity.js                                                               //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require(\"babel-runtime/helpers/createClass\");\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Security = void 0;\nmodule.watch(require(\"../Security\"), {\n  default: function _default(v) {\n    Security = v;\n  }\n}, 0);\n\nvar _Tasks = void 0;\n\nmodule.watch(require(\"../..\"), {\n  Tasks: function Tasks(v) {\n    _Tasks = v;\n  }\n}, 1);\n\nvar TaskSecurity = function () {\n  function TaskSecurity() {\n    (0, _classCallCheck3.default)(this, TaskSecurity);\n  }\n\n  (0, _createClass3.default)(TaskSecurity, null, [{\n    key: \"isAllowedToInsert\",\n    value: function isAllowedToInsert() {\n      Security.checkLoggedIn();\n    }\n  }, {\n    key: \"isAllowedToUpdate\",\n    value: function isAllowedToUpdate() {\n      Security.checkCurrentUserIsAdmin();\n    }\n  }, {\n    key: \"isAllowedToDelete\",\n    value: function isAllowedToDelete() {\n      Security.checkCurrentUserIsAdmin();\n    }\n  }]);\n  return TaskSecurity;\n}();\n\nmodule.exportDefault(TaskSecurity);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/security/collections/index.js                                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nmodule.watch(require(\"./LoanSecurity\"), {\n  default: function _default(v) {\n    exports.LoanSecurity = v;\n  }\n}, 0);\nmodule.watch(require(\"./OfferSecurity\"), {\n  default: function _default(v) {\n    exports.OfferSecurity = v;\n  }\n}, 1);\nmodule.watch(require(\"./BorrowerSecurity\"), {\n  default: function _default(v) {\n    exports.BorrowerSecurity = v;\n  }\n}, 2);\nmodule.watch(require(\"./PropertySecurity\"), {\n  default: function _default(v) {\n    exports.PropertySecurity = v;\n  }\n}, 3);\nmodule.watch(require(\"./TaskSecurity\"), {\n  default: function _default(v) {\n    exports.TaskSecurity = v;\n  }\n}, 4);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"Security.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/security/Security.js                                                                               //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SECURITY_ERROR = undefined;\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require(\"babel-runtime/helpers/createClass\");\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.export({\n  SECURITY_ERROR: function SECURITY_ERROR() {\n    return _SECURITY_ERROR;\n  },\n  default: function _default() {\n    return Security;\n  }\n});\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _Roles = void 0;\n\nexports.SECURITY_ERROR = _SECURITY_ERROR;\nmodule.watch(require(\"meteor/alanning:roles\"), {\n  Roles: function Roles(v) {\n    _Roles = v;\n  }\n}, 1);\n\nvar _ROLES = void 0;\n\nmodule.watch(require(\"../constants\"), {\n  ROLES: function ROLES(v) {\n    _ROLES = v;\n  }\n}, 2);\nvar _SECURITY_ERROR = 'NOT_AUTHORIZED';\n\nvar Security = function () {\n  function Security() {\n    (0, _classCallCheck3.default)(this, Security);\n  }\n\n  (0, _createClass3.default)(Security, null, [{\n    key: \"hasRole\",\n    value: function hasRole(userId, role) {\n      return _Roles.userIsInRole(userId, role);\n    }\n  }, {\n    key: \"handleUnauthorized\",\n    value: function handleUnauthorized(message) {\n      throw new _Meteor.Error(_SECURITY_ERROR, message);\n    }\n  }, {\n    key: \"checkRole\",\n    value: function checkRole(userId, role) {\n      if (!this.hasRole(userId, role)) {\n        this.handleUnauthorized(\"Checking role: \" + role);\n      }\n    }\n  }, {\n    key: \"checkLoggedIn\",\n    value: function checkLoggedIn() {\n      if (!_Meteor.userId()) {\n        this.handleUnauthorized('Checking if logged in');\n      }\n    }\n  }, {\n    key: \"currentUserHasRole\",\n    value: function currentUserHasRole(role) {\n      return this.hasRole(_Meteor.userId(), role);\n    }\n  }, {\n    key: \"currentUserIsAdmin\",\n    value: function currentUserIsAdmin() {\n      return this.hasRole(_Meteor.userId(), _ROLES.ADMIN) || this.hasRole(_Meteor.userId(), _ROLES.DEV);\n    }\n  }, {\n    key: \"checkCurrentUserIsAdmin\",\n    value: function checkCurrentUserIsAdmin() {\n      if (!this.currentUserIsAdmin()) {\n        this.handleUnauthorized('Checking if current user is admin');\n      }\n    }\n  }, {\n    key: \"checkOwnership\",\n    value: function checkOwnership(doc) {\n      if (_Meteor.userId() !== doc.userId) {\n        this.handleUnauthorized('Checking ownership');\n      }\n    }\n  }]);\n  return Security;\n}();\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/security/index.js                                                                                  //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require(\"babel-runtime/helpers/createClass\");\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require(\"babel-runtime/helpers/possibleConstructorReturn\");\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require(\"babel-runtime/helpers/inherits\");\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.watch(require(\"./Security\"), {\n  SECURITY_ERROR: function SECURITY_ERROR(v) {\n    exports.SECURITY_ERROR = v;\n  }\n}, 2);\nvar Security = void 0;\nmodule.watch(require(\"./Security\"), {\n  default: function _default(v) {\n    Security = v;\n  }\n}, 0);\n\nvar _LoanSecurity = void 0,\n    _OfferSecurity = void 0,\n    _BorrowerSecurity = void 0,\n    _PropertySecurity = void 0,\n    _TaskSecurity = void 0;\n\nmodule.watch(require(\"./collections\"), {\n  LoanSecurity: function LoanSecurity(v) {\n    _LoanSecurity = v;\n  },\n  OfferSecurity: function OfferSecurity(v) {\n    _OfferSecurity = v;\n  },\n  BorrowerSecurity: function BorrowerSecurity(v) {\n    _BorrowerSecurity = v;\n  },\n  PropertySecurity: function PropertySecurity(v) {\n    _PropertySecurity = v;\n  },\n  TaskSecurity: function TaskSecurity(v) {\n    _TaskSecurity = v;\n  }\n}, 1);\n\nvar SecurityService = function (_Security) {\n  (0, _inherits3.default)(SecurityService, _Security);\n\n  function SecurityService() {\n    (0, _classCallCheck3.default)(this, SecurityService);\n    return (0, _possibleConstructorReturn3.default)(this, (SecurityService.__proto__ || Object.getPrototypeOf(SecurityService)).apply(this, arguments));\n  }\n\n  (0, _createClass3.default)(SecurityService, null, [{\n    key: \"loans\",\n    get: function get() {\n      return _LoanSecurity;\n    }\n  }, {\n    key: \"offers\",\n    get: function get() {\n      return _OfferSecurity;\n    }\n  }, {\n    key: \"properties\",\n    get: function get() {\n      return _PropertySecurity;\n    }\n  }, {\n    key: \"borrowers\",\n    get: function get() {\n      return _BorrowerSecurity;\n    }\n  }, {\n    key: \"tasks\",\n    get: function get() {\n      return _TaskSecurity;\n    }\n  }]);\n  return SecurityService;\n}(Security);\n\nmodule.exportDefault(SecurityService);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"tasks\":{\"queries\":{\"exposures.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/tasks/queries/exposures.js                                                                         //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nmodule.watch(require(\"./tasksList.expose\"));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"tasksList.expose.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/tasks/queries/tasksList.expose.js                                                                  //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar Security = void 0;\nmodule.watch(require(\"../../security\"), {\n  default: function _default(v) {\n    Security = v;\n  }\n}, 0);\nvar query = void 0;\nmodule.watch(require(\"./tasksList\"), {\n  default: function _default(v) {\n    query = v;\n  }\n}, 1);\nquery.expose({\n  firewall: function firewall(userId) {\n    Security.checkCurrentUserIsAdmin(userId);\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"tasksList.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/tasks/queries/tasksList.js                                                                         //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Tasks = void 0;\n\nmodule.watch(require(\"../../\"), {\n  Tasks: function Tasks(v) {\n    _Tasks = v;\n  }\n}, 0);\n\nvar _TASK_QUERIES = void 0;\n\nmodule.watch(require(\"../tasksConstants\"), {\n  TASK_QUERIES: function TASK_QUERIES(v) {\n    _TASK_QUERIES = v;\n  }\n}, 1);\nmodule.exportDefault(_Tasks.createQuery(_TASK_QUERIES.TASKS, {\n  $filter: function $filter(_ref) {\n    var filters = _ref.filters,\n        options = _ref.options,\n        params = _ref.params;\n\n    if (params.userId) {\n      filters.assignedTo = params.userId;\n    } // filters.assignedUser.roles = {$in: ['admin']};\n\n  },\n  $options: {\n    sort: {\n      createdAt: -1\n    }\n  },\n  $paginate: true,\n  status: 1,\n  type: 1,\n  createdAt: 1,\n  updatedAt: 1,\n  dueAt: 1,\n  assignedUser: {\n    emails: 1,\n    roles: 1\n  },\n  // borrowerAssignee: 1,\n  // loanAssignee: 1,\n  // propertyAssignee: 1,\n  userId: 1\n}));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"server\":{\"mutations.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/tasks/server/mutations.js                                                                          //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _SecurityService = void 0,\n    _createMutator = void 0;\n\nmodule.watch(require(\"../..\"), {\n  SecurityService: function SecurityService(v) {\n    _SecurityService = v;\n  },\n  createMutator: function createMutator(v) {\n    _createMutator = v;\n  }\n}, 0);\nvar TaskService = void 0;\nmodule.watch(require(\"../TaskService\"), {\n  default: function _default(v) {\n    TaskService = v;\n  }\n}, 1);\nvar defs = void 0;\nmodule.watch(require(\"../mutationDefinitions\"), {\n  \"*\": function _(v) {\n    defs = v;\n  }\n}, 2);\n\n_createMutator(defs.TASK_INSERT, function (_ref) {\n  var type = _ref.type,\n      loanId = _ref.loanId;\n\n  _SecurityService.tasks.isAllowedToInsert();\n\n  return TaskService.insert({\n    type: type,\n    loanId: loanId\n  });\n});\n\n_createMutator(defs.TASK_UPDATE, function (_ref2) {\n  var taskId = _ref2.taskId,\n      task = _ref2.task;\n\n  _SecurityService.tasks.isAllowedToUpdate();\n\n  return TaskService.insert({\n    taskId: taskId,\n    task: task\n  });\n});\n\n_createMutator(defs.TASK_COMPLETE, function (_ref3) {\n  var taskId = _ref3.taskId;\n\n  _SecurityService.tasks.isAllowedToUpdate(taskId);\n\n  return TaskService.complete({\n    taskId: taskId\n  });\n});\n\n_createMutator(defs.TASK_COMPLETE_BY_TYPE, function (_ref4) {\n  var type = _ref4.type,\n      loanId = _ref4.loanId,\n      newStatus = _ref4.newStatus;\n\n  _SecurityService.tasks.isAllowedToUpdate();\n\n  return TaskService.completeByType({\n    type: type,\n    loanId: loanId,\n    newStatus: newStatus\n  });\n});\n\n_createMutator(defs.TASK_CHANGE_STATUS, function (_ref5) {\n  var taskId = _ref5.taskId,\n      newStatus = _ref5.newStatus;\n\n  _SecurityService.tasks.isAllowedToUpdate(taskId);\n\n  return TaskService.changeStatus({\n    taskId: taskId,\n    newStatus: newStatus\n  });\n});\n\n_createMutator(defs.TASK_CHANGE_USER, function (_ref6) {\n  var taskId = _ref6.taskId,\n      newUser = _ref6.newUser;\n\n  _SecurityService.tasks.isAllowedToUpdate(taskId);\n\n  return TaskService.changeUser({\n    taskId: taskId,\n    newUser: newUser\n  });\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"taskListeners.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/tasks/server/taskListeners.js                                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _USER_EVENTS = void 0;\n\nmodule.watch(require(\"../../users/userConstants\"), {\n  USER_EVENTS: function USER_EVENTS(v) {\n    _USER_EVENTS = v;\n  }\n}, 0);\nvar EventService = void 0;\nmodule.watch(require(\"../../events\"), {\n  default: function _default(v) {\n    EventService = v;\n  }\n}, 1);\n\nvar _mutations = void 0;\n\nmodule.watch(require(\"../../mutations\"), {\n  mutations: function mutations(v) {\n    _mutations = v;\n  }\n}, 2);\nvar TaskService = void 0;\nmodule.watch(require(\"../TaskService\"), {\n  default: function _default(v) {\n    TaskService = v;\n  }\n}, 3);\n\nvar _TASK_TYPE = void 0;\n\nmodule.watch(require(\"../tasksConstants\"), {\n  TASK_TYPE: function TASK_TYPE(v) {\n    _TASK_TYPE = v;\n  }\n}, 4);\nEventService.addMutationListener(_mutations.LOAN_DELETE, function (params) {// TODO: remove parent loan for these tasks\n});\nEventService.addMutationListener(_mutations.REQUEST_LOAN_VERIFICATION, function (params) {// TODO: ADMIN_ACTION_TYPE.VERIFY\n});\nEventService.addMutationListener(_mutations.START_AUCTION, function (params) {// TODO: ADMIN_ACTION_TYPE.AUCTION\n});\nEventService.addMutationListener(_mutations.END_AUCTION, function (params) {// TODO: complete auction task\n});\nEventService.addMutationListener(_mutations.CANCEL_AUCTION, function (params) {// TODO: remove auction task\n});\nEventService.addMutationListener(_mutations.ASSIGN_ADMIN_TO_USER, function (params) {\n  // TODO: reassign all tasks created by user\n  var adminId = params.adminId,\n      userId = params.userId;\n  TaskService.assignAllTasksToAdmin({\n    userId: userId,\n    adminId: adminId\n  });\n});\nEventService.addListener(_USER_EVENTS.USER_CREATED, function (params) {\n  var userId = params.userId;\n  var type = _TASK_TYPE.ADD_ASSIGNED_TO;\n  TaskService.insert({\n    type: type,\n    userId: {\n      userId: userId\n    }\n  });\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"TaskService.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/tasks/TaskService.js                                                                               //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\nvar Tasks = void 0;\nmodule.watch(require(\"../tasks\"), {\n  default: function _default(v) {\n    Tasks = v;\n  }\n}, 1);\n\nvar _TASK_STATUS = void 0,\n    _TASK_TYPE = void 0;\n\nmodule.watch(require(\"./tasksConstants\"), {\n  TASK_STATUS: function TASK_STATUS(v) {\n    _TASK_STATUS = v;\n  },\n  TASK_TYPE: function TASK_TYPE(v) {\n    _TASK_TYPE = v;\n  }\n}, 2);\n\nvar TaskService = function TaskService() {\n  var _this = this;\n\n  (0, _classCallCheck3.default)(this, TaskService);\n\n  this.insert = function (_ref) {\n    var type = _ref.type,\n        loanId = _ref.loanId,\n        assignedTo = _ref.assignedTo,\n        createdBy = _ref.createdBy;\n\n    if (type !== _TASK_TYPE.ADD_ASSIGNED_TO) {\n      var existingTask = Tasks.findOne({\n        type: type,\n        loanId: loanId,\n        status: _TASK_STATUS.ACTIVE\n      });\n\n      if (existingTask) {\n        throw new _Meteor.Error('duplicate active task');\n      }\n    } // check userId in loan and pass it as assignedTo\n\n\n    return Tasks.insert({\n      type: type,\n      loanId: loanId,\n      assignedTo: assignedTo,\n      createdBy: createdBy\n    });\n  };\n\n  this.remove = function (_ref2) {\n    var taskId = _ref2.taskId;\n    return Tasks.remove(taskId);\n  };\n\n  this.update = function (_ref3) {\n    var taskId = _ref3.taskId,\n        task = _ref3.task;\n    return Tasks.update(taskId, {\n      $set: task\n    });\n  };\n\n  this.complete = function (_ref4) {\n    var taskId = _ref4.taskId;\n    return _this.update({\n      taskId: taskId,\n      task: {\n        status: _TASK_STATUS.COMPLETED,\n        completedAt: new Date()\n      }\n    });\n  };\n\n  this.completeByType = function (_ref5) {\n    var type = _ref5.type,\n        loanId = _ref5.loanId,\n        newStatus = _ref5.newStatus;\n    var taskToComplete = Tasks.findOne({\n      loanId: loanId,\n      type: type,\n      status: _TASK_STATUS.ACTIVE\n    });\n\n    if (!taskToComplete) {\n      throw new _Meteor.Error(\"task couldn't be found\");\n    }\n\n    return _this.update({\n      taskId: taskToComplete._id,\n      task: {\n        status: newStatus || _TASK_STATUS.COMPLETED,\n        completedAt: new Date()\n      }\n    });\n  };\n\n  this.changeStatus = function (_ref6) {\n    var taskId = _ref6.taskId,\n        newStatus = _ref6.newStatus;\n    return _this.update({\n      taskId: taskId,\n      task: {\n        status: newStatus\n      }\n    });\n  };\n\n  this.changeUser = function (_ref7) {\n    var taskId = _ref7.taskId,\n        newUser = _ref7.newUser;\n    return _this.update({\n      taskId: taskId,\n      task: {\n        userId: newUser\n      }\n    });\n  };\n\n  this.changeAssignedTo = function (_ref8) {\n    var taskId = _ref8.taskId,\n        userId = _ref8.userId,\n        newAssignee = _ref8.newAssignee;\n    return _this.update({\n      taskId: taskId,\n      task: {\n        userId: userId,\n        assignedTo: newAssignee\n      }\n    });\n  };\n};\n\nmodule.exportDefault(new TaskService());\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/tasks/index.js                                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  taskMutations: function taskMutations() {\n    return _taskMutations;\n  }\n});\nmodule.watch(require(\"./tasks\"), {\n  default: function _default(v) {\n    exports.default = v;\n  }\n}, 1);\nvar mutationDefinitions = void 0;\nexports.taskMutations = _taskMutations;\nmodule.watch(require(\"./mutationDefinitions\"), {\n  \"*\": function _(v) {\n    mutationDefinitions = v;\n  }\n}, 0);\nvar _taskMutations = mutationDefinitions;\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"links.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/tasks/links.js                                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Tasks = void 0,\n    _Users = void 0,\n    _Loans = void 0,\n    _Borrowers = void 0,\n    _Properties = void 0;\n\nmodule.watch(require(\"../\"), {\n  Tasks: function Tasks(v) {\n    _Tasks = v;\n  },\n  Users: function Users(v) {\n    _Users = v;\n  },\n  Loans: function Loans(v) {\n    _Loans = v;\n  },\n  Borrowers: function Borrowers(v) {\n    _Borrowers = v;\n  },\n  Properties: function Properties(v) {\n    _Properties = v;\n  }\n}, 0);\n\n_Tasks.addLinks({\n  assignedUser: {\n    field: 'assignedTo',\n    collection: _Users,\n    type: 'one'\n  },\n  loan: {\n    field: 'loanId',\n    collection: _Loans,\n    type: 'one'\n  },\n  property: {\n    field: 'propertyId',\n    collection: _Properties,\n    type: 'one'\n  },\n  borrower: {\n    field: 'borrowerId',\n    collection: _Borrowers,\n    type: 'one'\n  },\n  user: {\n    field: 'userId',\n    collection: _Users,\n    type: 'one'\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"mutationDefinitions.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/tasks/mutationDefinitions.js                                                                       //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  TASK_INSERT: function TASK_INSERT() {\n    return _TASK_INSERT;\n  },\n  TASK_UPDATE: function TASK_UPDATE() {\n    return _TASK_UPDATE;\n  },\n  TASK_COMPLETE: function TASK_COMPLETE() {\n    return _TASK_COMPLETE;\n  },\n  TASK_COMPLETE_BY_TYPE: function TASK_COMPLETE_BY_TYPE() {\n    return _TASK_COMPLETE_BY_TYPE;\n  },\n  TASK_CHANGE_STATUS: function TASK_CHANGE_STATUS() {\n    return _TASK_CHANGE_STATUS;\n  },\n  TASK_CHANGE_USER: function TASK_CHANGE_USER() {\n    return _TASK_CHANGE_USER;\n  }\n});\nexports.TASK_INSERT = _TASK_INSERT;\nvar _TASK_INSERT = {\n  name: 'TASK_INSERT',\n  params: {\n    loanId: {\n      type: String\n    },\n    type: {\n      type: String\n    }\n  }\n};\nvar _TASK_UPDATE = {\n  name: 'TASK_UPDATE',\n  params: {\n    taskId: {\n      type: String\n    },\n    task: {\n      type: Object\n    }\n  }\n};\nvar _TASK_COMPLETE = {\n  name: 'TASK_COMPLETE',\n  params: {\n    taskId: {\n      type: String\n    }\n  }\n};\nvar _TASK_COMPLETE_BY_TYPE = {\n  name: 'TASK_COMPLETE_BY_TYPE',\n  params: {\n    type: {\n      type: String\n    },\n    loanId: {\n      type: String\n    },\n    newStatus: {\n      type: String,\n      optional: true\n    }\n  }\n};\nvar _TASK_CHANGE_STATUS = {\n  name: 'TASK_CHANGE_STATUS',\n  params: {\n    taskId: {\n      type: String\n    },\n    newStatus: {\n      type: String\n    }\n  }\n};\nvar _TASK_CHANGE_USER = {\n  name: 'TASK_CHANGE_USER',\n  params: {\n    taskId: {\n      type: String\n    },\n    newUser: {\n      type: String\n    }\n  }\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"tasks.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/tasks/tasks.js                                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Mongo = void 0;\n\nmodule.watch(require(\"meteor/mongo\"), {\n  Mongo: function Mongo(v) {\n    _Mongo = v;\n  }\n}, 0);\nvar SimpleSchema = void 0;\nmodule.watch(require(\"simpl-schema\"), {\n  default: function _default(v) {\n    SimpleSchema = v;\n  }\n}, 1);\n\nvar _TASK_STATUS = void 0,\n    _TASK_TYPE = void 0;\n\nmodule.watch(require(\"./tasksConstants\"), {\n  TASK_STATUS: function TASK_STATUS(v) {\n    _TASK_STATUS = v;\n  },\n  TASK_TYPE: function TASK_TYPE(v) {\n    _TASK_TYPE = v;\n  }\n}, 2);\nvar Tasks = new _Mongo.Collection('tasks'); // Prevent all client side modifications of mongoDB\n\nTasks.deny({\n  insert: function insert() {\n    return true;\n  },\n  update: function update() {\n    return true;\n  },\n  remove: function remove() {\n    return true;\n  }\n});\nTasks.allow({\n  insert: function insert() {\n    return false;\n  },\n  update: function update() {\n    return false;\n  },\n  remove: function remove() {\n    return false;\n  }\n});\nvar TasksSchema = new SimpleSchema({\n  createdAt: {\n    type: Date,\n    autoValue: function autoValue() {\n      if (this.isInsert) {\n        return new Date();\n      }\n    }\n  },\n  updatedAt: {\n    type: Date,\n    optional: true\n  },\n  status: {\n    type: String,\n    defaultValue: _TASK_STATUS.ACTIVE,\n    allowedValues: Object.values(_TASK_STATUS)\n  },\n  completedAt: {\n    type: Date,\n    optional: true\n  },\n  dueAt: {\n    type: Date,\n    optional: true\n  },\n  createdBy: {\n    type: String,\n    optional: true\n  },\n  assignedTo: {\n    type: String,\n    optional: true\n  },\n  type: {\n    type: String,\n    allowedValues: Object.values(_TASK_TYPE),\n    optional: true\n  },\n  title: {\n    type: String,\n    optional: true\n  },\n  description: {\n    type: String,\n    optional: true\n  },\n  loanId: {\n    type: String,\n    optional: true\n  },\n  propertyId: {\n    type: String,\n    optional: true\n  },\n  borrowerId: {\n    type: String,\n    optional: true\n  },\n  userId: {\n    type: String,\n    optional: true\n  }\n});\nTasks.attachSchema(TasksSchema);\nmodule.exportDefault(Tasks);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"tasksConstants.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/tasks/tasksConstants.js                                                                            //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  TASK_STATUS: function TASK_STATUS() {\n    return _TASK_STATUS;\n  },\n  TASK_TYPE: function TASK_TYPE() {\n    return _TASK_TYPE;\n  },\n  TASK_QUERIES: function TASK_QUERIES() {\n    return _TASK_QUERIES;\n  }\n});\nexports.TASK_STATUS = _TASK_STATUS;\nvar _TASK_STATUS = {\n  ACTIVE: 'ACTIVE',\n  COMPLETED: 'COMPLETED',\n  CANCELLED: 'CANCELLED'\n};\nvar _TASK_TYPE = {\n  VERIFY: 'VERIFY',\n  AUCTION: 'AUCTION',\n  LENDER_CHOSEN: 'LENDER_CHOSEN',\n  CUSTOM: 'CUSTOM',\n  ADD_ASSIGNED_TO: 'ADD_ASSIGNED_TO'\n};\nvar _TASK_QUERIES = {\n  TASKS: 'TASKS'\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"users\":{\"queries\":{\"adminUserView.expose.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/users/queries/adminUserView.expose.js                                                              //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar Security = void 0;\nmodule.watch(require(\"../../security\"), {\n  default: function _default(v) {\n    Security = v;\n  }\n}, 0);\nvar query = void 0;\nmodule.watch(require(\"./adminUserView\"), {\n  default: function _default(v) {\n    query = v;\n  }\n}, 1);\nquery.expose({\n  firewall: function firewall(userId) {\n    Security.checkCurrentUserIsAdmin(userId);\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"adminUserView.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/users/queries/adminUserView.js                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Users = void 0;\n\nmodule.watch(require(\"../../\"), {\n  Users: function Users(v) {\n    _Users = v;\n  }\n}, 0);\n\nvar _USER_QUERIES = void 0;\n\nmodule.watch(require(\"../userConstants\"), {\n  USER_QUERIES: function USER_QUERIES(v) {\n    _USER_QUERIES = v;\n  }\n}, 1);\nmodule.exportDefault(_Users.createQuery(_USER_QUERIES.ADMIN_USER, {\n  $filter: function $filter(_ref) {\n    var filters = _ref.filters,\n        options = _ref.options,\n        params = _ref.params;\n    filters._id = params._id;\n  },\n  $options: {\n    sort: {\n      createdAt: -1\n    }\n  },\n  emails: 1,\n  createdAt: 1,\n  loans: {\n    logic: {\n      step: 1\n    },\n    createdAt: 1,\n    updatedAt: 1,\n    general: {\n      insuranceFortuneUsed: 1,\n      fortuneUsed: 1\n    },\n    property: {\n      value: 1,\n      address1: 1\n    },\n    borrowers: {\n      firstName: 1,\n      lastName: 1\n    }\n  }\n}));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"adminUsersList.expose.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/users/queries/adminUsersList.expose.js                                                             //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar Security = void 0;\nmodule.watch(require(\"../../security\"), {\n  default: function _default(v) {\n    Security = v;\n  }\n}, 0);\nvar query = void 0;\nmodule.watch(require(\"./adminUsersList\"), {\n  default: function _default(v) {\n    query = v;\n  }\n}, 1);\nquery.expose({\n  firewall: function firewall(userId) {\n    Security.checkCurrentUserIsAdmin(userId);\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"adminUsersList.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/users/queries/adminUsersList.js                                                                    //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Users = void 0;\n\nmodule.watch(require(\"../../\"), {\n  Users: function Users(v) {\n    _Users = v;\n  }\n}, 0);\n\nvar _USER_QUERIES = void 0;\n\nmodule.watch(require(\"../userConstants\"), {\n  USER_QUERIES: function USER_QUERIES(v) {\n    _USER_QUERIES = v;\n  }\n}, 1);\nmodule.exportDefault(_Users.createQuery(_USER_QUERIES.ADMIN_USERS, {\n  $options: {\n    sort: {\n      createdAt: -1\n    }\n  },\n  emails: 1,\n  createdAt: 1,\n  roles: 1\n}));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"admins.expose.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/users/queries/admins.expose.js                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar Security = void 0;\nmodule.watch(require(\"../../security\"), {\n  default: function _default(v) {\n    Security = v;\n  }\n}, 0);\nvar query = void 0;\nmodule.watch(require(\"./admins\"), {\n  default: function _default(v) {\n    query = v;\n  }\n}, 1);\nquery.expose({\n  firewall: function firewall(userId) {\n    Security.checkCurrentUserIsAdmin(userId);\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"admins.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/users/queries/admins.js                                                                            //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Users = void 0;\n\nmodule.watch(require(\"../../\"), {\n  Users: function Users(v) {\n    _Users = v;\n  }\n}, 0);\n\nvar _USER_QUERIES = void 0;\n\nmodule.watch(require(\"../userConstants\"), {\n  USER_QUERIES: function USER_QUERIES(v) {\n    _USER_QUERIES = v;\n  }\n}, 1);\nmodule.exportDefault(_Users.createQuery(_USER_QUERIES.ADMINS, {\n  $filter: function $filter(_ref) {\n    var filters = _ref.filters,\n        options = _ref.options,\n        params = _ref.params;\n    filters.roles = {\n      $in: ['admin']\n    };\n  },\n  $options: {\n    sort: {\n      createdAt: -1\n    }\n  },\n  emails: 1\n}));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"exposures.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/users/queries/exposures.js                                                                         //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nmodule.watch(require(\"./adminUsersList.expose\"));\nmodule.watch(require(\"./adminUserView.expose\"));\nmodule.watch(require(\"./admins.expose\"));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"server\":{\"accounts-server-config.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/users/server/accounts-server-config.js                                                             //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _Accounts = void 0;\n\nmodule.watch(require(\"meteor/accounts-base\"), {\n  Accounts: function Accounts(v) {\n    _Accounts = v;\n  }\n}, 1);\n\n_Accounts.onCreateUser(function (options, user) {\n  var newUser = user;\n\n  if (_Meteor.isDevelopment) {\n    newUser.roles = 'dev';\n  } else {\n    newUser.roles = 'user';\n  }\n\n  return newUser;\n});\n\n_Accounts.config({\n  forbidClientAccountCreation: false\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"mutations.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/users/server/mutations.js                                                                          //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _Accounts = void 0;\n\nmodule.watch(require(\"meteor/accounts-base\"), {\n  Accounts: function Accounts(v) {\n    _Accounts = v;\n  }\n}, 1);\nvar UserService = void 0;\nmodule.watch(require(\"../UserService\"), {\n  default: function _default(v) {\n    UserService = v;\n  }\n}, 2);\n\nvar _SecurityService = void 0,\n    _createMutator = void 0;\n\nmodule.watch(require(\"../..\"), {\n  SecurityService: function SecurityService(v) {\n    _SecurityService = v;\n  },\n  createMutator: function createMutator(v) {\n    _createMutator = v;\n  }\n}, 3);\nvar defs = void 0;\nmodule.watch(require(\"../mutationDefinitions\"), {\n  \"*\": function _(v) {\n    defs = v;\n  }\n}, 4);\n\n_createMutator(defs.DOES_USER_EXIST, function (_ref) {\n  var email = _ref.email;\n  return _Accounts.findUserByEmail(email) != null;\n});\n\n_createMutator(defs.SEND_VERIFICATION_LINK, function (_ref2) {\n  var userId = _ref2.userId;\n\n  if (userId) {\n    _SecurityService.checkCurrentUserIsAdmin();\n  } else {\n    _SecurityService.checkLoggedIn();\n  }\n\n  var id = userId || _Meteor.userId();\n\n  if (_Meteor.isDevelopment) {\n    console.log(\"Not sending verification link in development for userId: \" + id);\n    return false;\n  }\n\n  return _Accounts.sendVerificationEmail(id);\n});\n\n_createMutator(defs.ASSIGN_ADMIN_TO_USER, function (_ref3) {\n  var userId = _ref3.userId,\n      adminId = _ref3.adminId;\n  return UserService.assignAdminToUser({\n    userId: userId,\n    adminId: adminId\n  });\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"publications.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/users/server/publications.js                                                                       //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _Roles = void 0;\n\nmodule.watch(require(\"meteor/alanning:roles\"), {\n  Roles: function Roles(v) {\n    _Roles = v;\n  }\n}, 1);\n\nvar _check = void 0;\n\nmodule.watch(require(\"meteor/check\"), {\n  check: function check(v) {\n    _check = v;\n  }\n}, 2);\n\n_Meteor.publish('allUsers', function publish() {\n  // Verify if the current user is an admin\n  if (_Roles.userIsInRole(_Meteor.userId(), 'admin') || _Roles.userIsInRole(_Meteor.userId(), 'dev')) {\n    // Return all users\n    return _Meteor.users.find();\n  }\n\n  return this.ready();\n});\n\n_Meteor.publish('currentUser', function publish() {\n  if (_Meteor.userId()) {\n    return _Meteor.users.find({\n      _id: _Meteor.userId()\n    });\n  } // Return an empy cursor if not logged in\n\n\n  return this.ready();\n});\n\n_Meteor.publish('user', function publish(userId) {\n  _check(userId, String);\n\n  if (_Roles.userIsInRole(_Meteor.userId(), 'admin') || _Roles.userIsInRole(_Meteor.userId(), 'dev')) {\n    return _Meteor.users.find({\n      _id: userId\n    });\n  } // Return an empy cursor if not logged in\n\n\n  return this.ready();\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"UserService.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/users/UserService.js                                                                               //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar _Accounts = void 0;\n\nmodule.watch(require(\"meteor/accounts-base\"), {\n  Accounts: function Accounts(v) {\n    _Accounts = v;\n  }\n}, 0);\n\nvar _Roles = void 0;\n\nmodule.watch(require(\"meteor/alanning:roles\"), {\n  Roles: function Roles(v) {\n    _Roles = v;\n  }\n}, 1);\nvar EventService = void 0;\nmodule.watch(require(\"../events\"), {\n  default: function _default(v) {\n    EventService = v;\n  }\n}, 2);\n\nvar _USER_EVENTS = void 0;\n\nmodule.watch(require(\"./userConstants\"), {\n  USER_EVENTS: function USER_EVENTS(v) {\n    _USER_EVENTS = v;\n  }\n}, 3);\nvar Users = void 0;\nmodule.watch(require(\"../users\"), {\n  default: function _default(v) {\n    Users = v;\n  }\n}, 4);\n\nvar UserService = function UserService() {\n  var _this = this;\n\n  (0, _classCallCheck3.default)(this, UserService);\n\n  this.createUser = function (_ref) {\n    var options = _ref.options,\n        role = _ref.role;\n\n    var newUserId = _Accounts.createUser(options, function (err) {\n      if (err) console.log(err);else {\n        _Roles.addUsersToRoles(newUserId, role); // Emitter.emit(Events.ITEM_CREATED, { newUserId });\n\n\n        if (role === 'user') {\n          EventService.emit(_USER_EVENTS.USER_CREATED, {\n            newUserId: newUserId\n          });\n        }\n\n        return newUserId;\n      }\n      return null;\n    });\n  };\n\n  this.remove = function (_ref2) {\n    var userId = _ref2.userId;\n    Users.remove(userId);\n  };\n\n  this.update = function (_ref3) {\n    var userId = _ref3.userId,\n        user = _ref3.user;\n    Users.update(userId, {\n      $set: user\n    });\n  };\n\n  this.assignAdminToUser = function (_ref4) {\n    var userId = _ref4.userId,\n        adminId = _ref4.adminId;\n\n    _this.update({\n      userId: userId,\n      user: {\n        assignedTo: adminId\n      }\n    });\n  };\n\n  this.getAdmins = function () {\n    return Users.find({\n      roles: {\n        $in: ['admin']\n      }\n    }).fetch();\n  };\n};\n\nmodule.exportDefault(new UserService());\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/users/index.js                                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  userMutations: function userMutations() {\n    return _userMutations;\n  }\n});\nmodule.watch(require(\"./users\"), {\n  default: function _default(v) {\n    exports.default = v;\n  }\n}, 1);\nexports.userMutations = _userMutations;\nvar mutationDefinitions = void 0;\nmodule.watch(require(\"./mutationDefinitions\"), {\n  \"*\": function _(v) {\n    mutationDefinitions = v;\n  }\n}, 0);\nvar _userMutations = mutationDefinitions;\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"links.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/users/links.js                                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Loans = void 0,\n    _Users = void 0,\n    _Borrowers = void 0;\n\nmodule.watch(require(\"../\"), {\n  Loans: function Loans(v) {\n    _Loans = v;\n  },\n  Users: function Users(v) {\n    _Users = v;\n  },\n  Borrowers: function Borrowers(v) {\n    _Borrowers = v;\n  }\n}, 0);\n\n_Users.addLinks({\n  loans: {\n    collection: _Loans,\n    inversedBy: 'user'\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"mutationDefinitions.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/users/mutationDefinitions.js                                                                       //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  DOES_USER_EXIST: function DOES_USER_EXIST() {\n    return _DOES_USER_EXIST;\n  },\n  SEND_VERIFICATION_LINK: function SEND_VERIFICATION_LINK() {\n    return _SEND_VERIFICATION_LINK;\n  },\n  ASSIGN_ADMIN_TO_USER: function ASSIGN_ADMIN_TO_USER() {\n    return _ASSIGN_ADMIN_TO_USER;\n  }\n});\nexports.DOES_USER_EXIST = _DOES_USER_EXIST;\nvar _DOES_USER_EXIST = {\n  name: 'DOES_USER_EXIST',\n  params: {\n    email: {\n      type: String\n    }\n  }\n};\nvar _SEND_VERIFICATION_LINK = {\n  name: 'SEND_VERIFICATION_LINK',\n  params: {\n    userId: {\n      type: String,\n      optional: true\n    }\n  }\n};\nvar _ASSIGN_ADMIN_TO_USER = {\n  name: 'ASSIGN_ADMIN_TO_USER',\n  params: {\n    userId: {\n      type: String\n    },\n    adminId: {\n      type: String\n    }\n  }\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"userConstants.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/users/userConstants.js                                                                             //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  ROLES: function ROLES() {\n    return _ROLES;\n  },\n  USER_QUERIES: function USER_QUERIES() {\n    return _USER_QUERIES;\n  },\n  USER_EVENTS: function USER_EVENTS() {\n    return _USER_EVENTS;\n  }\n});\nexports.ROLES = _ROLES;\nvar _ROLES = {\n  USER: 'user',\n  ADMIN: 'admin',\n  DEV: 'dev',\n  LENDER: 'lender'\n};\nvar _USER_QUERIES = {\n  ADMIN_USERS: 'ADMIN_USERS',\n  ADMIN_USER: 'ADMIN_USER',\n  ADMINS: 'ADMINS'\n};\nvar _USER_EVENTS = {\n  USER_CREATED: 'user_created'\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"users.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/users/users.js                                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar SimpleSchema = void 0;\nmodule.watch(require(\"simpl-schema\"), {\n  default: function _default(v) {\n    SimpleSchema = v;\n  }\n}, 0);\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 1);\n\nvar _ROLES = void 0;\n\nmodule.watch(require(\"./userConstants\"), {\n  ROLES: function ROLES(v) {\n    _ROLES = v;\n  }\n}, 2);\nvar UserSchema = new SimpleSchema({\n  username: {\n    type: String,\n    // For accounts-password, either emails or username is required, but not both. It is OK to make this\n    // optional here because the accounts-password package does its own validation.\n    // Third-party login packages may not require either. Adjust this schema as necessary for your usage.\n    optional: true\n  },\n  emails: {\n    type: Array,\n    // For accounts-password, either emails or username is required, but not both. It is OK to make this\n    // optional here because the accounts-password package does its own validation.\n    // Third-party login packages may not require either. Adjust this schema as necessary for your usage.\n    optional: true\n  },\n  'emails.$': {\n    type: Object\n  },\n  'emails.$.address': {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email\n  },\n  'emails.$.verified': {\n    type: Boolean\n  },\n  createdAt: {\n    type: Date\n  },\n  // Make sure this services field is in your schema if you're using any of the accounts packages\n  services: {\n    type: Object,\n    optional: true,\n    blackbox: true\n  },\n  // Add `roles` to your schema if you use the meteor-roles package.\n  // Option 1: Object type\n  // If you specify that type as Object, you must also specify the\n  // `Roles.GLOBAL_GROUP` group whenever you add a user to a role.\n  // Example:\n  // Roles.addUsersToRoles(userId, [\"admin\"], Roles.GLOBAL_GROUP);\n  // You can't mix and match adding with and without a group since\n  // you will fail validation in some cases.\n  // roles: {\n  //   type: Object,\n  //   optional: true,\n  //   blackbox: true,\n  // },\n  // Option 2: [String] type\n  // If you are sure you will never need to use role groups, then\n  // you can specify [String] as the type\n  roles: {\n    type: Array,\n    optional: true\n  },\n  'roles.$': {\n    type: String,\n    allowedValues: Object.values(_ROLES)\n  },\n  // In order to avoid an 'Exception in setInterval callback' from Meteor\n  heartbeat: {\n    type: Date,\n    optional: true\n  },\n  assignedTo: {\n    type: String,\n    optional: true\n  }\n});\n\n_Meteor.users.attachSchema(UserSchema);\n\nvar Users = _Meteor.users;\nmodule.exportDefault(Users);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"events\":{\"EventService.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/events/EventService.js                                                                             //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.EventService = undefined;\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require(\"babel-runtime/helpers/createClass\");\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.export({\n  EventService: function EventService() {\n    return _EventService;\n  }\n});\n\nvar _EventEmitter = void 0;\n\nmodule.watch(require(\"events\"), {\n  EventEmitter: function EventEmitter(v) {\n    _EventEmitter = v;\n  }\n}, 0);\n\nvar _Meteor = void 0;\n\nexports.EventService = _EventService;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 1);\nvar IS_LOGGING = true;\n\nvar _EventService = function () {\n  function _EventService(_ref) {\n    var emmitter = _ref.emmitter;\n    (0, _classCallCheck3.default)(this, _EventService);\n    this.emmitter = emmitter;\n    this.addErrorListener();\n  }\n\n  (0, _createClass3.default)(_EventService, [{\n    key: \"emit\",\n    value: function emit(eventName, params) {\n      this.logEmittedEvent(eventName, params);\n      this.emmitter.emit(eventName, params);\n    }\n  }, {\n    key: \"emitMutation\",\n    value: function emitMutation(_ref2, params) {\n      var name = _ref2.name;\n      this.emit(name, params);\n    }\n  }, {\n    key: \"addListener\",\n    value: function addListener(eventName, listenerFunction) {\n      var _this = this;\n\n      this.emmitter.addListener(eventName, function (params) {\n        _this.logListener(eventName, params);\n\n        listenerFunction(params);\n      });\n    }\n  }, {\n    key: \"addMutationListener\",\n    value: function addMutationListener(_ref3, listenerFunction) {\n      var name = _ref3.name;\n      this.addListener(name, listenerFunction);\n    }\n  }, {\n    key: \"addErrorListener\",\n    value: function addErrorListener() {\n      this.addListener('error', function (error) {\n        console.log('An error occured in an event listener:');\n        console.log(error);\n        throw error;\n      });\n    }\n  }, {\n    key: \"logEmittedEvent\",\n    value: function logEmittedEvent(eventName, params) {\n      if (IS_LOGGING && _Meteor.isDevelopment && !_Meteor.isTest) {\n        console.log(\"Event \\\"\" + eventName + \"\\\" triggered with params:\");\n        console.log(params);\n      }\n    }\n  }, {\n    key: \"logListener\",\n    value: function logListener(eventName, params) {\n      if (IS_LOGGING && _Meteor.isDevelopment && !_Meteor.isTest) {\n        console.log(\"Event \\\"\" + eventName + \"\\\" listened to with params:\");\n        console.log(params);\n      }\n    }\n  }]);\n  return _EventService;\n}();\n\nvar defaultEmmitter = new _EventEmitter();\nmodule.exportDefault(new _EventService({\n  emmitter: defaultEmmitter\n}));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/events/index.js                                                                                    //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nmodule.watch(require(\"./EventService\"), {\n  default: function _default(v) {\n    exports.default = v;\n  }\n}, 0);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"registerListeners.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/events/registerListeners.js                                                                        //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nmodule.watch(require(\"../email/server/emailListeners\"));\nmodule.watch(require(\"../tasks/server/taskListeners\"));\nmodule.watch(require(\"../jobs/server/jobListeners\"));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"api-server.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/api-server.js                                                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nmodule.watch(require(\"../fixtures/methods\"));\nmodule.watch(require(\"./adminActions/server/publications\"));\nmodule.watch(require(\"./adminActions/server/methods\"));\nmodule.watch(require(\"./borrowers/server/publications\"));\nmodule.watch(require(\"./borrowers/server/methods\"));\nmodule.watch(require(\"./comparators/server/publications\"));\nmodule.watch(require(\"./comparators/server/methods\"));\nmodule.watch(require(\"./loans/server/publications\"));\nmodule.watch(require(\"./loans/server/methods\"));\nmodule.watch(require(\"./offers/server/publications\"));\nmodule.watch(require(\"./offers/server/methods\"));\nmodule.watch(require(\"./properties/server/publications\"));\nmodule.watch(require(\"./properties/server/methods\"));\nmodule.watch(require(\"./users/server/publications\"));\nmodule.watch(require(\"./users/server/accounts-server-config\"));\nmodule.watch(require(\"./methods/server\"));\nmodule.watch(require(\"./factories\"));\nmodule.watch(require(\"./jobs/server\"));\nmodule.watch(require(\"./files/server/methods\"));\nmodule.watch(require(\"./files/meteor-slingshot-server\"));\nmodule.watch(require(\"../utils/logismata/methods\"));\nmodule.watch(require(\"./email/server\"));\nmodule.watch(require(\"./mutations/server\"));\nmodule.watch(require(\"./events/registerListeners\"));\nmodule.watch(require(\"./loans/queries/exposures\"));\nmodule.watch(require(\"./users/queries/exposures\"));\nmodule.watch(require(\"./tasks/queries/exposures\"));\nmodule.watch(require(\"./borrowers/queries/exposures\"));\nmodule.watch(require(\"./properties/queries/exposures\"));\n\nvar _Loans = void 0,\n    _Borrowers = void 0,\n    _Offers = void 0,\n    _Properties = void 0;\n\nmodule.watch(require(\".\"), {\n  Loans: function Loans(v) {\n    _Loans = v;\n  },\n  Borrowers: function Borrowers(v) {\n    _Borrowers = v;\n  },\n  Offers: function Offers(v) {\n    _Offers = v;\n  },\n  Properties: function Properties(v) {\n    _Properties = v;\n  }\n}, 0);\n\n_Loans._ensureIndex({\n  userId: 1\n});\n\n_Borrowers._ensureIndex({\n  userId: 1\n});\n\n_Offers._ensureIndex({\n  loanId: 1\n});\n\n_Properties._ensureIndex({\n  userId: 1\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"api.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/api.js                                                                                             //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nmodule.watch(require(\"./factories\"));\nmodule.watch(require(\"./files/meteor-slingshot\"));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"cleanMethods.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/cleanMethods.js                                                                                    //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar module1 = module;\n\nvar _Meteor = void 0;\n\nmodule1.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _Bert = void 0;\n\nmodule1.watch(require(\"meteor/themeteorchef:bert\"), {\n  Bert: function Bert(v) {\n    _Bert = v;\n  }\n}, 1);\n\n// Passed to all methods, shows a Bert error when it happens\nvar handleResult = function handleResult(result, bertObject) {\n  if (_Meteor.isClient && !!bertObject) {\n    var delay = bertObject.delay,\n        title = bertObject.title,\n        message = bertObject.message,\n        type = bertObject.type,\n        style = bertObject.style;\n\n    if (delay) {\n      _Bert.defaults.hideDelay = delay;\n    }\n\n    _Bert.alert({\n      title: title || \"C'est réussi\",\n      message: message === undefined ? '<h3 class=\"bert\">Bien joué!</h3>' : message,\n      type: type || 'success',\n      style: style || 'growl-top-right'\n    });\n  }\n\n  return result;\n}; // Passed to all methods, shows a bert alert\n\n\nvar handleError = function handleError(error) {\n  if (_Meteor.isClient) {\n    _Bert.defaults.hideDelay = 7500;\n\n    _Bert.alert({\n      title: 'Misère, une erreur!',\n      message: \"<h3 class=\\\"bert\\\">\" + error.message + \"</h3>\",\n      type: 'danger',\n      style: 'fixed-top'\n    });\n  }\n\n  console.log(error); // Throw the error again so that it can be catched again via promise chaining\n  // All uses of this module should catch and implement proper fail-safe logic\n\n  throw error;\n}; // A wrapper method that displays an error if it occurs\n\n\nvar cleanMethod = function cleanMethod(name, params, bertObject) {\n  console.log('cleanmethod!', name, params);\n  return new Promise(function (resolve, reject) {\n    _Meteor.call(name, params, function (error, result) {\n      if (error) {\n        reject(handleError(error));\n      } else {\n        resolve(handleResult(result, bertObject));\n      }\n    });\n  });\n};\n\nmodule1.exportDefault(cleanMethod);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"constants.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/constants.js                                                                                       //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nmodule.watch(require(\"./adminActions/adminActionConstants\"), {\n  \"*\": module.makeNsSetter()\n}, 0);\nmodule.watch(require(\"./borrowers/borrowerConstants\"), {\n  \"*\": module.makeNsSetter()\n}, 1);\nmodule.watch(require(\"./loans/loanConstants\"), {\n  \"*\": module.makeNsSetter()\n}, 2);\nmodule.watch(require(\"./offers/offerConstants\"), {\n  \"*\": module.makeNsSetter()\n}, 3);\nmodule.watch(require(\"./users/userConstants\"), {\n  \"*\": module.makeNsSetter()\n}, 4);\nmodule.watch(require(\"./properties/propertyConstants\"), {\n  \"*\": module.makeNsSetter()\n}, 5);\nmodule.watch(require(\"./files/fileConstants\"), {\n  \"*\": module.makeNsSetter()\n}, 6);\nmodule.watch(require(\"./tasks/tasksConstants\"), {\n  \"*\": module.makeNsSetter()\n}, 7);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"factories.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/factories.js                                                                                       //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _Factory = void 0;\n\nmodule.watch(require(\"meteor/dburles:factory\"), {\n  Factory: function Factory(v) {\n    _Factory = v;\n  }\n}, 1);\n\nvar _Loans = void 0,\n    _Borrowers = void 0,\n    _Offers = void 0,\n    _Comparators = void 0,\n    _Properties = void 0,\n    _AdminActions = void 0;\n\nmodule.watch(require(\".\"), {\n  Loans: function Loans(v) {\n    _Loans = v;\n  },\n  Borrowers: function Borrowers(v) {\n    _Borrowers = v;\n  },\n  Offers: function Offers(v) {\n    _Offers = v;\n  },\n  Comparators: function Comparators(v) {\n    _Comparators = v;\n  },\n  Properties: function Properties(v) {\n    _Properties = v;\n  },\n  AdminActions: function AdminActions(v) {\n    _AdminActions = v;\n  }\n}, 2);\nvar TEST_EMAIL = 'test@test.com';\n\n_Factory.define('user', _Meteor.users, {\n  roles: function roles() {\n    return 'user';\n  },\n  emails: function emails() {\n    return [{\n      address: TEST_EMAIL,\n      verified: false\n    }];\n  },\n  profile: {}\n});\n\n_Factory.define('dev', _Meteor.users, {\n  roles: function roles() {\n    return 'dev';\n  },\n  emails: function emails() {\n    return [{\n      address: TEST_EMAIL,\n      verified: false\n    }];\n  },\n  profile: {}\n});\n\n_Factory.define('admin', _Meteor.users, {\n  roles: function roles() {\n    return 'admin';\n  },\n  emails: function emails() {\n    return [{\n      address: TEST_EMAIL,\n      verified: false\n    }];\n  },\n  profile: {}\n});\n\n_Factory.define('lender', _Meteor.users, {\n  roles: function roles() {\n    return 'lender';\n  },\n  emails: function emails() {\n    return [{\n      address: TEST_EMAIL,\n      verified: false\n    }];\n  },\n  profile: function profile() {\n    return {\n      organization: 'bankName',\n      cantons: ['GE']\n    };\n  }\n});\n\n_Factory.define('borrower', _Borrowers, {\n  createdAt: function createdAt() {\n    return new Date();\n  },\n  expenses: function expenses() {\n    return [{\n      description: 'test',\n      value: 1\n    }];\n  },\n  files: function files() {\n    return {};\n  },\n  logic: function logic() {\n    return {};\n  },\n  age: 18\n});\n\n_Factory.define('loan', _Loans, {\n  createdAt: function createdAt() {\n    return new Date();\n  },\n  general: function general() {\n    return {\n      fortuneUsed: 250000,\n      insuranceFortuneUsed: 0,\n      partnersToAvoid: ['joe', 'john']\n    };\n  },\n  borrowers: [],\n  status: 'ACTIVE',\n  files: function files() {\n    return {};\n  },\n  logic: function logic() {\n    return {\n      auction: {},\n      lender: {},\n      verification: {},\n      step: 1\n    };\n  },\n  name: function name() {\n    return 'loan name';\n  },\n  emails: function emails() {\n    return [];\n  }\n});\n\n_Factory.define('property', _Properties, {\n  value: 1000000,\n  files: function files() {\n    return {};\n  }\n});\n\n_Factory.define('offer', _Offers, {\n  createdAt: function createdAt() {\n    return new Date();\n  },\n  organization: 'bankName',\n  canton: 'GE',\n  auctionEndTime: function auctionEndTime() {\n    return new Date();\n  },\n  standardOffer: function standardOffer() {\n    return {\n      maxAmount: 800000,\n      amortization: 0.01,\n      interestLibor: 0.01,\n      interest1: 0.01,\n      interest2: 0.01,\n      interest5: 0.01,\n      interest10: 0.01\n    };\n  }\n});\n\n_Factory.define('adminAction', _AdminActions, {\n  type: 'test',\n  status: 'ACTIVE'\n});\n\n_Factory.define('comparator', _Comparators, {\n  customFields: [],\n  customFieldCount: 0,\n  hiddenFields: [],\n  borrowRatio: 0.8\n});\n\n_Factory.define('comparatorProperty', _Properties, {\n  name: 'testName',\n  address: 'testAddress',\n  value: 100000,\n  latitude: 10,\n  longitude: 20\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/index.js                                                                                           //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  constants: function constants() {\n    return _constants2;\n  }\n});\nmodule.watch(require(\"./loans\"), {\n  default: function _default(v) {\n    exports.Loans = v;\n  }\n}, 1);\nmodule.watch(require(\"./borrowers\"), {\n  default: function _default(v) {\n    exports.Borrowers = v;\n  }\n}, 2);\nmodule.watch(require(\"./offers\"), {\n  default: function _default(v) {\n    exports.Offers = v;\n  }\n}, 3);\nmodule.watch(require(\"./properties\"), {\n  default: function _default(v) {\n    exports.Properties = v;\n  }\n}, 4);\nmodule.watch(require(\"./comparators\"), {\n  default: function _default(v) {\n    exports.Comparators = v;\n  }\n}, 5);\nmodule.watch(require(\"./adminActions\"), {\n  default: function _default(v) {\n    exports.AdminActions = v;\n  }\n}, 6);\nmodule.watch(require(\"./users\"), {\n  default: function _default(v) {\n    exports.Users = v;\n  }\n}, 7);\nmodule.watch(require(\"./tasks\"), {\n  default: function _default(v) {\n    exports.Tasks = v;\n  }\n}, 8);\nmodule.watch(require(\"./security\"), {\n  default: function _default(v) {\n    exports.SecurityService = v;\n  }\n}, 9);\nmodule.watch(require(\"./events\"), {\n  default: function _default(v) {\n    exports.EventService = v;\n  }\n}, 10);\nmodule.watch(require(\"./mutations\"), {\n  \"*\": module.makeNsSetter()\n}, 11);\n\nvar _constants = void 0;\n\nexports.constants = _constants2;\nmodule.watch(require(\"./constants\"), {\n  \"*\": function _(v) {\n    _constants = v;\n  }\n}, 0);\n// Do this for autocompletion...\nvar _constants2 = _constants;\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"links.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/api/links.js                                                                                           //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nmodule.watch(require(\"./loans/links\"));\nmodule.watch(require(\"./users/links\"));\nmodule.watch(require(\"./tasks/links\"));\nmodule.watch(require(\"./properties/links\"));\nmodule.watch(require(\"./borrowers/links\"));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"utils\":{\"testHelpers\":{\"wallaby\":{\"wallabyDefaults.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/utils/testHelpers/wallaby/wallabyDefaults.js                                                           //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// Use old-school javascript in this file to make it work nicely\nvar packageStubs = [{\n  expose: 'meteor',\n  src: 'imports/core/utils/testHelpers/meteorStubs'\n}];\n\nfunction setWallabyConfig(name) {\n  var overrides = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return function setupWallaby(wallaby) {\n    return (0, _extends3.default)({\n      name: name,\n      // debug: true, // Use this if things go wrong\n      testFramework: 'mocha',\n      files: [// load all files in imports\n      'imports/**/**.js*', // Don't load node_modules twice\n      '!imports/core/node_modules/**', // Don't import unnecessary folders\n      '!imports/core/assets/**', // Don't load tests here, but in the next variable\n      '!imports/**/*.spec.js*', // For a weird reason wallaby fucks up on .json files\n      '!**/*.json'],\n      tests: ['imports/**/*.spec.js*', '!imports/core/node_modules/**'],\n      compilers: {\n        '**/*.js*': wallaby.compilers.babel({\n          presets: ['env', 'react', 'stage-0'],\n          plugins: [['module-alias', [{\n            src: 'imports/core',\n            expose: 'core'\n          }].concat(packageStubs)]]\n        })\n      },\n      env: {\n        type: 'node'\n      },\n      setup: function setup() {\n        global.IS_WALLABY = true;\n        global.fetch = require('node-fetch');\n      }\n    }, overrides);\n  };\n}\n\nmodule.exports = setWallabyConfig;\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}}},\"logismata\":{\"api.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/utils/logismata/api.js                                                                                 //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.handleResponse = undefined;\n\nvar _typeof2 = require(\"babel-runtime/helpers/typeof\");\n\nvar _typeof3 = _interopRequireDefault(_typeof2);\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nmodule.export({\n  handleResponse: function handleResponse() {\n    return _handleResponse;\n  },\n  getAuthToken: function getAuthToken() {\n    return _getAuthToken;\n  },\n  setToken: function setToken() {\n    return _setToken;\n  },\n  convertParamsToLogismata: function convertParamsToLogismata() {\n    return _convertParamsToLogismata;\n  },\n  convertToLogismataTaxBase: function convertToLogismataTaxBase() {\n    return _convertToLogismataTaxBase;\n  },\n  getParamsArray: function getParamsArray() {\n    return _getParamsArray;\n  },\n  getTaxBase: function getTaxBase() {\n    return _getTaxBase;\n  },\n  callApi: function callApi() {\n    return _callApi;\n  },\n  getLocationId: function getLocationId() {\n    return _getLocationId;\n  },\n  getIndirectAmortization: function getIndirectAmortization() {\n    return _getIndirectAmortization;\n  },\n  getDirectAmortization: function getDirectAmortization() {\n    return _getDirectAmortization;\n  }\n});\n\nvar _2 = void 0;\n\nmodule.watch(require(\"lodash\"), {\n  _: function _(v) {\n    _2 = v;\n  }\n}, 0);\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 1);\n\nvar constants = void 0,\n    _logismataValues = void 0;\n\nmodule.watch(require(\"./constants\"), {\n  default: function _default(v) {\n    constants = v;\n  },\n  logismataValues: function logismataValues(v) {\n    _logismataValues = v;\n  }\n}, 2);\nexports.handleResponse = _handleResponse;\nvar fetch = void 0;\n\nif (_Meteor.isServer) {\n  fetch = require('node-fetch');\n} else {\n  fetch = global.fetch;\n}\n\n// Where the current token will be stored\nvar token = void 0;\n\nvar _handleResponse = function _handleResponse(response) {\n  if (response.status !== 200) {\n    throw response;\n  }\n\n  return response.json();\n}; /**\n    * getAuthToken - verifies if the token exists, and fetches a new one if not\n    *\n    * @param {String} testKey an optional string used for testing\n    *\n    * @return {String} The authentication token\n    */\n\nvar _getAuthToken = function _getAuthToken(testKey) {\n  return token ? Promise.resolve(token) : fetch(constants.authUrl(testKey), {\n    method: 'GET'\n  }).then(_handleResponse).then(function (body) {\n    token = body.authToken;\n    return body.authToken;\n  });\n};\n\nvar _setToken = function _setToken(authToken) {\n  return Promise.resolve(authToken).then(function () {\n    token = authToken;\n  });\n};\n\nvar _convertParamsToLogismata = function _convertParamsToLogismata() {\n  var params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var newParams = (0, _extends3.default)({}, params);\n  Object.keys(_logismataValues).forEach(function (key) {\n    if (params[key] !== undefined) {\n      var newValue = _2.findKey(_logismataValues[key], function (val) {\n        return val === params[key];\n      });\n\n      if (!newValue) {\n        throw new Error('invalid logismata value provided');\n      }\n\n      newParams[key] = Number(newValue);\n    } else {\n      newParams[key] = _logismataValues[key].default;\n    }\n  });\n  return newParams;\n};\n\nvar _convertToLogismataTaxBase = function _convertToLogismataTaxBase(taxBase) {\n  var params = _convertParamsToLogismata(taxBase);\n\n  return {\n    age: params.age,\n    children: params.childrenCount,\n    civil: params.civilStatus,\n    confession: params.confession,\n    gross_fortune: params.grossFortune,\n    gross_income: params.grossIncome,\n    income_type: params.incomeBase,\n    locationid: params.locationId,\n    sex: params.sex\n  };\n};\n\nvar _getParamsArray = function _getParamsArray(method, params) {\n  var logismataParams = _convertParamsToLogismata(params);\n\n  switch (method) {\n    case 'getLocationInfo':\n      return [logismataParams.locationId];\n\n    case 'searchLocations':\n      return [logismataParams.search, logismataParams.language, logismataParams.country];\n\n    case 'calcTaxableIncomeState': // Same as calcTaxableIncomeCountry\n\n    case 'calcTaxableIncomeCountry':\n      return [logismataParams.locationId, logismataParams.age, logismataParams.civilStatus, logismataParams.confession, logismataParams.childrenCount, logismataParams.grossIncome, logismataParams.isEmployee];\n\n    case 'calcTaxableFortune':\n      return [logismataParams.locationId, logismataParams.age, logismataParams.civilStatus, logismataParams.childrenCount, logismataParams.grossFortune];\n\n    case 'calcDirectAmortization':\n      return ['', // customization\n      _convertToLogismataTaxBase(params.taxBase), {\n        amortization_goal: logismataParams.amortizationGoal,\n        duration: logismataParams.duration,\n        has_detailed_amortization: logismataParams.isDetailed,\n        rental_value: logismataParams.rentalValue,\n        maintenance_costs: logismataParams.maintenanceCosts,\n        mortgages: logismataParams.mortgages,\n        new_mortgages: logismataParams.newMortgages\n      }];\n\n    case 'calcIndirectAmortization':\n      return ['', // customization\n      _convertToLogismataTaxBase(params.taxBase), {\n        amortization_goal: logismataParams.amortizationGoal,\n        duration: logismataParams.duration,\n        saving_type: logismataParams.savingType,\n        saving_interestrate: logismataParams.savingRate,\n        saving_amount_manual: false,\n        saving_amount: logismataParams.savingAmount,\n        rental_value: logismataParams.rentalValue,\n        maintenance_costs: logismataParams.maintenanceCosts,\n        mortgages: logismataParams.mortgages,\n        new_mortgages: logismataParams.newMortgages\n      }];\n\n    default:\n      throw new Error('invalid logismata method name');\n  }\n};\n\nvar _getTaxBase = function _getTaxBase(data) {};\n\nvar _callApi = function _callApi(method, params) {\n  var data = JSON.stringify({\n    authToken: token,\n    loan: {\n      method: method,\n      // Stringify objects in the array, do not stringify strings once again\n      params: [].concat(_toConsumableArray(_getParamsArray(method, params).map(function (i) {\n        return (typeof i === \"undefined\" ? \"undefined\" : (0, _typeof3.default)(i)) === 'object' ? JSON.stringify(i) : i;\n      })))\n    }\n  });\n  return fetch(constants.calcUrl(), {\n    method: 'PUT',\n    headers: {\n      'Content-Type': 'application/json',\n      Accept: '*/*'\n    },\n    body: data\n  }).then(function (response) {\n    return response.json();\n  });\n};\n\nvar _getLocationId = function _getLocationId(search) {\n  return _callApi('searchLocations', {\n    search: search,\n    country: 'CH',\n    language: 'all'\n  }).then(function (result) {\n    if (result.response && result.response.length) {\n      return result.response[result.response.length - 1].id;\n    }\n\n    throw new Error('Could not find locationId through logismata');\n  });\n};\n\nvar _getIndirectAmortization = function _getIndirectAmortization() {};\n\nvar _getDirectAmortization = function _getDirectAmortization() {};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"api_key.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/utils/logismata/api_key.js                                                                             //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nmodule.exportDefault('standard');\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"constants.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/utils/logismata/constants.js                                                                           //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  logismataValues: function logismataValues() {\n    return _logismataValues;\n  }\n});\nvar api_key = void 0;\nmodule.watch(require(\"./api_key\"), {\n  default: function _default(v) {\n    api_key = v;\n  }\n}, 0);\nvar key = api_key;\nexports.logismataValues = _logismataValues;\nmodule.exportDefault({\n  host: 'https://uat.logismata.ch',\n  authUrl: function authUrl(testKey) {\n    return this.host + \"/puma/authentication/\" + (testKey || key) + \"/createToken\";\n  },\n  calcUrl: function calcUrl() {\n    return this.host + \"/puma/calculator/onlinetax/calculate\";\n  },\n  calcUrl2: function calcUrl2() {\n    return 'https://hookb.in/vLNmVA3y';\n  }\n});\nvar _logismataValues = {\n  civilStatus: {\n    default: 2,\n    2: 'single',\n    3: 'concubinage',\n    4: 'married',\n    7: 'registered partnership'\n  },\n  confession: {\n    default: 'other',\n    1: 'reformed',\n    2: 'roman catholic',\n    3: 'christian catholic',\n    4: 'undenominational',\n    5: 'other'\n  },\n  incomeBase: {\n    default: 1,\n    1: 'gross income',\n    2: 'taxable income'\n  },\n  sex: {\n    default: 1,\n    1: 'male',\n    2: 'female'\n  },\n  country: {\n    default: 0,\n    0: 'all',\n    756: 'CH',\n    438: 'LI'\n  },\n  language: {\n    default: 0,\n    0: 'all',\n    1: 'german',\n    2: 'french',\n    3: 'italien'\n  },\n  mortgageType: {\n    default: 2,\n    1: 'Variable Rate',\n    2: 'Fixed Rate',\n    3: 'Libor'\n  },\n  savingType: {\n    default: 1,\n    1: 'Saving 3a',\n    2: 'Saving 3b/Assets'\n  },\n  existingOrNew: {\n    default: 1,\n    0: 'existing',\n    1: 'new'\n  }\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"methods.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/utils/logismata/methods.js                                                                             //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  getLogismataToken: function getLogismataToken() {\n    return _getLogismataToken;\n  }\n});\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _ValidatedMethod = void 0;\n\nmodule.watch(require(\"meteor/mdg:validated-method\"), {\n  ValidatedMethod: function ValidatedMethod(v) {\n    _ValidatedMethod = v;\n  }\n}, 1);\nexports.getLogismataToken = _getLogismataToken;\n\nvar _CallPromiseMixin = void 0;\n\nmodule.watch(require(\"meteor/didericis:callpromise-mixin\"), {\n  CallPromiseMixin: function CallPromiseMixin(v) {\n    _CallPromiseMixin = v;\n  }\n}, 2);\n\nvar _getAuthToken = void 0;\n\nmodule.watch(require(\"./api\"), {\n  getAuthToken: function getAuthToken(v) {\n    _getAuthToken = v;\n  }\n}, 3);\n\nvar _getLogismataToken = new _ValidatedMethod({\n  name: 'getLogismataToken',\n  mixins: [_CallPromiseMixin],\n  validate: null,\n  run: function run() {\n    return _Meteor.isServer && _getAuthToken();\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"analytics.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/utils/analytics.js                                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  allowTracking: function allowTracking() {\n    return _allowTracking;\n  },\n  addUserTracking: function addUserTracking() {\n    return _addUserTracking;\n  },\n  trackOncePerSession: function trackOncePerSession() {\n    return _trackOncePerSession;\n  }\n});\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _analytics = void 0;\n\nexports.allowTracking = _allowTracking;\nmodule.watch(require(\"meteor/okgrow:analytics\"), {\n  analytics: function analytics(v) {\n    _analytics = v;\n  }\n}, 1);\n\nvar _storageAvailable = void 0,\n    _isDemo = void 0;\n\nmodule.watch(require(\"./browserFunctions\"), {\n  storageAvailable: function storageAvailable(v) {\n    _storageAvailable = v;\n  },\n  isDemo: function isDemo(v) {\n    _isDemo = v;\n  }\n}, 2);\n\n/**\n * allowTracking - Prevents tracking during tests and on a demo website\n *\n * @return {Boolean}\n */var _allowTracking = function _allowTracking() {\n  if (_isDemo()) {\n    return false;\n  } else if (_Meteor.isTest) {\n    return false;\n  }\n\n  return true;\n};\n\nvar _addUserTracking = function _addUserTracking(userId, metadata) {\n  if (!userId) {\n    throw new Error('no tracking identification userId provided');\n  }\n\n  if (_allowTracking()) {\n    _analytics.identify(userId, metadata);\n  }\n};\n\nvar track = function track(eventName, metadata) {\n  if (!eventName) {\n    throw new Error('no tracking eventName provided');\n  }\n\n  if (_allowTracking()) {\n    _analytics.track(eventName, metadata);\n  }\n};\n\nmodule.exportDefault(track);\n\nvar _trackOncePerSession = function _trackOncePerSession(eventName, metadata) {\n  var localId = \"epotek-tracking.\" + eventName; // Make sure we can use sessionStorage\n\n  if (_storageAvailable('sessionStorage')) {\n    var localTracked = sessionStorage.getItem(localId);\n\n    if (!localTracked) {\n      // If this id has never been tracked in localStorage, track\n      track(eventName, metadata);\n      sessionStorage.setItem(localId, eventName);\n    } else {\n      return false;\n    }\n  }\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"borrowerFunctions.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/utils/borrowerFunctions.js                                                                             //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nmodule.export({\n  getFortune: function getFortune() {\n    return _getFortune;\n  },\n  getInsuranceFortune: function getInsuranceFortune() {\n    return _getInsuranceFortune;\n  },\n  getBorrowerCompletion: function getBorrowerCompletion() {\n    return _getBorrowerCompletion;\n  },\n  getBonusIncome: function getBonusIncome() {\n    return _getBonusIncome;\n  },\n  getArrayValues: function getArrayValues() {\n    return _getArrayValues;\n  },\n  getOtherIncome: function getOtherIncome() {\n    return _getOtherIncome;\n  },\n  getExpenses: function getExpenses() {\n    return _getExpenses;\n  },\n  getBorrowerIncome: function getBorrowerIncome() {\n    return _getBorrowerIncome;\n  },\n  getTotalFortune: function getTotalFortune() {\n    return _getTotalFortune;\n  },\n  getRealEstateFortune: function getRealEstateFortune() {\n    return _getRealEstateFortune;\n  },\n  getRealEstateValue: function getRealEstateValue() {\n    return _getRealEstateValue;\n  },\n  getRealEstateDebt: function getRealEstateDebt() {\n    return _getRealEstateDebt;\n  },\n  getBorrowerSalary: function getBorrowerSalary() {\n    return _getBorrowerSalary;\n  }\n});\n\nvar _personalInfoPercent = void 0,\n    _filesPercent = void 0;\n\nmodule.watch(require(\"../arrays/steps\"), {\n  personalInfoPercent: function personalInfoPercent(v) {\n    _personalInfoPercent = v;\n  },\n  filesPercent: function filesPercent(v) {\n    _filesPercent = v;\n  }\n}, 0);\n\nvar _borrowerFiles = void 0;\n\nexports.getFortune = _getFortune;\nmodule.watch(require(\"../api/files/files\"), {\n  borrowerFiles: function borrowerFiles(v) {\n    _borrowerFiles = v;\n  }\n}, 1);\n\nvar _arrayify = void 0;\n\nmodule.watch(require(\"./general\"), {\n  arrayify: function arrayify(v) {\n    _arrayify = v;\n  }\n}, 2);\n\nvar _getFortune = function _getFortune(_ref) {\n  var borrowers = _ref.borrowers;\n  var array = [];\n\n  _arrayify(borrowers).forEach(function (b) {\n    array.push(b.bankFortune);\n  });\n\n  return array.reduce(function (tot, val) {\n    return val > 0 && tot + val || tot;\n  }, 0);\n};\n\nvar _getInsuranceFortune = function _getInsuranceFortune(_ref2) {\n  var borrowers = _ref2.borrowers;\n  var array = [];\n\n  _arrayify(borrowers).forEach(function (b) {\n    array.push(b.insuranceSecondPillar);\n    array.push(b.insuranceThirdPillar);\n  });\n\n  return array.reduce(function (tot, val) {\n    return val > 0 && tot + val || tot;\n  }, 0);\n};\n\nvar _getBorrowerCompletion = function _getBorrowerCompletion(_ref3) {\n  var borrower = _ref3.borrower;\n  return (_filesPercent([borrower], _borrowerFiles, 'auction') + _personalInfoPercent([borrower]) + (borrower.logic.hasValidatedFinances ? 1 : 0)) / 3;\n};\n\nvar _getBonusIncome = function _getBonusIncome(_ref4) {\n  var borrowers = _ref4.borrowers;\n  var total = 0;\n\n  _arrayify(borrowers).forEach(function (borrower) {\n    if (borrower.bonus) {\n      var arr = Object.keys(borrower.bonus).map(function (key) {\n        return borrower.bonus[key];\n      });\n\n      if (arr.length < 1) {\n        return;\n      } else if (arr.length > 4) {\n        throw new Error('too many bonuses provided');\n      }\n\n      arr = arr.map(function (v) {\n        return v || 0;\n      }); // Sum all values, remove the lowest one, and return 50% of their average\n\n      var sum = arr.reduce(function (tot, val) {\n        return tot + val;\n      }, 0);\n\n      if (arr.length > 3) {\n        sum -= Math.min.apply(Math, _toConsumableArray(arr));\n      }\n\n      total = 0.5 * (sum / Math.min(3, arr.length)) || 0;\n    }\n  });\n\n  return Math.max(0, Math.round(total));\n};\n\nvar _getArrayValues = function _getArrayValues(_ref5, key, mapFunc) {\n  var borrowers = _ref5.borrowers;\n  var sum = 0;\n\n  _arrayify(borrowers).forEach(function (borrower) {\n    if (!borrower[key]) {\n      return 0;\n    }\n\n    sum += [].concat(_toConsumableArray(borrower[key] ? borrower[key].map(mapFunc || function (i) {\n      return i.value;\n    }) : [])).reduce(function (tot, val) {\n      return val > 0 && tot + val || tot;\n    }, 0);\n  });\n\n  return Math.max(0, Math.round(sum));\n};\n\nvar _getOtherIncome = function _getOtherIncome(_ref6) {\n  var borrowers = _ref6.borrowers;\n  return _getArrayValues({\n    borrowers: borrowers\n  }, 'otherIncome');\n};\n\nvar _getExpenses = function _getExpenses(_ref7) {\n  var borrowers = _ref7.borrowers;\n  return _getArrayValues({\n    borrowers: borrowers\n  }, 'expenses');\n};\n\nvar _getBorrowerIncome = function _getBorrowerIncome(_ref8) {\n  var borrowers = _ref8.borrowers;\n  var sum = 0;\n\n  _arrayify(borrowers).forEach(function (borrower) {\n    sum += borrower.salary || 0;\n    sum += _getBonusIncome({\n      borrowers: borrower\n    }) || 0;\n    sum += _getOtherIncome({\n      borrowers: borrower\n    }) || 0;\n    sum -= _getExpenses({\n      borrowers: borrower\n    }) || 0;\n  });\n\n  return Math.max(sum, 0);\n};\n\nvar _getTotalFortune = function _getTotalFortune(_ref9) {\n  var borrowers = _ref9.borrowers;\n  var sum = 0;\n\n  _arrayify(borrowers).forEach(function (borrower) {\n    sum += borrower.bankFortune || 0;\n    sum += borrower.insuranceSecondPillar || 0;\n    sum += borrower.insuranceThirdPillar || 0; // TODO: Complete with all fortune fields !!\n  });\n\n  return Math.max(0, Math.round(sum));\n};\n\nvar _getRealEstateFortune = function _getRealEstateFortune(_ref10) {\n  var borrowers = _ref10.borrowers;\n  return _getArrayValues({\n    borrowers: borrowers\n  }, 'realEstate', function (i) {\n    return i.value - i.loan;\n  });\n};\n\nvar _getRealEstateValue = function _getRealEstateValue(_ref11) {\n  var borrowers = _ref11.borrowers;\n  return _getArrayValues({\n    borrowers: borrowers\n  }, 'realEstate');\n};\n\nvar _getRealEstateDebt = function _getRealEstateDebt(_ref12) {\n  var borrowers = _ref12.borrowers;\n  return _getArrayValues({\n    borrowers: borrowers\n  }, 'realEstate', function (i) {\n    return i.loan;\n  });\n};\n\nvar _getBorrowerSalary = function _getBorrowerSalary(_ref13) {\n  var borrowers = _ref13.borrowers;\n  return _arrayify(borrowers).reduce(function (t, b) {\n    return t + (b.salary || 0);\n  }, 0);\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"browserFunctions.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/utils/browserFunctions.js                                                                              //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  getWidth: function getWidth() {\n    return _getWidth;\n  },\n  isDemo: function isDemo() {\n    return _isDemo;\n  },\n  isWww: function isWww() {\n    return _isWww;\n  },\n  isApp: function isApp() {\n    return _isApp;\n  },\n  isAdmin: function isAdmin() {\n    return _isAdmin;\n  },\n  isLender: function isLender() {\n    return _isLender;\n  },\n  storageAvailable: function storageAvailable() {\n    return _storageAvailable;\n  },\n  easeOut: function easeOut() {\n    return _easeOut;\n  }\n});\nexports.getWidth = _getWidth;\n\nvar _getWidth = function _getWidth() {\n  if (global.window) {\n    var w = window;\n    var d = document;\n    var documentElement = d.documentElement;\n    var body = d.getElementsByTagName('body')[0];\n    return w.innerWidth || documentElement.clientWidth || body.clientWidth;\n  }\n};\n\nvar getSubdomain = function getSubdomain() {\n  if (global.window) {\n    var fullPath = window.location.host; // window.location.host is subdomain.domain.com\n\n    return fullPath.split('.')[0];\n  }\n};\n\nvar _isDemo = function _isDemo() {\n  return getSubdomain() === 'demo';\n};\n\nvar _isWww = function _isWww() {\n  return getSubdomain() === 'www';\n};\n\nvar _isApp = function _isApp() {\n  return getSubdomain() === 'app';\n};\n\nvar _isAdmin = function _isAdmin() {\n  return getSubdomain() === 'admin';\n};\n\nvar _isLender = function _isLender() {\n  return getSubdomain() === 'lender';\n};\n\nvar _storageAvailable = function _storageAvailable(type) {\n  try {\n    var storage = window[type];\n    var x = '__storage_test__';\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return true;\n  } catch (e) {\n    return false;\n  }\n};\n\nvar _easeOut = function _easeOut(min, max, intervals) {\n  var diff = 1 / intervals;\n  var difference = max - min;\n  var curve = [];\n\n  for (var i = diff; i <= 1; i += diff) {\n    curve.push(min + difference * Math.pow(i, 0.48));\n  }\n\n  return curve;\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"finance-math.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/utils/finance-math.js                                                                                  //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  getYearsToRetirement: function getYearsToRetirement() {\n    return _getYearsToRetirement;\n  },\n  getAmortization: function getAmortization() {\n    return _getAmortization;\n  },\n  getInterests: function getInterests() {\n    return _getInterests;\n  },\n  getMonthlyPayment: function getMonthlyPayment() {\n    return _getMonthlyPayment;\n  },\n  getTheoreticalMonthly: function getTheoreticalMonthly() {\n    return _getTheoreticalMonthly;\n  },\n  getIncomeRatio: function getIncomeRatio() {\n    return _getIncomeRatio;\n  },\n  canAffordRank1: function canAffordRank1() {\n    return _canAffordRank;\n  }\n});\n\nvar _GENDER = void 0,\n    _USAGE_TYPE = void 0;\n\nmodule.watch(require(\"../api/constants\"), {\n  GENDER: function GENDER(v) {\n    _GENDER = v;\n  },\n  USAGE_TYPE: function USAGE_TYPE(v) {\n    _USAGE_TYPE = v;\n  }\n}, 0);\nvar constants = void 0;\nmodule.watch(require(\"../config/constants\"), {\n  default: function _default(v) {\n    constants = v;\n  }\n}, 1);\n\nvar _getLoanValue = void 0,\n    _getPropAndWork = void 0,\n    _getMaintenance = void 0,\n    _getFees = void 0;\n\nexports.getYearsToRetirement = _getYearsToRetirement;\nmodule.watch(require(\"./loanFunctions\"), {\n  getLoanValue: function getLoanValue(v) {\n    _getLoanValue = v;\n  },\n  getPropAndWork: function getPropAndWork(v) {\n    _getPropAndWork = v;\n  },\n  getMaintenance: function getMaintenance(v) {\n    _getMaintenance = v;\n  },\n  getFees: function getFees(v) {\n    _getFees = v;\n  }\n}, 2);\n\nvar _getFortune = void 0,\n    _getInsuranceFortune = void 0,\n    _getTotalFortune = void 0,\n    _getBorrowerIncome = void 0;\n\nmodule.watch(require(\"./borrowerFunctions\"), {\n  getFortune: function getFortune(v) {\n    _getFortune = v;\n  },\n  getInsuranceFortune: function getInsuranceFortune(v) {\n    _getInsuranceFortune = v;\n  },\n  getTotalFortune: function getTotalFortune(v) {\n    _getTotalFortune = v;\n  },\n  getBorrowerIncome: function getBorrowerIncome(v) {\n    _getBorrowerIncome = v;\n  }\n}, 3);\n\nvar _arrayify = void 0;\n\nmodule.watch(require(\"./general\"), {\n  arrayify: function arrayify(v) {\n    _arrayify = v;\n  }\n}, 4);\n\n// Determine retirement age depending on the gender of the borrowers\n// Return a positive value only, negative values rounded to 0\nvar _getYearsToRetirement = function _getYearsToRetirement(age1, age2, gender1, gender2) {\n  var retirement1 = gender1 === _GENDER.F ? 64 : 65;\n  var retirement2 = null;\n\n  if (gender2) {\n    retirement2 = gender2 === _GENDER.F ? 64 : 65;\n  } // Substract age to determine remaining time to retirement for both borrowers\n\n\n  var toRetirement1 = retirement1 - age1;\n  var toRetirement2 = void 0;\n\n  if (retirement2 && age2) {\n    toRetirement2 = retirement2 - age2;\n  } // Get the most limiting time to retirement for both borrowers, in years\n\n\n  var yearsToRetirement = void 0;\n\n  if (toRetirement2) {\n    yearsToRetirement = Math.min(toRetirement1, toRetirement2);\n  } else {\n    yearsToRetirement = toRetirement1;\n  }\n\n  return Math.max(yearsToRetirement, 0);\n}; // get monthly amortization for a loan loan\n\n\nvar _getAmortization = function _getAmortization(_ref) {\n  var loan = _ref.loan,\n      borrowers = _ref.borrowers,\n      property = _ref.property;\n\n  var loanValue = _getLoanValue({\n    loan: loan,\n    property: property\n  });\n\n  var propAndWork = _getPropAndWork({\n    loan: loan,\n    property: property\n  });\n\n  var safeBorrowers = _arrayify(borrowers);\n\n  var yearsToRetirement = _getYearsToRetirement(safeBorrowers[0] ? Number(safeBorrowers[0].age) : undefined, safeBorrowers[1] && safeBorrowers[1].age ? Number(safeBorrowers[1].age) : 0, safeBorrowers[0] ? safeBorrowers[0].gender : undefined, safeBorrowers[1] && safeBorrowers[1].gender); // fallback if the loan is smaller than 0\n\n\n  if (loanValue <= 0) {\n    return 0;\n  }\n\n  var loanPercent = loanValue / propAndWork;\n  var yearlyAmortization = 0;\n  var remainingYears = Math.min(yearsToRetirement, 15);\n\n  if (loanPercent > 0.65) {\n    // The loan has to be below 65% before 15 years or before retirement,\n    // whichever comes first\n    var amountToAmortize = (loanPercent - 0.65) * propAndWork; // Make sure we don't create a black hole, or use negative values by error\n\n    if (remainingYears > 0) {\n      // Amortization is the amount to amortize divided by the amount\n      // of years before the deadline\n      yearlyAmortization = amountToAmortize / remainingYears;\n    }\n  } else {// For projects below 65%, stop amortizing\n    // yearlyAmortization = propAndWork * constants.amortization;\n  }\n\n  return {\n    amortization: yearlyAmortization / 12,\n    years: remainingYears\n  };\n};\n\nvar _getInterests = function _getInterests(_ref2, rate, loanValue) {\n  var loan = _ref2.loan,\n      property = _ref2.property;\n  loanValue = loanValue || _getLoanValue({\n    loan: loan,\n    property: property\n  });\n\n  if (loanValue <= 0) {\n    throw new Error('negative loan');\n  } // Use a base interest rate of 1.5%\n\n\n  var interests = rate || 0.015;\n  return loanValue * interests / 12;\n};\n\nvar _getMonthlyPayment = function _getMonthlyPayment(_ref3) {\n  var loan = _ref3.loan,\n      borrowers = _ref3.borrowers,\n      property = _ref3.property;\n\n  var interests = _getInterests({\n    loan: loan,\n    property: property\n  });\n\n  var _getAmortization2 = _getAmortization({\n    loan: loan,\n    borrowers: borrowers,\n    property: property\n  }),\n      amortization = _getAmortization2.amortization;\n\n  var maintenance = _getMaintenance({\n    loan: loan,\n    property: property\n  });\n\n  return {\n    total: amortization + interests + maintenance,\n    amortization: amortization,\n    interests: interests,\n    maintenance: maintenance\n  };\n};\n\nvar _getTheoreticalMonthly = function _getTheoreticalMonthly(_ref4) {\n  var loan = _ref4.loan,\n      borrowers = _ref4.borrowers,\n      property = _ref4.property;\n  var maintenance = _getPropAndWork({\n    loan: loan,\n    property: property\n  }) * constants.maintenance / 12;\n\n  var loanValue = _getLoanValue({\n    loan: loan,\n    property: property\n  });\n\n  var interests = loanValue * constants.interests / 12;\n\n  var _getAmortization3 = _getAmortization({\n    loan: loan,\n    borrowers: borrowers,\n    property: property\n  }),\n      amortization = _getAmortization3.amortization;\n\n  return {\n    total: amortization + interests + maintenance,\n    amortization: amortization,\n    interests: interests,\n    maintenance: maintenance\n  };\n};\n\nvar _getIncomeRatio = function _getIncomeRatio(_ref5) {\n  var loan = _ref5.loan,\n      borrowers = _ref5.borrowers,\n      property = _ref5.property;\n\n  var monthlyPayment = _getTheoreticalMonthly({\n    loan: loan,\n    borrowers: borrowers,\n    property: property\n  }).total;\n\n  var borrowerIncome = _getBorrowerIncome({\n    borrowers: borrowers\n  }) / 12; // Add infinity check\n\n  if (borrowerIncome > 0) {\n    return monthlyPayment / borrowerIncome;\n  }\n\n  return '-';\n};\n\nvar _canAffordRank = function _canAffordRank(_ref6) {\n  var loan = _ref6.loan,\n      borrowers = _ref6.borrowers,\n      property = _ref6.property;\n\n  var propAndWork = _getPropAndWork({\n    loan: loan,\n    property: property\n  });\n\n  var totalFortune = _getTotalFortune({\n    borrowers: borrowers\n  });\n\n  var fortune = _getFortune({\n    borrowers: borrowers\n  });\n\n  var insuranceFortune = _getInsuranceFortune({\n    borrowers: borrowers\n  });\n\n  var fortuneRequired = 0.35 * propAndWork + property.value * constants.notaryFees;\n\n  if (fortune >= fortuneRequired) {\n    return true;\n  }\n\n  if (loan.general && loan.general.usageType === _USAGE_TYPE.PRIMARY) {\n    if (fortune + insuranceFortune >= fortuneRequired) {\n      // ignore lppFees\n      return true;\n    }\n  }\n\n  return false;\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"general.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/utils/general.js                                                                                       //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  arrayify: function arrayify() {\n    return _arrayify;\n  }\n});\nvar isArray = void 0;\nexports.arrayify = _arrayify;\nmodule.watch(require(\"lodash/isArray\"), {\n  default: function _default(v) {\n    isArray = v;\n  }\n}, 0);\n\nvar _arrayify = function _arrayify(value) {\n  return value ? isArray(value) ? value : [value] : [];\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"generate-pdf.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/utils/generate-pdf.js                                                                                  //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  generateComponentAsPDF: function generateComponentAsPDF() {\n    return _generateComponentAsPDF;\n  }\n});\nvar ReactDOMServer = void 0;\nmodule.watch(require(\"react-dom/server\"), {\n  default: function _default(v) {\n    ReactDOMServer = v;\n  }\n}, 0);\nvar pdf = void 0;\nmodule.watch(require(\"html-pdf\"), {\n  default: function _default(v) {\n    pdf = v;\n  }\n}, 1);\nvar fs = void 0;\nmodule.watch(require(\"fs\"), {\n  default: function _default(v) {\n    fs = v;\n  }\n}, 2);\nvar thisModule = void 0;\n\nvar getBase64String = function getBase64String(path) {\n  try {\n    var file = fs.readFileSync(path);\n    return new Buffer(file).toString('base64');\n  } catch (exception) {\n    thisModule.reject(exception);\n  }\n};\n\nexports.generateComponentAsPDF = _generateComponentAsPDF;\n\nvar generatePDF = function generatePDF(html, fileName) {\n  try {\n    pdf.create(html, {\n      format: 'A4',\n      border: {\n        top: '1in',\n        right: '1in',\n        bottom: '1in',\n        left: '1in'\n      }\n    }).toFile(\"./tmp/\" + fileName, function (error, response) {\n      if (error) {\n        thisModule.reject(error);\n      } else {\n        thisModule.resolve({\n          fileName: fileName,\n          base64: getBase64String(response.filename)\n        });\n        fs.unlink(response.filename);\n      }\n    });\n  } catch (exception) {\n    thisModule.reject(exception);\n  }\n};\n\nvar getComponentAsHTML = function getComponentAsHTML(component, props) {\n  try {\n    return ReactDOMServer.renderToStaticMarkup(component(props));\n  } catch (exception) {\n    thisModule.reject(exception);\n  }\n};\n\nvar handler = function handler(_ref, promise) {\n  var component = _ref.component,\n      props = _ref.props,\n      fileName = _ref.fileName;\n  thisModule = promise;\n  var html = getComponentAsHTML(component, props);\n\n  if (html && fileName) {\n    generatePDF(html, fileName);\n  }\n};\n\nvar _generateComponentAsPDF = function _generateComponentAsPDF(options) {\n  return new Promise(function (resolve, reject) {\n    return handler(options, {\n      resolve: resolve,\n      reject: reject\n    });\n  });\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"intl.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/utils/intl.js                                                                                          //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar IntlMessageFormat = void 0;\nmodule.watch(require(\"intl-messageformat\"), {\n  default: function _default(v) {\n    IntlMessageFormat = v;\n  }\n}, 0);\n\nvar _getUserLocale = void 0,\n    _getFormats = void 0;\n\nmodule.watch(require(\"./localization\"), {\n  getUserLocale: function getUserLocale(v) {\n    _getUserLocale = v;\n  },\n  getFormats: function getFormats(v) {\n    _getFormats = v;\n  }\n}, 1);\nvar messagesFR = void 0;\nmodule.watch(require(\"../lang/fr.json\"), {\n  default: function _default(v) {\n    messagesFR = v;\n  }\n}, 2);\n\n/**\n * formatMessage - A server-side method to use the intl package\n *\n * @param {type}   id          the id of the message\n * @param {object} [values={}] any additional values you want to use in the\n * string\n *\n * @return {type} The formatted string\n */var formatMessage = function formatMessage(id) {\n  var values = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var customFallback = arguments[2];\n\n  if (id === undefined) {\n    throw new Error('an id is required in formatMessage');\n  }\n\n  var message = new IntlMessageFormat(messagesFR[id] || (customFallback !== undefined ? customFallback : id), _getUserLocale());\n  return message.format(values);\n};\n\nmodule.exportDefault(formatMessage);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"loadable.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/utils/loadable.js                                                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.export({\n  default: function _default() {\n    return MyLoadable;\n  }\n});\nvar Loadable = void 0;\nmodule.watch(require(\"react-loadable\"), {\n  default: function _default(v) {\n    Loadable = v;\n  }\n}, 0);\n\nvar _LoadingComponent = void 0;\n\nmodule.watch(require(\"../components/Loading\"), {\n  LoadingComponent: function LoadingComponent(v) {\n    _LoadingComponent = v;\n  }\n}, 1);\n\nfunction MyLoadable(options) {\n  return Loadable((0, _extends3.default)({\n    loading: _LoadingComponent,\n    delay: 200\n  }, options));\n}\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"loanFunctions.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/utils/loanFunctions.js                                                                                 //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getProjectValue = undefined;\n\nvar _defineProperty2 = require(\"babel-runtime/helpers/defineProperty\");\n\nvar _defineProperty3 = _interopRequireDefault(_defineProperty2);\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.export({\n  getProjectValue: function getProjectValue() {\n    return _getProjectValue;\n  },\n  getLoanValue: function getLoanValue() {\n    return _getLoanValue;\n  },\n  loanStrategySuccess: function loanStrategySuccess() {\n    return _loanStrategySuccess;\n  },\n  strategiesChosen: function strategiesChosen() {\n    return _strategiesChosen;\n  },\n  getInterestsWithOffer: function getInterestsWithOffer() {\n    return _getInterestsWithOffer;\n  },\n  getMonthlyWithOffer: function getMonthlyWithOffer() {\n    return _getMonthlyWithOffer;\n  },\n  getMonthlyWithExtractedOffer: function getMonthlyWithExtractedOffer() {\n    return _getMonthlyWithExtractedOffer;\n  },\n  getPropAndWork: function getPropAndWork() {\n    return _getPropAndWork;\n  },\n  getTotalUsed: function getTotalUsed() {\n    return _getTotalUsed;\n  },\n  getBorrowRatio: function getBorrowRatio() {\n    return _getBorrowRatio;\n  },\n  getLenderCount: function getLenderCount() {\n    return _getLenderCount;\n  },\n  disableForms: function disableForms() {\n    return _disableForms;\n  },\n  getFees: function getFees() {\n    return _getFees;\n  },\n  isLoanValid: function isLoanValid() {\n    return _isLoanValid;\n  },\n  getPropertyCompletion: function getPropertyCompletion() {\n    return _getPropertyCompletion;\n  },\n  validateRatios: function validateRatios() {\n    return _validateRatios;\n  },\n  validateRatiosCompletely: function validateRatiosCompletely() {\n    return _validateRatiosCompletely;\n  },\n  getMaintenance: function getMaintenance() {\n    return _getMaintenance;\n  },\n  strategyDone: function strategyDone() {\n    return _strategyDone;\n  },\n  getAuctionEndTime: function getAuctionEndTime() {\n    return _getAuctionEndTime;\n  }\n});\nvar moment = void 0;\nmodule.watch(require(\"moment\"), {\n  default: function _default(v) {\n    moment = v;\n  }\n}, 0);\nvar constants = void 0;\nmodule.watch(require(\"../config/constants\"), {\n  default: function _default(v) {\n    constants = v;\n  }\n}, 1);\n\nvar _USAGE_TYPE = void 0,\n    _LOAN_STRATEGY_PRESET = void 0,\n    _OFFER_TYPE = void 0;\n\nmodule.watch(require(\"../api/constants\"), {\n  USAGE_TYPE: function USAGE_TYPE(v) {\n    _USAGE_TYPE = v;\n  },\n  LOAN_STRATEGY_PRESET: function LOAN_STRATEGY_PRESET(v) {\n    _LOAN_STRATEGY_PRESET = v;\n  },\n  OFFER_TYPE: function OFFER_TYPE(v) {\n    _OFFER_TYPE = v;\n  }\n}, 2);\nexports.getProjectValue = _getProjectValue;\n\nvar _getIncomeRatio = void 0;\n\nmodule.watch(require(\"./finance-math\"), {\n  getIncomeRatio: function getIncomeRatio(v) {\n    _getIncomeRatio = v;\n  }\n}, 3);\n\nvar _propertyPercent = void 0,\n    _filesPercent = void 0;\n\nmodule.watch(require(\"../arrays/steps\"), {\n  propertyPercent: function propertyPercent(v) {\n    _propertyPercent = v;\n  },\n  filesPercent: function filesPercent(v) {\n    _filesPercent = v;\n  }\n}, 4);\n\nvar _loanFiles = void 0,\n    _propertyFiles = void 0;\n\nmodule.watch(require(\"../api/files/files\"), {\n  loanFiles: function loanFiles(v) {\n    _loanFiles = v;\n  },\n  propertyFiles: function propertyFiles(v) {\n    _propertyFiles = v;\n  }\n}, 5);\n\nvar _getProjectValue = function _getProjectValue(_ref) {\n  var loan = _ref.loan,\n      property = _ref.property;\n\n  if (!property || !property.value) {\n    return 0;\n  } else if (property.value <= 0) {\n    return 0;\n  }\n\n  var value = property.value * (1 + constants.notaryFees) + (loan.general.propertyWork || 0);\n\n  if (loan.general.usageType === _USAGE_TYPE.PRIMARY) {\n    value += (loan.general.insuranceFortuneUsed || 0) * constants.lppFees;\n  }\n\n  return Math.max(0, Math.round(value));\n};\n\nvar _getLoanValue = function _getLoanValue(_ref2, roundedTo10000) {\n  var loan = _ref2.loan,\n      property = _ref2.property;\n\n  if (!loan || !loan.general) {\n    return 0;\n  }\n\n  var value = _getProjectValue({\n    loan: loan,\n    property: property\n  }) - (loan.general.fortuneUsed || 0);\n\n  if (loan.general.usageType === _USAGE_TYPE.PRIMARY) {\n    value -= loan.general.insuranceFortuneUsed || 0;\n  } // Do this when picking tranches\n\n\n  if (roundedTo10000) {\n    value = Math.round(value / 10000) * 10000;\n  } // Check negative values\n\n\n  return Math.max(0, Math.round(value));\n};\n\nvar _loanStrategySuccess = function _loanStrategySuccess() {\n  var loanTranches = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var loanValue = arguments[1];\n\n  if (!Number.isInteger(loanValue)) {\n    throw new Error('loanValue must be an integer');\n  }\n\n  if (loanTranches.length < 1) {\n    return false;\n  } // User has to choose a preset\n\n\n  var trancheSum = loanTranches.reduce(function (tot, tranche) {\n    return tranche.value + tot;\n  }, 0);\n\n  if (trancheSum === loanValue) {\n    // If the sum of all tranches is equal to the loan, success!\n    return true;\n  }\n\n  return false;\n};\n\nvar _strategiesChosen = function _strategiesChosen(_ref3) {\n  var loan = _ref3.loan,\n      property = _ref3.property;\n  return _loanStrategySuccess(loan.general.loanTranches, _getLoanValue({\n    loan: loan,\n    property: property\n  })) && loan.logic.amortizationStrategyPreset && loan.logic.hasValidatedCashStrategy;\n};\n\nvar _getInterestsWithOffer = function _getInterestsWithOffer(_ref4) {\n  var loan = _ref4.loan,\n      offer = _ref4.offer;\n  var isStandard = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\n  if (!offer) {\n    return 0;\n  }\n\n  var tranches = loan.general.loanTranches;\n  var interestRates = isStandard ? offer.standardOffer : offer.counterpartOffer;\n  var interests = 0;\n  tranches.every(function (tranche) {\n    var rate = interestRates[tranche.type]; // If the lender doesn't have this interest rate, return false\n\n    if (!rate) {\n      interests = -1; // break loop\n\n      return false;\n    }\n\n    interests += tranche.value * rate;\n    return true;\n  });\n  return interests >= 0 ? Math.round(interests / 12) : interests;\n};\n\nvar _getMonthlyWithOffer = function _getMonthlyWithOffer(_ref5) {\n  var loan = _ref5.loan,\n      property = _ref5.property,\n      offer = _ref5.offer;\n  var isStandard = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n  var fortuneUsed = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  var insuranceFortuneUsed = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n\n  // Return undefined if the counterpartOffer doesn't exist\n  if (!isStandard && !offer.counterpartOffer) {\n    return undefined;\n  } // Make a copy of the loan\n\n\n  var r = (0, _extends3.default)({}, loan, {\n    general: (0, _extends3.default)({}, loan.general, {\n      fortuneUsed: fortuneUsed || loan.general.fortuneUsed,\n      insuranceFortuneUsed: insuranceFortuneUsed || loan.general.insuranceFortuneUsed\n    })\n  }); // Modify it to include additional parameters\n  // r.general.fortuneUsed = fortuneUsed || r.general.fortuneUsed;\n  // r.general.insuranceFortuneUsed =\n  //   insuranceFortuneUsed || r.general.insuranceFortuneUsed;\n\n  var loanValue = _getLoanValue({\n    loan: r,\n    property: property\n  });\n\n  var maintenance = constants.maintenanceReal * (property.value + (r.general.propertyWork || 0));\n  var amortization = isStandard ? offer.standardOffer.amortization : offer.counterpartOffer.amortization;\n  amortization = amortization || constants.amortization;\n\n  var interests = _getInterestsWithOffer({\n    loan: r,\n    offer: offer\n  }, isStandard);\n\n  return interests >= 0 ? Math.round((maintenance + loanValue * amortization + interests) / 12) || 0 : 0;\n};\n\nvar _getMonthlyWithExtractedOffer = function _getMonthlyWithExtractedOffer(_ref6) {\n  var loan = _ref6.loan,\n      offer = _ref6.offer,\n      property = _ref6.property;\n  return _getMonthlyWithOffer({\n    loan: loan,\n    property: property,\n    offer: (0, _defineProperty3.default)({}, offer.type === _OFFER_TYPE.STANDARD ? 'standardOffer' : 'counterpartOffer', offer)\n  }, offer.type === _OFFER_TYPE.STANDARD);\n};\n\nvar _getPropAndWork = function _getPropAndWork(_ref7) {\n  var loan = _ref7.loan,\n      property = _ref7.property;\n  return property && property.value + (loan && loan.general && loan.general.propertyWork || 0) || 0;\n};\n\nvar _getTotalUsed = function _getTotalUsed(_ref8) {\n  var loan = _ref8.loan;\n  return Math.round(loan.general.fortuneUsed + (loan.general.insuranceFortuneUsed || 0));\n};\n\nvar _getBorrowRatio = function _getBorrowRatio(_ref9) {\n  var loan = _ref9.loan,\n      property = _ref9.property;\n\n  var loanValue = _getLoanValue({\n    loan: loan,\n    property: property\n  });\n\n  var propAndWork = _getPropAndWork({\n    loan: loan,\n    property: property\n  });\n\n  return loanValue / propAndWork;\n};\n\nvar _getLenderCount = function _getLenderCount(_ref10) {\n  var loan = _ref10.loan,\n      borrowers = _ref10.borrowers,\n      property = _ref10.property;\n\n  var incomeRatio = _getIncomeRatio({\n    loan: loan,\n    borrowers: borrowers,\n    property: property\n  });\n\n  var borrowRatio = _getBorrowRatio({\n    loan: loan,\n    property: property\n  });\n\n  if (incomeRatio > 0.38) {\n    return 0;\n  } else if (incomeRatio > 1 / 3) {\n    return 4;\n  } else if (borrowRatio <= 0.65) {\n    return 20;\n  } else if (borrowRatio > 0.65 && borrowRatio <= 0.9) {\n    return 10;\n  }\n\n  return 0;\n};\n\nvar _disableForms = function _disableForms(_ref11) {\n  var loan = _ref11.loan;\n  return !!(loan.logic && (loan.logic.step > 1 || loan.logic.verification && (loan.logic.verification.requested || loan.logic.verification.validated !== undefined)));\n};\n\nvar _getFees = function _getFees(_ref12) {\n  var loan = _ref12.loan,\n      property = _ref12.property;\n  var notaryFees = property.value * constants.notaryFees;\n  var insuranceFees = 0;\n\n  if (loan.general.usageType === _USAGE_TYPE.PRIMARY) {\n    insuranceFees = loan.general.insuranceFortuneUsed * constants.lppFees;\n  }\n\n  return notaryFees + (insuranceFees || 0);\n};\n\nvar _isLoanValid = function _isLoanValid(_ref13) {\n  var loan = _ref13.loan,\n      borrowers = _ref13.borrowers,\n      property = _ref13.property;\n\n  var incomeRatio = _getIncomeRatio({\n    loan: loan,\n    borrowers: borrowers,\n    property: property\n  });\n\n  var borrowRatio = _getBorrowRatio({\n    loan: loan,\n    borrowers: borrowers,\n    property: property\n  });\n\n  var fees = _getFees({\n    loan: loan,\n    property: property\n  });\n\n  var propAndWork = _getPropAndWork({\n    loan: loan,\n    property: property\n  });\n\n  var cashRequired = constants.minCash * propAndWork + fees;\n\n  if (incomeRatio > 0.38) {\n    throw new Error('income');\n  } else if (loan.general.fortuneUsed < cashRequired) {\n    throw new Error('cash');\n  } else if (borrowRatio > 0.8) {\n    throw new Error('ownFunds');\n  }\n\n  return true;\n};\n\nvar _getPropertyCompletion = function _getPropertyCompletion(_ref14) {\n  var loan = _ref14.loan,\n      borrowers = _ref14.borrowers,\n      property = _ref14.property;\n\n  var formsProgress = _propertyPercent(loan, borrowers, property);\n\n  var filesProgress = _filesPercent(property, _propertyFiles, 'auction');\n\n  return (formsProgress + filesProgress) / 2;\n};\n\nvar _validateRatios = function _validateRatios(incomeRatio, borrowRatio) {\n  var allowInsurance = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n  var borrowRatioWanted = arguments[3];\n  // To prevent rounding errors\n  var incomeRatioSafe = incomeRatio - 0.001;\n  var borrowRatioSafe = borrowRatio - 0.001;\n\n  if (borrowRatioWanted && borrowRatioWanted !== 0.8) {\n    if (borrowRatioSafe > borrowRatioWanted) {\n      throw new Error('fortune');\n    }\n  }\n\n  if (incomeRatioSafe > 0.38) {\n    throw new Error('income');\n  } else if (!allowInsurance && borrowRatioSafe > 0.8) {\n    throw new Error('fortune');\n  } else if (borrowRatioSafe > 0.9) {\n    throw new Error('fortune');\n  } else if (incomeRatioSafe > 1 / 3) {\n    throw new Error('incomeTight');\n  } else if (borrowRatioSafe > 0.8) {\n    throw new Error('fortuneTight');\n  }\n\n  return true;\n};\n\nvar _validateRatiosCompletely = function _validateRatiosCompletely(incomeRatio, borrowRatio) {\n  var allowInsurance = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n  var borrowRatioWanted = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0.9;\n\n  try {\n    _validateRatios(incomeRatio, borrowRatio, borrowRatioWanted, allowInsurance);\n\n    return {\n      isValid: true,\n      message: 'valid',\n      message2: '',\n      icon: 'check',\n      className: 'success'\n    };\n  } catch (error) {\n    var isTight = error.message.indexOf('Tight') >= 0;\n    return {\n      isValid: false,\n      message: \"\" + error.message,\n      message2: error.message + \"2\",\n      icon: isTight ? 'warning' : 'close',\n      className: isTight ? 'warning' : 'error'\n    };\n  }\n};\n\nvar _getMaintenance = function _getMaintenance(_ref15) {\n  var property = _ref15.property;\n  return property.value * 0.01 / 12;\n};\n\nvar _strategyDone = function _strategyDone(_ref16) {\n  var loan = _ref16.loan,\n      property = _ref16.property;\n  var general = loan.general,\n      logic = loan.logic;\n\n  if (general.insuranceFortuneUsed > 0 && !logic.insuranceUsePreset) {\n    return false;\n  }\n\n  if (!logic.amortizationStrategyPreset) {\n    return false;\n  }\n\n  if (!logic.loanStrategyPreset) {\n    return false;\n  }\n\n  if (logic.loanStrategyPreset === _LOAN_STRATEGY_PRESET.MANUAL && !_loanStrategySuccess(general.loanTranches, _getLoanValue({\n    loan: loan,\n    property: property\n  }, true))) {\n    return false;\n  }\n\n  return true;\n};\n\nvar _getAuctionEndTime = function _getAuctionEndTime(startTime) {\n  var time = moment(startTime);\n\n  if (time.isoWeekday() === 6) {\n    // On saturdays, go to Tuesday\n    time.add(3, 'd');\n  } else if (time.isoWeekday() === 7) {\n    // On saturdays, go to Tuesday\n    time.add(2, 'd');\n  } else if (time.hour() >= 0 && time.hour() < 7) {\n    // If the start time is between midnight and 7:00,\n    // set endtime to be tomorrow night\n    time.add(1, 'd');\n  } else {\n    // Else, set endtime in 2 days from now\n    time.add(2, 'd');\n  } // Skip weekends\n\n\n  if (time.isoWeekday() === 6 || time.isoWeekday() === 7) {\n    // Saturday or Sunday\n    time.add(2, 'd');\n  } // Auctions always end at midnight\n\n\n  time.hours(23);\n  time.minutes(59);\n  time.seconds(59);\n  time.milliseconds(0);\n  return time.toDate();\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"localization.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/utils/localization.js                                                                                  //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  getUserLocale: function getUserLocale() {\n    return _getUserLocale;\n  },\n  getFormats: function getFormats() {\n    return _getFormats;\n  },\n  localizationStartup: function localizationStartup() {\n    return _localizationStartup;\n  }\n});\n\nvar _addLocaleData = void 0;\n\nmodule.watch(require(\"react-intl\"), {\n  addLocaleData: function addLocaleData(v) {\n    _addLocaleData = v;\n  }\n}, 0);\n\nvar _T9n = void 0;\n\nmodule.watch(require(\"meteor/softwarerero:accounts-t9n\"), {\n  T9n: function T9n(v) {\n    _T9n = v;\n  }\n}, 1);\nvar moment = void 0;\nexports.getUserLocale = _getUserLocale;\nmodule.watch(require(\"moment\"), {\n  default: function _default(v) {\n    moment = v;\n  }\n}, 2);\nvar Loadable = void 0;\nmodule.watch(require(\"./loadable\"), {\n  default: function _default(v) {\n    Loadable = v;\n  }\n}, 3);\nvar fr = void 0;\nmodule.watch(require(\"react-intl/locale-data/fr\"), {\n  default: function _default(v) {\n    fr = v;\n  }\n}, 4);\n\nvar _getUserLocale = function _getUserLocale() {\n  return 'fr-CH';\n};\n\nvar _getFormats = function _getFormats() {\n  return {\n    number: {\n      money: {\n        style: 'currency',\n        currency: 'CHF',\n        maximumFractionDigits: 0,\n        minimumFractionDigits: 0\n      },\n      moneyWithoutCurrency: {\n        style: 'decimal',\n        useGrouping: true,\n        maximumFractionDigits: 0,\n        minimumFractionDigits: 0\n      },\n      percentage: {\n        style: 'percent',\n        minimumFractionDigits: 2,\n        maximumFractionDigits: 2\n      },\n      percentageRounded: {\n        style: 'percent',\n        minimumFractionDigits: 0,\n        maximumFractionDigits: 0\n      }\n    }\n  };\n};\n\nvar _localizationStartup = function _localizationStartup() {\n  // Add locales used in app here\n  _addLocaleData(fr);\n\n  _T9n.setLanguage('fr');\n\n  setupMoment();\n  moment.locale('fr');\n};\n\nvar setupMoment = function setupMoment() {\n  moment.locale('fr', {\n    months: 'Janvier_Février_Mars_Avril_Mai_Juin_Juillet_Août_Septembre_Octobre_Novembre_Décembre'.split('_'),\n    monthsShort: 'Janv._Févr._Mars_Avr._Mai_Juin_Juil._Août_Sept._Oct._Nov._Déc.'.split('_'),\n    monthsParseExact: true,\n    weekdays: 'Dimanche_Lundi_Mardi_Mercredi_Jeudi_Vendredi_Samedi'.split('_'),\n    weekdaysShort: 'Dim._Lun._Mar._Mer._Jeu._Ven._Sam.'.split('_'),\n    weekdaysMin: 'Di_Lu_Ma_Me_Je_Ve_Sa'.split('_'),\n    weekdaysParseExact: true,\n    longDateFormat: {\n      LT: 'HH:mm',\n      LTS: 'HH:mm:ss',\n      L: 'DD/MM/YYYY',\n      LL: 'D MMMM YYYY',\n      LLL: 'D MMMM YYYY HH:mm',\n      LLLL: 'dddd D MMMM YYYY HH:mm'\n    },\n    calendar: {\n      sameDay: '[Aujourd’hui à] LT',\n      nextDay: '[Demain à] LT',\n      nextWeek: 'dddd [à] LT',\n      lastDay: '[Hier à] LT',\n      lastWeek: 'dddd [dernier à] LT',\n      sameElse: 'L'\n    },\n    relativeTime: {\n      future: 'dans %s',\n      past: 'il y a %s',\n      s: 'quelques secondes',\n      m: 'une minute',\n      mm: '%d minutes',\n      h: 'une heure',\n      hh: '%d heures',\n      d: 'un jour',\n      dd: '%d jours',\n      M: 'un mois',\n      MM: '%d mois',\n      y: 'un an',\n      yy: '%d ans'\n    },\n    dayOfMonthOrdinalParse: /\\d{1,2}(er|e)/,\n    ordinal: function ordinal(number) {\n      return number + (number === 1 ? 'er' : 'e');\n    },\n    meridiemParse: /PD|MD/,\n    isPM: function isPM(input) {\n      return input.charAt(0) === 'M';\n    },\n    // In case the meridiem units are not separated around 12, then implement\n    // this function (look at locale/id.js for an example).\n    // meridiemHour : function (hour, meridiem) {\n    //     return /* 0-23 hour, given meridiem token and hour 1-12 */ ;\n    // },\n    meridiem: function meridiem(hours, minutes, isLower) {\n      return hours < 12 ? 'PD' : 'MD';\n    },\n    week: {\n      dow: 1,\n      // Monday is the first day of the week.\n      doy: 4 // The week that contains Jan 4th is the first week of the year.\n\n    }\n  });\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"rate-limit.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/utils/rate-limit.js                                                                                    //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nmodule.export({\n  default: function _default() {\n    return rateLimit;\n  }\n});\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _DDPRateLimiter = void 0;\n\nmodule.watch(require(\"meteor/ddp-rate-limiter\"), {\n  DDPRateLimiter: function DDPRateLimiter(v) {\n    _DDPRateLimiter = v;\n  }\n}, 1);\n\nvar _2 = void 0;\n\nmodule.watch(require(\"meteor/underscore\"), {\n  _: function _(v) {\n    _2 = v;\n  }\n}, 2);\n\n// DDPRateLimiter.setErrorMessage(({ timeToReset }) => {\n//   const time = Math.ceil(timeToReset / 1000);\n//   const seconds = time === 1 ? 'second' : 'seconds';\n//   return `Easy on the gas, buddy. Too many loans. Try again in ${time} ${seconds}.`;\n// });\nvar fetchMethodNames = function fetchMethodNames(methods) {\n  return _2.pluck(methods, 'name');\n};\n\nvar assignLimits = function assignLimits(_ref) {\n  var methods = _ref.methods,\n      _ref$limit = _ref.limit,\n      limit = _ref$limit === undefined ? 5 : _ref$limit,\n      _ref$timeRange = _ref.timeRange,\n      timeRange = _ref$timeRange === undefined ? 1000 : _ref$timeRange;\n  var methodNames = fetchMethodNames(methods);\n\n  if (_Meteor.isServer) {\n    _DDPRateLimiter.addRule({\n      name: function name(_name) {\n        return _2.contains(methodNames, _name);\n      },\n      connectionId: function connectionId() {\n        return true;\n      }\n    }, limit, timeRange);\n  }\n};\n\nfunction rateLimit(options) {\n  return assignLimits(options);\n}\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"saveStartForm.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/utils/saveStartForm.js                                                                                 //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar cleanMethod = void 0;\nmodule.watch(require(\"../api/cleanMethods\"), {\n  default: function _default(v) {\n    cleanMethod = v;\n  }\n}, 0);\n\n// The final function that inserts the documents once the form is finished\nvar saveStartForm = function saveStartForm(f, userId) {\n  var multiple = f.borrowerCount > 1;\n  var borrowerOne = {\n    age: f.age,\n    gender: f.gender,\n    salary: f.income1,\n    bonusExists: f.bonusExists,\n    bonus: {\n      bonus2014: f.bonus11,\n      bonus2015: f.bonus21,\n      bonus2016: f.bonus31,\n      bonus2017: f.bonus41\n    },\n    otherIncome: f.otherIncome || [],\n    expenses: f.expenses || [],\n    realEstate: f.realEstate || [],\n    bankFortune: f.fortune1,\n    insuranceSecondPillar: f.insurance11,\n    insuranceThirdPillar: f.insurance21\n  };\n  var borrowerTwo = {};\n\n  if (multiple) {\n    borrowerTwo = {\n      salary: f.income2,\n      bonusExists: f.bonusExists,\n      bonus: {\n        bonus2014: f.bonus12,\n        bonus2015: f.bonus22,\n        bonus2016: f.bonus32,\n        bonus2017: f.bonus42\n      },\n      bankFortune: f.fortune2,\n      insuranceSecondPillar: f.insurance12,\n      insuranceThirdPillar: f.insurance22,\n      sameAddress: true\n    };\n  }\n\n  var loan = {\n    general: {\n      usageType: f.usageType,\n      purchaseType: f.purchaseType,\n      oldestAge: multiple ? f.oldestAge : f.age,\n      oldestGender: multiple ? f.oldestGender : f.gender,\n      fortuneUsed: f.fortuneUsed,\n      insuranceFortuneUsed: f.insuranceFortuneUsed,\n      propertyWork: f.propertyWork || 0\n    },\n    // property: {\n    //   usageType: f.usageType,\n    //   value: f.propertyValue,\n    //   propertyWork: f.propertyWork || 0,\n    //   investmentRent: f.propertyRent,\n    // },\n    borrowerIds: []\n  };\n  var property = {\n    value: f.propertyValue,\n    investmentRent: f.propertyRent\n  };\n  return cleanMethod('insertBorrower', {\n    object: borrowerOne,\n    userId: userId\n  }).then(function (id1) {\n    return loan.borrowerIds.push(id1);\n  }).then(function () {\n    return !!multiple && cleanMethod('insertBorrower', {\n      object: borrowerTwo,\n      userId: userId\n    });\n  }).then(function (id2) {\n    return !!id2 && loan.borrowerIds.push(id2);\n  }).then(function () {\n    return cleanMethod('insertProperty', {\n      object: property,\n      userId: userId\n    });\n  }).then(function (propertyId) {\n    loan.propertyId = propertyId;\n    return cleanMethod('insertLoan', {\n      object: loan,\n      userId: userId\n    });\n  }) // If no userId is provided, return the loanId\n  .then(function (loanId) {\n    return userId || loanId;\n  }).catch(function (error) {\n    console.warn(error);\n    throw error;\n  });\n};\n\nmodule.exportDefault(saveStartForm);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"arrays\":{\"BorrowerFormArray.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/arrays/BorrowerFormArray.js                                                                            //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nmodule.export({\n  getBorrowerInfoArray: function getBorrowerInfoArray() {\n    return _getBorrowerInfoArray;\n  },\n  getBorrowerFinanceArray: function getBorrowerFinanceArray() {\n    return _getBorrowerFinanceArray;\n  }\n});\n\nvar _constants = void 0;\n\nexports.getBorrowerInfoArray = _getBorrowerInfoArray;\nmodule.watch(require(\"../api\"), {\n  constants: function constants(v) {\n    _constants = v;\n  }\n}, 0);\n\nvar _getBorrowerInfoArray = function _getBorrowerInfoArray(_ref) {\n  var borrowers = _ref.borrowers,\n      id = _ref.borrowerId;\n  var b = borrowers.find(function (borrower) {\n    return borrower._id === id;\n  });\n  var multiple = borrowers.length > 1; // If this is the first borrower in the array of borrowers, don't ask for same address\n\n  var isFirst = borrowers[0]._id === id;\n\n  if (!b) {\n    throw new Error(\"couldn't find borrower\");\n  }\n\n  var disableAddress = !!b.sameAddress && !isFirst;\n  return [{\n    id: 'firstName',\n    type: 'textInput'\n  }, {\n    id: 'lastName',\n    type: 'textInput'\n  }, {\n    id: 'gender',\n    type: 'radioInput',\n    options: Object.values(_constants.GENDER)\n  }, {\n    type: 'h3',\n    id: 'yourAddress',\n    ignore: true,\n    required: false\n  }, {\n    id: 'sameAddress',\n    type: 'radioInput',\n    intlValues: {\n      name: borrowers[0].firstName || 'Emprunteur 1'\n    },\n    options: [true, false],\n    condition: multiple && !isFirst\n  }, {\n    id: 'address1',\n    type: 'textInput',\n    disabled: disableAddress,\n    placeholder: disableAddress && borrowers[0].address1,\n    noIntl: disableAddress\n  }, {\n    id: 'address2',\n    type: 'textInput',\n    disabled: !!b.sameAddress && !isFirst,\n    required: false,\n    placeholder: disableAddress && borrowers[0].address2,\n    noIntl: disableAddress\n  }, {\n    id: 'zipCode',\n    type: 'custom',\n    component: 'ZipAutoComplete',\n    componentProps: {\n      savePath: '',\n      initialValue: b.zipCode && b.city ? b.zipCode + \" \" + b.city : ''\n    },\n    disabled: !!b.sameAddress && !isFirst,\n    placeholder: disableAddress && (borrowers[0].zipCode && borrowers[0].city ? borrowers[0].zipCode + \" \" + borrowers[0].city : ''),\n    noIntl: disableAddress\n  }, {\n    type: 'conditionalInput',\n    conditionalTrueValue: false,\n    inputs: [{\n      id: 'isSwiss',\n      type: 'radioInput',\n      options: [true, false]\n    }, {\n      id: 'residencyPermit',\n      type: 'selectFieldInput',\n      options: Object.values(_constants.RESIDENCY_PERMIT)\n    }]\n  }, {\n    id: 'age',\n    type: 'textInput',\n    number: true,\n    saveOnChange: false\n  }, {\n    id: 'birthPlace',\n    type: 'textInput',\n    condition: !!b.isSwiss\n  }, {\n    id: 'citizenship',\n    type: 'textInput',\n    condition: !b.isSwiss\n  }, {\n    id: 'isUSPerson',\n    type: 'radioInput',\n    options: [true, false]\n  }, {\n    id: 'civilStatus',\n    type: 'radioInput',\n    options: Object.values(_constants.CIVIL_STATUS).map(function (value) {\n      return {\n        id: value,\n        intlValues: {\n          gender: b.gender\n        }\n      };\n    })\n  }, {\n    id: 'childrenCount',\n    type: 'textInput',\n    number: true\n  }, {\n    id: 'company',\n    type: 'textInput',\n    required: false,\n    autoComplete: 'organization'\n  }, {\n    id: 'worksForOwnCompany',\n    type: 'radioInput',\n    options: [true, false]\n  }, {\n    id: 'personalBank',\n    type: 'textInput'\n  }];\n};\n\nvar _getBorrowerFinanceArray = function _getBorrowerFinanceArray(_ref2) {\n  var borrowers = _ref2.borrowers,\n      id = _ref2.borrowerId,\n      loan = _ref2.loan;\n  var b = borrowers.find(function (borr) {\n    return borr._id === id;\n  });\n  var multiple = borrowers.length > 1; // If this is the first borrower in the array of borrowers, don't ask for same address\n\n  var isFirst = borrowers[0]._id === id;\n\n  if (!b) {\n    throw new Error(\"couldn't find borrower\");\n  }\n\n  var incomeArray = [{\n    type: 'h3',\n    id: 'incomeAndExpenses',\n    ignore: true,\n    required: false\n  }, {\n    id: 'salary',\n    type: 'textInput',\n    money: true\n  }, {\n    type: 'conditionalInput',\n    conditionalTrueValue: true,\n    inputs: [{\n      id: 'bonusExists',\n      type: 'radioInput',\n      options: [true, false]\n    }].concat(_toConsumableArray([2017, 2016, 2015, 2014].map(function (year) {\n      return {\n        id: \"bonus.bonus\" + year,\n        type: 'textInput',\n        money: true\n      };\n    })))\n  }, {\n    id: 'expenses',\n    type: 'arrayInput',\n    required: false,\n    inputs: [{\n      id: 'description',\n      type: 'selectInput',\n      options: Object.values(_constants.EXPENSES)\n    }, {\n      id: 'value',\n      type: 'textInput',\n      money: true\n    }]\n  }, {\n    id: 'otherIncome',\n    type: 'arrayInput',\n    required: false,\n    inputs: [{\n      id: 'description',\n      type: 'selectInput',\n      options: Object.values(_constants.OTHER_INCOME)\n    }, {\n      id: 'value',\n      type: 'textInput',\n      money: true\n    }]\n  }];\n  var fortuneArray = [{\n    type: 'h3',\n    id: 'fortune',\n    ignore: true,\n    required: false\n  }, {\n    id: 'bankFortune',\n    type: 'textInput',\n    money: true\n  }, {\n    id: 'realEstate',\n    type: 'arrayInput',\n    inputs: [{\n      id: 'description',\n      type: 'selectInput',\n      options: Object.values(_constants.REAL_ESTATE)\n    }, {\n      id: 'value',\n      type: 'textInput',\n      money: true\n    }, {\n      id: 'loan',\n      type: 'textInput',\n      money: true\n    }]\n  }, {\n    id: 'otherFortune',\n    type: 'arrayInput',\n    required: false,\n    inputs: [{\n      id: 'description',\n      type: 'selectInput',\n      options: Object.values(_constants.OTHER_FORTUNE)\n    }, {\n      id: 'value',\n      type: 'textInput',\n      money: true\n    }]\n  }];\n  var insuranceArray = [{\n    type: 'h3',\n    id: 'insurance',\n    required: false,\n    ignore: true\n  }, {\n    id: 'insuranceSecondPillar',\n    type: 'textInput',\n    money: true,\n    required: false\n  }, {\n    id: 'insuranceThirdPillar',\n    type: 'textInput',\n    money: true,\n    required: false\n  }, {\n    id: 'insurance3B',\n    type: 'textInput',\n    money: true,\n    required: false\n  }, {\n    id: 'insurancePureRisk',\n    type: 'textInput',\n    money: true,\n    required: false\n  }];\n  return incomeArray.concat([].concat(fortuneArray, insuranceArray));\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"PropertyFormArray.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/arrays/PropertyFormArray.js                                                                            //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getPropertyLoanArray = undefined;\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.export({\n  getPropertyLoanArray: function getPropertyLoanArray() {\n    return _getPropertyLoanArray;\n  },\n  getPropertyArray: function getPropertyArray() {\n    return _getPropertyArray;\n  }\n});\n\nvar _PROPERTY_STYLE = void 0,\n    _PURCHASE_TYPE = void 0,\n    _OWNER = void 0,\n    _USAGE_TYPE = void 0,\n    _EXPERTISE_RATING = void 0;\n\nmodule.watch(require(\"../api/constants\"), {\n  PROPERTY_STYLE: function PROPERTY_STYLE(v) {\n    _PROPERTY_STYLE = v;\n  },\n  PURCHASE_TYPE: function PURCHASE_TYPE(v) {\n    _PURCHASE_TYPE = v;\n  },\n  OWNER: function OWNER(v) {\n    _OWNER = v;\n  },\n  USAGE_TYPE: function USAGE_TYPE(v) {\n    _USAGE_TYPE = v;\n  },\n  EXPERTISE_RATING: function EXPERTISE_RATING(v) {\n    _EXPERTISE_RATING = v;\n  }\n}, 0);\nexports.getPropertyLoanArray = _getPropertyLoanArray;\n\nvar mapInput = function mapInput(input) {\n  var intlSafeObject = (0, _extends3.default)({}, input); // If the id contains a dot in it, split it and add a intlId\n  // This makes it easier to write intl messages\n\n  if (input.id && input.id.indexOf('.') > 0) {\n    // Perform some additional slicing to make sure ids with multiple dots\n    // work by removing only the first part\n    intlSafeObject.intlId = input.id.split('.').slice(1).join('.');\n  }\n\n  if (input.inputs) {\n    // If there are nested inputs, give them an intlId too\n    intlSafeObject.inputs = input.inputs.map(function (obj) {\n      return obj.id && obj.id.indexOf('.') > 0 ? (0, _extends3.default)({}, obj, {\n        intlId: obj.id.split('.')[1]\n      }) : obj;\n    });\n  }\n\n  return intlSafeObject;\n};\n\nvar _getPropertyLoanArray = function _getPropertyLoanArray(_ref) {\n  var loan = _ref.loan,\n      borrowers = _ref.borrowers;\n  var r = loan;\n\n  if (!r) {\n    throw new Error('requires a loan');\n  }\n\n  var array = [{\n    type: 'h3',\n    id: 'propertyInfo',\n    ignore: true,\n    required: false\n  }, {\n    id: 'general.usageType',\n    type: 'radioInput',\n    options: Object.values(_USAGE_TYPE)\n  }, {\n    id: 'general.propertyWork',\n    type: 'textInput',\n    money: true,\n    required: false\n  }, {\n    type: 'conditionalInput',\n    conditionalTrueValue: _OWNER.OTHER,\n    condition: borrowers.length > 1 && r.general.purchaseType === _PURCHASE_TYPE.REFINANCING,\n    inputs: [{\n      id: 'general.currentOwner',\n      type: 'radioInput',\n      options: Object.values(_OWNER).filter(function (value) {\n        return borrowers.length === 1 ? value !== _OWNER.SECOND : true;\n      }).map(function (value) {\n        var isFirst = value === _OWNER.FIRST;\n        var isSecond = value === _OWNER.SECOND;\n        return isFirst || isSecond ? {\n          id: isFirst ? 0 : 1,\n          intlValues: {\n            name: borrowers[isFirst ? 0 : 1].firstName || \"Emprunteur \" + (isFirst ? 1 : 2)\n          }\n        } : value;\n      })\n    }, {\n      id: 'general.otherOwner',\n      type: 'textInput'\n    }]\n  }, {\n    type: 'conditionalInput',\n    conditionalTrueValue: _OWNER.OTHER,\n    condition: borrowers.length > 1 && r.general.purchaseType !== _PURCHASE_TYPE.REFINANCING,\n    inputs: [{\n      id: 'general.futureOwner',\n      type: 'radioInput',\n      options: Object.values(_OWNER).filter(function (value) {\n        return borrowers.length === 1 ? value !== _OWNER.SECOND : true;\n      }).map(function (value) {\n        var isFirst = value === _OWNER.FIRST;\n        var isSecond = value === _OWNER.SECOND;\n        return isFirst || isSecond ? {\n          id: isFirst ? 0 : 1,\n          intlValues: {\n            name: borrowers[isFirst ? 0 : 1].firstName || \"Emprunteur \" + (isFirst ? 1 : 2)\n          }\n        } : value;\n      })\n    }, {\n      id: 'general.otherOwner',\n      type: 'textInput'\n    }]\n  }];\n  return array.map(mapInput);\n};\n\nvar _getPropertyArray = function _getPropertyArray(_ref2) {\n  var loan = _ref2.loan,\n      borrowers = _ref2.borrowers,\n      property = _ref2.property;\n  var r = loan;\n\n  if (!r) {\n    throw new Error('requires a loan');\n  }\n\n  var array = [{\n    id: 'value',\n    type: 'textInput',\n    money: true\n  }, {\n    id: 'style',\n    type: 'radioInput',\n    options: Object.values(_PROPERTY_STYLE)\n  }, {\n    id: 'isNew',\n    type: 'radioInput',\n    options: [true, false],\n    condition: r.general.purchaseType === _PURCHASE_TYPE.ACQUISITION\n  }, {\n    type: 'h3',\n    id: 'propertyAddress',\n    ignore: true,\n    required: false\n  }, {\n    id: 'address1',\n    type: 'textInput'\n  }, {\n    id: 'address2',\n    type: 'textInput',\n    required: false\n  }, {\n    id: 'zipCode',\n    type: 'custom',\n    component: 'ZipAutoComplete',\n    componentProps: {\n      savePath: '',\n      initialValue: property.zipCode && property.city ? property.zipCode + \" \" + property.city : ''\n    }\n  }, {\n    type: 'h3',\n    id: 'propertyDetails',\n    ignore: true,\n    required: false\n  }, {\n    id: 'constructionYear',\n    type: 'textInput',\n    number: true\n  }, {\n    id: 'renovationYear',\n    type: 'textInput',\n    number: true,\n    required: false,\n    info: true\n  }, {\n    id: 'landArea',\n    type: 'textInput',\n    number: true,\n    condition: property.style === _PROPERTY_STYLE.VILLA\n  }, {\n    id: 'insideArea',\n    type: 'textInput',\n    number: true\n  }, {\n    id: 'balconyArea',\n    type: 'textInput',\n    number: true,\n    required: false\n  }, {\n    id: 'terraceArea',\n    type: 'textInput',\n    number: true,\n    required: false\n  }, {\n    id: 'volume',\n    type: 'textInput',\n    number: true,\n    condition: property.style === _PROPERTY_STYLE.VILLA\n  }, {\n    id: 'volumeNorm',\n    type: 'textInput',\n    condition: property.style === _PROPERTY_STYLE.VILLA\n  }, {\n    id: 'roomCount',\n    type: 'textInput',\n    decimal: true,\n    info: true\n  }, {\n    id: 'bathroomCount',\n    type: 'textInput',\n    number: true,\n    info: true\n  }, {\n    id: 'toiletCount',\n    type: 'textInput',\n    number: true\n  }, {\n    id: 'parking.box',\n    type: 'textInput',\n    number: true\n  }, {\n    id: 'parking.inside',\n    type: 'textInput',\n    number: true\n  }, {\n    id: 'parking.outside',\n    type: 'textInput',\n    number: true\n  }, {\n    id: 'minergie',\n    type: 'radioInput',\n    options: [true, false]\n  }, {\n    type: 'conditionalInput',\n    conditionalTrueValue: true,\n    condition: property.style === _PROPERTY_STYLE.VILLA,\n    inputs: [{\n      id: 'isCoproperty',\n      type: 'radioInput',\n      options: [true, false]\n    }, {\n      id: 'copropertyPercentage',\n      type: 'textInput',\n      number: true,\n      info: true\n    }]\n  }, {\n    id: 'copropertyPercentage',\n    type: 'textInput',\n    number: true,\n    condition: property.style === _PROPERTY_STYLE.FLAT,\n    info: true\n  }, {\n    type: 'h3',\n    id: 'propertyQuality',\n    ignore: true,\n    required: false\n  }, {\n    id: 'cityPlacementQuality',\n    type: 'radioInput',\n    options: Object.values(_EXPERTISE_RATING)\n  }, {\n    id: 'buildingPlacementQuality',\n    type: 'radioInput',\n    options: Object.values(_EXPERTISE_RATING),\n    condition: property.style === _PROPERTY_STYLE.FLAT\n  }, {\n    id: 'buildingQuality',\n    type: 'radioInput',\n    options: Object.values(_EXPERTISE_RATING)\n  }, {\n    id: 'flatQuality',\n    type: 'radioInput',\n    options: Object.values(_EXPERTISE_RATING),\n    condition: property.style === _PROPERTY_STYLE.FLAT\n  }, {\n    id: 'materialsQuality',\n    type: 'radioInput',\n    options: Object.values(_EXPERTISE_RATING)\n  }, {\n    id: 'otherNotes',\n    type: 'textInput',\n    multiline: true,\n    rows: 3,\n    required: false\n  }];\n  return array.map(mapInput);\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"steps.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/arrays/steps.js                                                                                        //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nmodule.export({\n  previousDone: function previousDone() {\n    return _previousDone;\n  },\n  getPercent: function getPercent() {\n    return _getPercent;\n  },\n  shouldCountField: function shouldCountField() {\n    return _shouldCountField;\n  },\n  getCountedArray: function getCountedArray() {\n    return _getCountedArray;\n  },\n  personalInfoPercent: function personalInfoPercent() {\n    return _personalInfoPercent;\n  },\n  propertyPercent: function propertyPercent() {\n    return _propertyPercent;\n  },\n  auctionFilesPercent: function auctionFilesPercent() {\n    return _auctionFilesPercent;\n  },\n  filesPercent: function filesPercent() {\n    return _filesPercent;\n  },\n  getAllFilesPercent: function getAllFilesPercent() {\n    return _getAllFilesPercent;\n  },\n  closingPercent: function closingPercent() {\n    return _closingPercent;\n  }\n});\nvar React = void 0;\nmodule.watch(require(\"react\"), {\n  default: function _default(v) {\n    React = v;\n  }\n}, 0);\nvar get = void 0;\nmodule.watch(require(\"lodash/get\"), {\n  default: function _default(v) {\n    get = v;\n  }\n}, 1);\nvar isArray = void 0;\nmodule.watch(require(\"lodash/isArray\"), {\n  default: function _default(v) {\n    isArray = v;\n  }\n}, 2);\n\nvar _getBorrowerInfoArray = void 0;\n\nmodule.watch(require(\"./BorrowerFormArray\"), {\n  getBorrowerInfoArray: function getBorrowerInfoArray(v) {\n    _getBorrowerInfoArray = v;\n  }\n}, 3);\n\nvar _borrowerFiles = void 0,\n    _loanFiles = void 0,\n    _propertyFiles = void 0;\n\nmodule.watch(require(\"../api/files/files\"), {\n  borrowerFiles: function borrowerFiles(v) {\n    _borrowerFiles = v;\n  },\n  loanFiles: function loanFiles(v) {\n    _loanFiles = v;\n  },\n  propertyFiles: function propertyFiles(v) {\n    _propertyFiles = v;\n  }\n}, 4);\n\nvar _getPropertyArray = void 0,\n    _getPropertyLoanArray = void 0;\n\nmodule.watch(require(\"./PropertyFormArray\"), {\n  getPropertyArray: function getPropertyArray(v) {\n    _getPropertyArray = v;\n  },\n  getPropertyLoanArray: function getPropertyLoanArray(v) {\n    _getPropertyLoanArray = v;\n  }\n}, 5);\n\nvar _strategyDone = void 0,\n    _getPropertyCompletion = void 0;\n\nexports.previousDone = _previousDone;\nmodule.watch(require(\"../utils/loanFunctions\"), {\n  strategyDone: function strategyDone(v) {\n    _strategyDone = v;\n  },\n  getPropertyCompletion: function getPropertyCompletion(v) {\n    _getPropertyCompletion = v;\n  }\n}, 6);\n\nvar _arrayify = void 0;\n\nmodule.watch(require(\"../utils/general\"), {\n  arrayify: function arrayify(v) {\n    _arrayify = v;\n  }\n}, 7);\n\nvar _isDemo = void 0;\n\nmodule.watch(require(\"../utils/browserFunctions\"), {\n  isDemo: function isDemo(v) {\n    _isDemo = v;\n  }\n}, 8);\n\nvar _LOAN_STATUS = void 0,\n    _AUCTION_STATUS = void 0,\n    _FILE_STATUS = void 0,\n    _CLOSING_STEPS_STATUS = void 0,\n    _CLOSING_STEPS_TYPE = void 0;\n\nmodule.watch(require(\"../api/constants\"), {\n  LOAN_STATUS: function LOAN_STATUS(v) {\n    _LOAN_STATUS = v;\n  },\n  AUCTION_STATUS: function AUCTION_STATUS(v) {\n    _AUCTION_STATUS = v;\n  },\n  FILE_STATUS: function FILE_STATUS(v) {\n    _FILE_STATUS = v;\n  },\n  CLOSING_STEPS_STATUS: function CLOSING_STEPS_STATUS(v) {\n    _CLOSING_STEPS_STATUS = v;\n  },\n  CLOSING_STEPS_TYPE: function CLOSING_STEPS_TYPE(v) {\n    _CLOSING_STEPS_TYPE = v;\n  }\n}, 9);\n\nvar getSteps = function getSteps(props) {\n  var loan = props.loan,\n      borrowers = props.borrowers,\n      property = props.property,\n      serverTime = props.serverTime;\n  var steps = [{\n    nb: 0,\n    items: []\n  }, {\n    nb: 1,\n    items: [{\n      id: 'personal',\n      link: \"/loans/\" + loan._id + \"/borrowers/\" + borrowers[0]._id + \"/personal\",\n      percent: function percent() {\n        return _personalInfoPercent(borrowers);\n      },\n      isDone: function isDone() {\n        return this.percent() >= 1;\n      }\n    }, {\n      id: 'finance',\n      link: \"/loans/\" + loan._id + \"/borrowers/\" + borrowers[0]._id + \"/finance\",\n      isDone: function isDone() {\n        return borrowers.reduce(function (res, b) {\n          return res && b.logic.hasValidatedFinances;\n        }, true);\n      },\n      percent: function percent() {\n        return borrowers.reduce(function (res, b) {\n          return b.logic.hasValidatedFinances ? res + 1 : res;\n        }, 0) / borrowers.length;\n      }\n    }, {\n      id: 'files',\n      link: \"/loans/\" + loan._id + \"/borrowers/\" + borrowers[0]._id + \"/files\",\n      percent: function percent() {\n        return _filesPercent(borrowers, _borrowerFiles, 'auction');\n      },\n      isDone: function isDone() {\n        return this.percent() >= 1;\n      }\n    }, {\n      id: 'property',\n      link: \"/loans/\" + loan._id + \"/property\",\n      percent: function percent() {\n        return _getPropertyCompletion(props);\n      },\n      isDone: function isDone() {\n        return this.percent() >= 1;\n      }\n    }, {\n      id: 'verification',\n      link: \"/loans/\" + loan._id + \"/verification\",\n      waiting: function waiting() {\n        return loan.logic.verification.requested && !loan.logic.verification.validated;\n      },\n      isDone: function isDone() {\n        return loan.logic.verification.validated === true;\n      }\n    }]\n  }, {\n    nb: 2,\n    items: [{\n      id: 'structure',\n      link: \"/loans/\" + loan._id + \"/structure\",\n      isDone: function isDone() {\n        return loan.logic.hasValidatedStructure;\n      },\n      disabled: loan.logic.step < 2\n    }, {\n      id: 'auction',\n      link: \"/loans/\" + loan._id + \"/auction\",\n      waiting: function waiting() {\n        return loan.logic.auction.status === _AUCTION_STATUS.STARTED;\n      },\n      isDone: function isDone() {\n        return loan.logic.auction.status === _AUCTION_STATUS.ENDED;\n      },\n      disabled: loan.logic.step < 2\n    }, {\n      id: 'strategy',\n      link: \"/loans/\" + loan._id + \"/strategy\",\n      isDone: function isDone() {\n        return _strategyDone({\n          loan: loan\n        });\n      }\n    }, {\n      id: 'offerPicker',\n      link: \"/loans/\" + loan._id + \"/offerpicker\",\n      isDone: function isDone() {\n        return !!(loan.logic.lender && loan.logic.lender.offerId);\n      }\n    }]\n  }, {\n    nb: 3,\n    items: [{\n      id: 'contract',\n      link: \"/loans/\" + loan._id + \"/contract\",\n      disabled: loan.logic.step < 3 && !(loan.logic.lender && loan.logic.lender.offerId),\n      percent: function percent() {\n        return _getAllFilesPercent({\n          loan: loan,\n          borrowers: borrowers,\n          property: property\n        }, 'contract');\n      },\n      waiting: function waiting() {\n        return loan.logic.lender.contractRequested && !loan.logic.lender.contract;\n      },\n      isDone: function isDone() {\n        return loan.files.contract && loan.files.contract.length;\n      }\n    }, {\n      id: 'closing',\n      link: \"/loans/\" + loan._id + \"/closing\",\n      // FIXME: true && value used because of weird linting...\n      disabled: (true && _getAllFilesPercent({\n        loan: loan,\n        borrowers: borrowers,\n        property: property\n      }, 'contract')) < 1 || loan.logic.step < 3,\n      percent: function percent() {\n        return _closingPercent(loan);\n      },\n      isDone: function isDone() {\n        return loan.status === _LOAN_STATUS.DONE;\n      }\n    }]\n  }, {\n    nb: 4,\n    title: React.createElement(\"span\", {\n      className: \"fa fa-home fa-2x\",\n      style: {\n        color: '#ADB5BD',\n        paddingLeft: 8\n      }\n    }),\n    disabled: true,\n    // TODO\n    subtitle: null,\n    items: []\n  }]; // Make sure these indices correspond\n  // Verify all 3 items before item 4 are done\n\n  steps[1].items[4].disabled = !_previousDone(steps, 1, 4); // Vérification e-Potek\n  // steps[0].items[6].disabled = !previousDone(steps, 0, 6); // Expertise\n\n  steps[2].items[1].disabled = !_previousDone(steps, 2, 1); // Enchères\n\n  steps[2].items[2].disabled = !_previousDone(steps, 2, 2); // Stratégie\n\n  steps[2].items[3].disabled = !_previousDone(steps, 2, 3); // Choix du prêteur\n\n  return steps;\n};\n\nmodule.exportDefault(getSteps);\n\n// Returns the current value of an autoForm input\nvar getCurrentValue = function getCurrentValue(input, doc) {\n  return get(doc, input.id);\n}; /**\n    * previousDone - Checks if all previous subSteps have been finished upto this\n    * item\n    *\n    * @param {array} steps  An array of subSteps/items\n    * @param {number} stepNb The step Number\n    * @param {number} itemNb The number of the item that is concerned\n    *\n    * @return {boolean} Description\n    */\n\nvar _previousDone = function _previousDone(steps, stepNb, itemNb) {\n  if (stepNb >= steps.length) {\n    throw new Error('invalid stepNb');\n  } else if (itemNb >= steps[stepNb].items.length) {\n    throw new Error('invalid itemNb');\n  }\n\n  return steps[stepNb].items.slice(0, itemNb).reduce(function (res, i) {\n    return res && i.isDone();\n  }, true);\n}; /**\n    * getPercent - Given an array of values, any value that is undefined or null\n    * will be counted as incomplete, make sure we don't divide by 0\n    *\n    * @param {array} array Array of numbers, strings, or dates\n    *\n    * @return {number} a value between 0 and 1\n    */\n\nvar _getPercent = function _getPercent() {\n  var array = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var percent = array.reduce(function (tot, val) {\n    if (isArray(val)) {\n      return tot + (val.length ? 1 : 0);\n    } else if (val !== undefined && val !== null) {\n      return tot + 1;\n    }\n\n    return tot;\n  }, 0) / array.length;\n  return isFinite(percent) ? percent : 0;\n};\n\nvar _shouldCountField = function _shouldCountField(f) {\n  return (f.condition === undefined || f.condition === true) && f.required !== false && !f.disabled && f.type !== 'h3';\n};\n\nvar _getCountedArray = function _getCountedArray(formArray, doc) {\n  var arr = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n  formArray.forEach(function (i) {\n    if (_shouldCountField(i)) {\n      if (i.type === 'conditionalInput') {\n        if (getCurrentValue(i.inputs[0], doc) === i.conditionalTrueValue) {\n          // If the conditional input is triggering the next input, add all values\n          i.inputs.forEach(function (input) {\n            return arr.push(getCurrentValue(input, doc));\n          });\n        } else {\n          // If conditional value is not triggering\n          arr.push(getCurrentValue(i.inputs[0], doc));\n        }\n      } else {\n        arr.push(getCurrentValue(i, doc));\n      }\n    }\n  });\n  return arr;\n};\n\nvar _personalInfoPercent = function _personalInfoPercent(borrowers) {\n  var a = [];\n\n  _arrayify(borrowers).forEach(function (b) {\n    var formArray = _getBorrowerInfoArray({\n      borrowers: _arrayify(borrowers),\n      borrowerId: b._id\n    });\n\n    _getCountedArray(formArray, b, a);\n  });\n\n  return _getPercent(a);\n};\n\nvar _propertyPercent = function _propertyPercent(loan, borrowers, property) {\n  var formArray1 = _getPropertyArray({\n    loan: loan,\n    borrowers: borrowers,\n    property: property\n  });\n\n  var formArray2 = _getPropertyLoanArray({\n    loan: loan,\n    borrowers: borrowers,\n    property: property\n  });\n\n  var a = _getCountedArray(formArray1, property);\n\n  a = [].concat(_toConsumableArray(a), [_getCountedArray(formArray2, loan)]);\n  return _getPercent(a);\n};\n\nvar _auctionFilesPercent = function _auctionFilesPercent(borrowers) {\n  var a = [];\n\n  _arrayify(borrowers).forEach(function (b) {\n    var fileArray = _borrowerFiles(b).auction;\n\n    if (_isDemo()) {\n      a.push(b.files[fileArray[0].id]);\n    } else {\n      fileArray.forEach(function (f) {\n        return f.condition !== false && a.push(b.files[f.id]);\n      });\n    }\n  });\n\n  return _getPercent(a);\n};\n\nvar _filesPercent = function _filesPercent(doc, fileArrayFunc, step, checkValidity) {\n  var a = [];\n\n  var iterate = function iterate(files, doc2) {\n    if (!doc2 || !doc2.files) {\n      return;\n    }\n\n    if (_isDemo()) {\n      a.push(doc2.files[files[0].id]);\n    } else {\n      files.forEach(function (f) {\n        if (!(f.required === false || f.condition === false)) {\n          if (checkValidity) {\n            a.push(isArray(doc2.files[f.id]) && doc2.files[f.id].every(function (file) {\n              return file.status === _FILE_STATUS.VALID;\n            }) ? true : undefined);\n          } else {\n            a.push(doc2.files[f.id]);\n          }\n        }\n      });\n    }\n  };\n\n  if (isArray(doc)) {\n    doc.forEach(function (item) {\n      var fileArray = fileArrayFunc(item)[step];\n      iterate(fileArray, item);\n    });\n  } else {\n    var fileArray = fileArrayFunc(doc)[step];\n    iterate(fileArray, doc);\n  }\n\n  return _getPercent(a);\n};\n\nvar _getAllFilesPercent = function _getAllFilesPercent(_ref, step) {\n  var loan = _ref.loan,\n      borrowers = _ref.borrowers,\n      property = _ref.property;\n  var array = [];\n\n  if (loan) {\n    array.push(_filesPercent(loan, _loanFiles, step));\n  }\n\n  if (borrowers) {\n    array.push(_filesPercent(borrowers, _borrowerFiles, step));\n  }\n\n  if (property) {\n    array.push(_filesPercent(property, _propertyFiles, step));\n  } // Sum and divide by amount of them\n\n\n  return array.reduce(function (a, b) {\n    return a + b;\n  }, 0) / array.length;\n};\n\nvar _closingPercent = function _closingPercent(loan) {\n  var closingSteps = loan.logic.closingSteps;\n  var arr = [];\n  closingSteps.forEach(function (step) {\n    if (step.type === _CLOSING_STEPS_TYPE.TODO) {\n      arr.push(step.status === _CLOSING_STEPS_STATUS.VALID ? true : undefined);\n    } else {\n      arr.push(isArray(loan.files[step.id]) && loan.files[step.id].every(function (file) {\n        return file.status === _CLOSING_STEPS_STATUS.VALID;\n      }) ? true : undefined);\n    }\n  });\n  return _getPercent(arr);\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"components\":{\"Loading.jsx\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/components/Loading.jsx                                                                                 //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  LoadingComponent: function LoadingComponent() {\n    return _LoadingComponent;\n  }\n});\nvar React = void 0;\nexports.LoadingComponent = _LoadingComponent;\nmodule.watch(require(\"react\"), {\n  default: function _default(v) {\n    React = v;\n  }\n}, 0);\n\n// http://codepen.io/TaniaLD/pen/oKxep\nvar _LoadingComponent = function _LoadingComponent() {\n  return (// Fade it in so that the loader doesn't show up if loading is super fast\n    React.createElement(\n      \"div\",\n      {\n        className: \"loading-container animated fadeIn\"\n      },\n      React.createElement(\n        \"div\",\n        {\n          className: \"loading-box\"\n        },\n        React.createElement(\"div\", {\n          className: \"loader2\"\n        })\n      )\n    )\n  );\n};\n\nvar options = {\n  loadingHandler: _LoadingComponent\n};\nmodule.exportDefault(options);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"config\":{\"constants.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/config/constants.js                                                                                    //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  fortuneLimitedProperty: function fortuneLimitedProperty() {\n    return _fortuneLimitedProperty;\n  },\n  incomeLimitedProperty: function incomeLimitedProperty() {\n    return _incomeLimitedProperty;\n  },\n  calculatePrimaryProperty: function calculatePrimaryProperty() {\n    return _calculatePrimaryProperty;\n  }\n});\n\nvar _USAGE_TYPE = void 0;\n\nmodule.watch(require(\"../api/constants\"), {\n  USAGE_TYPE: function USAGE_TYPE(v) {\n    _USAGE_TYPE = v;\n  }\n}, 0);\nexports.fortuneLimitedProperty = _fortuneLimitedProperty;\nvar constants = {\n  cpsLimit: 300,\n  // Average characters typed per second\n  amortization: 0.0125,\n  interests: 0.05,\n  interestsReal: 0.015,\n  maintenance: 0.01,\n  maintenanceReal: 0.005,\n  notaryFees: 0.05,\n  lppFees: 0.1,\n  maxRatio: 0.38,\n  minCash: 0.1,\n  getCurrency: function getCurrency() {\n    return 'CHF';\n  },\n  loanCost: function loanCost(borrowRatio, toRetirement) {\n    return this.interests + this.getAmortization(borrowRatio, toRetirement);\n  },\n  loanCostReal: function loanCostReal(borrowRatio, toRetirement, interestRate) {\n    return (interestRate || this.interestsReal) + this.getAmortization(borrowRatio, toRetirement);\n  },\n  propertyToIncome: function propertyToIncome() {\n    var usageType = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : _USAGE_TYPE.PRIMARY;\n    var borrowRatio = arguments[1];\n    var toRetirement = arguments[2];\n    return 3 * (this.maintenance + this.maxLoan(usageType, toRetirement) * this.loanCost(borrowRatio, toRetirement));\n  },\n  propertyToIncomeReal: function propertyToIncomeReal() {\n    var usageType = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : _USAGE_TYPE.PRIMARY;\n    var borrowRatio = arguments[1];\n    var toRetirement = arguments[2];\n    return 3 * (this.maintenanceReal + this.maxLoan(usageType, toRetirement) * this.loanCostReal(borrowRatio, toRetirement));\n  },\n  maxProperty: function maxProperty(income, fortune) {\n    var insuranceFortune = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    var usageType = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : _USAGE_TYPE.PRIMARY;\n    var toRetirement = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 15;\n    var r = toRetirement; // Make sure toRetirement is capped between 0 and 15 years\n\n    if (toRetirement < 0) {\n      r = 0;\n    } else if (toRetirement > 15) {\n      r = 15;\n    }\n\n    var fortuneLimited = _fortuneLimitedProperty(income, fortune, insuranceFortune, usageType, r);\n\n    var incomeLimited = _incomeLimitedProperty(income, fortune, insuranceFortune, usageType, r); // Use floor to make sure the ratios are respected and avoid edge cases\n\n\n    return Math.round(Math.min(fortuneLimited, incomeLimited));\n  },\n  maxLoan: function maxLoan() {\n    var usageType = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : _USAGE_TYPE.PRIMARY;\n    var toRetirement = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 15;\n\n    if (toRetirement <= 0) {\n      return 0.65;\n    }\n\n    if (usageType === _USAGE_TYPE.SECONDARY) {\n      return 0.7;\n    }\n\n    return 0.8;\n  },\n  getAmortization: function getAmortization() {\n    var borrowRatio = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0.8;\n    var toRetirement = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 15;\n\n    if (borrowRatio > 0.65) {\n      var toAmortize = borrowRatio - 0.65;\n\n      if (toRetirement > 15) {\n        // use parseFloat, to round to 15 decimals, which is the maximal guaranteed precision of floating pt. numbers\n        return Math.max(parseFloat(toAmortize / borrowRatio / 15).toPrecision(15));\n      } else if (toRetirement >= 0) {\n        // use parseFloat, to round to 15 decimals, which is the maximal guaranteed precision of floating pt. numbers\n        return Math.max(parseFloat(toAmortize / borrowRatio / toRetirement).toPrecision(15));\n      }\n\n      return parseFloat(toAmortize / borrowRatio).toPrecision(15);\n    }\n\n    return 0;\n  }\n};\n\nvar _fortuneLimitedProperty = function _fortuneLimitedProperty(income, fortune) {\n  var insuranceFortune = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  var usageType = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : _USAGE_TYPE.PRIMARY;\n  var toRetirement = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 15;\n  var fortuneLimited = 0;\n\n  if (usageType === _USAGE_TYPE.PRIMARY) {\n    // Use insuranceFortune to calculate more complicated value which\n    // includes lppFees\n    fortuneLimited = _calculatePrimaryProperty(fortune, insuranceFortune);\n  } else {\n    // Fortune should cover 20% and notary fees\n    fortuneLimited = fortune / (1 - constants.maxLoan(usageType, toRetirement) + 0.05);\n  }\n\n  return fortuneLimited;\n};\n\nvar _incomeLimitedProperty = function _incomeLimitedProperty(income, fortune) {\n  var insuranceFortune = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  var usageType = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : _USAGE_TYPE.PRIMARY;\n  var toRetirement = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 15;\n  // The arithmetic relation to have the cost of the loan be at exactly the max ratio of income\n  // Derive it like this:\n  // maxRatio * salary >= property * maintenance + loan * loanCost\n  // loan = (property + notaryFees + lppFees) - totalFortune\n  // Extract property from this relation\n  var totalFortune = fortune + insuranceFortune;\n  var lppFees = insuranceFortune * constants.lppFees;\n  var nF = constants.notaryFees;\n  var i = constants.interests;\n  var mR = constants.maxRatio;\n  var m = constants.maintenance;\n  var r = toRetirement; // The first one is with 0 amortization\n\n  var incomeLimited1 = (mR * income + (totalFortune - lppFees) * i) / (m + (1 + nF) * i); // The second is with amortization factored in (and it could be negative due to math)\n\n  var incomeLimited2 = ((1 + r * i) * (totalFortune - lppFees) + mR * r * income) / (r * (m + i) + nF * (1 + r * i) + 0.35); // Therefore, take the minimum value of both, which is the most limiting one\n  // Because of the ratios, round this value down\n\n  return Math.floor(Math.min(incomeLimited1, incomeLimited2));\n};\n\nvar _calculatePrimaryProperty = function _calculatePrimaryProperty(fortune, insuranceFortune) {\n  if (fortune <= 0 || insuranceFortune < 0) {\n    return 0;\n  }\n\n  var lppFees = insuranceFortune * constants.lppFees;\n  var notaryFees = constants.notaryFees; // Make sure cash can pay for lppFees, and fortune can cover notaryfees\n\n  var totalFortuneLimitedValue = (fortune - lppFees + insuranceFortune) / (0.2 + notaryFees); // Make sure cash can pay for lppfees and notaryfees\n\n  var cashLimitedValue = (fortune - lppFees) / (0.1 + notaryFees);\n  return Math.max(Math.round(Math.min(cashLimitedValue, totalFortuneLimitedValue)), 0);\n};\n\nmodule.exportDefault(constants);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"fixtures\":{\"borrowers.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/fixtures/borrowers.js                                                                                  //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar BorrowerService = void 0;\nmodule.watch(require(\"../api/borrowers/BorrowerService\"), {\n  default: function _default(v) {\n    BorrowerService = v;\n  }\n}, 0);\n\nvar _RESIDENCY_PERMIT = void 0,\n    _GENDER = void 0,\n    _CIVIL_STATUS = void 0,\n    _OTHER_FORTUNE = void 0,\n    _OTHER_INCOME = void 0,\n    _EXPENSES = void 0,\n    _REAL_ESTATE = void 0;\n\nmodule.watch(require(\"../api/borrowers/borrowerConstants\"), {\n  RESIDENCY_PERMIT: function RESIDENCY_PERMIT(v) {\n    _RESIDENCY_PERMIT = v;\n  },\n  GENDER: function GENDER(v) {\n    _GENDER = v;\n  },\n  CIVIL_STATUS: function CIVIL_STATUS(v) {\n    _CIVIL_STATUS = v;\n  },\n  OTHER_FORTUNE: function OTHER_FORTUNE(v) {\n    _OTHER_FORTUNE = v;\n  },\n  OTHER_INCOME: function OTHER_INCOME(v) {\n    _OTHER_INCOME = v;\n  },\n  EXPENSES: function EXPENSES(v) {\n    _EXPENSES = v;\n  },\n  REAL_ESTATE: function REAL_ESTATE(v) {\n    _REAL_ESTATE = v;\n  }\n}, 1);\n\nvar _fakeFile = void 0;\n\nmodule.watch(require(\"../api/files/files\"), {\n  fakeFile: function fakeFile(v) {\n    _fakeFile = v;\n  }\n}, 2);\nvar firstNames = ['Marie', 'Camille', 'Léa', 'Manon', 'Thomas', 'Nicolas', 'Julien'];\nvar lastNames = ['Arsenault', 'Babel', 'Rochat'];\n\nvar generateSecondBorrowerProbabillity = function generateSecondBorrowerProbabillity() {\n  return Math.random() < 0.8;\n};\n\nvar insertFakeBorrower = function insertFakeBorrower(userId) {\n  var borrower = {\n    firstName: firstNames[Math.floor(Math.random() * firstNames.length)],\n    lastName: lastNames[Math.floor(Math.random() * lastNames.length)],\n    gender: 'F',\n    address1: 'Chemin du Mont 3',\n    zipCode: 1400,\n    city: 'Yverdon-les-Bains',\n    citizenships: 'Suisse, Français',\n    age: 35,\n    birthPlace: 'Lausanne',\n    civilStatus: 'SINGLE',\n    childrenCount: 2,\n    company: 'Deloitte',\n    personalBank: 'BCGE',\n    isSwiss: true,\n    isUSPerson: false,\n    worksForOwnCompany: false,\n    sameAddress: true,\n    salary: 300000,\n    bonusExists: true,\n    bonus: {\n      bonus2014: 12300,\n      bonus2015: 15490,\n      bonus2016: 11140,\n      bonus2017: 13780\n    },\n    otherIncome: [{\n      value: 10000,\n      description: 'PENSION'\n    }, {\n      value: 15000,\n      description: 'RENT'\n    }],\n    expenses: [{\n      value: 3000,\n      description: 'LEASING'\n    }, {\n      value: 4000,\n      description: 'PERSONAL_LOAN'\n    }],\n    realEstate: [{\n      value: 433000,\n      loan: 240000,\n      description: 'PRIMARY'\n    }],\n    bankFortune: 300000,\n    insuranceSecondPillar: 120000,\n    insuranceThirdPillar: 50000,\n    files: {\n      identity: [_fakeFile],\n      taxes: [_fakeFile],\n      salaryCertificate: [_fakeFile],\n      bonus: [_fakeFile],\n      otherIncome: [_fakeFile],\n      expenses: [_fakeFile],\n      nonPursuitExtract: [_fakeFile],\n      lastSalaries: [_fakeFile],\n      currentMortgages: [_fakeFile],\n      bankAssetsChange: [_fakeFile],\n      pensionFundYearlyStatement: [_fakeFile],\n      retirementInsurancePlan: [_fakeFile]\n    },\n    logic: {\n      financeEthics: true,\n      hasValidatedFinances: true\n    }\n  };\n  return BorrowerService.insert({\n    borrower: borrower,\n    userId: userId\n  });\n};\n\nvar createFakeBorrowers = function createFakeBorrowers(userId) {\n  var borrowerIds = [insertFakeBorrower(userId)];\n\n  if (generateSecondBorrowerProbabillity()) {\n    borrowerIds.push(insertFakeBorrower(userId));\n  }\n\n  return borrowerIds;\n};\n\nmodule.exportDefault(createFakeBorrowers);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"config.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/fixtures/config.js                                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  USER_COUNT: function USER_COUNT() {\n    return _USER_COUNT;\n  },\n  ADMIN_COUNT: function ADMIN_COUNT() {\n    return _ADMIN_COUNT;\n  },\n  DEV_COUNT: function DEV_COUNT() {\n    return _DEV_COUNT;\n  },\n  MAX_LOANS_PER_USER: function MAX_LOANS_PER_USER() {\n    return _MAX_LOANS_PER_USER;\n  },\n  STEPS_PER_LOAN: function STEPS_PER_LOAN() {\n    return _STEPS_PER_LOAN;\n  },\n  MAX_OFFERS_PER_LOAN: function MAX_OFFERS_PER_LOAN() {\n    return _MAX_OFFERS_PER_LOAN;\n  },\n  MIN_OFFERS_PER_LOAN: function MIN_OFFERS_PER_LOAN() {\n    return _MIN_OFFERS_PER_LOAN;\n  }\n});\nexports.USER_COUNT = _USER_COUNT;\nvar _USER_COUNT = 10;\nvar _ADMIN_COUNT = 10;\nvar _DEV_COUNT = 5;\nvar _MAX_LOANS_PER_USER = 2;\nvar _STEPS_PER_LOAN = 3;\nvar _MAX_OFFERS_PER_LOAN = 10;\nvar _MIN_OFFERS_PER_LOAN = 5;\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/fixtures/index.js                                                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\nvar createFakeUsers = void 0;\nmodule.watch(require(\"./users\"), {\n  default: function _default(v) {\n    createFakeUsers = v;\n  }\n}, 1);\n\nvar _DEV_COUNT = void 0;\n\nmodule.watch(require(\"./config\"), {\n  DEV_COUNT: function DEV_COUNT(v) {\n    _DEV_COUNT = v;\n  }\n}, 2);\n\n_Meteor.startup(function () {\n  if (_Meteor.users.find({\n    roles: {\n      $in: ['dev']\n    }\n  }).count() === 0) {\n    console.log('creating devs');\n    createFakeUsers(_DEV_COUNT, 'dev');\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"loans.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/fixtures/loans.js                                                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar moment = void 0;\nmodule.watch(require(\"moment\"), {\n  default: function _default(v) {\n    moment = v;\n  }\n}, 0);\nvar LoanService = void 0;\nmodule.watch(require(\"../api/loans/LoanService\"), {\n  default: function _default(v) {\n    LoanService = v;\n  }\n}, 1);\n\nvar _LOAN_STATUS = void 0,\n    _PURCHASE_TYPE = void 0,\n    _CANTONS = void 0,\n    _INTEREST_RATES = void 0,\n    _OWNER = void 0,\n    _AUCTION_STATUS = void 0,\n    _CLOSING_STEPS_TYPE = void 0,\n    _CLOSING_STEPS_STATUS = void 0,\n    _AUCTION_MOST_IMPORTANT = void 0,\n    _INSURANCE_USE_PRESET = void 0,\n    _LOAN_STRATEGY_PRESET = void 0,\n    _AMORTIZATION_STRATEGY_PRESET = void 0,\n    _PAYMENT_SCHEDULES = void 0;\n\nmodule.watch(require(\"../api/loans/loanConstants\"), {\n  LOAN_STATUS: function LOAN_STATUS(v) {\n    _LOAN_STATUS = v;\n  },\n  PURCHASE_TYPE: function PURCHASE_TYPE(v) {\n    _PURCHASE_TYPE = v;\n  },\n  CANTONS: function CANTONS(v) {\n    _CANTONS = v;\n  },\n  INTEREST_RATES: function INTEREST_RATES(v) {\n    _INTEREST_RATES = v;\n  },\n  OWNER: function OWNER(v) {\n    _OWNER = v;\n  },\n  AUCTION_STATUS: function AUCTION_STATUS(v) {\n    _AUCTION_STATUS = v;\n  },\n  CLOSING_STEPS_TYPE: function CLOSING_STEPS_TYPE(v) {\n    _CLOSING_STEPS_TYPE = v;\n  },\n  CLOSING_STEPS_STATUS: function CLOSING_STEPS_STATUS(v) {\n    _CLOSING_STEPS_STATUS = v;\n  },\n  AUCTION_MOST_IMPORTANT: function AUCTION_MOST_IMPORTANT(v) {\n    _AUCTION_MOST_IMPORTANT = v;\n  },\n  INSURANCE_USE_PRESET: function INSURANCE_USE_PRESET(v) {\n    _INSURANCE_USE_PRESET = v;\n  },\n  LOAN_STRATEGY_PRESET: function LOAN_STRATEGY_PRESET(v) {\n    _LOAN_STRATEGY_PRESET = v;\n  },\n  AMORTIZATION_STRATEGY_PRESET: function AMORTIZATION_STRATEGY_PRESET(v) {\n    _AMORTIZATION_STRATEGY_PRESET = v;\n  },\n  PAYMENT_SCHEDULES: function PAYMENT_SCHEDULES(v) {\n    _PAYMENT_SCHEDULES = v;\n  }\n}, 2);\n\nvar _fakeFile = void 0;\n\nmodule.watch(require(\"../api/files/files\"), {\n  fakeFile: function fakeFile(v) {\n    _fakeFile = v;\n  }\n}, 3);\n\nvar _STEPS_PER_LOAN = void 0;\n\nmodule.watch(require(\"./config\"), {\n  STEPS_PER_LOAN: function STEPS_PER_LOAN(v) {\n    _STEPS_PER_LOAN = v;\n  }\n}, 4);\nvar createFakeBorrowers = void 0;\nmodule.watch(require(\"./borrowers\"), {\n  default: function _default(v) {\n    createFakeBorrowers = v;\n  }\n}, 5);\nvar createFakeProperty = void 0;\nmodule.watch(require(\"./properties\"), {\n  default: function _default(v) {\n    createFakeProperty = v;\n  }\n}, 6);\nvar purchaseTypes = Object.values(_PURCHASE_TYPE);\n\nvar generateRandomNumber = function generateRandomNumber(maxSteps) {\n  return Math.floor(Math.random() * maxSteps + 1);\n};\n\nvar fakeGeneral = {\n  purchaseType: purchaseTypes[Math.floor(Math.random() * purchaseTypes.length)],\n  fortuneUsed: 250000,\n  insuranceFortuneUsed: 100000,\n  wantedClosingDate: moment().add(15, 'd').toDate()\n};\nvar logic1 = {};\nvar logic2 = {\n  step: 2,\n  verification: {\n    requested: false,\n    validated: true,\n    comments: []\n  },\n  auction: {}\n};\nvar logic3 = {\n  step: 3,\n  verification: {\n    requested: false,\n    validated: true,\n    comments: []\n  },\n  // auctionStarted: true,\n  auction: {\n    status: 'ENDED',\n    startTime: new Date(),\n    endTime: new Date()\n  },\n  // auctionEndTime: new Date(),\n  hasValidatedStructure: true,\n  insuranceUsePreset: 'WITHDRAWAL',\n  loanStrategyPreset: 'FIXED',\n  amortizationStrategyPreset: 'INDIRECT',\n  lender: {},\n  closingSteps: [{\n    id: 'upload0',\n    title: 'Contrat de prêt signé',\n    type: 'UPLOAD'\n  }, {\n    id: 'todo0',\n    title: 'Ouverture de compte chez votre prêteur',\n    description: 'Il faut ouvrir un compte bancaire chez votre prêteur où les fonds de votre hypothèque résideront.',\n    type: 'TODO',\n    status: 'VALID'\n  }, {\n    id: 'todo1',\n    title: 'Versement des fonds propres',\n    description: 'Vous devez aller chez le notaire et verser les fonds propres nécessaires sur un compte escrow.',\n    type: 'TODO',\n    status: 'UNVERIFIED'\n  }, {\n    id: 'todo2',\n    title: 'Engagement du notaire relative aux cédules hypothécaires',\n    description: '',\n    type: 'TODO',\n    status: 'ERROR',\n    error: 'Le notaire doit vous convier à un 2ème rendez-vous'\n  }]\n};\nvar fakeFiles = {\n  plans: [_fakeFile],\n  cubage: [_fakeFile],\n  pictures: [_fakeFile],\n  buyersContract: [_fakeFile],\n  landRegisterExtract: [_fakeFile],\n  coownershipAllocationAgreement: [_fakeFile],\n  coownershipAgreement: [_fakeFile],\n  upload0: [_fakeFile]\n};\nvar fakeFiles2 = {\n  plans: [_fakeFile],\n  cubage: [_fakeFile],\n  pictures: [_fakeFile] // buyersContract: [fakeFile],\n  // landRegisterExtract: [fakeFile],\n  // marketingBrochure: [fakeFile],\n  // coownershipAllocationAgreement: [fakeFile],\n  // coownershipAgreement: [fakeFile],\n\n};\n\nvar createFakeLoans = function createFakeLoans(userId) {\n  var completeFiles = Math.random() > 0.5;\n  var borrowerIds = createFakeBorrowers(userId);\n  var propertyId = createFakeProperty(userId);\n  var loan = {\n    name: \"Rue du Test \" + Math.floor(Math.random()),\n    borrowerIds: borrowerIds,\n    propertyId: propertyId,\n    general: fakeGeneral,\n    files: fakeFiles\n  };\n\n  switch (generateRandomNumber(_STEPS_PER_LOAN)) {\n    case 3:\n      loan.logic = logic3;\n      loan.files = completeFiles ? fakeFiles : fakeFiles2;\n      loan.loanTranches = [{\n        value: 750000,\n        type: 'interest10' // TODO add tranches here\n\n      }];\n      break;\n\n    case 2:\n      loan.logic = logic2;\n      break;\n\n    default:\n      loan.logic = logic1;\n  }\n\n  return LoanService.insert({\n    loan: loan,\n    userId: userId\n  });\n};\n\nmodule.exportDefault(createFakeLoans);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"methods.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/fixtures/methods.js                                                                                    //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _check = void 0;\n\nmodule.watch(require(\"meteor/check\"), {\n  check: function check(v) {\n    _check = v;\n  }\n}, 1);\n\nvar _Borrowers = void 0,\n    _Loans = void 0,\n    _Offers = void 0,\n    _Properties = void 0,\n    _Tasks = void 0,\n    _Users = void 0,\n    _SecurityService = void 0;\n\nmodule.watch(require(\"../api\"), {\n  Borrowers: function Borrowers(v) {\n    _Borrowers = v;\n  },\n  Loans: function Loans(v) {\n    _Loans = v;\n  },\n  Offers: function Offers(v) {\n    _Offers = v;\n  },\n  Properties: function Properties(v) {\n    _Properties = v;\n  },\n  Tasks: function Tasks(v) {\n    _Tasks = v;\n  },\n  Users: function Users(v) {\n    _Users = v;\n  },\n  SecurityService: function SecurityService(v) {\n    _SecurityService = v;\n  }\n}, 2);\nvar UserService = void 0;\nmodule.watch(require(\"../api/users/UserService\"), {\n  default: function _default(v) {\n    UserService = v;\n  }\n}, 3);\n\nvar _USER_COUNT = void 0,\n    _ADMIN_COUNT = void 0,\n    _MAX_LOANS_PER_USER = void 0;\n\nmodule.watch(require(\"./config\"), {\n  USER_COUNT: function USER_COUNT(v) {\n    _USER_COUNT = v;\n  },\n  ADMIN_COUNT: function ADMIN_COUNT(v) {\n    _ADMIN_COUNT = v;\n  },\n  MAX_LOANS_PER_USER: function MAX_LOANS_PER_USER(v) {\n    _MAX_LOANS_PER_USER = v;\n  }\n}, 4);\nvar createFakeLoan = void 0;\nmodule.watch(require(\"./loans\"), {\n  default: function _default(v) {\n    createFakeLoan = v;\n  }\n}, 5);\nvar createFakeTask = void 0;\nmodule.watch(require(\"./tasks\"), {\n  default: function _default(v) {\n    createFakeTask = v;\n  }\n}, 6);\nvar createFakeUsers = void 0;\nmodule.watch(require(\"./users\"), {\n  default: function _default(v) {\n    createFakeUsers = v;\n  }\n}, 7);\nvar createFakeOffer = void 0;\nmodule.watch(require(\"./offers\"), {\n  default: function _default(v) {\n    createFakeOffer = v;\n  }\n}, 8);\n\nvar generateNumberOfLoans = function generateNumberOfLoans(max) {\n  return Math.floor(Math.random() * max + 1);\n};\n\nvar getAdmins = function getAdmins() {\n  var admins = _Users.find({\n    roles: {\n      $in: ['admin']\n    }\n  }).fetch();\n\n  if (admins.length === 0) {\n    var newAdmins = createFakeUsers(_ADMIN_COUNT, 'admin');\n    return newAdmins;\n  }\n\n  return admins.map(function (admin) {\n    return admin._id;\n  });\n};\n\n_Meteor.methods({\n  generateTestData: function generateTestData() {\n    if (_SecurityService.currentUserHasRole('dev') && !_Meteor.isProduction) {\n      var admins = getAdmins();\n      var newUsers = createFakeUsers(_USER_COUNT, 'user');\n      newUsers.map(function (userId) {\n        var adminId = admins[Math.floor(Math.random() * admins.length)];\n        UserService.assignAdminToUser({\n          userId: userId,\n          adminId: adminId\n        });\n        var numberOfLoans = generateNumberOfLoans(_MAX_LOANS_PER_USER);\n\n        for (var i = 0; i < numberOfLoans; i += 1) {\n          var loanId = createFakeLoan(userId, adminId);\n          createFakeTask(loanId, adminId);\n          createFakeOffer(loanId, userId);\n        }\n\n        return userId;\n      });\n    }\n  },\n  purgeDatabase: function purgeDatabase(currentUserId) {\n    _check(currentUserId, String);\n\n    if (_SecurityService.currentUserHasRole('dev') && !_Meteor.isProduction) {\n      _Borrowers.remove({});\n\n      _Loans.remove({});\n\n      _Offers.remove({});\n\n      _Properties.remove({});\n\n      _Tasks.remove({});\n\n      _Users.remove({\n        _id: {\n          $ne: currentUserId\n        }\n      });\n    }\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"offers.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/fixtures/offers.js                                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar OfferService = void 0;\nmodule.watch(require(\"../api/offers/OfferService\"), {\n  default: function _default(v) {\n    OfferService = v;\n  }\n}, 0);\n\nvar _getRandomOffer = void 0;\n\nmodule.watch(require(\"../api/offers/fakes\"), {\n  getRandomOffer: function getRandomOffer(v) {\n    _getRandomOffer = v;\n  }\n}, 1);\n\nvar _Loans = void 0,\n    _Properties = void 0;\n\nmodule.watch(require(\"../api\"), {\n  Loans: function Loans(v) {\n    _Loans = v;\n  },\n  Properties: function Properties(v) {\n    _Properties = v;\n  }\n}, 2);\n\nvar createFakeOffers = function createFakeOffers(loanId, userId) {\n  var loan = _Loans.findOne(loanId);\n\n  var property = _Properties.findOne(loan.propertyId);\n\n  var offer = _getRandomOffer({\n    loan: (0, _extends3.default)({}, loan, {\n      _id: loan._id\n    }),\n    property: property\n  }, true);\n\n  return OfferService.insertAdminOffer({\n    offer: offer,\n    loan: loan,\n    userId: userId\n  });\n};\n\nmodule.exportDefault(createFakeOffers);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"properties.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/fixtures/properties.js                                                                                 //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar PropertyService = void 0;\nmodule.watch(require(\"../api/properties/PropertyService\"), {\n  default: function _default(v) {\n    PropertyService = v;\n  }\n}, 0);\n\nvar _PROPERTY_STATUS = void 0,\n    _USAGE_TYPE = void 0,\n    _PROPERTY_STYLE = void 0,\n    _VOLUME_NORM = void 0;\n\nmodule.watch(require(\"../api/properties/propertyConstants\"), {\n  PROPERTY_STATUS: function PROPERTY_STATUS(v) {\n    _PROPERTY_STATUS = v;\n  },\n  USAGE_TYPE: function USAGE_TYPE(v) {\n    _USAGE_TYPE = v;\n  },\n  PROPERTY_STYLE: function PROPERTY_STYLE(v) {\n    _PROPERTY_STYLE = v;\n  },\n  VOLUME_NORM: function VOLUME_NORM(v) {\n    _VOLUME_NORM = v;\n  }\n}, 1);\n\nvar _fakeFile = void 0;\n\nmodule.watch(require(\"../api/files/files\"), {\n  fakeFile: function fakeFile(v) {\n    _fakeFile = v;\n  }\n}, 2);\nvar statuses = Object.values(_PROPERTY_STATUS);\nvar usageTypes = Object.values(_USAGE_TYPE);\nvar styles = Object.values(_PROPERTY_STYLE);\nvar volumeNorms = Object.values(_VOLUME_NORM);\n\nvar createFakeProperties = function createFakeProperties(userId) {\n  var object = {\n    status: statuses[Math.floor(Math.random() * statuses.length)],\n    value: Math.floor(Math.random() * 100000000 + 1),\n    address1: \"Rue du Succ\\xE8s \" + Math.floor(Math.random()),\n    propertyWork: 40000,\n    zipCode: Math.floor(Math.random() * 1000 + 1000),\n    city: 'Lausanne',\n    usageType: usageTypes[Math.floor(Math.random() * usageTypes.length)],\n    style: styles[Math.floor(Math.random() * styles.length)],\n    futureOwner: 0,\n    constructionYear: 2010,\n    landArea: 300,\n    insideArea: 140,\n    volume: 1500,\n    volumeNorm: volumeNorms[Math.floor(Math.random() * volumeNorms.length)],\n    roomCount: 5,\n    bathroomCount: 2,\n    toiletCount: 0,\n    parking: {\n      box: 0,\n      inside: 1,\n      outside: 2\n    },\n    minergie: true,\n    isCoproperty: true,\n    copropertyPercentage: 400,\n    cityPlacementQuality: 2,\n    buildingPlacementQuality: 3,\n    buildingQuality: 1,\n    flatQuality: 2,\n    materialsQuality: 2,\n    files: {\n      plans: [_fakeFile],\n      cubage: [_fakeFile],\n      pictures: [_fakeFile],\n      landRegisterExtract: [_fakeFile]\n    }\n  };\n  return PropertyService.insert({\n    object: object,\n    userId: userId\n  });\n};\n\nmodule.exportDefault(createFakeProperties);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"tasks.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/fixtures/tasks.js                                                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar TaskService = void 0;\nmodule.watch(require(\"../api/tasks/TaskService\"), {\n  default: function _default(v) {\n    TaskService = v;\n  }\n}, 0);\n\nvar _TASK_TYPE = void 0;\n\nmodule.watch(require(\"../api/tasks/tasksConstants\"), {\n  TASK_TYPE: function TASK_TYPE(v) {\n    _TASK_TYPE = v;\n  }\n}, 1);\nvar types = Object.values(_TASK_TYPE);\n\nvar createFakeTasks = function createFakeTasks(loanId, assignedTo) {\n  var type = types[Math.floor(Math.random() * types.length)];\n  return TaskService.insert({\n    type: type,\n    loanId: loanId,\n    assignedTo: assignedTo // createdByUserId: Meteor.userId(),\n\n  });\n};\n\nmodule.exportDefault(createFakeTasks);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"users.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/fixtures/users.js                                                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Accounts = void 0;\n\nmodule.watch(require(\"meteor/accounts-base\"), {\n  Accounts: function Accounts(v) {\n    _Accounts = v;\n  }\n}, 0);\n\nvar _Roles = void 0;\n\nmodule.watch(require(\"meteor/alanning:roles\"), {\n  Roles: function Roles(v) {\n    _Roles = v;\n  }\n}, 1);\nvar EventService = void 0;\nmodule.watch(require(\"../api/events\"), {\n  default: function _default(v) {\n    EventService = v;\n  }\n}, 2);\n\nvar _USER_EVENTS = void 0;\n\nmodule.watch(require(\"../api/users/userConstants\"), {\n  USER_EVENTS: function USER_EVENTS(v) {\n    _USER_EVENTS = v;\n  }\n}, 3);\n\nvar createFakeUsers = function createFakeUsers(count, role) {\n  var insertedUsers = [];\n\n  for (var i = 0; i < count; i += 1) {\n    var userId = _Accounts.createUser({\n      email: role + \"-\" + (i + 1) + \"@epotek.ch\",\n      password: '12345'\n    });\n\n    _Roles.addUsersToRoles(userId, [role]);\n\n    EventService.emit(_USER_EVENTS.USER_CREATED, {\n      userId: userId\n    });\n    insertedUsers.push(userId);\n  }\n\n  return insertedUsers;\n};\n\nmodule.exportDefault(createFakeUsers);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"lang\":{\"fr.json\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/core/lang/fr.json                                                                                           //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.exports = {\n  \"AboutPage.description\": \"e-Potek vous permet de facilement trouver un prêt hypothécaire dans le canton de Genève. Expansion prévue prochainement.{verticalSpace}L'équipe derrière e-Potek est composée d'entrepreneurs expérimentés dans la finance et les prêts hypothécaires en Suisse.\",\n  \"AboutPage.title\": \"Le Prêt Hypothécaire de Demain\",\n  \"AcceptClosingModal.description\": \"Toute l'équipe d'e-Potek vous félicite pour le décaissement de votre prêt hypothécaire, et d'être enfin propriétaire de votre bien immobilier.{verticalSpace}Vous pouvez maintenant utiliser votre tableau de bord e-Potek pour garder un oeil sur votre prochaine échéance de paiement, et consulter les taux lorsque le refinancement s'approchera.\",\n  \"AcceptClosingModal.description2\": \"Merci d'avoir utilisé e-Potek, voici votre code pour nous recommander auprès de vos proches, et empocher jusqu'a CHF 1 000 pour une affaire conclue.\",\n  \"AcceptClosingModal.title\": \"Félicitations!\",\n  \"AccountPage.change\": \"Changer\",\n  \"AccountPage.email\": \"Adresse email\",\n  \"AccountPage.language\": \"Langue\",\n  \"AccountPage.notifications\": \"Recevoir des notifications quand mon dossier avance\",\n  \"AccountPage.notifications.email\": \"Par email\",\n  \"AccountPage.notifications.sms\": \"Par SMS\",\n  \"AccountPage.password\": \"Mot de passe\",\n  \"AccountPage.phone\": \"Téléphone\",\n  \"AccountPage.title\": \"Mon Compte\",\n  \"ActionsTable.actionName\": \"À faire\",\n  \"ActionsTable.comment\": \"Commentaire\",\n  \"ActionsTable.date\": \"Date\",\n  \"ActionsTable.do\": \" \",\n  \"ActionsTable.loanName\": \"Projet\",\n  \"AddLoanPage.logIntoOtherAccount\": \"Utiliser un autre compte\",\n  \"adminAction.addFinalSteps\": \"Transmettre réponse du prêteur\",\n  \"adminAction.auction\": \"Enchères en cours\",\n  \"adminAction.confirmClosing\": \"Confirmer le décaissement\",\n  \"adminAction.lenderChosen\": \"Prêteur a été choisi\",\n  \"adminAction.loanContract\": \"Demander le contrat\",\n  \"adminAction.uploadContract\": \"Uploader le contrat\",\n  \"adminAction.verify\": \"Vérifier dossier\",\n  \"adminAction.verifyFinalSteps\": \"Vérifier les derniers documents\",\n  \"AdvancedOptions.borrowRatio\": \"Endettement voulu\",\n  \"AmortizationChart.amortizationSeries\": \"Amortissement mensuel\",\n  \"AmortizationChart.debtSeries\": \"Dette\",\n  \"AmortizationChart.fortuneSeries\": \"Fonds Propres\",\n  \"AmortizationChart.paymentSeries\": \"Paiement mensuel\",\n  \"AmortizationChart.refinancingFlag\": \"Refinancement\",\n  \"AmortizationChart.title\": \"Les vingt années à venir\",\n  \"AmortizationChart.yAxis1\": \"Dette et fonds propres\",\n  \"AmortizationChart.yAxis2\": \"Paiements mensuels\",\n  \"AmortizationTool.catastrophy.title\": \"Scénario catastrophe\",\n  \"AmortizationTool.futureRate\": \"Refinancement dans 10 ans\",\n  \"AmortizationTool.initialRate\": \"Taux initial à 10 ans\",\n  \"AmortizationTool.lower.title\": \"Baisse des taux\",\n  \"AmortizationTool.rate\": \"Taux à 10 ans: {rate, number, percentage}\",\n  \"AmortizationTool.rise.title\": \"Augmentation des taux\",\n  \"AmortizationTool.stable.title\": \"Taux stables\",\n  \"AmortizingPicker.description\": \"Choisir comment amortir son bien immobilier peut avoir des conséquences très importantes pour votre futur. N'hésitez pas à nous appeler pour prendre cette décision en toute confiance.\",\n  \"AmortizingPicker.title\": \"Stratégie d'amortissement\",\n  \"AmortizingSummary.direct.description\": \"Vous avez choisi l'amortissement direct.\",\n  \"AmortizingSummary.indirect.description\": \"Vous avez choisi l'amortissement indirect.\",\n  \"AppPage.begin\": \"Commencer\",\n  \"AppPage.comparator\": \"Comparateur de propriétés\",\n  \"AppPage.loan\": \"Demande de prêt\",\n  \"AppPage.loan.done\": \"Prêt Hypothécaire\",\n  \"AppPage.newLoan\": \"Nouvelle demande de prêt\",\n  \"AppPage.noName\": \"Sans titre\",\n  \"AppPage.properties\": \"{count, plural, =0 {Pas de propriétés} one {Une propriété} other {# propriétés}}\",\n  \"AppPage.step\": \"{step, plural, one {1ère Étape} other {#ème Étape}}\",\n  \"ArrayInput.add\": \"Ajouter\",\n  \"Auction.notified\": \"Vous recevrez une notification lorsque ce sera terminé\",\n  \"Auction.tableText\": \"Bataille des prêteurs en cours\",\n  \"Auction.title\": \"Enchères en cours..\",\n  \"AuctionResults.countSuffix\": \" Offres reçues\",\n  \"AuctionResults.description\": \"Vos offres sont arrivées, vous pouvez dès à présent choisir votre prêteur.\",\n  \"AuctionResults.title\": \"Résultat des enchères\",\n  \"AuctionStart.cancel\": \"Pas maintenant\",\n  \"AuctionStart.countSuffix\": \" Prêteurs\",\n  \"AuctionStart.CTA\": \"Commencer les enchères\",\n  \"AuctionStart.description\": \"Durant les enchères, les {count} prêteurs vont entrer en compétition sur votre dossier. Ils auront deux fois 24 heures pour miser avec un taux d'intérêt sur votre projet.{verticalSpace}Puis, dans deux jours ouvrables, vous recevrez un tableau avec toutes les offres.\",\n  \"AuctionStart.lenderList\": \"Voir la liste\",\n  \"AuctionStart.title\": \"Lancez les enchères\",\n  \"bert.emailVerificationSent\": \"Vérification envoyée à {email}!\",\n  \"BorrowerAdder.label\": \"+ Ajouter un 2e emprunteur\",\n  \"BorrowerHeader.age\": \"{value} ans\",\n  \"BorrowerHeader.title\": \"Emprunteur {index}\",\n  \"BorrowerPage.files\": \"Documents\",\n  \"BorrowerPage.finance\": \"Finances\",\n  \"BorrowerPage.personal\": \"Perso\",\n  \"BorrowersPage.borrowers\": \"Emprunteurs\",\n  \"BorrowersTable.createdAt\": \"Créé le\",\n  \"BorrowersTable.name\": \"Nom\",\n  \"BorrowersTable.updatedAt\": \"Modifié le\",\n  \"CareersPage.description\": \"Nous ne cherchons pas activement de nouveaux candidats en ce moment. Cependant, nous sommes toujours ouverts aux candidatures spontanées, écris-nous à {email}.\",\n  \"CareersPage.title\": \"Travailler à e-Potek\",\n  \"ClosingPage.CTA\": \"Demander le décaissement\",\n  \"ClosingPage.description\": \"Lorsque vous avez soumis les derniers documents, vous pourrez demander à votre prêteur de décaisser le prêt.\",\n  \"ClosingPage.empty\": \"Nous sommes en train de préparer les dernières étapes pour que vous puissiez décaisser votre prêt hypothécaire. Revenez bientôt!\",\n  \"ClosingPage.loading\": \"Vous serez notifié par e-mail lorsque votre prêteur est disposé au décaissement.\",\n  \"ClosingPage.progress\": \"Progrès: {value, number, percent}\",\n  \"Comparator.createdAt\": \"Créé le\",\n  \"Comparator.empty\": \"Ajoutez une propriété pour commencer\",\n  \"Comparator.incomeRatio\": \"Charges / Revenus\",\n  \"Comparator.isValid\": \"Ça passe ?\",\n  \"Comparator.loan\": \"Prêt Hypothécaire\",\n  \"Comparator.minergy\": \"Minergie\",\n  \"Comparator.monthly\": \"Charges estimées\",\n  \"Comparator.name\": \"Nom\",\n  \"Comparator.nearestBusStation\": \"Bus proche\",\n  \"Comparator.nearestStore\": \"Courses proche\",\n  \"Comparator.nearestTrainStation\": \"Train proche\",\n  \"Comparator.notaryFees\": \"Frais de notaire\",\n  \"Comparator.ownFunds\": \"Fonds propres requis\",\n  \"Comparator.realBorrowRatio\": \"Prêt / Prix d'achat\",\n  \"Comparator.realMonthly\": \"Charges estimées\",\n  \"Comparator.theoreticalMonthly\": \"Charges théoriques FINMA\",\n  \"Comparator.value\": \"Prix d'achat\",\n  \"CompareColumn.boolean.false\": \"Non\",\n  \"CompareColumn.boolean.true\": \"Oui\",\n  \"CompareColumnFooter.hide\": \"Masquer\",\n  \"CompareColumnFooter.show\": \"Options\",\n  \"CompareOptions.addProperty\": \"Ajouter une propriété\",\n  \"CompareOptions.hideAdvanced\": \"Masquer Options\",\n  \"CompareOptions.showAdvanced\": \"Options Avancées\",\n  \"CompareOptions.useBorrowers\": \"Calculs simplifiés\",\n  \"ComparePage.CTA\": \"Ajouter un bien à comparer\",\n  \"ComparePage.start\": \"Commencer à comparer\",\n  \"CompareTable.empty\": \"Ajoutez une propriété pour commencer\",\n  \"CompareTableContent.empty\": \"Aucune propriété avec ce filtre\",\n  \"ConditionsButton.counterpart\": \"Contreparties pour les meilleurs taux\",\n  \"ConditionsButton.counterparts\": \"Contreparties pour les meilleurs taux\",\n  \"ConditionsButton.CTA\": \"Ok\",\n  \"ConditionsButton.mandatory\": \"Conditions obligatoires\",\n  \"ConditionsButton.title\": \"Conditions\",\n  \"ContactButton.byEmail\": \"Par email\",\n  \"ContactButton.byPhone\": \"Par téléphone\",\n  \"ContactButton.yourAdvisor\": \"Votre conseiller\",\n  \"ContractDownloader.ready\": \"Votre contrat est prêt, vous pouvez le télécharger dès maintenant.\",\n  \"ContractDownloader.waiting\": \"Votre contrat arrivera ici.\",\n  \"ContractPage.CTA\": \"Demander le contrat\",\n  \"ContractPage.description\": \"Pour obtenir un contrat officiel de prêt, votre prêteur a encore besoin de quelques documents. Dès que vous avez soumis tous les documents nécessaires, vous pourrez demander le contrat, ce qui prendra quelques jours à votre prêteur.\",\n  \"ContractPage.loading\": \"Vous serez notifié par e-mail lorsque votre contrat est prêt.\",\n  \"ContractPage.progress\": \"Progrès: {value, number, percent}\",\n  \"CustomFieldAdder.add\": \"Ajouter\",\n  \"CustomFieldAdder.attic\": \"Avec grenier\",\n  \"CustomFieldAdder.balcony\": \"Avec balcon\",\n  \"CustomFieldAdder.basement\": \"Avec cave\",\n  \"CustomFieldAdder.biscuitHouse\": \"Murs en pain d'épices\",\n  \"CustomFieldAdder.boolean\": \"Oui / Non\",\n  \"CustomFieldAdder.chimney\": \"Avec cheminée\",\n  \"CustomFieldAdder.constructionYear\": \"Année de construction\",\n  \"CustomFieldAdder.contact\": \"Contact\",\n  \"CustomFieldAdder.date\": \"Date\",\n  \"CustomFieldAdder.dishwasher\": \"Avec lave-vaisselle\",\n  \"CustomFieldAdder.extensionAllowed\": \"Aggrandissement possible\",\n  \"CustomFieldAdder.facing\": \"Orientation\",\n  \"CustomFieldAdder.floor\": \"Étage dans l'immeuble\",\n  \"CustomFieldAdder.floors\": \"Nombre d'Étages\",\n  \"CustomFieldAdder.garage\": \"Avec garage\",\n  \"CustomFieldAdder.garden\": \"Avec jardin\",\n  \"CustomFieldAdder.groundFloor\": \"Rez-de-chaussée\",\n  \"CustomFieldAdder.haunted\": \"Maison hantée\",\n  \"CustomFieldAdder.internetSpeed\": \"Débit internet max\",\n  \"CustomFieldAdder.landArea\": \"Surface du terrain\",\n  \"CustomFieldAdder.landingRunway\": \"Avec piste d'atterissage\",\n  \"CustomFieldAdder.money\": \"Montant en CHF\",\n  \"CustomFieldAdder.name\": \"Nom du champ\",\n  \"CustomFieldAdder.number\": \"Nombre\",\n  \"CustomFieldAdder.parkingSpots\": \"Places de parc\",\n  \"CustomFieldAdder.percent\": \"Pourcentage\",\n  \"CustomFieldAdder.pool\": \"Avec piscine\",\n  \"CustomFieldAdder.renovationRequired\": \"Rénovations nécessaires\",\n  \"CustomFieldAdder.richNeighbours\": \"Voisins milliardaires\",\n  \"CustomFieldAdder.rooms\": \"Nombre de pièces\",\n  \"CustomFieldAdder.summerTemperature\": \"Température en été\",\n  \"CustomFieldAdder.surface\": \"Surface habitable\",\n  \"CustomFieldAdder.terrace\": \"Avec terrasse\",\n  \"CustomFieldAdder.text\": \"Texte\",\n  \"CustomFieldAdder.title\": \"Ajouter un champ personnel\",\n  \"CustomFieldAdder.type\": \"Type de valeur\",\n  \"CustomFieldAdder.washingMachine\": \"Avec machine à laver\",\n  \"DashboardBorrowers.age\": \"{value} ans\",\n  \"DashboardBorrowers.itemTitle\": \"Emprunteur {index}\",\n  \"DashboardBorrowers.title\": \"{count, plural, one {Emprunteur} other {Emprunteurs}}\",\n  \"DashboardCharts.expensesTitle\": \"Coût Mensuel\",\n  \"DashboardDownload.contract\": \"Votre contrat\",\n  \"DashboardDownload.title\": \"Documents\",\n  \"DashboardLastSteps.closing\": \"Décaisser le prêt\",\n  \"DashboardLastSteps.contract\": \"Obtenir le contrat\",\n  \"DashboardLastSteps.progress\": \"Progrès: {value}/{total}\",\n  \"DashboardLastSteps.subtitle\": \"Date de Décaissement\",\n  \"DashboardLastSteps.title\": \"Date de Décaissement\",\n  \"DashboardMenu.financePage\": \"Plus de détails\",\n  \"DashboardMenu.showDetail\": \"Afficher les détails\",\n  \"DashboardMenu.showOverview\": \"Afficher le résumé\",\n  \"DashboardOffer.title\": \"Offre retenue\",\n  \"DashboardPage.title\": \"Tableau de Bord\",\n  \"DashboardPayments.lastDate\": \"Dernier paiement\",\n  \"DashboardPayments.title\": \"Prochain paiement\",\n  \"DashboardProperty.title\": \"Bien immobilier\",\n  \"DashboardRecap.detail\": \"Détail\",\n  \"DashboardRecap.overview\": \"Résumé\",\n  \"DashboardRecap.title\": \"Plan Financier\",\n  \"DashboardStatus.auction\": \"Enchères en cours...\",\n  \"DashboardStatus.step\": \"{step, plural, one {1ère étape} =2 {2ème étape} =3 {3ème étape} =4 {4ème étape}}\",\n  \"DashboardStatus.title\": \"Statut de votre demande\",\n  \"DashboardStatus.verification\": \"Vérification en cours...\",\n  \"DashboardUnverified.CTA\": \"Renvoyer l'email\",\n  \"DashboardUnverified.description\": \"Jetez un oeil à votre boite email pour un message de notre part. Rien reçu ?\",\n  \"DashboardUnverified.title\": \"Vous n'avez pas encore vérifié votre adresse email.\",\n  \"DateInput.placeholder\": \"Choisissez une date\",\n  \"DefaultOptions.fortune\": \"Fonds propres\",\n  \"DefaultOptions.income\": \"Revenus annuels bruts\",\n  \"DefaultOptions.interestRate\": \"Taux d'intérêts\",\n  \"DropzoneArrayItem.fileCount\": \"{count, plural, =0 {Pas de fichiers} one {Un fichier} other {# fichiers}}\",\n  \"DropzoneInput.cancelUpload\": \"Annuler l'upload\",\n  \"DropzoneInput.cancelUploadConfirmation\": \"Êtes-vous sûr ?\",\n  \"DropzoneInput.invalidFileType\": \"Vous ne pouvez uploader que des fichiers PDF, JPG et PNG.\",\n  \"DropzoneInput.message\": \"Déposez un ou plusieurs fichiers ici, ou cliquez pour choisir\",\n  \"DropzoneInput.removeFile\": \"Supprimer\",\n  \"e-Potek\": \"e-Potek\",\n  \"EmailLine.alreadyAnAccount\": \"J'ai déjà un compte e-Potek\",\n  \"emails.auctionEnded.body\": \"Les prêteurs se sont battus d'arrache-pied pour vous faire des offres incroyables et avoir le plaisir de financer votre futur bien immobilier. Découvrez combien d'offres vous avez reçues, et choisissez votre prêteur en cliquant sur le bouton en bas.\",\n  \"emails.auctionEnded.CTA\": \"Choisir son prêteur\",\n  \"emails.auctionEnded.subject\": \"[e-Potek] Les résultats sont arrivés\",\n  \"emails.auctionEnded.title\": \"Félicitations\",\n  \"emails.auctionStarted.body\": \"Nous avons appelé tous les prêteurs de la place à se lancer et vous faire une offre incroyable. Vous pourrez accéder aux résultats le {date, date, full} à minuit.{verticalSpace}Vous recevrez une nouvelle notification quand les enchères seront terminées, donc en attendant, reposez vous!\",\n  \"emails.auctionStarted.subject\": \"[e-Potek] Les enchères ont commencé\",\n  \"emails.auctionStarted.title\": \"La bataille se prépare\",\n  \"emails.AUCTION_ENDED.BODY\": \"Les prêteurs se sont battus d'arrache-pied pour vous faire des offres incroyables et avoir le plaisir de financer votre futur bien immobilier. Découvrez combien d'offres vous avez reçues, et choisissez votre prêteur en cliquant sur le bouton en bas.\",\n  \"emails.AUCTION_ENDED.CTA\": \"Choisir son prêteur\",\n  \"emails.AUCTION_ENDED.SUBJECT\": \"[e-Potek] Les résultats sont arrivés\",\n  \"emails.AUCTION_ENDED.TITLE\": \"Félicitations\",\n  \"emails.AUCTION_STARTED.BODY\": \"Nous avons appelé tous les prêteurs de la place à se lancer et vous faire une offre incroyable. Vous pourrez accéder aux résultats le {date, date, full} à minuit.{verticalSpace}Vous recevrez une nouvelle notification quand les enchères seront terminées, donc en attendant, reposez vous!\",\n  \"emails.AUCTION_STARTED.SUBJECT\": \"[e-Potek] Les enchères ont commencé\",\n  \"emails.AUCTION_STARTED.TITLE\": \"La bataille se prépare\",\n  \"emails.enrollAccount.body\": \"On a bien enregistré votre projet, et vous invitons à découvrir votre compte et avancer sur votre prêt hypothécaire.\",\n  \"emails.enrollAccount.CTA\": \"Continuer l'expérience\",\n  \"emails.enrollAccount.from\": \"Yannis d'e-Potek\",\n  \"emails.enrollAccount.subject\": \"Bienvenue chez e-Potek\",\n  \"emails.enrollAccount.title\": \"Entrez sur votre compte e-Potek\",\n  \"emails.ENROLL_ACCOUNT.BODY\": \"On a bien enregistré votre projet, et vous invitons à découvrir votre compte et avancer sur votre prêt hypothécaire.\",\n  \"emails.ENROLL_ACCOUNT.CTA\": \"Continuer l'expérience\",\n  \"emails.ENROLL_ACCOUNT.from\": \"Yannis d'e-Potek\",\n  \"emails.ENROLL_ACCOUNT.SUBJECT\": \"Bienvenue chez e-Potek\",\n  \"emails.ENROLL_ACCOUNT.TITLE\": \"Entrez sur votre compte e-Potek\",\n  \"emails.footer\": \"{copyright}Vous recevez cet email car vous avez créé un compte sur {url}{unsubscribe}\",\n  \"emails.resetPassword.body\": \"Il vous regarde avec un air exaspéré, visiblement déçu que vous ayiez pu oublier un mot de passe aussi simple. Il essaie d'attirer votre attention sur le gros bouton en bas.\",\n  \"emails.resetPassword.CTA\": \"Le gros bouton\",\n  \"emails.resetPassword.from\": \"Gardien des clés d'e-Potek\",\n  \"emails.resetPassword.subject\": \"Égarer son mot de passe\",\n  \"emails.resetPassword.title\": \"Vous avez invoqué le gardien des clés d'e-Potek\",\n  \"emails.RESET_PASSWORD.BODY\": \"Il vous regarde avec un air exaspéré, visiblement déçu que vous ayiez pu oublier un mot de passe aussi simple. Il essaie d'attirer votre attention sur le gros bouton en bas.\",\n  \"emails.RESET_PASSWORD.CTA\": \"Le gros bouton\",\n  \"emails.RESET_PASSWORD.from\": \"Gardien des clés d'e-Potek\",\n  \"emails.RESET_PASSWORD.SUBJECT\": \"Égarer son mot de passe\",\n  \"emails.RESET_PASSWORD.TITLE\": \"Vous avez invoqué le gardien des clés d'e-Potek\",\n  \"emails.unsubscribe\": \"Me Désabonner\",\n  \"emails.verificationError.body\": \"Il semblerait qu'il y a eu un petit problème lors de la vérification.\",\n  \"emails.verificationError.CTA\": \"Fixer la fuite d'eau\",\n  \"emails.verificationError.subject\": \"[e-Potek] Souci de vérification\",\n  \"emails.verificationError.title\": \"Oops..\",\n  \"emails.verificationPassed.body\": \"Vous pouvez continuer votre demande de prêt et lancer les enchères à tout moment. Vous pourrez encore modifier la structure de votre projet une dernière fois avant de vous lancer.\",\n  \"emails.verificationPassed.CTA\": \"Continuer\",\n  \"emails.verificationPassed.subject\": \"[e-Potek] Vérification réussie\",\n  \"emails.verificationPassed.title\": \"Tout est en ordre\",\n  \"emails.verificationRequested.body\": \"Nous allons regarder ce que vous nous avez confié avec le plus grand soin, et vérifier que vos informations sont en ordre et dans le meilleur état pour être envoyé aux prêteurs. Nous traiterons votre dossier dans les plus brefs délais durant les heures ouvrables.\",\n  \"emails.verificationRequested.subject\": \"[e-Potek] Vérification demandée\",\n  \"emails.verificationRequested.title\": \"Vous avez demandé la vérification de votre dossier\",\n  \"emails.VERIFICATION_ERROR.BODY\": \"Il semblerait qu'il y a eu un petit problème lors de la vérification.\",\n  \"emails.VERIFICATION_ERROR.CTA\": \"Fixer la fuite d'eau\",\n  \"emails.VERIFICATION_ERROR.SUBJECT\": \"[e-Potek] Souci de vérification\",\n  \"emails.VERIFICATION_ERROR.TITLE\": \"Oops..\",\n  \"emails.VERIFICATION_PASSED.BODY\": \"Vous pouvez continuer votre demande de prêt et lancer les enchères à tout moment. Vous pourrez encore modifier la structure de votre projet une dernière fois avant de vous lancer.\",\n  \"emails.VERIFICATION_PASSED.CTA\": \"Continuer\",\n  \"emails.VERIFICATION_PASSED.SUBJECT\": \"[e-Potek] Vérification réussie\",\n  \"emails.VERIFICATION_PASSED.TITLE\": \"Tout est en ordre\",\n  \"emails.VERIFICATION_REQUESTED.BODY\": \"Nous allons regarder ce que vous nous avez confié avec le plus grand soin, et vérifier que vos informations sont en ordre et dans le meilleur état pour être envoyé aux prêteurs. Nous traiterons votre dossier dans les plus brefs délais durant les heures ouvrables.\",\n  \"emails.VERIFICATION_REQUESTED.SUBJECT\": \"[e-Potek] Vérification demandée\",\n  \"emails.VERIFICATION_REQUESTED.TITLE\": \"Vous avez demandé la vérification de votre dossier\",\n  \"emails.verifyEmail.subject\": \"Hypothèque, quand je t'aurai..\",\n  \"emails.VERIFY_EMAIL.SUBJECT\": \"Bienvenue chez e-Potek!\",\n  \"EmailVerification.error\": \"Zut, il y a eu une erreur, rééssayez!\",\n  \"EmailVerification.message\": \"Email vérifié, Merci!\",\n  \"error.fileSize.description\": \"On ne peut prendre que des fichiers en dessous de 50MB\",\n  \"error.fileSize.title\": \"Fichier trop gros\",\n  \"error.fileType.description\": \"On ne peut prendre que les .pdf, .jpg, .jpeg et .png\",\n  \"error.fileType.title\": \"Fichier incompatible\",\n  \"error.general\": \"Woops, il y a eu un petit souci!\",\n  \"ExpensesChart.perMonth\": \"par mois\",\n  \"ExpensesChartInterests.libor\": \"Libor moyen: {value, number, percentage}\",\n  \"ExpensesChartInterests.selectFieldLabel\": \"Taux d'intérêt indicatif\",\n  \"ExpensesChartInterests.years\": \"{years} ans moyen: {value, number, percentage}\",\n  \"FaqPage.description\": \"En développement..\",\n  \"FaqPage.title\": \"Questions fréquentes\",\n  \"FieldToggles.customFields\": \"Champs personnels\",\n  \"FieldToggles.defaultFields\": \"Champs e-Potek\",\n  \"FieldToggles.label\": \"Choisir les champs\",\n  \"FieldToggles.noCustomFields\": \"Vous n'avez pas encore de champs personnels, ajoutez-en en cliquant en bas à gauche de la page.\",\n  \"FieldToggles.title\": \"Choisir quels champs afficher\",\n  \"FileAdder.title\": \"+ Uploader un fichier\",\n  \"files.bankAssetsChange\": \"Justificatif de fortune bancaire\",\n  \"files.bankAssetsChange.tooltip\": \"Tout document justifiant de votre fortune bancaires (print screen e-banking, relevé mensuel ou annuel)\",\n  \"files.bonus\": \"Justificatif des bonus\",\n  \"files.bonus.tooltip\": \"Un justificatif par bonus perçu lors des 4 dernières années\",\n  \"files.buyersContract\": \"Acte d'achat\",\n  \"files.buyersContract.tooltipa\": \"Vous pouvez demander un duplicata auprès du notaire qui était chargé de la signature par le passé\",\n  \"files.buyersContract.tooltipb\": \"Le notaire est chargé de produire un projet d’acte d’achat\",\n  \"files.contract\": \"Contrat\",\n  \"files.coownershipAgreement\": \"Règlement PPE\",\n  \"files.coownershipAgreement.tooltip\": \"Ce document édicte les règles de vie de la copropriété\",\n  \"files.coownershipAgreement.tooltip2\": \"Un tiers est nommé comme administrateur de la propriété (souvent une régie) cette entité peut vous fournir ce document.\",\n  \"files.coownershipAllocationAgreement\": \"Cahier de répartition des locaux\",\n  \"files.coownershipAllocationAgreement.tooltip\": \"Document décrivant la pondération de votre lot PPE vis à vis de l’immeuble entier\",\n  \"files.coownershipAllocationAgreement.tooltip2\": \"Un tiers est nommé comme administrateur de la propriété (souvent une régie) cette entité peut vous fournir ce document.\",\n  \"files.cubage\": \"Cubage\",\n  \"files.cubage.tooltip\": \"Le cubage indique le volume en mètres cubes de votre bien immobilier.\",\n  \"files.cubage.tooltip2\": \"Peut être mentionné sur la police d’assurance du bâtiment, dans un rapport du BEB ou peut être demandé auprès de votre architecte.\",\n  \"files.currentMortgages\": \"Contrats de prêts existants\",\n  \"files.currentMortgages.tooltip\": \"Nous avons besoins de connaître le montant de votre prêt hypothécaire existant, le taux d’intérêt et son échéance ainsi que de l‘amortissement annuel y relatif\",\n  \"Files.description\": \"Voici l'endroit où vous pouvez uploader vos document en toute confidentialité.\",\n  \"files.divorceJudgment\": \"Jugement de divorce\",\n  \"files.expenses\": \"Charges\",\n  \"files.expenses.tooltip\": \"Justificatif des charges mentionnées\",\n  \"Files.files1.title\": \"Documents de base\",\n  \"files.fireAndWaterInsurance\": \"Assurance incendie et dégâts des eaux\",\n  \"files.fireAndWaterInsurance.tooltip\": \"Vous pouvez obtenir la copie de la police d’assurance existante auprès du vendeur\",\n  \"files.identity\": \"Pièce d'identité\",\n  \"files.identity.tooltip\": \"Passeport ou carte d'identité (les deux côtés)\",\n  \"files.landRegisterExtract\": \"Extrait du registre foncier\",\n  \"files.landRegisterExtract.tooltip\": \"Contient toutes les informations officielles de votre bien immobilier\",\n  \"files.landRegisterExtract.tooltip2\": \"Vous pouvez obtenir l’extrait du registre du commerce auprès du registre foncier auquel votre commune est rattachée.\",\n  \"files.lastSalaries\": \"3 dernières fiches de salaire\",\n  \"files.marketingBrochure\": \"Brochure de vente\",\n  \"files.marketingBrochure.tooltip\": \"Brochure marketing décrivant le bien immobilier. N'est pas obligatoire.\",\n  \"files.nonPursuitExtract\": \"Extrait de l'office des poursuites\",\n  \"files.nonPursuitExtract.tooltip\": \"Mentionne si vous êtes sujet à des poursuites. Avoir des poursuites peut arriver à tout le monde et peuvent parfois s’expliquer\",\n  \"files.nonPursuitExtract.tooltip2\": \"Vous pouvez commander un extrait de l’office des poursuites sur le site internet ou physiquement au guichet de l’office cantonal de votre canton de résidence actuel. Il doit dater de moins de trois mois.\",\n  \"files.otherIncome\": \"Autres revenus\",\n  \"files.otherIncome.tooltip\": \"Justificatif de chaque autre revenu que vous avez mentionné\",\n  \"files.ownCompanyFinancialStatements\": \"États financiers de l'employeur\",\n  \"files.ownCompanyFinancialStatements.tooltip\": \"Bilans et comptes Pertes et Profits des 3 dernières années\",\n  \"files.pensionFundYearlyStatement\": \"Certificat de la caisse de pension\",\n  \"files.pensionFundYearlyStatement.tooltip\": \"Certificat que vous recevez chaque année de la part de la caisse de pension de votre employeur ou attestation de compte Libre Passage\",\n  \"files.pensionFundYearlyStatement.tooltip2\": \"Ce document contient le capital prévoyance disponible pour l’accession à la propriété ainsi que différentes informations y relatives, vous devriez recevoir ce document chaque année au mois de janvier si vous ne le trouvez pas vous pouvez le réclamer auprès de votre caisse de pension directement.\",\n  \"files.pictures\": \"4 Photos du bien\",\n  \"files.pictures.tooltip\": \"Cuisine, salle de bains, façade extérieure, et vue. Mettez le bien immobilier en valeur\",\n  \"files.plans\": \"Plans\",\n  \"files.plans.tooltip\": \"Vous pouvez obtenir le plan auprès du vendeur ou auprès de la régie, il est préférable d’obtenir un plan avec les métrées\",\n  \"files.reimbursementStatement\": \"Décompte de remboursement\",\n  \"files.reimbursementStatement.tooltip\": \"Le décompte de remboursement est produit par votre prêteur actuel\",\n  \"files.rent\": \"Loyers perçus\",\n  \"files.rent.tooltip\": \"Loyer versé par le locataire existant ou justificatif du futur loyer\",\n  \"files.rent.tooltip2\": \"Vous pouvez obtenir cette information auprès du vendeur ou auprès de la régie qui va gérer vos locataires, si vous n’avez pas de régie nous vous recommandons de vous informer sur la régie qui s'occupe actuellement de la gestion de l'immeuble.\",\n  \"files.residencyPermit\": \"Permis d’établissement\",\n  \"files.residencyPermit.tooltip\": \"Permis d’établissement pour étrangers mentionnant votre résidence fiscale\",\n  \"files.retirementInsurancePlan\": \"Fortune de prévoyance Assurance\",\n  \"files.retirementInsurancePlan.tooltip\": \"Document attestant de la valeur de rachat et des primes payées sur vos polices d’assurances 3A et 3B\",\n  \"files.retirementInsurancePlan.tooltip2\": \"Vous pouvez obtenir ces informations auprès des compagnies d’assurances dans lesquels vous effectuez votre épargne de prévoyance.\",\n  \"files.retirementPlanOther\": \"Fortune de prévoyance Bancaire\",\n  \"files.retirementPlanOther.tooltip\": \"Relevé au 31/12 de vos compte épargne 3A et/ou comptes libre-passage\",\n  \"files.retirementPlanOther.tooltip2\": \"Vous pouvez obtenir les relevés de vos comptes épargne 3A auprès des établissements bancaires dans lesquels vous déposez votre épargne\",\n  \"files.salaryCertificate\": \"Certificat de salaire\",\n  \"files.salaryCertificate.tooltip\": \"De l’année précédente - est utilisé pour votre déclaration fiscale\",\n  \"files.salaryChange\": \"Justificatif du nouveau salaire\",\n  \"files.salaryChange.tooltip\": \"Options: 3 dernières fiches salaires / une attestation de votre employeur / contrat de travail / avenant à votre contrat de travail\",\n  \"files.signedContract\": \"Contrat signé\",\n  \"files.signedContract.tooltip\": \"Le contrat de prêt avec votre signature à tous les endroits requis\",\n  \"File.status.ERROR\": \"Non valide\",\n  \"File.status.UNVERIFIED\": \"En attente de vérification\",\n  \"File.status.VALID\": \"Validé\",\n  \"files.taxes\": \"Déclaration fiscale\",\n  \"files.taxes.tooltip\": \"Dernière disponible, complète et détaillée dans la mesure du possible accompagnée des annexes\",\n  \"Files.title\": \"Mes Documents\",\n  \"FilesPage.description\": \"Vous trouverez ici tous les documents que vous avez ajoutés à votre projet. Ils sont enregistrés en toute sécurité, et vous pourrez les y retrouver à tout instant.\",\n  \"FilesPage.title\": \"Documents\",\n  \"Finance.description\": \"Normalement, vous nous avez déjà donné tout ce dont nous avons besoin sur cette page.{verticalSpace}Vérifiez cependant que vous avez détaillé de façon exhaustive vos finances personelles. Les prêteurs vous offriront des conditions plus attractives si vos moyens dépassent le minimum nécéssaire pour votre Prêt Hypothécaire.\",\n  \"Finance.notValidated\": \"Non validées\",\n  \"Finance.recapTitle\": \"Récapitulatif (en {currency})\",\n  \"Finance.title\": \"Mes Finances\",\n  \"Finance.validated\": \"Validées\",\n  \"FinancePage.title\": \"Graphiques financiers\",\n  \"Forms.address1\": \"Adresse 1\",\n  \"Forms.address1.placeholder\": \"Rue des Champs 7\",\n  \"Forms.address2\": \"Adresse 2\",\n  \"Forms.address2.placeholder\": \" \",\n  \"Forms.age\": \"Âge\",\n  \"Forms.age.placeholder\": \"35\",\n  \"Forms.auction.formTitle\": \"Derniers réglages\",\n  \"Forms.balconyArea\": \"Surface des balcons en m2\",\n  \"Forms.balconyArea.placeholder\": \"20\",\n  \"Forms.bankFortune\": \"Fortune Bancaire\",\n  \"Forms.bankFortune.placeholder\": \"CHF 100 000\",\n  \"Forms.bathroomCount\": \"Nb. de salles de bain\",\n  \"Forms.bathroomCount.info\": \"Salles de bains ou salles d’eau (respectivement avec baignoire ou douche)\",\n  \"Forms.bathroomCount.placeholder\": \"1\",\n  \"Forms.birthPlace\": \"Lieu de Naissance\",\n  \"Forms.birthPlace.placeholder\": \"Berne, Suisse\",\n  \"Forms.bonus.bonus2014\": \"Bonus 2014\",\n  \"Forms.bonus.bonus2014.placeholder\": \"CHF 10 000\",\n  \"Forms.bonus.bonus2015\": \"Bonus 2015\",\n  \"Forms.bonus.bonus2015.placeholder\": \"CHF 10 000\",\n  \"Forms.bonus.bonus2016\": \"Bonus 2016\",\n  \"Forms.bonus.bonus2016.placeholder\": \"CHF 10 000\",\n  \"Forms.bonus.bonus2017\": \"Bonus 2017\",\n  \"Forms.bonus.bonus2017.placeholder\": \"CHF 10 000\",\n  \"Forms.bonusExists\": \"Avez-vous un bonus ?\",\n  \"Forms.buildingPlacementQuality\": \"Emplacement dans l'immeublee\",\n  \"Forms.buildingPlacementQuality.0\": \"Mauvais\",\n  \"Forms.buildingPlacementQuality.1\": \"Moyen\",\n  \"Forms.buildingPlacementQuality.2\": \"Bon\",\n  \"Forms.buildingPlacementQuality.3\": \"Très Bon\",\n  \"Forms.buildingQuality\": \"Condition d’entretien du bâtiment\",\n  \"Forms.buildingQuality.0\": \"Mauvais\",\n  \"Forms.buildingQuality.1\": \"Moyen\",\n  \"Forms.buildingQuality.2\": \"Bon\",\n  \"Forms.buildingQuality.3\": \"Très Bon\",\n  \"Forms.childrenCount\": \"Enfants à charge\",\n  \"Forms.childrenCount.placeholder\": \"0\",\n  \"Forms.citizenship\": \"Nationalité\",\n  \"Forms.citizenship.placeholder\": \"Français, Allemand, Italien\",\n  \"Forms.cityPlacementQuality\": \"Qualité de l'emplacement au sein de la commune\",\n  \"Forms.cityPlacementQuality.0\": \"Mauvais\",\n  \"Forms.cityPlacementQuality.1\": \"Moyen\",\n  \"Forms.cityPlacementQuality.2\": \"Bon\",\n  \"Forms.cityPlacementQuality.3\": \"Très Bon\",\n  \"Forms.civilStatus\": \"État civil\",\n  \"Forms.civilStatus.DIVORCED\": \"{gender, select, m {Divorcé} f {Divorcée} other {Divorcé}}\",\n  \"Forms.civilStatus.MARRIED\": \"{gender, select, m {Marié} f {Mariée} other {Marié}}\",\n  \"Forms.civilStatus.PACSED\": \"{gender, select, m {Pacsé} f {Pacsée} other {pacsé}}\",\n  \"Forms.civilStatus.SINGLE\": \"Célibataire\",\n  \"Forms.company\": \"Employeur\",\n  \"Forms.company.placeholder\": \"Nestlé\",\n  \"Forms.constructionYear\": \"Année de construction\",\n  \"Forms.constructionYear.placeholder\": \"2005\",\n  \"Forms.copropertyPercentage\": \"Répartition du bien au sein de la copropriété\",\n  \"Forms.copropertyPercentage.info\": \"En millièmes\",\n  \"Forms.copropertyPercentage.placeholder\": \"125\",\n  \"Forms.currentOwner\": \"Qui est le propriétaire actuel ?\",\n  \"Forms.currentOwner.0\": \"{name}\",\n  \"Forms.currentOwner.1\": \"{name}\",\n  \"Forms.currentOwner.both\": \"Les Deux\",\n  \"Forms.currentOwner.other\": \"Autre\",\n  \"Forms.expenses\": \"Charges\",\n  \"Forms.expenses.description\": \"Type de charge\",\n  \"Forms.expenses.LEASING\": \"Leasings\",\n  \"Forms.expenses.MORTGAGE_LOAN\": \"Prêts immobiliers\",\n  \"Forms.expenses.OTHER\": \"Autre\",\n  \"Forms.expenses.PENSIONS\": \"Pensions et rentes\",\n  \"Forms.expenses.PERSONAL_LOAN\": \"Crédits personnels\",\n  \"Forms.expenses.RENT\": \"Loyers\",\n  \"Forms.expenses.value\": \"Montant annuel\",\n  \"Forms.expenses.value.placeholder\": \"CHF 10 000\",\n  \"Forms.firstName\": \"Prénom\",\n  \"Forms.firstName.placeholder\": \"Marie\",\n  \"Forms.flatQuality\": \"Condition d’entretien de l’appartement\",\n  \"Forms.flatQuality.0\": \"Mauvais\",\n  \"Forms.flatQuality.1\": \"Moyen\",\n  \"Forms.flatQuality.2\": \"Bon\",\n  \"Forms.flatQuality.3\": \"Très Bon\",\n  \"Forms.fortune\": \"Fortune\",\n  \"Forms.futureOwner\": \"Qui sera le propriétaire du bien immobilier ?\",\n  \"Forms.futureOwner.0\": \"{name}\",\n  \"Forms.futureOwner.1\": \"{name}\",\n  \"Forms.futureOwner.both\": \"Les Deux\",\n  \"Forms.futureOwner.other\": \"Autre\",\n  \"Forms.gender\": \"Sexe\",\n  \"Forms.gender.F\": \"Femme\",\n  \"Forms.gender.M\": \"Homme\",\n  \"Forms.gender.OTHER\": \"Autre\",\n  \"Forms.general.auctionMostImportant\": \"Critère le plus important\",\n  \"Forms.general.auctionMostImportant.NOTHING\": \"Aucun\",\n  \"Forms.general.auctionMostImportant.PRICE\": \"Coût mensuel le plus bas\",\n  \"Forms.general.auctionMostImportant.SPEED\": \"Décaissement le plus rapide\",\n  \"Forms.general.wantedClosingDate\": \"Date espérée du décaissement\",\n  \"Forms.incomeAndExpenses\": \"Revenus & Charges\",\n  \"Forms.insideArea\": \"Surface habitable en m2\",\n  \"Forms.insideArea.placeholder\": \"150\",\n  \"Forms.insurance\": \"Prévoyance\",\n  \"Forms.insurance3B\": \"Assurance 3B\",\n  \"Forms.insurance3B.placeholder\": \"CHF 100 000\",\n  \"Forms.insurancePureRisk\": \"Risque pure\",\n  \"Forms.insurancePureRisk.placeholder\": \"CHF 100 000\",\n  \"Forms.insuranceSecondPillar\": \"LPP / 2ème Pilier\",\n  \"Forms.insuranceSecondPillar.placeholder\": \"CHF 100 000\",\n  \"Forms.insuranceThirdPillar\": \"Assurance 3A\",\n  \"Forms.insuranceThirdPillar.placeholder\": \"CHF 100 000\",\n  \"Forms.investment\": \"Bien d'investissement\",\n  \"Forms.isCoproperty\": \"Est-ce une copropriété ?\",\n  \"Forms.isNew\": \"Est-ce un bien neuf ?\",\n  \"Forms.isSwiss\": \"Avez-vous la nationalité Suisse ?\",\n  \"Forms.isUSPerson\": \"Êtes-vous une US Person?\",\n  \"Forms.landArea\": \"Surface du terrain en m2\",\n  \"Forms.landArea.placeholder\": \"250\",\n  \"Forms.lastName\": \"Nom\",\n  \"Forms.lastName.placeholder\": \"Ducret\",\n  \"Forms.mandatory\": \"Les champs marqués avec un * sont obligatoires\",\n  \"Forms.materialsQuality\": \"Qualité des matériaux\",\n  \"Forms.materialsQuality.0\": \"Mauvais\",\n  \"Forms.materialsQuality.1\": \"Moyen\",\n  \"Forms.materialsQuality.2\": \"Bon\",\n  \"Forms.materialsQuality.3\": \"Très Bon\",\n  \"Forms.minergie\": \"Est-ce une construction Minergie ?\",\n  \"Forms.otherFortune\": \"Autre Fortune\",\n  \"Forms.otherFortune.airplanes\": \"Aéronefs\",\n  \"Forms.otherFortune.art\": \"Objets d'art\",\n  \"Forms.otherFortune.boats\": \"Bateaux\",\n  \"Forms.otherFortune.cars\": \"Véhicules\",\n  \"Forms.otherFortune.description\": \"Type de Fortune\",\n  \"Forms.otherFortune.jewelry\": \"Bijoux\",\n  \"Forms.otherFortune.value\": \"Valeur\",\n  \"Forms.otherFortune.value.description\": \"CHF 100 000\",\n  \"Forms.otherIncome\": \"Autres revenus\",\n  \"Forms.otherIncome.description\": \"Type de revenu\",\n  \"Forms.otherIncome.INVESTMENT\": \"Revenus de vos titres\",\n  \"Forms.otherIncome.OTHER\": \"Autre activité\",\n  \"Forms.otherIncome.PENSION\": \"Pensions\",\n  \"Forms.otherIncome.REAL_ESTATE\": \"Revenus de fortune immobilière\",\n  \"Forms.otherIncome.RENT\": \"Rentes\",\n  \"Forms.otherIncome.value\": \"Montant annuel\",\n  \"Forms.otherIncome.value.placeholder\": \"CHF 10 000\",\n  \"Forms.otherIncome.WELFARE\": \"Allocations\",\n  \"Forms.otherNotes\": \"Autres informations\",\n  \"Forms.otherNotes.placeholder\": \"Aménagements extérieurs, piscine, jardins, cabanons, annexes, sous-sols utiles,...\",\n  \"Forms.otherOwner\": \"Autre propriétaire\",\n  \"Forms.otherOwner.placeholder\": \" \",\n  \"Forms.parking.box\": \"Box de parking\",\n  \"Forms.parking.box.placeholder\": \"1\",\n  \"Forms.parking.inside\": \"Places de parc intérieur\",\n  \"Forms.parking.inside.placeholder\": \"1\",\n  \"Forms.parking.outside\": \"Places de parc extérieur\",\n  \"Forms.parking.outside.placeholder\": \"1\",\n  \"Forms.personalBank\": \"Votre Banque Personelle\",\n  \"Forms.personalBank.placeholder\": \"UBS\",\n  \"Forms.primary\": \"Résidence principale\",\n  \"Forms.propertyAddress\": \"Adresse du bien immobilier\",\n  \"Forms.propertyDetails\": \"Détails du bien\",\n  \"Forms.propertyQuality\": \"Qualité et Emplacement\",\n  \"Forms.propertyWork\": \"Travaux de plus-value\",\n  \"Forms.propertyWork.placeholder\": \"CHF 50 000\",\n  \"Forms.realEstate\": \"Fortune Immobilière\",\n  \"Forms.realEstate.description\": \"Type de propriété\",\n  \"Forms.realEstate.INVESTMENT\": \"Bien d'investissement\",\n  \"Forms.realEstate.loan\": \"Emprunt actuel\",\n  \"Forms.realEstate.loan.placeholder\": \"CHF 300 000\",\n  \"Forms.realEstate.PRIMARY\": \"Propriété principale\",\n  \"Forms.realEstate.SECONDARY\": \"Propriété secondaire\",\n  \"Forms.realEstate.value\": \"Valeur du bien\",\n  \"Forms.realEstate.value.placeholder\": \"CHF 400 000\",\n  \"Forms.renovationYear\": \"Année de rénovation\",\n  \"Forms.renovationYear.info\": \"Seulement si la propriété a été rénovée\",\n  \"Forms.renovationYear.placeholder\": \"2010\",\n  \"Forms.residencyPermit\": \"Permis de résidence\",\n  \"Forms.residencyPermit.b\": \"Permis B\",\n  \"Forms.residencyPermit.c\": \"Permis C\",\n  \"Forms.residencyPermit.ci\": \"Permis Ci\",\n  \"Forms.residencyPermit.f\": \"Permis F\",\n  \"Forms.residencyPermit.g\": \"Permis G\",\n  \"Forms.residencyPermit.l\": \"Permis L\",\n  \"Forms.residencyPermit.n\": \"Permis N\",\n  \"Forms.residencyPermit.none\": \"Pas de permis\",\n  \"Forms.residencyPermit.s\": \"Permis S\",\n  \"Forms.roomCount\": \"Nb. de chambres\",\n  \"Forms.roomCount.info\": \"Chambres à coucher\",\n  \"Forms.roomCount.placeholder\": \"3.5\",\n  \"Forms.salary\": \"Revenus bruts annuels\",\n  \"Forms.salary.placeholder\": \"CHF 100 000\",\n  \"Forms.sameAddress\": \"Utiliser la même adresse que {name} ?\",\n  \"Forms.secondary\": \"Résidence secondaire\",\n  \"Forms.style\": \"Type de bien immobilier\",\n  \"Forms.style.FLAT\": \"Appartement\",\n  \"Forms.style.VILLA\": \"Villa\",\n  \"Forms.terraceArea\": \"Surface des terrasses en m2\",\n  \"Forms.terraceArea.placeholder\": \"40\",\n  \"Forms.toiletCount\": \"Nb. de WC\",\n  \"Forms.toiletCount.placeholder\": \"1\",\n  \"Forms.usageType\": \"Type d'utilisation\",\n  \"Forms.usageType.INVESTMENT\": \"Bien d'investissement\",\n  \"Forms.usageType.PRIMARY\": \"Résidence principale\",\n  \"Forms.usageType.SECONDARY\": \"Résidence secondaire\",\n  \"Forms.value\": \"Prix d'achat\",\n  \"Forms.value.placeholder\": \"CHF 500 000\",\n  \"Forms.volume\": \"Volume/Cubage en m3\",\n  \"Forms.volume.placeholder\": \"1000\",\n  \"Forms.volumeNorm\": \"Type de cubage\",\n  \"Forms.volumeNorm.placeholder\": \"SIA\",\n  \"Forms.worksForOwnCompany\": \"Êtes-vous employé de votre propre entreprise ?\",\n  \"Forms.yourAddress\": \"Votre adresse\",\n  \"Forms.zipCode\": \"NPA et localité\",\n  \"Forms.zipCode.placeholder\": \"1201 Genève\",\n  \"general.1\": \"Un\",\n  \"general.2\": \"Deux\",\n  \"general.amortization\": \"Amortissement\",\n  \"general.areYouSure\": \"Êtes-vous sûr ?\",\n  \"general.buildingMaintenance\": \"Frais d'entretien\",\n  \"general.cancel\": \"Annuler\",\n  \"general.close\": \"Fermer\",\n  \"general.continue\": \"Continuer\",\n  \"general.delete\": \"Supprimer\",\n  \"general.download\": \"Télécharger\",\n  \"general.hide\": \"Masquer\",\n  \"general.income\": \"Revenus\",\n  \"general.insuranceFees\": \"Frais retrait Prévoyance\",\n  \"general.insuranceFunds\": \"Prévoyance\",\n  \"general.interests\": \"Intérêts\",\n  \"general.learnMore\": \"En savoir plus\",\n  \"general.lenders\": \"Prêteurs\",\n  \"general.login\": \"Login\",\n  \"general.logout\": \"Déconnexion\",\n  \"general.modify\": \"Modifier\",\n  \"general.mortgageLoan\": \"Prêt Hypothécaire\",\n  \"general.no\": \"Non\",\n  \"general.notaryFees\": \"Frais de notaire\",\n  \"general.ok\": \"Ok\",\n  \"general.one\": \"Un\",\n  \"general.ownFunds\": \"Fonds propres\",\n  \"general.perMonth\": \"/mois\",\n  \"general.progress\": \"Progrès: {value, number, percent}\",\n  \"general.property\": \"Bien immobilier\",\n  \"general.salary\": \"Salaire\",\n  \"general.save\": \"Sauvegarder\",\n  \"general.savings\": \"Épargne\",\n  \"general.search\": \"Rechercher\",\n  \"general.showAll\": \"Afficher tout\",\n  \"general.signup\": \"Créer un compte\",\n  \"general.sortBy\": \"Trier par\",\n  \"general.validate\": \"Valider\",\n  \"general.yes\": \"Oui\",\n  \"GoogleMapsAutocomplete.label\": \"Addresse de la propriété\",\n  \"HomeDev.CTA\": \"M'avertir par e-mail\",\n  \"HomeDev.description\": \"Nous allons bientôt ouvrir e-Potek aux refinancements, soyez le premier averti !\",\n  \"HomeDev.title\": \"En Développement\",\n  \"HomePage.compare\": \"Comparer des propriétés\",\n  \"HomePage.CTA.buy\": \"Faire une acquisition\",\n  \"HomePage.CTA.compare\": \"Comparer des propriétés\",\n  \"HomePage.CTA1\": \"Faire une acquisition\",\n  \"HomePage.CTA12\": \"Financement hypothécaire\",\n  \"HomePage.CTA2\": \"Refinancer un bien\",\n  \"HomePage.description\": \"Votre guide pour traverser la jungle hypothécaire.\",\n  \"HomePage.footer.about\": \"À Propos\",\n  \"HomePage.footer.careers\": \"Carrières\",\n  \"HomePage.footer.conditions\": \"Conditions\",\n  \"HomePage.footer.contact\": \"Contact\",\n  \"HomePage.footer.faq\": \"FAQ\",\n  \"HomePage.sellingpoint1.text\": \"Identifiez le montant que vous pouvez emprunter en quelques clics.\",\n  \"HomePage.sellingpoint1.title\": \"1. Testez votre éligibilité\",\n  \"HomePage.sellingpoint2.text\": \"Obtenez de manière anonyme des offres sur mesure de la part des prêteurs du marché.\",\n  \"HomePage.sellingpoint2.title\": \"2. Organisez les enchères\",\n  \"HomePage.sellingpoint3.text\": \"La plateforme simple et sécurisée vous permet de communiquer facilement avec votre prêteur.\",\n  \"HomePage.sellingpoint3.title\": \"3. Communiquez avec votre prêteur\",\n  \"HomePage.sellingpoint4.text\": \"Vous êtes accompagnés dans vos décisions stratégiques par des spécialistes en financement jusqu'à l'obtention de votre prêt.\",\n  \"HomePage.sellingpoint4.title\": \"4. Obtenez votre prêt\",\n  \"HomePage.sellingpoint5.text\": \"Avancez à votre rythme, arrêtez quand vous voulez, tout ça en toute gratuité, pour toujours.\",\n  \"HomePage.sellingpoint5.title\": \"Sans engagement et entièrement gratuit\",\n  \"HomePage.sellingpoint6.text\": \"Vos données sont en sûreté, et vous maintenez une confidentialité maximale auprès de tous les établissements financiers.\",\n  \"HomePage.sellingpoint6.title\": \"En toute sécurité\",\n  \"HomePage.tagline1\": \"Mettez votre prêt hypothécaire aux enchères\",\n  \"HomePage.tagline2\": \"Tout simplement\",\n  \"HomePage.webapp.description\": \"Notre application vous accompagne du début jusqu'à la fin et s'adapte de façon intelligente à votre situation\",\n  \"HomePage.webapp.title\": \"Votre guide personnel\",\n  \"Info.title\": \"Mes Informations Personelles\",\n  \"InsuranceStrategy.description\": \"Vous avez décidé d'utiliser votre prévoyance pour ce projet. Il faut encore décider par quel mécanisme financier vous allez le faire.\",\n  \"InsuranceStrategy.title\": \"Stratégie de prévoyance\",\n  \"InterestRanges.title\": \"Vos Taux\",\n  \"LayoutError.description\": \"Quelque chose n'a pas fonctionné comme prévu, on en est déjà informés, et vous pouvez essayer de recharger la page.{verticalSpace}Si ça ne résoud pas le problème, écrivez-nous.\",\n  \"LayoutError.reload\": \"Recharger la page\",\n  \"LayoutError.title\": \"Woops une erreur!\",\n  \"LenderSummary.amount\": \"Montant prêté le plus élevé\",\n  \"LenderSummary.count\": \"Quantité\",\n  \"LenderSummary.monthly\": \"Coût mensuel le plus bas\",\n  \"LenderSummary.title\": \"Offres correspondant à vos critères\",\n  \"LenderTable.amount\": \"Montant prêté\",\n  \"LenderTable.conditions\": \"Conditions ?\",\n  \"LenderTable.monthly\": \"Coût mensuel\",\n  \"LenderTable.perMonth\": \"/mois\",\n  \"LoanSelector.addLoan\": \"Ajouter nouvelle demande\",\n  \"LoanStrategyPicker.description\": \"Il n'y a pas une seule stratégie parfaite pour structurer votre prêt, cependant, nous pouvons vous aiguiller dans la bonne direction grâce à notre savoir-faire.{verticalSpace}Sinon, utilisez notre outil interactif ci-dessous.\",\n  \"LoanStrategyPicker.disclaimer\": \"* Ce choix est indicatif, et vous permet de déterminer quelle stratégie vous conviendra le mieux.\",\n  \"LoanStrategyPicker.title\": \"Stratégie de taux\",\n  \"LoanTabs.actions\": \"Actes\",\n  \"LoanTabs.analytics\": \"Analytique\",\n  \"LoanTabs.borrowers\": \"Emprunteurs\",\n  \"LoanTabs.communication\": \"Communication\",\n  \"LoanTabs.files\": \"Documents\",\n  \"LoanTabs.forms\": \"Formulaires\",\n  \"LoanTabs.offers\": \"Offres des prêteurs\",\n  \"LoanTabs.overview\": \"Résumé\",\n  \"LoanTabs.property\": \"Propriété\",\n  \"LoanTabs.tasks\": \"Tâches\",\n  \"LoginForm.email\": \"Adresse e-mail\",\n  \"LoginForm.password\": \"Mot de passe\",\n  \"LoginPage.loggedIn\": \"Vous êtes connecté\",\n  \"LoginPage.title\": \"Login / Créer un compte\",\n  \"NewLoanModal.description\": \"Ça nous permettra de l'identifier\",\n  \"NewLoanModal.label\": \"Nom du projet\",\n  \"NewLoanModal.placeholder\": \"Rue du Pré 2\",\n  \"NewLoanModal.title\": \"Donnez un nom à votre projet, il sera visible par e-Potek.\",\n  \"NewUserOptions.description\": \"Vous pourrez monter votre dossier, lancer les enchères, et conclure votre demande de prêt depuis ici.\",\n  \"NewUserOptions.title\": \"Ça à l'air bien vide ici!\",\n  \"NotFound.button\": \"Retourner à la maison\",\n  \"NotFound.description\": \"On dirait que vous vous êtes perdu!\",\n  \"NotFound.title\": \"Oops..\",\n  \"offer.amortization\": \"Amortissement demandé\",\n  \"offer.interest1\": \"Taux 1 an\",\n  \"offer.interest10\": \"Taux 10 ans\",\n  \"offer.interest15\": \"Taux 15 ans\",\n  \"offer.interest2\": \"Taux 2 ans\",\n  \"offer.interest5\": \"Taux 5 ans\",\n  \"offer.interestLibor\": \"Taux Libor\",\n  \"offer.maxAmount\": \"Prêt maximal\",\n  \"offer.monthly\": \"Coût Mensuel\",\n  \"offer.rating\": \"Rating\",\n  \"OfferPickerPage.description\": \"Choisissez l'offre qui vous convient.\",\n  \"OfferPickerPage.title\": \"Les meilleures offres\",\n  \"OffersTable.amount\": \"Montant\",\n  \"OffersTable.conditions\": \"Conditions ?\",\n  \"OffersTable.libor\": \"Taux Libor\",\n  \"OffersTable.years\": \"{years, plural, one {Taux un an} other {Taux # ans}}\",\n  \"OfferToggle.counterpart\": \"Offres avec contrepartie ({count})\",\n  \"OfferToggle.counterpart-short\": \"Avec contrepartie\",\n  \"OfferToggle.standard\": \"Offres standard ({count})\",\n  \"OfferToggle.standard-short\": \"Standard\",\n  \"PasswordChange.change\": \"Changer\",\n  \"PasswordChange.dialogTitle\": \"Changer mon mot de passe\",\n  \"PasswordChange.oldPassword\": \"Ancien mot de passe\",\n  \"PasswordChange.password\": \"Nouveau mot de passe\",\n  \"PasswordChange.passwordRepeat\": \"Répéter mot de passe\",\n  \"PasswordLine.create\": \"Créer\",\n  \"PasswordLine.login\": \"Connexion\",\n  \"PasswordPage.button\": \"M'avertir du lancement\",\n  \"PasswordResetPage.confirmPassword\": \"Confirmer le mot de passe\",\n  \"PasswordResetPage.CTA\": \"Login\",\n  \"PasswordResetPage.password\": \"Votre nouveau mot de passe\",\n  \"PasswordResetPage.title\": \"Entrez votre nouveau mot de passe\",\n  \"ProcessPageBar.next\": \"Suivant\",\n  \"ProcessPageBar.nextStep\": \"Prochaine étape\",\n  \"ProcessPageBar.previous\": \"Précédent\",\n  \"ProjectBarChart.fees\": \"Frais\",\n  \"ProjectBarChart.property\": \"Propriété\",\n  \"ProjectBarChart.title\": \"Mon Projet\",\n  \"PropertyAdder.add\": \"Ajouter\",\n  \"PropertyPage.description\": \"Il nous faut des informations supplémentaires sur votre bien immobilier, nous pourrons alors mieux comprendre vos besoins, et vous indiquer si le prix du bien est conforme au marché.\",\n  \"PropertyPage.progress\": \"Progrès: {value, number, percent}\",\n  \"PropertyPage.title\": \"{count, plural, one {Mon bien immobilier} other {Notre bien immobilier}}\",\n  \"Recap.availableFunds\": \"Fonds propres dispo\",\n  \"Recap.bankFortune\": \"Fortune bancaire\",\n  \"Recap.borrowRatio\": \"Prêt / Prix d'achat\",\n  \"Recap.borrowRatio1\": \"Prêt / Prix d'achat\",\n  \"Recap.borrowRatio2\": \"Prêt / Valeur du bien\",\n  \"Recap.consideredBonus\": \"Bonus considéré\",\n  \"Recap.consideredIncome\": \"Revenus considérés\",\n  \"Recap.expenses\": \"Charges\",\n  \"Recap.financing\": \"Financement\",\n  \"Recap.finmaRules\": \"Règles FINMA\",\n  \"Recap.fortune\": \"Fortune\",\n  \"Recap.incomeRatio\": \"Charges / Revenus\",\n  \"Recap.insuranceFortune\": \"Fortune de prévoyance\",\n  \"Recap.interestedLenders\": \"Prêteurs intéressés\",\n  \"Recap.maxPurchasePrice\": \"Prix d'achat maximal\",\n  \"Recap.monthlyCost\": \"Charges estimées\",\n  \"Recap.netFortune\": \"Fortune Nette\",\n  \"Recap.otherIncome\": \"Autres Revenus\",\n  \"Recap.ownFundsCash\": \"Fonds Propres - Épargne\",\n  \"Recap.ownFundsInsurance\": \"Fonds Propres - LPP\",\n  \"Recap.ownFundsTotal\": \"Fonds Propres - Total\",\n  \"Recap.propAndWork\": \"Valeur du bien\",\n  \"Recap.propertyWork\": \"Travaux de plus-value\",\n  \"Recap.purchasePrice\": \"Prix d'achat\",\n  \"Recap.realEstate\": \"Biens immobiliers\",\n  \"Recap.realEstateLoans\": \"Emprunts actuels\",\n  \"Recap.receivedRent\": \"Loyer perçu\",\n  \"Recap.title\": \"Projet (en CHF)\",\n  \"Recap.totalCost\": \"Coût total du projet\",\n  \"Recap.totalFinancing\": \"Financement total\",\n  \"Search.placeholder\": \"Cherchez quelque chose..\",\n  \"SearchResults.none\": \"Aucun résultat\",\n  \"SideNavStepper.title\": \"PROGRESSION\",\n  \"SideNavUser.dashboard\": \"Tableau de Bord\",\n  \"SideNavUser.files\": \"Documents\",\n  \"Start1Page.chartTitle\": \"Charges estimées\",\n  \"Start1Page.CTA\": \"Passer au check-up complet\",\n  \"Start1Page.description\": \"Ce calculateur vous permet de rapidement savoir ce que vous pouvez acheter avant de faire une analyse de votre situation personnelle plus détaillée.{verticalSpace}Entre vos revenus, votre fortune ou la valeur du bien, ajoutez les valeurs que vous connaissez, puis nous calculerons automatiquement le reste pour optimiser votre capacité d'achat, tout en respectant les normes FINMA en vigueur en Suisse.\",\n  \"Start1Page.fortuneLabel\": \"Fonds Propres\",\n  \"Start1Page.incomeLabel\": \"Revenus annuels bruts\",\n  \"Start1Page.loanValue\": \"Votre Prêt Hypothécaire:\",\n  \"Start1Page.propertyLabel\": \"Prix d'achat\",\n  \"Start1Page.showCalculatorButton\": \"Démarrer\",\n  \"Start1Page.title\": \"Calculateur\",\n  \"Start1Recap.temporaryTitle\": \"Entrez une ou plusieurs valeurs et modifiez les à votre guise\",\n  \"Start1Validator.fortune\": \"Vous n'avez pas assez de fonds propres\",\n  \"Start1Validator.fortune2\": \"Essayez de réduire le prix d'achat\",\n  \"Start1Validator.fortuneTight\": \"Vos fonds propres sont faibles\",\n  \"Start1Validator.fortuneTight2\": \"Si vous voulez acquérir une résidence principale, vous pouvez combler le manque avec votre prévoyance\",\n  \"Start1Validator.income\": \"Vous n'avez pas assez de revenus\",\n  \"Start1Validator.income2\": \"N'hésitez pas a compter vos rentes, pensions, soustraire un loyer que vous n'aurez plus à payer\",\n  \"Start1Validator.incomeTight\": \"Vos revenus sont limite\",\n  \"Start1Validator.incomeTight2\": \"Peu de prêteurs pourront vous suivre, mais ça va fonctionner\",\n  \"Start1Validator.valid\": \"Tout est bon, continuez!\",\n  \"Start2Form.acceptedLoan\": \"Vous pouvez emprunter {value}.\",\n  \"Start2Form.age\": \"J'ai\",\n  \"Start2Form.age.placeholder\": \"18\",\n  \"Start2Form.age2\": \"ans.\",\n  \"Start2Form.bonus1\": \"Bonus 2014\",\n  \"Start2Form.bonus2\": \"Bonus 2015\",\n  \"Start2Form.bonus3\": \"Bonus 2016\",\n  \"Start2Form.bonus4\": \"Bonus 2017\",\n  \"Start2Form.bonusExists\": \"Avez vous touché un bonus lors des quatre dernières années ?\",\n  \"Start2Form.borrowerCount\": \"Combien êtes vous d'emprunteurs ?\",\n  \"Start2Form.expensesExists\": \"Avez-vous des charges annuelles comme des leasings, {optional}pensions, loyers, crédits personnels ou autres prêts immobiliers ?\",\n  \"Start2Form.finalized\": \"Vous-êtes arrivé au bout, formidable!\",\n  \"Start2Form.finalized.button\": \"Afficher les résultats\",\n  \"Start2Form.fortune\": \"Quelle est votre épargne bancaire personnelle (cash et titres) ?\",\n  \"Start2Form.fortuneRequiredAgreed\": \"Vous devrez donc mettre {value} de fonds propres.\",\n  \"Start2Form.fortuneSliders\": \"Vous devez donc mettre {value} de fonds propres, comment voulez-vous les répartir ?\",\n  \"Start2Form.fortuneSliders.hasToUseLpp\": \"Vous devez utiliser votre prévoyance pour ce projet\",\n  \"Start2Form.fortuneSliders.label1\": \"Épargne\",\n  \"Start2Form.fortuneSliders.label2\": \"Prévoyance\",\n  \"Start2Form.fortuneSliders.notHasToUseLpp\": \"Vous êtes éligible pour utiliser votre prévoyance\",\n  \"Start2Form.fortuneSliders.use\": \"Utiliser\",\n  \"Start2Form.gender\": \"Je suis\",\n  \"Start2Form.gender.F\": \"une femme\",\n  \"Start2Form.gender.M\": \"un homme\",\n  \"Start2Form.gender2\": \".\",\n  \"Start2Form.income\": \"Quel est votre salaire annuel brut ?\",\n  \"Start2Form.initialFortuneAgreed\": \"Vous avez indiqué que vous vouliez allouer {value} de fonds propres pour ce projet. Merci de détailler votre fortune maintenant.\",\n  \"Start2Form.initialIncomeAgreed\": \"Vous avez indiqué que vos revenus sont de {value} par an, vous pouvez les détailler maintenant.\",\n  \"Start2Form.insurance1\": \"Quels sont les fonds de prévoyance disponibles au sein de votre 2ème pilier ?\",\n  \"Start2Form.insurance1Exists\": \"Avez-vous un 2ème pilier ?\",\n  \"Start2Form.insurance2\": \"Quels sont les fonds de prévoyance disponibles au sein de votre 3ème pilier ?\",\n  \"Start2Form.insurance2Exists\": \"Avez-vous un 3ème pilier ?\",\n  \"Start2Form.insuranceConditions\": \"Il y a des conditions pour pouvoir utiliser sa prévoyance, est-ce que vous les passez ?\",\n  \"Start2Form.insuranceConditions.1\": \"Ne pas avoir fait de retrait dans les 5 dernières années\",\n  \"Start2Form.insuranceConditions.2\": \"Faire un retrait d'au moins 20 000 CHF\",\n  \"Start2Form.insuranceConditions.button\": \"Conditions\",\n  \"Start2Form.insuranceConditions.description\": \"Pour pouvoir utiliser votre prévoyance sur votre projet, vous devez remplir les conditions suivantes:\",\n  \"Start2Form.insuranceConditions.title\": \"Conditions\",\n  \"Start2Form.loanWanted\": \"Combien voulez-vous emprunter ?\",\n  \"Start2Form.loanWanted.sliderMax\": \"Max\",\n  \"Start2Form.loanWanted.sliderMin\": \"Min\",\n  \"Start2Form.notaryFeesAgreed\": \"À ce prix s'ajoutent les frais de notaire de {value}.\",\n  \"Start2Form.notEnoughCash\": \"Vous devez avoir au moins {value} de fortune (sans compter votre prévoyance) pour ce projet.\",\n  \"Start2Form.notEnoughCash.description\": \"Vous devez pouvoir couvrir au moins 10% du bien immobilier ainsi que les différents frais (~5%) avec votre épargne personelle. Il n'est malheureusement pas possible d'utiliser votre Prêt Hypothécaire pour payer les frais de notaire.\",\n  \"Start2Form.notEnoughCash.dialogTitle\": \"Manque d'épargne\",\n  \"Start2Form.notEnoughIncome\": \"Vous devez avoir un revenu annuel disponible d'au moins {value} pour couvrir les charges de votre bien, selon les règles FINMA.\",\n  \"Start2Form.notEnoughIncome.description\": \"Vous n'avez pas assez de revenus pour passer les critères de la FINMA, qui demande que la charge théorique de ce bien soit environ 3 fois plus petite que vos revenus totaux.{verticalSpace}Le calcul utilisé est sévère, et utilise en outre un taux d'intérêt théorique de 5%. Vérifiez que vous ayez compté tous les revenus que nous vous proposons d'ajouter, et vos éventuels bonus.\",\n  \"Start2Form.notEnoughIncome.dialogTitle\": \"Manque de revenus\",\n  \"Start2Form.notEnoughOwnFunds\": \"Vous devez avoir au moins {value} de fonds propres pour ce projet.\",\n  \"Start2Form.notEnoughOwnFunds.description\": \"Vous devez avoir au moins 20% de fonds propres engagés dans ce projet, sans oublier les frais de notaire qui doivent venir directement de votre épargne personelle, il n'est pas possible d'utiliser votre Prêt Hypothécaire ni votre prévoyance pour les payer.\",\n  \"Start2Form.notEnoughOwnFunds.dialogTitle\": \"Manque de fonds propres\",\n  \"Start2Form.oldestAge\": \"L'emprunteur le plus agé a\",\n  \"Start2Form.oldestAge.placeholder\": \"18\",\n  \"Start2Form.oldestAge2\": \"ans.\",\n  \"Start2Form.oldestGender\": \"Et cette personne est\",\n  \"Start2Form.otherIncomeExists\": \"Avez-vous d'autres sources de revenus annuels ?\",\n  \"Start2Form.projectAgreed\": \"Le coût de votre projet sera donc de {value}.\",\n  \"Start2Form.propertyRent\": \"J'estime que le loyer mensuel pour cette propriété sera\",\n  \"Start2Form.propertyValue\": \"Le prix d'achat de la propriété est de\",\n  \"Start2Form.propertyWork\": \"Les travaux de plus-value sont estimés à\",\n  \"Start2Form.propertyWorkExists\": \"Souhaitez-vous rajouter à votre projet des travaux de plus-value ?\",\n  \"Start2Form.realEstateExists\": \"Êtes-vous propriétaire d'autres biens immobiliers ?\",\n  \"Start2Form.usageType\": \"Quel sera le type d'utilisation de cette propriété ?\",\n  \"Start2Form.usageTypeButtonINVESTMENT\": \"Je veux le louer\",\n  \"Start2Form.usageTypeButtonPRIMARY\": \"Ma résidence principale\",\n  \"Start2Form.usageTypeButtonSECONDARY\": \"Ma résidence secondaire\",\n  \"Start2Form.useInsurance1\": \"Voulez-vous utiliser votre fortune de prévoyance sur ce projet ?\",\n  \"Start2Form.useInsurance1.description\": \"En Suisse, vous pouvez utiliser votre prévoyance en tant que fonds propres, pour autant que ce bien devienne votre résidence principale.{verticalSpace}Vous avez suffisamment d'épargne pour ne pas être obligé d'utiliser votre prévoyance, mais ça vous permettrait de garder plus de liquidités.\",\n  \"Start2Form.useInsurance1.dialogTitle\": \"Prévoyance en fonds propres\",\n  \"Start2Form.useInsurance2\": \"Vous devrez utiliser votre fortune de prévoyance pour ce projet\",\n  \"Start2Form.useInsurance2.description\": \"Vous n'avez pas suffisamment d'épargne personelle pour acquérir ce bien, heureusement vous pouvez utiliser votre prévoyance pour combler le manque.\",\n  \"Start2Form.whyButton\": \"Pourquoi ?\",\n  \"Start2Page.initialButton\": \"C'est parti\",\n  \"Start2Page.initialText1\": \"Allons vous obtenir ce prêt hypothécaire\",\n  \"Start2Page.initialText2\": \"Il nous faut plus d'informations pour mieux comprendre vos besoins, prenez deux minutes pour nous en dire un peu plus sur vous\",\n  \"Start2Page.recapTitle\": \"Votre Plan Financier\",\n  \"StartResult.countSuffix\": \" Prêteurs\",\n  \"StartResult.createAccount\": \"Créer un compte\",\n  \"StartResult.description1\": \"Vous êtes éligible pour e-Potek. Pour continuer votre demande de prêt, créez vous un compte et nous vous aiderons à préparer votre dossier pour mettre ces {count} prêteurs en compétition.\",\n  \"StartResult.description2\": \"Vous pouvez acquérir un bien immobilier d'une valeur maximale de {value}. Cliquez sur continuer pour affiner vos informations et avoir une estimation précise d'emprunt et de ce que ça va vous coûter.\",\n  \"StartResult.loan\": \"Votre Prêt Hypothécaire:\",\n  \"StartResult.maxLoan\": \"Prêt Hypothécaire maximal:\",\n  \"StartResult.title\": \"Résultat: {result}\",\n  \"StartSignUp.email\": \"Entrez votre adresse email\",\n  \"StartSignUp.notSignedUp\": \"Entrez votre nouveau mot de passe\",\n  \"StartSignUp.signedUp\": \"Cette adresse existe déjà, entrez votre mot de passe\",\n  \"steps.0.subtitle\": \"5 min\",\n  \"steps.0.title\": \"0. Passez le test\",\n  \"steps.1.subtitle\": \"15 minutes\",\n  \"steps.1.title\": \"1. Préparez votre dossier\",\n  \"steps.2.subtitle\": \"30 minutes\",\n  \"steps.2.title\": \"2. Trouvez votre prêteur\",\n  \"steps.3.subtitle\": \"60 minutes\",\n  \"steps.3.title\": \"3. Finalisez votre demande\",\n  \"steps.auction.subtitle\": \"2 jours\",\n  \"steps.auction.title\": \"Envoyez les enchères\",\n  \"steps.auction.waiting\": \"Enchères en cours...\",\n  \"steps.closing.subtitle\": \"30 min\",\n  \"steps.closing.title\": \"Décaissez votre emprunt\",\n  \"steps.contract.subtitle\": \"30 min\",\n  \"steps.contract.title\": \"Obtenez le contrat\",\n  \"steps.files.subtitle\": \"15 min\",\n  \"steps.files.title\": \"Uploadez vos documents\",\n  \"steps.finance.subtitle\": \"10 min\",\n  \"steps.finance.title\": \"Vérifiez vos finances\",\n  \"steps.lenderPicker.subtitle\": \"5 min\",\n  \"steps.lenderPicker.title\": \"Choisissez votre prêteur\",\n  \"steps.offerPicker.subtitle\": \"5 min\",\n  \"steps.offerPicker.title\": \"Choisissez votre prêteur\",\n  \"steps.personal.subtitle\": \"1 min\",\n  \"steps.personal.title\": \"Dites en plus sur vous\",\n  \"steps.property.subtitle\": \"4 min\",\n  \"steps.property.title\": \"Détaillez votre propriété\",\n  \"steps.strategy.subtitle\": \"15 min\",\n  \"steps.strategy.title\": \"Les grandes décisions\",\n  \"steps.structure.subtitle\": \"2h\",\n  \"steps.structure.title\": \"Structure finale\",\n  \"steps.verification.subtitle\": \"2h\",\n  \"steps.verification.title\": \"Vérification d'e-Potek\",\n  \"steps.verification.waiting\": \"Vérification demandée...\",\n  \"StrategyChoices.recommended\": \"Recommandé pour vous\",\n  \"StructureError.cash\": \"Vous n'avez pas assez d'épargne engagée dans ce projet\",\n  \"StructureError.income\": \"Vous n'avez pas assez de revenus pour couvrir les charges de votre projet\",\n  \"StructureError.ownFunds\": \"Il n'y a pas assez de fonds propres dans votre structure\",\n  \"StructureError.valid\": \"Votre structure est valide\",\n  \"StructurePage.CTA\": \"Confirmer la structure\",\n  \"StructurePage.description\": \"Vous pouvez ajuster la structure globale de votre projet une dernière fois, nous vous aiderons à la peaufiner.\",\n  \"Table.empty\": \"Rien à afficher\",\n  \"Table.sort\": \"Trier\",\n  \"TasksStatusDropdown.ACTIVE\": \"Actif\",\n  \"TasksStatusDropdown.CANCELLED\": \"Annulé\",\n  \"TasksStatusDropdown.COMPLETED\": \"Terminé\",\n  \"TasksTable.actions\": \"Actions\",\n  \"TasksTable.asignedTo\": \"Assigné à\",\n  \"TasksTable.completedAt\": \"Complété le\",\n  \"TasksTable.createdAt\": \"Créé le\",\n  \"TasksTable.dueAt\": \"Échéance\",\n  \"TasksTable.status\": \"Statut\",\n  \"TasksTable.updatedAt\": \"Modifié le\",\n  \"TasksTabs.allTasks\": \"Toutes les tâches\",\n  \"TasksTabs.myTasks\": \"Mes tâches\",\n  \"tooltip.bonus\": \"Tout revenu variable supplémentaire à votre salaire de base, lié à vos performances\",\n  \"tooltip.borrowers\": \"Les personnes financièrement et légalement bénéficiaires du prêt\",\n  \"tooltip.borrowRatio\": \"Ce ratio détermine combien est couvert par le prêt hypothécaire, il ne doit pas dépasser 80% dans la majorité des cas.\",\n  \"tooltip.consideredBonus\": \"Nous utilisons 50% de la moyenne de vos 3 meilleurs bonus.\",\n  \"tooltip.counterpartOffers\": \"Les meilleures offres des prêteurs, qui vous donnent un taux d'intérêt spécialement bas, en échange d'une contrepartie.\",\n  \"tooltip.expertise\": \"Vérification de la valeur du bien par rapport à son état et son emplacement\",\n  \"tooltip.finma\": \"Autorité fédérale de surveillance des marchés financiers\",\n  \"tooltip.incomeRatio\": \"Ce ratio indique combien de vos revenus vont théoriquement être utilisés pour payer les charges de votre bien. Il ne doit pas dépasser 33%, exceptions jusqu'à 38%.\",\n  \"tooltip.insuranceFees\": \"Lorsque vous retirez votre lpp en avance, vous devez payer des impôts sur ce retrait\",\n  \"tooltip.interestedLenders\": \"La quantité de prêteurs e-Potek dont les conditions correspondent à votre dossier\",\n  \"tooltip.lpp\": \"Aussi appelé 2ème pilier\",\n  \"tooltip.monthlyEstimated\": \"Avant les enchères d'e-Potek, cette estimation conservative sert d'indication\",\n  \"tooltip.notaryFees\": \"Frais obligatoires lorsqu'on conclut un prêt hypothécaire - environ 5% du prix d'achat\",\n  \"tooltip.offerTable.10\": \"Un taux d'intérêt qui arrive à échéance en 10 ans\",\n  \"tooltip.offerTable.2\": \"Un taux d'intérêt qui arrive à échéance en 2 ans\",\n  \"tooltip.offerTable.5\": \"Un taux d'intérêt qui arrive à échéance en 5 ans\",\n  \"tooltip.offerTable.amortization\": \"L'amortissement annuel minimum de l'emprunt demandé par la banque\",\n  \"tooltip.offerTable.amount\": \"Le montant maximal que la banque peut vous prêter\",\n  \"tooltip.offerTable.conditions\": \"Les conditions que vous devez remplir pour avoir accès à cette offre\",\n  \"tooltip.offerTable.expertise\": \"Indique si la banque veut faire une expertise supplémentaire, ajoute environ 2 semaines à la procédure\",\n  \"tooltip.offerTable.libor\": \"\\\"London Interbank Offered Rate\\\", c'est un type de taux d'intérêt parmi les plus bas mais aussi le plus volatile\",\n  \"tooltip.otherIncome\": \"Allocations, rentes, pensions, loyers, investissements, revenus de titres, ou autres activités\",\n  \"tooltip.ownFunds\": \"Vos économies, prévoyance et dons de tiers que vous allez engager dans le projet\",\n  \"tooltip.ownFundsRequired\": \"Les fonds propres nécessaires de votre part pour financer ce projet, y compris les frais de notaire\",\n  \"tooltip.propertyWork\": \"Agrandissements, rénovations ou améliorations du bien.\",\n  \"tooltip.purchasePrice\": \"La valeur du bien que vous voulez acquérir\",\n  \"tooltip.secondPillar\": \"Aussi appelé LPP\",\n  \"tooltip.standardOffers\": \"Les offres de base des banques.\",\n  \"tooltip.thirdPillar\": \"XXX\",\n  \"tooltip.usageType\": \"Les résidences principales permettent l'utilisation du 2ème pilier en tant que fonds propres\",\n  \"tooltip.yearlyIncome\": \"La somme de votre salaire, et toute autre source de revenus\",\n  \"tooltip2.consideredBonus\": \"Les bonus étant des montants variables, les banques ne les comptent pas à 100%.{verticalSpace}Si vous avez 4 bonus sur les années précédentes de 10, 20, 30 et 40 CHF, nous utiliserons 50% de la moyenne de 20, 30 et 40, soit 15 CHF.\",\n  \"tooltip2.finma\": \"La FINMA détermine quelles sont les conditions minimales pour que vous puissiez obtenir un prêt, pour vous protéger d'éventuelles remontées imprévues des taux hypothécaires.{verticalSpace}Les taux sont bas aujourd'hui, mais si vos finances ne sont pas assez solides et que les taux montent, vous pourriez avoir de sérieuses difficultés financières.\",\n  \"tooltip2.notaryFees\": \"Les frais de notaire sont compris d'une multitude de frais supplémentaires que vous devrez couvrir avec votre épargne, il est impossible d'utiliser sa prévoyance ou son prêt hypothécaire pour les payer. \",\n  \"tooltip2.propertyWork\": \"Ces travaux sont une bonne façon d'augmenter la valeur de votre bien, sans augmenter les frais de notaire.\",\n  \"TopNav.login\": \"Login\",\n  \"TopNavDropdown.account\": \"Mon Compte\",\n  \"TopNavDropdown.admin\": \"Admin Dashboard\",\n  \"TopNavDropdown.app\": \"App\",\n  \"TopNavDropdown.dashboard\": \"Tableau de Bord\",\n  \"TopNavDropdown.dev\": \"< dev />\",\n  \"TopNavDropdown.logout\": \"Déconnexion\",\n  \"TopNavDropdown.partner\": \"Partner Dashboard\",\n  \"TosPage.description\": \"<En Développement />\",\n  \"TosPage.title\": \"Termes et Conditions\",\n  \"Tranche.tranche\": \"Tranche\",\n  \"TrancheChart.rest\": \"Montant restant à attribuer\",\n  \"TrancheChart.value\": \"Montant\",\n  \"TrancheCount.add\": \"Ajouter\",\n  \"TrancheCount.description\": \"Nombre de tranches:\",\n  \"TranchePicker.add\": \"+ Ajouter une tranche\",\n  \"Uploader.fileCount\": \"{count, plural, =0 {Pas de fichiers} one {Un fichier} other {# fichiers}}\",\n  \"ValidatorItem.error.fortune\": \"Manque de fortune\",\n  \"ValidatorItem.error.fortuneTight\": \"Possible avec prévoyance\",\n  \"ValidatorItem.error.income\": \"Manque de revenus\",\n  \"ValidatorItem.error.incomeTight\": \"Revenus limite limite\",\n  \"ValidatorItem.isValid\": \"Acquisition possible!\",\n  \"VerificationPage.CTA\": \"Envoyer mon dossier\",\n  \"VerificationPage.CTA.warning\": \"Vous ne pourrez plus modifier vos informations et vos documents\",\n  \"VerificationPage.CTA2\": \"Re-Vérifier\",\n  \"VerificationPage.description\": \"Votre dossier va être analysé en détail par les professionels d'e-Potek, et votre conseiller vous aidera pour préparer la meilleure demande possible.\",\n  \"VerificationPage.failedDescription\": \"Votre expert a vérifié votre dossier, et y a trouvé une faille. Veuillez addresser les points ci-dessous puis demander une re-vérification.{verticalSpace}N'hésitez pas à appeler votre expert en cas de doute.\",\n  \"VerificationPage.failedTitle\": \"Il y a eu un petit souci\",\n  \"VerificationPage.successDescription\": \"Les informations que vous nous avez confiées nous ont permis de vérifier l'intégrité et la qualité de votre demande de prêt.\",\n  \"VerificationPage.successTitle\": \"Votre dossier est valide!\",\n  \"VerificationRequested.description\": \"Vérification en cours, vous serez averti par email lorsque c'est fait.\",\n  \"ZipAutoComplete.empty\": \"Pas de résultat\"\n};\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}}},\"startup\":{\"server\":{\"index.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/startup/server/index.js                                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _Inject = void 0;\n\nmodule.watch(require(\"meteor/meteorhacks:inject-initial\"), {\n  Inject: function Inject(v) {\n    _Inject = v;\n  }\n}, 1);\nmodule.watch(require(\"../../core/fixtures\"));\nmodule.watch(require(\"../../core/api/api\"));\nmodule.watch(require(\"../../core/api/api-server\"));\nvar jc = void 0;\nmodule.watch(require(\"../../core/api/jobs/server\"), {\n  default: function _default(v) {\n    jc = v;\n  }\n}, 2);\nmodule.watch(require(\"../../core/api/links\"));\nmodule.watch(require(\"../accounts-config\"));\n\n_Meteor.startup(function () {\n  // Do something on startup if necessary\n  // Add password protection\n  // if (Meteor.settings.public.environment === 'staging') {\n  //   setupAuth();\n  // }\n  jc.startJobServer();\n}); // Inject a loader before client is ready, is removed in the on startup function on the client\n\n\n_Inject.rawHead('loader', Assets.getText('loader.html')); // Make sure this is passed a function, so that it gets random strings for\n// every client, instead of once on server-startup\n// FIXME: This gets picked up by google crawlers..! Very bad\n// Inject.rawHead('loadingText', getHtml);\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"accounts-config.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/startup/accounts-config.js                                                                                  //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\nvar AccountsUI = void 0;\nmodule.watch(require(\"meteor/std:accounts-ui\"), {\n  Accounts: function Accounts(v) {\n    AccountsUI = v;\n  }\n}, 1);\n\nvar _Accounts = void 0;\n\nmodule.watch(require(\"meteor/accounts-base\"), {\n  Accounts: function Accounts(v) {\n    _Accounts = v;\n  }\n}, 2);\n\nvar _Roles = void 0;\n\nmodule.watch(require(\"meteor/alanning:roles\"), {\n  Roles: function Roles(v) {\n    _Roles = v;\n  }\n}, 3);\nAccountsUI.ui.config({\n  passwordSignupFields: 'EMAIL_ONLY',\n  loginPath: '/login',\n  homeRoutePath: '/',\n  profilePath: '/',\n  minimumPasswordLength: 1\n}); // Accounts.onCreateUser((options, user) => {\n//   const newUser = user;\n//   newUser.roles = 'user';\n//   return newUser;\n// });\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}}},\"wallaby-admin.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// wallaby-admin.js                                                                                                    //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nvar setWallabyConfig = require('./imports/core/utils/testHelpers/wallaby/wallabyDefaults');\n\nmodule.exports = setWallabyConfig('e-Potek admin tests - Client');\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"server\":{\"main.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// server/main.js                                                                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\"use strict\";\n\nmodule.watch(require(\"./../imports/startup/server\"));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}}},{\n  \"extensions\": [\n    \".js\",\n    \".json\",\n    \".jsx\"\n  ]\n});\nrequire(\"./wallaby-admin.js\");\nrequire(\"./server/main.js\");","servePath":"/app.js","sourceMap":{"version":3,"sources":["imports/core/api/adminActions/server/methods.js","imports/core/api/adminActions/server/publications.js","imports/core/api/adminActions/adminActionConstants.js","imports/core/api/adminActions/adminActions.js","imports/core/api/adminActions/index.js","imports/core/api/borrowers/queries/borrowerAssignedTo.expose.js","imports/core/api/borrowers/queries/borrowerAssignedTo.js","imports/core/api/borrowers/queries/borrowersList.expose.js","imports/core/api/borrowers/queries/borrowersList.js","imports/core/api/borrowers/queries/exposures.js","imports/core/api/borrowers/server/methods.js","imports/core/api/borrowers/server/mutations.js","imports/core/api/borrowers/server/publications.js","imports/core/api/borrowers/BorrowerService.js","imports/core/api/borrowers/borrowerConstants.js","imports/core/api/borrowers/borrowers.js","imports/core/api/borrowers/index.js","imports/core/api/borrowers/links.js","imports/core/api/borrowers/mutationDefinitions.js","imports/core/api/comparators/server/methods.js","imports/core/api/comparators/server/publications.js","imports/core/api/comparators/comparators.js","imports/core/api/comparators/index.js","imports/core/api/email/server/EmailService.js","imports/core/api/email/server/accountsEmails.js","imports/core/api/email/server/email-methods.js","imports/core/api/email/server/emailConfigs.js","imports/core/api/email/server/emailHelpers.js","imports/core/api/email/server/emailListeners.js","imports/core/api/email/server/emailMethods.js","imports/core/api/email/server/index.js","imports/core/api/email/server/mandrill.js","imports/core/api/email/emailConstants.js","imports/core/api/files/server/methods.js","imports/core/api/files/fileConstants.js","imports/core/api/files/files.js","imports/core/api/files/meteor-slingshot-server.js","imports/core/api/files/meteor-slingshot.js","imports/core/api/jobs/server/JobService.js","imports/core/api/jobs/server/index.js","imports/core/api/jobs/server/jobConstants.js","imports/core/api/jobs/server/jobListeners.js","imports/core/api/jobs/server/jobs.js","imports/core/api/loans/queries/adminLoanView.expose.js","imports/core/api/loans/queries/adminLoanView.js","imports/core/api/loans/queries/adminLoansList.expose.js","imports/core/api/loans/queries/adminLoansList.js","imports/core/api/loans/queries/exposures.js","imports/core/api/loans/server/methods.js","imports/core/api/loans/server/mutations.js","imports/core/api/loans/server/publications.js","imports/core/api/loans/LoanService.js","imports/core/api/loans/additionalSchemas.js","imports/core/api/loans/index.js","imports/core/api/loans/links.js","imports/core/api/loans/loanConstants.js","imports/core/api/loans/loans.js","imports/core/api/loans/mutationDefinitions.js","imports/core/api/loans/pdf.js","imports/core/api/methods/server/compoundMethods.js","imports/core/api/methods/server/createUserAndLoan.js","imports/core/api/methods/server/index.js","imports/core/api/methods/server/miscellaneous.js","imports/core/api/mutations/server/index.js","imports/core/api/mutations/callMutation.js","imports/core/api/mutations/createMutator.js","imports/core/api/mutations/index.js","imports/core/api/offers/server/methods.js","imports/core/api/offers/server/mutations.js","imports/core/api/offers/server/publications.js","imports/core/api/offers/OfferService.js","imports/core/api/offers/fakes.js","imports/core/api/offers/index.js","imports/core/api/offers/mutationDefinitions.js","imports/core/api/offers/offerConstants.js","imports/core/api/offers/offers.js","imports/core/api/properties/queries/exposures.js","imports/core/api/properties/queries/propertyAsignee.expose.js","imports/core/api/properties/queries/propertyAsignee.js","imports/core/api/properties/server/methods.js","imports/core/api/properties/server/mutations.js","imports/core/api/properties/server/publications.js","imports/core/api/properties/PropertyService.js","imports/core/api/properties/index.js","imports/core/api/properties/links.js","imports/core/api/properties/mutationDefinitions.js","imports/core/api/properties/properties.js","imports/core/api/properties/propertyConstants.js","imports/core/api/security/collections/BorrowerSecurity.js","imports/core/api/security/collections/LoanSecurity.js","imports/core/api/security/collections/OfferSecurity.js","imports/core/api/security/collections/PropertySecurity.js","imports/core/api/security/collections/TaskSecurity.js","imports/core/api/security/collections/index.js","imports/core/api/security/Security.js","imports/core/api/security/index.js","imports/core/api/tasks/queries/exposures.js","imports/core/api/tasks/queries/tasksList.expose.js","imports/core/api/tasks/queries/tasksList.js","imports/core/api/tasks/server/mutations.js","imports/core/api/tasks/server/taskListeners.js","imports/core/api/tasks/TaskService.js","imports/core/api/tasks/index.js","imports/core/api/tasks/links.js","imports/core/api/tasks/mutationDefinitions.js","imports/core/api/tasks/tasks.js","imports/core/api/tasks/tasksConstants.js","imports/core/api/users/queries/adminUserView.expose.js","imports/core/api/users/queries/adminUserView.js","imports/core/api/users/queries/adminUsersList.expose.js","imports/core/api/users/queries/adminUsersList.js","imports/core/api/users/queries/admins.expose.js","imports/core/api/users/queries/admins.js","imports/core/api/users/queries/exposures.js","imports/core/api/users/server/accounts-server-config.js","imports/core/api/users/server/mutations.js","imports/core/api/users/server/publications.js","imports/core/api/users/UserService.js","imports/core/api/users/index.js","imports/core/api/users/links.js","imports/core/api/users/mutationDefinitions.js","imports/core/api/users/userConstants.js","imports/core/api/users/users.js","imports/core/api/events/EventService.js","imports/core/api/events/index.js","imports/core/api/events/registerListeners.js","imports/core/api/api-server.js","imports/core/api/api.js","imports/core/api/cleanMethods.js","imports/core/api/constants.js","imports/core/api/factories.js","imports/core/api/index.js","imports/core/api/links.js","imports/core/utils/testHelpers/wallaby/wallabyDefaults.js","imports/core/utils/logismata/api.js","imports/core/utils/logismata/api_key.js","imports/core/utils/logismata/constants.js","imports/core/utils/logismata/methods.js","imports/core/utils/analytics.js","imports/core/utils/borrowerFunctions.js","imports/core/utils/browserFunctions.js","imports/core/utils/finance-math.js","imports/core/utils/general.js","imports/core/utils/generate-pdf.js","imports/core/utils/intl.js","imports/core/utils/loadable.js","imports/core/utils/loanFunctions.js","imports/core/utils/localization.js","imports/core/utils/rate-limit.js","imports/core/utils/saveStartForm.js","imports/core/arrays/BorrowerFormArray.js","imports/core/arrays/PropertyFormArray.js","imports/core/arrays/steps.js","imports/core/components/Loading.jsx","imports/core/config/constants.js","imports/core/fixtures/borrowers.js","imports/core/fixtures/config.js","imports/core/fixtures/index.js","imports/core/fixtures/loans.js","imports/core/fixtures/methods.js","imports/core/fixtures/offers.js","imports/core/fixtures/properties.js","imports/core/fixtures/tasks.js","imports/core/fixtures/users.js","imports/startup/server/index.js","imports/startup/accounts-config.js","wallaby-admin.js","server/main.js"],"names":["module","export","insertAdminAction","completeAction","completeActionByType","removeParentLoan","Meteor","watch","require","v","ValidatedMethod","Roles","check","Match","CallPromiseMixin","rateLimit","default","AdminActions","ADMIN_ACTION_STATUS","name","mixins","validate","loanId","type","String","run","existingAction","findOne","status","ACTIVE","Error","insert","id","action","COMPLETED","update","$set","completedAt","Date","newStatus","Optional","_id","PARENT_DELETED","multi","methods","publish","userIsInRole","userId","find","ready","ADMIN_ACTION_TYPE","VERIFY","AUCTION","LENDER_CHOSEN","CANCELLED","Mongo","SimpleSchema","Collection","deny","remove","allow","AdminActionSchema","createdAt","autoValue","isInsert","defaultValue","allowedValues","Object","values","optional","staffId","extra","blackbox","notes","attachSchema","exportDefault","exports","Security","query","expose","firewall","checkCurrentUserIsAdmin","Borrowers","BORROWER_QUERIES","createQuery","BORROWER_ASSIGNED_TO","$filter","filters","params","assignedTo","ADMIN_BORROWERS","$options","sort","firstName","lastName","updatedAt","insertBorrower","updateBorrower","pushBorrowerValue","popBorrowerValue","deleteBorrower","object","undefined","$push","$pop","getAutoValues","SecurityService","createMutator","BorrowerService","defs","BORROWER_INSERT","borrower","userIdIsDefined","borrowers","isAllowedToInsert","BORROWER_UPDATE","borrowerId","isAllowedToUpdate","BORROWER_DELETE","isAllowedToDelete","borrowerIds","$in","_class","pushValue","RESIDENCY_PERMIT","GENDER","CIVIL_STATUS","OTHER_FORTUNE","OTHER_INCOME","EXPENSES","REAL_ESTATE","B","C","CI","F","G","L","N","S","NONE","M","OTHER","MARRIED","SINGLE","PACSED","DIVORCED","ART","CARS","BOATS","AIRPLANES","JEWELRY","WELFARE","PENSION","RENT","INVESTMENT","LEASING","PERSONAL_LOAN","MORTGAGE_LOAN","PENSIONS","PRIMARY","SECONDARY","BorrowerSchema","getFileSchema","BorrowerFilesSchema","LogicSchema","financeEthics","Boolean","hasValidatedFinances","adminValidated","doc","docId","fields","isUpdate","gender","age","Integer","min","max","address1","address2","zipCode","Number","city","sameAddress","isSwiss","residencyPermit","birthDate","regEx","birthPlace","citizenship","isUSPerson","civilStatus","childrenCount","company","worksForOwnCompany","salary","bonusExists","bonus","otherIncome","Array","otherFortune","expenses","bankFortune","realEstate","personalBank","corporateBankExists","corporateBank","insuranceSecondPillar","insuranceThirdPillar","insurance3B","files","logic","admin","adminValidation","borrowerMutations","mutationDefinitions","Users","addLinks","asignee","field","collection","insertComparator","updateComparator","addComparatorField","removeComparatorField","toggleHiddenField","Comparators","userComparators","count","comparator","$inc","customFieldCount","customFields","fieldId","$pull","hiddenFields","indexOf","ComparatorSchema","useBorrowers","income","fortune","interestRate","borrowRatio","usageType","emailConfigs","getEmailContent","getEmailPart","sendMandrillTemplate","getMandrillTemplate","getSimpleMandrillTemplate","renderMandrillTemplate","FROM_NAME","FROM_EMAIL","EmailService","sendEmail","emailId","address","templateOptions","createTemplateOptions","template","getTemplate","isDevelopment","isTest","emailLogger","sendEmailToUser","user","users","emailAddress","emails","sendEmailToLoggedInUser","getEmailConfig","emailConfig","mandrillId","createIntlValues","intlValues","emailContent","createOverrides","variables","allowUnsubscribe","templateName","recipientAddress","senderAddress","senderName","subject","sendAt","getAccountsTemplate","part","renderTemplate","result","error","reason","message","console","log","JSON","stringify","Accounts","FROM_DEFAULT","EMAIL_IDS","EMAIL_PARTS","emailTemplates","siteName","from","verifyEmail","VERIFY_EMAIL","SUBJECT","html","url","data","resetPassword","RESET_PASSWORD","enrollAccount","ENROLL_ACCOUNT","EMAIL_TEMPLATES","CTA_URL_DEFAULT","getEnrollmentUrl","notificationTemplateDefaultOverride","notificationAndCtaTemplateDefaultOverride","emailDefaults","addEmailConfig","config","NOTIFICATION","NOTIFICATION_AND_CTA","verifyConfig","WELCOME","urlWithoutHash","replace","VERIFICATION_URL","content","title","body","cta","TITLE","BODY","CTA","CTA_URL","enrollUrl","VERIFICATION_REQUESTED","VERIFICATION_ERROR","VERIFICATION_PASSED","AUCTION_STARTED","auctionEndTime","date","AUCTION_ENDED","AUCTION_CANCELLED","getEmailFooter","formatMessage","EMAIL_I18N_NAMESPACE","WWW_URL","settings","public","subdomains","www","APP_URL","app","copyright","unsubscribe","intlFallback","verticalSpace","customFrom","FROM","roles","enrollToken","split","moment","EventService","mutations","Loans","getAuctionEndTime","addMutationListener","REQUEST_LOAN_VERIFICATION","START_AUCTION","END_AUCTION","CANCEL_AUCTION","SEND_EMAIL","unblock","call","setupMandrill","Mandrill","key","MANDRILL_API_KEY_TEST","MANDRILL_API_KEY","username","MANDRILL_LOGIN","port","host","options","template_name","template_content","merge_vars","from_email","from_name","to","email","rcpt","vars","send_at","toISOString","templates","render","mandrillTemplate","Promise","resolve","reject","messages","sendTemplate","parse","isAllowed","AWS","keyId","loanFound","borrowerFound","setupS3","accessKeyId","secretAccessKey","secretAccesskey","S3","signatureVersion","deleteFile","s3","Bucket","S3Bucket","Key","async","wrapAsync","deleteObject","bind","downloadFile","parameters","callback","getObject","FILE_STATUS","UNVERIFIED","VALID","ERROR","borrowerFiles","loanFiles","propertyFiles","getFileIDs","FileSchema","fakeFile","getFileCount","PURCHASE_TYPE","USAGE_TYPE","b","auction","condition","keys","length","noTooltips","contract","doubleTooltip","fortuneChange","closing","all","r","tooltipSuffix","general","purchaseType","propertyId","isCoproperty","isNew","other","property","loan","style","ACQUISITION","required","list","ids","forEach","push","f","initialName","size","RegEx","Url","fileCount","schema","arr","maxCount","currentValue","fileCountString","Math","map","Slingshot","createDirective","S3Storage","authorize","file","allowedFileTypes","maxSize","fileRestrictions","Job","Jobs","SCHEDULE_METHOD","JobService","scheduleMethod","method","jobId","after","save","scheduleMutation","mutation","cancelJob","cancelJobs","removeJob","removeJobs","cancelExistingJob","job","cancelExistingMutationJob","CANCEL_JOB","REMOVE_JOB","JobCollection","jobList","pollInterval","err","jobObject","processJobs","done","fail","LOAN_QUERIES","ADMIN_LOAN","value","propertyWork","investmentRent","constructionYear","renovationYear","insideArea","landArea","balconyArea","terraceArea","roomCount","bathroomCount","toiletCount","volume","volumeNorm","parking","minergie","copropertyPercentage","cityPlacementQuality","buildingPlacementQuality","buildingQuality","flatQuality","materialsQuality","otherNotes","pictures","latitude","longitude","nearestBusStation","nearestTrainStation","tasks","dueAt","assignedUser","ADMIN_LOANS","insertLoan","updateLoan","incrementStep","startAuction","pushLoanValue","popLoanValue","loanVerification","deleteLoan","endAuction","cancelAuction","confirmClosing","addEmail","modifyEmail","LOAN_STATUS","AUCTION_STATUS","importServerMethods","isServer","isSimulation","rescheduleJob","cancelScheduledEmail","rescheduleEmail","currentStep","step","isDemo","add","toDate","auctionObject","STARTED","callPromise","then","catch","e","verification","requested","ENDED","scheduledAt","DONE","LoanService","LOAN_INSERT","loans","LOAN_UPDATE","LOAN_DELETE","delete","INCREMENT_LOAN_STEP","askVerification","CONFIRM_CLOSING","partnerVisibleFields","$and","profile","cantons","$or","$ne","organization","LoanServiceModel","GeneralSchema","INTEREST_RATES","OWNER","CANTONS","OFFER_TYPE","CLOSING_STEPS_TYPE","CLOSING_STEPS_STATUS","AUCTION_MOST_IMPORTANT","INSURANCE_USE_PRESET","LOAN_STRATEGY_PRESET","AMORTIZATION_STRATEGY_PRESET","PAYMENT_SCHEDULES","fortuneUsed","insuranceFortuneUsed","oldestAge","oldestGender","partnersToAvoidExists","partnersToAvoid","selectedPartner","canton","loanTranches","LIBOR","currentOwner","FIRST","futureOwner","otherOwner","wantedClosingDate","auctionMostImportant","expertiseRequired","expertiseDone","expertiseValid","hasValidatedStructure","insuranceUsePreset","loanStrategyPreset","amortizationStrategyPreset","lender","acceptedClosing","recommendationCode","firstPaymentDate","paymentSchedule","closingSteps","loanMutations","Properties","Tasks","inversedBy","REFINANCING","CONSTRUCTION","AG","AR","AI","BL","BS","BE","FR","GE","GL","GR","JU","LU","NE","NW","OW","SG","SH","SZ","SO","TG","TI","UR","VD","VS","ZG","ZH","YEARS_1","YEARS_2","YEARS_5","YEARS_10","YEARS_15","SECOND","BOTH","TODO","UPLOAD","SPEED","PRICE","NOTHING","WITHDRAWAL","COLLATERAL","FIXED","MANUAL","INDIRECT","DIRECT","MONTHLY","YEARLY","SEMESTERLY","ASSIGNED_TO","PropertySchema","LoanFilesSchema","LoanSchema","AnonymousLoanPDF","LoanPDF","React","InlineCss","setUserToLoan","addBorrower","newBorrowerId","removeBorrower","saveStartForm","addUserTracking","createUserAndLoan","formState","newUserId","createUser","sendEnrollmentEmail","makeNsSetter","downloadPDF","generateComponentAsPDF","getServerTime","getMixpanelAuthorization","btoa","API_KEY","MIXPANEL_API_KEY","API_SECRET","MIXPANEL_API_SECRET","prefix","fileName","component","props","module1","Bert","checkParams","handleError","mutationName","isClient","defaults","hideDelay","alert","callMutation","mutationOptions","callParams","beforeLogger","afterLogger","validateMutationOptions","INVALID_MUTATION_OPTIONS","MUTATION_ERROR","callParameters","param","reduce","matchPattern","functionBody","emitMutation","userMutations","offerMutations","propertyMutations","taskMutations","insertOffer","insertAdminOffer","updateOffer","insertFakeOffer","deleteOffer","Offers","offer","endTime","isAdmin","OfferService","OFFER_INSERT","offers","OFFER_INSERT_ADMIN","checkLoggedIn","currentUserIsAdmin","OFFER_UPDATE","offerId","OFFER_DELETE","activeLoan","active","IDs","getRandomOffer","getLoanValue","getPropAndWork","getRandomCondition","conditions","floor","random","getRandomCounterpart","counterparts","round","rand","matchLoanWanted","rate1","rate2","loanWanted","maxAmoutLimited","counterpart","standardOffer","maxAmount","amortization","interestLibor","interest1","interest2","interest5","interest10","counterpartOffer","STANDARD","COUNTERPARTS","OfferSchema","singleOffer","interestKey","Property","PROPERTY_QUERIES","PROPERTY_ASSIGNED_TO","insertProperty","deleteProperty","updateProperty","pushPropertyValue","popPropertyValue","setPropertyField","PropertyService","PROPERTY_INSERT","properties","PROPERTY_UPDATE","PROPERTY_DELETE","propertyIds","popValue","PROPERTY_STATUS","PROPERTY_STYLE","VOLUME_NORM","PropertyFilesSchema","FOR_SALE","FLAT","SIA","EXPERTISE_RATING","SOLD","VILLA","BorrowerSecurity","checkOwnership","LoanSecurity","OfferSecurity","PropertySecurity","TaskSecurity","SECURITY_ERROR","ROLES","role","hasRole","handleUnauthorized","ADMIN","DEV","TASK_QUERIES","TASKS","$paginate","TaskService","TASK_INSERT","TASK_UPDATE","taskId","task","TASK_COMPLETE","complete","TASK_COMPLETE_BY_TYPE","completeByType","TASK_CHANGE_STATUS","changeStatus","TASK_CHANGE_USER","newUser","changeUser","USER_EVENTS","TASK_TYPE","ASSIGN_ADMIN_TO_USER","adminId","assignAllTasksToAdmin","addListener","USER_CREATED","ADD_ASSIGNED_TO","TASK_STATUS","createdBy","existingTask","taskToComplete","changeAssignedTo","newAssignee","TasksSchema","description","CUSTOM","USER_QUERIES","ADMIN_USER","ADMIN_USERS","ADMINS","onCreateUser","forbidClientAccountCreation","UserService","DOES_USER_EXIST","findUserByEmail","SEND_VERIFICATION_LINK","sendVerificationEmail","assignAdminToUser","addUsersToRoles","emit","getAdmins","fetch","USER","LENDER","UserSchema","Email","services","heartbeat","EventEmitter","IS_LOGGING","emmitter","addErrorListener","eventName","logEmittedEvent","listenerFunction","logListener","defaultEmmitter","_ensureIndex","handleResult","bertObject","delay","cleanMethod","Factory","TEST_EMAIL","define","verified","constants","_constants","packageStubs","src","setWallabyConfig","overrides","setupWallaby","wallaby","testFramework","tests","compilers","babel","presets","plugins","env","setup","global","IS_WALLABY","handleResponse","getAuthToken","setToken","convertParamsToLogismata","convertToLogismataTaxBase","getParamsArray","getTaxBase","callApi","getLocationId","getIndirectAmortization","getDirectAmortization","_","logismataValues","token","response","json","authUrl","testKey","authToken","newParams","newValue","findKey","val","taxBase","children","civil","confession","gross_fortune","grossFortune","gross_income","grossIncome","income_type","incomeBase","locationid","locationId","sex","logismataParams","search","language","country","isEmployee","amortization_goal","amortizationGoal","duration","has_detailed_amortization","isDetailed","rental_value","rentalValue","maintenance_costs","maintenanceCosts","mortgages","new_mortgages","newMortgages","saving_type","savingType","saving_interestrate","savingRate","saving_amount_manual","saving_amount","savingAmount","i","calcUrl","headers","Accept","api_key","calcUrl2","mortgageType","existingOrNew","getLogismataToken","allowTracking","trackOncePerSession","analytics","storageAvailable","metadata","identify","track","localId","localTracked","sessionStorage","getItem","setItem","getFortune","getInsuranceFortune","getBorrowerCompletion","getBonusIncome","getArrayValues","getOtherIncome","getExpenses","getBorrowerIncome","getTotalFortune","getRealEstateFortune","getRealEstateValue","getRealEstateDebt","getBorrowerSalary","personalInfoPercent","filesPercent","arrayify","array","tot","total","sum","mapFunc","t","getWidth","isWww","isApp","isLender","easeOut","window","w","d","document","documentElement","getElementsByTagName","innerWidth","clientWidth","getSubdomain","fullPath","location","storage","x","removeItem","intervals","diff","difference","curve","pow","getYearsToRetirement","getAmortization","getInterests","getMonthlyPayment","getTheoreticalMonthly","getIncomeRatio","canAffordRank1","getMaintenance","getFees","age1","age2","gender1","gender2","retirement1","retirement2","toRetirement1","toRetirement2","yearsToRetirement","loanValue","propAndWork","safeBorrowers","loanPercent","yearlyAmortization","remainingYears","amountToAmortize","years","rate","interests","maintenance","monthlyPayment","borrowerIncome","totalFortune","insuranceFortune","fortuneRequired","notaryFees","isArray","ReactDOMServer","pdf","fs","thisModule","getBase64String","path","readFileSync","Buffer","toString","exception","generatePDF","create","format","border","top","right","bottom","left","toFile","base64","filename","unlink","getComponentAsHTML","renderToStaticMarkup","handler","promise","IntlMessageFormat","getUserLocale","getFormats","messagesFR","customFallback","MyLoadable","Loadable","LoadingComponent","loading","getProjectValue","loanStrategySuccess","strategiesChosen","getInterestsWithOffer","getMonthlyWithOffer","getMonthlyWithExtractedOffer","getTotalUsed","getBorrowRatio","getLenderCount","disableForms","isLoanValid","getPropertyCompletion","validateRatios","validateRatiosCompletely","strategyDone","propertyPercent","lppFees","roundedTo10000","isInteger","trancheSum","tranche","hasValidatedCashStrategy","isStandard","tranches","interestRates","every","maintenanceReal","incomeRatio","validated","insuranceFees","fees","cashRequired","minCash","formsProgress","filesProgress","allowInsurance","borrowRatioWanted","incomeRatioSafe","borrowRatioSafe","isValid","message2","icon","className","isTight","startTime","time","isoWeekday","hour","hours","minutes","seconds","milliseconds","localizationStartup","addLocaleData","T9n","fr","number","money","currency","maximumFractionDigits","minimumFractionDigits","moneyWithoutCurrency","useGrouping","percentage","percentageRounded","setLanguage","setupMoment","locale","months","monthsShort","monthsParseExact","weekdays","weekdaysShort","weekdaysMin","weekdaysParseExact","longDateFormat","LT","LTS","LL","LLL","LLLL","calendar","sameDay","nextDay","nextWeek","lastDay","lastWeek","sameElse","relativeTime","future","past","s","m","mm","h","hh","dd","MM","y","yy","dayOfMonthOrdinalParse","ordinal","meridiemParse","isPM","input","charAt","meridiem","isLower","week","dow","doy","DDPRateLimiter","fetchMethodNames","pluck","assignLimits","limit","timeRange","methodNames","addRule","contains","connectionId","multiple","borrowerCount","borrowerOne","income1","bonus2014","bonus11","bonus2015","bonus21","bonus2016","bonus31","bonus2017","bonus41","fortune1","insurance11","insurance21","borrowerTwo","income2","bonus12","bonus22","bonus32","bonus42","fortune2","insurance12","insurance22","propertyValue","propertyRent","id1","id2","warn","getBorrowerInfoArray","getBorrowerFinanceArray","isFirst","disableAddress","ignore","disabled","placeholder","noIntl","componentProps","savePath","initialValue","conditionalTrueValue","inputs","saveOnChange","autoComplete","borr","incomeArray","year","fortuneArray","insuranceArray","concat","getPropertyLoanArray","getPropertyArray","mapInput","intlSafeObject","intlId","slice","join","obj","filter","isSecond","info","decimal","multiline","rows","previousDone","getPercent","shouldCountField","getCountedArray","auctionFilesPercent","getAllFilesPercent","closingPercent","get","getSteps","serverTime","steps","nb","items","link","percent","isDone","res","waiting","contractRequested","color","paddingLeft","subtitle","getCurrentValue","stepNb","itemNb","isFinite","formArray","a","formArray1","formArray2","fileArray","fileArrayFunc","checkValidity","iterate","doc2","item","loadingHandler","fortuneLimitedProperty","incomeLimitedProperty","calculatePrimaryProperty","cpsLimit","interestsReal","maxRatio","getCurrency","loanCost","toRetirement","loanCostReal","propertyToIncome","maxLoan","propertyToIncomeReal","maxProperty","fortuneLimited","incomeLimited","toAmortize","parseFloat","toPrecision","nF","mR","incomeLimited1","incomeLimited2","totalFortuneLimitedValue","cashLimitedValue","firstNames","lastNames","generateSecondBorrowerProbabillity","insertFakeBorrower","citizenships","identity","taxes","salaryCertificate","nonPursuitExtract","lastSalaries","currentMortgages","bankAssetsChange","pensionFundYearlyStatement","retirementInsurancePlan","createFakeBorrowers","USER_COUNT","ADMIN_COUNT","DEV_COUNT","MAX_LOANS_PER_USER","STEPS_PER_LOAN","MAX_OFFERS_PER_LOAN","MIN_OFFERS_PER_LOAN","createFakeUsers","startup","createFakeProperty","purchaseTypes","generateRandomNumber","maxSteps","fakeGeneral","logic1","logic2","comments","logic3","fakeFiles","plans","cubage","buyersContract","landRegisterExtract","coownershipAllocationAgreement","coownershipAgreement","upload0","fakeFiles2","createFakeLoans","completeFiles","createFakeLoan","createFakeTask","createFakeOffer","generateNumberOfLoans","admins","newAdmins","generateTestData","currentUserHasRole","isProduction","newUsers","numberOfLoans","purgeDatabase","currentUserId","createFakeOffers","statuses","usageTypes","styles","volumeNorms","createFakeProperties","box","inside","outside","types","createFakeTasks","insertedUsers","password","Inject","jc","startJobServer","rawHead","Assets","getText","AccountsUI","ui","passwordSignupFields","loginPath","homeRoutePath","profilePath","minimumPasswordLength"],"mappings":"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,GAAP;AASD,CAZuC,EAAxC;;AAcAV,UAASI,cAAT,CAAwBW,aAAxB,GAAyC,YAAM;AAC7C,MAAMxD,UAAU2C,WAAUc,cAA1B;AAEA,SAAO;AACL7B,aAAS;AAAA,aAAM9B,aAAaP,YAAb,CAA0BS,OAA1B,EAAmC4C,aAAYM,OAA/C,CAAN;AAAA,KADJ;AAELC,QAFK,gBAEAzC,IAFA,EAEM0C,GAFN,EAEW;AACd;AACA,UAAMhD,WAAWN,aAAagC,mBAAb,CAAiC9B,OAAjC,EAA0C;AAAEU,kBAAF;AAAQ0C;AAAR,OAA1C,CAAjB;AACA,UAAMnB,SAASnC,aAAakC,cAAb,CAA4B5B,QAA5B,EAAsCJ,OAAtC,CAAf;AACA,aAAOiC,OAAOoB,IAAP,CAAYF,IAAnB;AACD;AAPI,GAAP;AASD,CAZuC,EAAxC,C;;;;;;;;;;;ACrCA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAC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","file":"/app.js","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { ValidatedMethod } from 'meteor/mdg:validated-method';\nimport { Roles } from 'meteor/alanning:roles';\nimport { check, Match } from 'meteor/check';\nimport { CallPromiseMixin } from 'meteor/didericis:callpromise-mixin';\nimport rateLimit from '../../../utils/rate-limit.js';\n\nimport AdminActions from '../adminActions';\nimport { ADMIN_ACTION_STATUS } from '../adminActionConstants';\n\nexport const insertAdminAction = new ValidatedMethod({\n  name: 'insertAdminAction',\n  mixins: [CallPromiseMixin],\n  validate({ loanId, type }) {\n    check(loanId, String);\n    check(type, String);\n  },\n  run({ loanId, type }) {\n    // Make sure there isn't an action active with the same ID\n    const existingAction = AdminActions.findOne({\n      type,\n      loanId,\n      status: ADMIN_ACTION_STATUS.ACTIVE,\n    });\n    if (existingAction) {\n      throw new Meteor.Error('duplicate active admin action');\n    }\n\n    return AdminActions.insert({ type, loanId });\n  },\n});\n\nexport const completeAction = new ValidatedMethod({\n  name: 'completeAction',\n  mixins: [CallPromiseMixin],\n  validate({ id }) {\n    check(id, String);\n  },\n  run({ id }) {\n    const action = AdminActions.findOne(id);\n\n    if (action.status === ADMIN_ACTION_STATUS.COMPLETED) {\n      throw new Meteor.Error('action is already completed');\n    }\n\n    return AdminActions.update(id, {\n      $set: {\n        status: ADMIN_ACTION_STATUS.COMPLETED,\n        completedAt: new Date(),\n      },\n    });\n  },\n});\n\nexport const completeActionByType = new ValidatedMethod({\n  name: 'completeActionByType',\n  mixins: [CallPromiseMixin],\n  validate({ loanId, type, newStatus }) {\n    check(loanId, String);\n    check(type, String);\n    check(newStatus, Match.Optional(String));\n  },\n  run({ loanId, type, newStatus }) {\n    const action = AdminActions.findOne({\n      loanId,\n      type,\n      status: ADMIN_ACTION_STATUS.ACTIVE,\n    });\n\n    if (!action) {\n      throw new Meteor.Error(\"action couldn't be found\");\n    }\n\n    return AdminActions.update(action._id, {\n      $set: {\n        status: newStatus || ADMIN_ACTION_STATUS.COMPLETED,\n        completedAt: new Date(),\n      },\n    });\n  },\n});\n\nexport const removeParentLoan = new ValidatedMethod({\n  name: 'removeParentLoan',\n  mixins: [CallPromiseMixin],\n  validate({ loanId }) {\n    check(loanId, String);\n  },\n  run({ loanId }) {\n    return AdminActions.update(\n      { loanId },\n      { $set: { status: ADMIN_ACTION_STATUS.PARENT_DELETED } },\n      { multi: true },\n    );\n  },\n});\n\nrateLimit({ methods: [insertAdminAction, completeAction] });\n","import { Meteor } from 'meteor/meteor';\nimport { check } from 'meteor/check';\nimport AdminActions from '../adminActions';\nimport { Roles } from 'meteor/alanning:roles';\n\nMeteor.publish('allAdminActions', function publish() {\n  // Verify if user is an admin\n  if (\n    Roles.userIsInRole(Meteor.userId(), 'admin') ||\n    Roles.userIsInRole(Meteor.userId(), 'dev')\n  ) {\n    // Return all\n    return AdminActions.find();\n  }\n\n  return this.ready();\n});\n","export const ADMIN_ACTION_TYPE = {\n  VERIFY: 'VERIFY',\n  AUCTION: 'AUCTION',\n  LENDER_CHOSEN: 'LENDER_CHOSEN',\n};\n\nexport const ADMIN_ACTION_STATUS = {\n  ACTIVE: 'ACTIVE',\n  COMPLETED: 'COMPLETED',\n  PARENT_DELETED: 'PARENT_DELETED',\n  CANCELLED: 'CANCELLED',\n};\n","import { Mongo } from 'meteor/mongo';\nimport SimpleSchema from 'simpl-schema';\nimport { ADMIN_ACTION_TYPE, ADMIN_ACTION_STATUS } from './adminActionConstants';\n\nconst AdminActions = new Mongo.Collection('adminActions');\n\n// Action types\n// 'verify'\n// 'auction'\n// 'lenderChosen'\n\n// Prevent all client side modifications of mongoDB\nAdminActions.deny({\n  insert: () => true,\n  update: () => true,\n  remove: () => true,\n});\n\nAdminActions.allow({\n  insert: () => false,\n  update: () => false,\n  remove: () => false,\n});\n\nconst AdminActionSchema = new SimpleSchema({\n  createdAt: {\n    type: Date,\n    autoValue() {\n      if (this.isInsert) {\n        return new Date();\n      }\n    },\n  },\n  status: {\n    type: String,\n    defaultValue: ADMIN_ACTION_STATUS.ACTIVE,\n    allowedValues: Object.values(ADMIN_ACTION_STATUS),\n  },\n  completedAt: {\n    type: Date,\n    optional: true,\n  },\n  type: {\n    type: String,\n    allowedValues: Object.values(ADMIN_ACTION_TYPE),\n  },\n  loanId: String,\n  staffId: {\n    type: String,\n    optional: true,\n  },\n  extra: {\n    type: Object,\n    optional: true,\n    blackbox: true,\n  },\n  notes: {\n    type: String,\n    optional: true,\n  },\n});\n\nAdminActions.attachSchema(AdminActionSchema);\nexport default AdminActions;\n","export { default } from './adminActions';\n","import Security from 'core/api/security';\nimport query from './borrowerAssignedTo';\n\nquery.expose({\n  firewall(userId) {\n    Security.checkCurrentUserIsAdmin(userId);\n  },\n});\n","import Borrowers from '..';\nimport { BORROWER_QUERIES } from '../borrowerConstants';\n\nexport default Borrowers.createQuery(BORROWER_QUERIES.BORROWER_ASSIGNED_TO, {\n  $filter({ filters, params }) {\n    filters.userId = params.userId;\n  },\n  assignedTo: 1,\n});\n","import Security from 'core/api/security';\nimport query from './borrowersList';\n\nquery.expose({\n  firewall(userId) {\n    Security.checkCurrentUserIsAdmin(userId);\n  },\n});\n","import Borrowers from '..';\nimport { BORROWER_QUERIES } from '../borrowerConstants';\n\nexport default Borrowers.createQuery(BORROWER_QUERIES.ADMIN_BORROWERS, {\n  $options: {\n    sort: {\n      createdAt: -1,\n    },\n  },\n  firstName: 1,\n  lastName: 1,\n  createdAt: 1,\n  updatedAt: 1,\n});\n","import './borrowersList.expose';\nimport './borrowerAssignedTo.expose';\n","import { Meteor } from 'meteor/meteor';\nimport { ValidatedMethod } from 'meteor/mdg:validated-method';\nimport { check } from 'meteor/check';\nimport { Roles } from 'meteor/alanning:roles';\nimport { CallPromiseMixin } from 'meteor/didericis:callpromise-mixin';\nimport rateLimit from '../../../utils/rate-limit.js';\n\nimport Borrowers from '../borrowers';\n\nexport const insertBorrower = new ValidatedMethod({\n  name: 'insertBorrower',\n  mixins: [CallPromiseMixin],\n  validate() {},\n  run({ object, userId }) {\n    return Borrowers.insert({\n      ...object,\n      // Allow null as userId\n      userId: userId === undefined ? Meteor.userId() : userId,\n    });\n  },\n});\n\n// Lets you set an entire object in the document\nexport const updateBorrower = new ValidatedMethod({\n  name: 'updateBorrower',\n  mixins: [CallPromiseMixin],\n  validate({ id }) {\n    check(id, String);\n  },\n  run({ object, id }) {\n    return Borrowers.update(id, { $set: object });\n  },\n});\n\n// Lets you push a value to an array\nexport const pushBorrowerValue = new ValidatedMethod({\n  name: 'pushBorrowerValue',\n  mixins: [CallPromiseMixin],\n  validate({ id }) {\n    check(id, String);\n  },\n  run({ object, id }) {\n    return Borrowers.update(id, { $push: object });\n  },\n});\n\n// Lets you pop a value from the end of an array\nexport const popBorrowerValue = new ValidatedMethod({\n  name: 'popBorrowerValue',\n  mixins: [CallPromiseMixin],\n  validate({ id }) {\n    check(id, String);\n  },\n  run({ object, id }) {\n    return Borrowers.update(id, { $pop: object }, { getAutoValues: false });\n  },\n});\n\nexport const deleteBorrower = new ValidatedMethod({\n  name: 'deleteBorrower',\n  mixins: [CallPromiseMixin],\n  validate({ id }) {\n    check(id, String);\n  },\n  run({ id }) {\n    if (Roles.userIsInRole(Meteor.userId(), 'dev')) {\n      return Borrowers.remove(id);\n    }\n\n    return false;\n  },\n});\n\nrateLimit({\n  methods: [\n    insertBorrower,\n    updateBorrower,\n    pushBorrowerValue,\n    popBorrowerValue,\n    deleteBorrower,\n  ],\n});\n","import { Meteor } from 'meteor/meteor';\n\nimport { SecurityService, createMutator } from '../..';\nimport BorrowerService from '../BorrowerService';\nimport * as defs from '../mutationDefinitions';\n\ncreateMutator(defs.BORROWER_INSERT, ({ borrower, userId }) => {\n  const userIdIsDefined = userId !== undefined;\n  if (userIdIsDefined) {\n    SecurityService.checkCurrentUserIsAdmin();\n  } else {\n    SecurityService.borrowers.isAllowedToInsert();\n  }\n\n  return BorrowerService.insert({\n    borrower,\n    userId: userIdIsDefined ? userId : Meteor.userId(),\n  });\n});\n\ncreateMutator(defs.BORROWER_UPDATE, ({ borrowerId, borrower }) => {\n  SecurityService.borrowers.isAllowedToUpdate(borrowerId);\n  return BorrowerService.update({ borrowerId, borrower });\n});\n\ncreateMutator(defs.BORROWER_DELETE, ({ borrowerId }) => {\n  SecurityService.borrowers.isAllowedToDelete(borrowerId);\n  return BorrowerService.remove({ borrowerId });\n});\n","import { Meteor } from 'meteor/meteor';\nimport { check } from 'meteor/check';\nimport { Roles } from 'meteor/alanning:roles';\nimport Borrowers from '../borrowers';\n\n// Publish a specific loan with an ID\nMeteor.publish('borrower', function publish(id) {\n  // Verify if user is logged In\n  if (!Meteor.userId()) {\n    return this.ready();\n  }\n\n  check(id, String);\n\n  if (\n    Roles.userIsInRole(Meteor.userId(), 'admin') ||\n    Roles.userIsInRole(Meteor.userId(), 'dev')\n  ) {\n    return Borrowers.find({\n      _id: id,\n    });\n  }\n\n  return Borrowers.find({\n    userId: Meteor.userId(),\n    _id: id,\n  });\n});\n\n// Publish all borrowers from the current user\nMeteor.publish('borrowers', function publish() {\n  // Verify if user is logged In\n  if (!Meteor.userId()) {\n    return this.ready();\n  }\n\n  const borrowers = Borrowers.find({\n    userId: Meteor.userId(),\n  });\n\n  return borrowers;\n});\n\n// Publish all borrowers for a user\nMeteor.publish('userBorrowers', function publish(userId) {\n  check(userId, String);\n\n  // Verify if user is logged In\n  if (\n    Roles.userIsInRole(Meteor.userId(), 'admin') ||\n    Roles.userIsInRole(Meteor.userId(), 'dev')\n  ) {\n    // Return all users\n    return Borrowers.find({ userId });\n  }\n\n  return this.ready();\n});\n\n// Publish all borrowers in the database for admins\nMeteor.publish('allBorrowers', function publish() {\n  // Verify if user is logged In\n  if (\n    Roles.userIsInRole(Meteor.userId(), 'admin') ||\n    Roles.userIsInRole(Meteor.userId(), 'dev')\n  ) {\n    // Return all users\n    return Borrowers.find();\n  }\n\n  return this.ready();\n});\n\n// Publish all borrowers for a loan for admins\nMeteor.publish('loanBorrowers', function publish(borrowerIds) {\n  check(borrowerIds, [String]);\n  // Verify if user is an admin\n  if (\n    Roles.userIsInRole(Meteor.userId(), 'admin') ||\n    Roles.userIsInRole(Meteor.userId(), 'dev')\n  ) {\n    // Return all borrowers\n    return Borrowers.find({ _id: { $in: borrowerIds } });\n  }\n\n  return this.ready();\n});\n","import Borrowers from '../borrowers';\n\nexport default class {\n  static update = ({ borrowerId, borrower }) =>\n    Borrowers.update(borrowerId, { $set: borrower });\n\n  static insert = ({ borrower, userId }) =>\n    Borrowers.insert({ ...borrower, userId });\n\n  static remove = ({ borrowerId }) => Borrowers.remove(borrowerId);\n\n  static pushValue = ({ borrowerId, borrower }) =>\n    Borrowers.update(borrowerId, { $push: borrower });\n}\n","export const RESIDENCY_PERMIT = {\n  B: 'b',\n  C: 'c',\n  CI: 'ci',\n  F: 'f',\n  G: 'g',\n  L: 'l',\n  N: 'n',\n  S: 's',\n  NONE: 'none',\n};\n\nexport const GENDER = {\n  M: 'M',\n  F: 'F',\n  OTHER: 'OTHER',\n};\n\nexport const CIVIL_STATUS = {\n  MARRIED: 'MARRIED',\n  SINGLE: 'SINGLE',\n  PACSED: 'PACSED',\n  DIVORCED: 'DIVORCED',\n};\n\nexport const OTHER_FORTUNE = {\n  ART: 'ART',\n  CARS: 'CARS',\n  BOATS: 'BOATS',\n  AIRPLANES: 'AIRPLANES',\n  JEWELRY: 'JEWELRY',\n};\n\nexport const OTHER_INCOME = {\n  WELFARE: 'WELFARE',\n  PENSION: 'PENSION',\n  RENT: 'RENT',\n  REAL_ESTATE: 'REAL_ESTATE',\n  INVESTMENT: 'INVESTMENT',\n  OTHER: 'OTHER',\n};\n\nexport const EXPENSES = {\n  LEASING: 'LEASING',\n  RENT: 'RENT',\n  PERSONAL_LOAN: 'PERSONAL_LOAN',\n  MORTGAGE_LOAN: 'MORTGAGE_LOAN',\n  PENSIONS: 'PENSIONS',\n  OTHER: 'OTHER',\n};\n\nexport const REAL_ESTATE = {\n  PRIMARY: 'PRIMARY',\n  SECONDARY: 'SECONDARY',\n  INVESTMENT: 'INVESTMENT',\n};\n\nexport const BORROWER_QUERIES = {\n  ADMIN_BORROWERS: 'ADMIN_BORROWERS',\n  BORROWER_ASSIGNED_TO: 'BORROWER_ASSIGNED_TO',\n};\n","import { Mongo } from 'meteor/mongo';\nimport SimpleSchema from 'simpl-schema';\nimport { getFileSchema } from '../files/files';\nimport {\n  RESIDENCY_PERMIT,\n  GENDER,\n  CIVIL_STATUS,\n  OTHER_FORTUNE,\n  OTHER_INCOME,\n  EXPENSES,\n  REAL_ESTATE,\n} from './borrowerConstants';\n\nconst Borrowers = new Mongo.Collection('borrowers');\n\n// Prevent all client side modifications of mongoDB\nBorrowers.deny({\n  insert: () => true,\n  update: () => true,\n  remove: () => true,\n});\n\nBorrowers.allow({\n  insert: () => false,\n  update: () => false,\n  remove: () => false,\n});\n\nconst BorrowerFilesSchema = new SimpleSchema(getFileSchema('borrower'));\n\nconst LogicSchema = new SimpleSchema({\n  financeEthics: {\n    type: Boolean,\n    defaultValue: false,\n    optional: true,\n  },\n  hasValidatedFinances: {\n    type: Boolean,\n    defaultValue: false,\n    optional: true,\n  },\n  adminValidated: {\n    type: Boolean,\n    defaultValue: false,\n  },\n});\n\n// Documentation is in the google drive dev/MongoDB Schemas\nexport const BorrowerSchema = new SimpleSchema({\n  userId: {\n    type: String,\n    optional: true,\n  },\n  createdAt: {\n    type: Date,\n    autoValue() {\n      if (this.isInsert) {\n        return new Date();\n      }\n    },\n  },\n  updatedAt: {\n    type: Date,\n    autoValue() {\n      // Verify the update is from the user owning this doc, ignoring admin/partner updates\n      const doc = Borrowers.findOne(this.docId, { fields: { userId: 1 } });\n\n      if (this.isInsert) {\n        return new Date();\n      } else if (this.isUpdate && doc && this.userId === doc.userId) {\n        return new Date();\n      }\n    },\n  },\n\n  // Personal Information\n  firstName: {\n    type: String,\n    optional: true,\n  },\n  lastName: {\n    type: String,\n    optional: true,\n  },\n  gender: {\n    type: String,\n    optional: true,\n    allowedValues: Object.values(GENDER),\n  },\n  age: {\n    type: SimpleSchema.Integer,\n    optional: true,\n    min: 18,\n    max: 120,\n  },\n  address1: {\n    type: String,\n    optional: true,\n  },\n  address2: {\n    type: String,\n    optional: true,\n  },\n  zipCode: {\n    type: Number,\n    optional: true,\n    min: 1000,\n    max: 9999,\n  },\n  city: {\n    type: String,\n    optional: true,\n  },\n  sameAddress: {\n    type: Boolean,\n    optional: true,\n  },\n  isSwiss: {\n    type: Boolean,\n    optional: true,\n  },\n  residencyPermit: {\n    type: String,\n    optional: true,\n    allowedValues: Object.values(RESIDENCY_PERMIT),\n  },\n  birthDate: {\n    type: String,\n    optional: true,\n    regEx: '/^d{4}[/-](0?[1-9]|1[012])[/-](0?[1-9]|[12][0-9]|3[01])$/', // YYYY-MM-DD\n  },\n  birthPlace: {\n    type: String,\n    optional: true,\n  },\n  citizenship: {\n    type: String,\n    optional: true,\n  },\n  isUSPerson: {\n    type: Boolean,\n    optional: true,\n  },\n  civilStatus: {\n    type: String,\n    defaultValue: CIVIL_STATUS.SINGLE,\n    allowedValues: Object.values(CIVIL_STATUS),\n  },\n  childrenCount: {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 20,\n  },\n  company: {\n    type: String,\n    optional: true,\n  },\n  worksForOwnCompany: {\n    type: Boolean,\n    optional: true,\n  },\n  salary: {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 100000000,\n  },\n  bonusExists: {\n    type: Boolean,\n    defaultValue: false,\n  },\n  bonus: {\n    type: Object,\n    defaultValue: {},\n  },\n  'bonus.bonus2014': {\n    // oldest\n    type: Number,\n    min: 0,\n    max: 100000000,\n    optional: true,\n  },\n  'bonus.bonus2015': {\n    type: Number,\n    min: 0,\n    max: 100000000,\n    optional: true,\n  },\n  'bonus.bonus2016': {\n    type: Number,\n    min: 0,\n    max: 100000000,\n    optional: true,\n  },\n  'bonus.bonus2017': {\n    // most recent\n    type: Number,\n    min: 0,\n    max: 100000000,\n    optional: true,\n  },\n  otherIncome: {\n    type: Array,\n    optional: true,\n    defaultValue: [],\n  },\n  'otherIncome.$': Object,\n  'otherIncome.$.value': {\n    type: Number,\n    min: 0,\n    max: 100000000,\n  },\n  'otherIncome.$.description': {\n    type: String,\n    allowedValues: Object.values(OTHER_INCOME),\n  },\n  otherFortune: {\n    type: Array,\n    optional: true,\n    defaultValue: [],\n  },\n  'otherFortune.$': Object,\n  'otherFortune.$.value': {\n    type: Number,\n    min: 0,\n    max: 100000000,\n  },\n  'otherFortune.$.description': {\n    type: String,\n    allowedValues: Object.values(OTHER_FORTUNE),\n  },\n  expenses: {\n    type: Array,\n    optional: true,\n    defaultValue: [],\n  },\n  'expenses.$': Object,\n  'expenses.$.value': {\n    type: Number,\n    min: 0,\n    max: 100000000,\n  },\n  'expenses.$.description': {\n    type: String,\n    allowedValues: Object.values(EXPENSES),\n  },\n  bankFortune: {\n    type: Number,\n    min: 0,\n    max: 100000000,\n    optional: true,\n  },\n  realEstate: {\n    type: Array,\n    optional: true,\n    defaultValue: [],\n  },\n  'realEstate.$': Object,\n  'realEstate.$.value': {\n    type: Number,\n    min: 0,\n    max: 100000000,\n  },\n  'realEstate.$.loan': {\n    type: Number,\n    min: 0,\n    max: 100000000,\n  },\n  'realEstate.$.description': {\n    type: String,\n    allowedValues: Object.values(REAL_ESTATE),\n  },\n  personalBank: {\n    type: String,\n    optional: true,\n  },\n  corporateBankExists: {\n    type: Boolean,\n    defaultValue: false,\n  },\n  corporateBank: {\n    type: String,\n    optional: true,\n  },\n  insuranceSecondPillar: {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 100000000,\n  },\n  insuranceThirdPillar: {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 100000000,\n  },\n  insurance3B: {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 100000000,\n  },\n  files: {\n    type: BorrowerFilesSchema,\n    defaultValue: {},\n  },\n  // business logic and admin\n  logic: {\n    type: LogicSchema,\n    defaultValue: {},\n  },\n  admin: {\n    // TODO\n    type: Object,\n    optional: true,\n  },\n  adminValidation: {\n    type: Object,\n    defaultValue: {},\n    blackbox: true,\n  },\n});\n\nBorrowers.attachSchema(BorrowerSchema);\nexport default Borrowers;\n","import * as mutationDefinitions from './mutationDefinitions';\n\nexport { default } from './borrowers';\nexport const borrowerMutations = mutationDefinitions;\n","import { Borrowers, Users } from '../';\n\nBorrowers.addLinks({\n  asignee: {\n    field: 'userId',\n    collection: Users,\n    type: 'one',\n  },\n});\n","export const BORROWER_INSERT = {\n  name: 'BORROWER_INSERT',\n  params: {\n    borrower: { type: Object },\n    userId: { type: String, optional: true },\n  },\n};\n\nexport const BORROWER_UPDATE = {\n  name: 'BORROWER_UPDATE',\n  params: {\n    borrowerId: { type: String },\n    object: { type: Object },\n  },\n};\n\nexport const BORROWER_DELETE = {\n  name: 'BORROWER_DELETE',\n  params: {\n    borrowerId: { type: String },\n  },\n};\n","import { Meteor } from 'meteor/meteor';\nimport { ValidatedMethod } from 'meteor/mdg:validated-method';\nimport { check, Match } from 'meteor/check';\nimport { Roles } from 'meteor/alanning:roles';\nimport { CallPromiseMixin } from 'meteor/didericis:callpromise-mixin';\nimport rateLimit from '../../../utils/rate-limit.js';\n\nimport Comparators from '../comparators';\n\nexport const insertComparator = new ValidatedMethod({\n  name: 'insertComparator',\n  mixins: [CallPromiseMixin],\n  validate() {},\n  run() {\n    const userId = Meteor.userId();\n    const userComparators = Comparators.find({ userId }).count();\n\n    if (userComparators > 0) {\n      throw new Meteor.Error(\"Can't have more than one comparator per user\");\n    }\n\n    return Comparators.insert({ userId });\n  },\n});\n\nexport const updateComparator = new ValidatedMethod({\n  name: 'updateComparator',\n  mixins: [CallPromiseMixin],\n  validate({ object, id }) {\n    check(object, Object);\n    check(id, String);\n  },\n  run({ object, id }) {\n    return Comparators.update(id, { $set: object });\n  },\n});\n\nexport const addComparatorField = new ValidatedMethod({\n  name: 'addComparatorField',\n  mixins: [CallPromiseMixin],\n  validate({ object, id }) {\n    const { name, type } = object;\n\n    check(id, String);\n    check(name, String);\n    check(type, String);\n  },\n  run({ object, id }) {\n    const { name, type } = object;\n\n    const comparator = Comparators.findOne(id);\n\n    return Comparators.update(id, {\n      $inc: { customFieldCount: 1 },\n      $push: {\n        customFields: {\n          id: `custom${comparator.customFieldCount}`,\n          name,\n          type,\n        },\n      },\n    });\n  },\n});\n\nexport const removeComparatorField = new ValidatedMethod({\n  name: 'removeComparatorField',\n  mixins: [CallPromiseMixin],\n  validate({ object, id }) {\n    check(id, String);\n    check(object, Object);\n    check(object.fieldId, String);\n  },\n  run({ object, id }) {\n    const { fieldId } = object;\n\n    return Comparators.update(id, {\n      $pull: { customFields: { id: fieldId } },\n    });\n  },\n});\n\nexport const toggleHiddenField = new ValidatedMethod({\n  name: 'toggleHiddenField',\n  mixins: [CallPromiseMixin],\n  validate({ object, id }) {\n    check(id, String);\n    check(object, Object);\n    check(object.fieldId, String);\n  },\n  run({ object, id }) {\n    const { fieldId } = object;\n\n    const comparator = Comparators.findOne(id);\n\n    if (comparator.hiddenFields.indexOf(fieldId) >= 0) {\n      // Field is currently hidden\n      return Comparators.update(id, {\n        $pull: { hiddenFields: fieldId },\n      });\n    }\n\n    return Comparators.update(id, {\n      $push: { hiddenFields: fieldId },\n    });\n  },\n});\n","import { Meteor } from 'meteor/meteor';\n\nimport Comparators from '../comparators';\n\n// Get all comparators for the current user\nMeteor.publish('userComparators', function publish() {\n  // Verify if user is logged In\n  if (!Meteor.userId()) {\n    return this.ready();\n  }\n\n  return Comparators.find({\n    userId: Meteor.userId(),\n  });\n});\n","import { Mongo } from 'meteor/mongo';\nimport SimpleSchema from 'simpl-schema';\n\nconst Comparators = new Mongo.Collection('comparators');\n\n// Prevent all client side modifications of mongoDB\nComparators.deny({\n  insert: () => true,\n  update: () => true,\n  remove: () => true,\n});\nComparators.allow({\n  insert: () => false,\n  update: () => false,\n  remove: () => false,\n});\n\nexport const ComparatorSchema = new SimpleSchema({\n  userId: { type: String },\n  createdAt: {\n    type: Date,\n    autoValue() {\n      if (this.isInsert) {\n        return new Date();\n      }\n    },\n  },\n  updatedAt: {\n    type: Date,\n    autoValue() {\n      if (this.isInsert || this.isUpdate) {\n        return new Date();\n      }\n    },\n  },\n  useBorrowers: { type: Boolean, defaultValue: false },\n  income: { type: Number, defaultValue: 100000, optional: true },\n  fortune: { type: Number, defaultValue: 100000, optional: true },\n  interestRate: { type: Number, defaultValue: 0.0125, optional: true },\n  borrowRatio: { type: Number, defaultValue: 0.8, optional: true },\n  usageType: { type: String, defaultValue: 'primary' },\n  customFields: { type: Array, defaultValue: [] },\n  'customFields.$': Object,\n  'customFields.$.id': String,\n  'customFields.$.name': String,\n  'customFields.$.type': String,\n  customFieldCount: { type: Number, defaultValue: 0 },\n  hiddenFields: {\n    type: Array,\n    defaultValue: ['realBorrowRatio', 'incomeRatio', 'theoreticalMonthly'],\n  },\n  'hiddenFields.$': String,\n  borrowers: { type: Array, defaultValue: [] },\n  'borrowers.$': String,\n});\n\n// Attach schema\nComparators.attachSchema(ComparatorSchema);\nexport default Comparators;\n","export { default } from './comparators';\n","import { Meteor } from 'meteor/meteor';\nimport emailConfigs from './emailConfigs';\nimport { getEmailContent, getEmailPart } from './emailHelpers';\nimport {\n  sendMandrillTemplate,\n  getMandrillTemplate,\n  getSimpleMandrillTemplate,\n  renderMandrillTemplate,\n} from './mandrill';\nimport { FROM_NAME, FROM_EMAIL } from '../emailConstants';\n\nclass EmailService {\n  sendEmail = (emailId, address, params) => {\n    const templateOptions = this.createTemplateOptions({\n      emailId,\n      address,\n      params,\n    });\n    const template = this.getTemplate(templateOptions);\n    if (Meteor.isDevelopment || Meteor.isTest) {\n      this.emailLogger({ emailId, address, template });\n    } else {\n      sendMandrillTemplate(template);\n    }\n  };\n\n  sendEmailToUser = (emailId, userId, params) => {\n    const user = Meteor.users.findOne(userId);\n    const emailAddress = user && user.emails[0].address;\n    this.sendEmail(emailId, emailAddress, params);\n  };\n\n  sendEmailToLoggedInUser = (emailId, params) => {\n    this.sendEmailToUser(emailId, Meteor.userId(), params);\n  };\n\n  getEmailConfig = emailId => emailConfigs[emailId];\n\n  createTemplateOptions = ({ emailId, address, params }) => {\n    const emailConfig = this.getEmailConfig(emailId);\n    const { template: { mandrillId }, createIntlValues } = emailConfig;\n\n    const intlValues = createIntlValues(params);\n    const emailContent = getEmailContent(emailId, intlValues);\n\n    // Make sure you call `createOverrides` from emailConfig, to preserve `this`\n    // See: https://github.com/Microsoft/vscode/issues/43930\n    const { variables, allowUnsubscribe } = emailConfig.createOverrides(\n      params,\n      emailContent,\n    );\n\n    return {\n      templateName: mandrillId,\n      allowUnsubscribe,\n      variables,\n      recipientAddress: address,\n      senderAddress: FROM_EMAIL,\n      senderName: FROM_NAME,\n      subject: emailContent.subject,\n      sendAt: undefined,\n    };\n  };\n\n  getAccountsTemplate = (emailId, params = {}) => {\n    const templateOptions = this.createTemplateOptions({ emailId, params });\n    return getSimpleMandrillTemplate(templateOptions);\n  };\n\n  getTemplate = templateOptions => getMandrillTemplate(templateOptions);\n\n  getEmailPart = (emailId, part) => getEmailPart({ emailId, part });\n\n  renderTemplate = (templateOptions, emailId) => {\n    let result;\n    this.emailLogger({ emailId, template: templateOptions });\n\n    try {\n      result = renderMandrillTemplate(templateOptions);\n    } catch (error) {\n      throw new Meteor.Error(\n        'MANDRILL_ERROR',\n        `Error while rendering mandrill template for ${emailId}`,\n        error.reason || error.message || error,\n      );\n    }\n\n    return result;\n  };\n\n  emailLogger = ({ emailId, address, template }) => {\n    if (Meteor.isDevelopment || Meteor.isTest) {\n      if (address) {\n        console.log(`EmailService dev: Would've sent ${emailId} to ${address} with this template:`);\n      } else {\n        console.log(`EmailService dev: Would've sent ${emailId} with this template:`);\n      }\n      console.log(JSON.stringify(template, null, 2));\n    }\n  };\n}\n\nexport default new EmailService();\n","import { Accounts } from 'meteor/accounts-base';\n\nimport { FROM_DEFAULT, EMAIL_IDS, EMAIL_PARTS } from '../emailConstants';\nimport EmailService from './EmailService';\n\n// Meteor default emails\n// https://themeteorchef.com/tutorials/sign-up-with-email-verification\nAccounts.emailTemplates.siteName = 'e-Potek';\nAccounts.emailTemplates.from = FROM_DEFAULT;\n\nAccounts.emailTemplates.verifyEmail = (() => {\n  const emailId = EMAIL_IDS.VERIFY_EMAIL;\n  return {\n    subject: () => EmailService.getEmailPart(emailId, EMAIL_PARTS.SUBJECT),\n    html(user, url) {\n      // TODO: Make sure this doesn't block\n      const template = EmailService.getAccountsTemplate(emailId, { user, url });\n      const result = EmailService.renderTemplate(template, emailId);\n      return result.data.html;\n    },\n  };\n})();\n\nAccounts.emailTemplates.resetPassword = (() => {\n  const emailId = EMAIL_IDS.RESET_PASSWORD;\n\n  return {\n    subject: () => EmailService.getEmailPart(emailId, EMAIL_PARTS.SUBJECT),\n    html(user, url) {\n      // TODO: Make sure this doesn't block\n      const template = EmailService.getAccountsTemplate(emailId, { user, url });\n      const result = EmailService.renderTemplate(template, emailId);\n      return result.data.html;\n    },\n  };\n})();\n\nAccounts.emailTemplates.enrollAccount = (() => {\n  const emailId = EMAIL_IDS.ENROLL_ACCOUNT;\n\n  return {\n    subject: () => EmailService.getEmailPart(emailId, EMAIL_PARTS.SUBJECT),\n    html(user, url) {\n      // TODO: Make sure this doesn't block\n      const template = EmailService.getAccountsTemplate(emailId, { user, url });\n      const result = EmailService.renderTemplate(template, emailId);\n      return result.data.html;\n    },\n  };\n})();\n","// import { Meteor } from 'meteor/meteor';\n// import { Mandrill } from 'meteor/wylio:mandrill';\n// import { ValidatedMethod } from 'meteor/mdg:validated-method';\n// import { check, Match } from 'meteor/check';\n// import { CallPromiseMixin } from 'meteor/didericis:callpromise-mixin';\n\n// import rateLimit from 'core/utils/rate-limit.js';\n// import {\n//   from,\n//   fromEmail,\n//   defaultCTA_URL,\n//   emailFooter,\n//   getEmailContent,\n// } from '../email-defaults';\n// import { addEmail, modifyEmail } from 'core/api/loans/server/methods';\n\n// export const sendEmail = new ValidatedMethod({\n//   name: 'sendEmail',\n//   mixins: [CallPromiseMixin],\n//   validate({\n//     emailId,\n//     loanId,\n//     template = 'notification',\n//     CTA_URL,\n//     sendAt,\n//     userId,\n//     intlValues,\n//   }) {\n//     check(emailId, String);\n//     check(loanId, String);\n//     check(template, Match.Optional(String));\n//     check(CTA_URL, Match.Optional(String));\n//     check(sendAt, Match.Optional(Date));\n//     check(userId, Match.Optional(String));\n//     check(intlValues, Match.Optional(Object));\n//   },\n//   run({\n//     emailId,\n//     loanId,\n//     template = 'notification',\n//     CTA_URL,\n//     sendAt,\n//     userId,\n//     intlValues,\n//   }) {\n//     const { email, subject, title, body, CTA } = getEmailContent(\n//       emailId,\n//       intlValues,\n//     );\n//     let toEmail;\n\n//     // When this is sent by an admin, use the userId to find the email to whom this should be sent to\n//     if (userId) {\n//       toEmail = Meteor.users.findOne(userId).emails[0].address;\n//     }\n//     toEmail = toEmail || email;\n\n//     // If this is a demo site, do not send emails\n//     if (\n//       this.connection &&\n//       this.connection.httpHeaders &&\n//       this.connection.httpHeaders.host.indexOf('demo') !== -1\n//     ) {\n//       return false;\n//     }\n\n//     const options = {\n//       template_name: template,\n//       template_content: [{ name: 'footer', content: emailFooter() }],\n//       message: {\n//         from_email: fromEmail,\n//         from_name: from,\n//         subject,\n//         to: [\n//           {\n//             email: toEmail,\n//             // name: 'Jon Snow',\n//             type: 'to',\n//           },\n//         ],\n//         merge_vars: [\n//           {\n//             rcpt: toEmail,\n//             vars: [\n//               { name: 'title', content: title },\n//               { name: 'body', content: body },\n//               { name: 'CTA', content: CTA },\n//               { name: 'CTA_URL', content: CTA_URL || defaultCTA_URL }, // overrides the global_merge_vars if it is set}\n//             ],\n//           },\n//         ],\n//         metadata: [{ userId: Meteor.userId(), loanId }],\n//       },\n//     };\n\n//     if (sendAt) {\n//       options.send_at = sendAt.toISOString();\n//     }\n\n//     // FIXME Mandrill can't be tested currently\n//     // https://github.com/Wylio/meteor-mandrill/issues/23\n//     if (Meteor.isTest) {\n//       return;\n//     }\n\n//     this.unblock();\n//     Mandrill.messages.sendTemplate(options, (error, result) => {\n//       if (error) {\n//         throw new Meteor.Error(error);\n//       }\n\n//       const content = JSON.parse(result.content)[0];\n//       return addEmail.call(\n//         {\n//           loanId,\n//           emailId,\n//           _id: content._id,\n//           status: content.status,\n//           sendAt,\n//         },\n//         (err) => {\n//           throw new Meteor.Error(err);\n//         },\n//       );\n//     });\n//   },\n// });\n\n// export const cancelScheduledEmail = new ValidatedMethod({\n//   name: 'cancelScheduledEmail',\n//   mixins: [CallPromiseMixin],\n//   validate({ id, loanId }) {\n//     check(id, String);\n//     check(loanId, String);\n//   },\n//   run({ id, loanId }) {\n//     this.unblock();\n//     Mandrill.messages.cancelScheduled({ id }, (error, result) => {\n//       if (error) {\n//         throw new Meteor.Error(error);\n//       }\n\n//       const content = JSON.parse(result.content);\n//       return modifyEmail.call(\n//         { loanId, _id: content._id, status: 'cancelled' },\n//         (err) => {\n//           throw new Meteor.Error(err);\n//         },\n//       );\n//     });\n//   },\n// });\n\n// export const rescheduleEmail = new ValidatedMethod({\n//   name: 'rescheduleEmail',\n//   mixins: [CallPromiseMixin],\n//   validate({ id, loanId, date }) {\n//     check(id, String);\n//     check(loanId, String);\n//     check(date, Date);\n//   },\n//   run({ id, loanId, date }) {\n//     this.unblock();\n//     Mandrill.messages.reschedule(\n//       { id, send_at: date.toISOString() },\n//       (error, result) => {\n//         if (error) {\n//           throw new Meteor.Error(error);\n//         }\n\n//         const content = JSON.parse(result.content);\n//         return modifyEmail.call({ loanId, _id: content._id, sendAt }, (err) => {\n//           throw new Meteor.Error(err);\n//         });\n//       },\n//     );\n//   },\n// });\n\n// // Send max 1 email per second\n// rateLimit({\n//   methods: [sendEmail, cancelScheduledEmail, rescheduleEmail],\n//   limit: 1,\n//   timeRange: 1000,\n// });\n","import { EMAIL_TEMPLATES, EMAIL_IDS, CTA_URL_DEFAULT } from '../emailConstants';\nimport {\n  getEnrollmentUrl,\n  notificationTemplateDefaultOverride,\n  notificationAndCtaTemplateDefaultOverride,\n} from './emailHelpers';\n\nconst emailConfigs = {};\n\nconst emailDefaults = {\n  allowUnsubscribe: false,\n  createIntlValues: () => ({ variables: [] }),\n};\n\n/**\n * addEmailConfig - A function that creates a config for a given emailId\n *\n * @param {String} emailId A unique id representing the email, from EMAIL_IDS\n * @param {Object} config A config object that can have the following keys:\n * {Object} template A template object from EMAIL_TEMPLATES\n * {Boolean} allowUnsubscribe Defines whether the email will be rendered with\n * a footer that allows the user to unsubscribe to notifications.\n * default is `false`\n * {Function} createOverrides A function that takes the user's values and\n * returns an object with overrides for the email template\n * {Function} createIntlValues A function that takes the user's values and\n * returns an object with intl values that need to be injected inside of the\n * i18n strings\n */\nconst addEmailConfig = (emailId, config) => {\n  if (config.template === EMAIL_TEMPLATES.NOTIFICATION) {\n    emailConfigs[emailId] = {\n      createOverrides: notificationTemplateDefaultOverride,\n      ...emailDefaults,\n      ...config,\n    };\n  } else if (config.template === EMAIL_TEMPLATES.NOTIFICATION_AND_CTA) {\n    emailConfigs[emailId] = {\n      createOverrides: notificationAndCtaTemplateDefaultOverride,\n      ...emailDefaults,\n      ...config,\n    };\n  } else {\n    emailConfigs[emailId] = { ...emailDefaults, ...config };\n  }\n};\n\nconst verifyConfig = {\n  template: EMAIL_TEMPLATES.WELCOME,\n  createOverrides({ user, url }) {\n    const { variables } = this.template;\n    const urlWithoutHash = url.replace('#/', '');\n\n    return {\n      variables: [\n        { name: variables.VERIFICATION_URL, content: urlWithoutHash },\n      ],\n    };\n  },\n};\naddEmailConfig(EMAIL_IDS.VERIFY_EMAIL, verifyConfig);\n\naddEmailConfig(EMAIL_IDS.RESET_PASSWORD, {\n  template: EMAIL_TEMPLATES.NOTIFICATION_AND_CTA,\n  createOverrides({ user, url }, { title, body, cta }) {\n    const { variables } = this.template;\n    const urlWithoutHash = url.replace('#/', '');\n\n    return {\n      variables: [\n        { name: variables.TITLE, content: title },\n        { name: variables.BODY, content: body },\n        { name: variables.CTA, content: cta },\n        { name: variables.CTA_URL, content: urlWithoutHash || CTA_URL_DEFAULT },\n      ],\n    };\n  },\n});\n\naddEmailConfig(EMAIL_IDS.ENROLL_ACCOUNT, {\n  template: EMAIL_TEMPLATES.NOTIFICATION_AND_CTA,\n  createOverrides({ user, url }, { title, body, cta }) {\n    const { variables } = this.template;\n    const enrollUrl = getEnrollmentUrl(user, url);\n\n    return {\n      variables: [\n        { name: variables.TITLE, content: title },\n        { name: variables.BODY, content: body },\n        { name: variables.CTA, content: cta },\n        { name: variables.CTA_URL, content: enrollUrl || CTA_URL_DEFAULT },\n      ],\n    };\n  },\n});\n\naddEmailConfig(EMAIL_IDS.VERIFICATION_REQUESTED, {\n  template: EMAIL_TEMPLATES.NOTIFICATION,\n});\n\naddEmailConfig(EMAIL_IDS.VERIFICATION_ERROR, {\n  template: EMAIL_TEMPLATES.NOTIFICATION_AND_CTA,\n});\n\naddEmailConfig(EMAIL_IDS.VERIFICATION_PASSED, {\n  template: EMAIL_TEMPLATES.NOTIFICATION_AND_CTA,\n});\n\naddEmailConfig(EMAIL_IDS.AUCTION_STARTED, {\n  template: EMAIL_TEMPLATES.NOTIFICATION_AND_CTA,\n  createIntlValues: ({ auctionEndTime }) => ({ date: auctionEndTime }),\n});\n\naddEmailConfig(EMAIL_IDS.AUCTION_ENDED, {\n  template: EMAIL_TEMPLATES.NOTIFICATION_AND_CTA,\n});\n\naddEmailConfig(EMAIL_IDS.AUCTION_CANCELLED, {\n  template: EMAIL_TEMPLATES.NOTIFICATION_AND_CTA,\n});\n\nexport default emailConfigs;\n","import { Meteor } from 'meteor/meteor';\nimport formatMessage from 'core/utils/intl';\n\nimport {\n  FROM_DEFAULT,\n  CTA_URL_DEFAULT,\n  EMAIL_I18N_NAMESPACE,\n  EMAIL_PARTS,\n} from '../emailConstants';\n\nconst WWW_URL = Meteor.settings.public.subdomains.www;\nconst APP_URL = Meteor.settings.public.subdomains.app;\n\n/**\n * emailFooter - Returns the default email footer for all emails\n *\n * @param {boolean} [unsubscribe=true] Whether to show an unsubscribe line or not\n *\n * @return {type} a HTML string\n */\nexport const getEmailFooter = (allowUnsubscribe = true) =>\n  formatMessage('emails.footer', {\n    copyright: '<em>&copy; *|CURRENT_YEAR|* e-Potek</em><br /><br />',\n    url: `<a href=\"${WWW_URL}\" target=\"_blank\">e-potek.ch</a><br />`,\n    unsubscribe: allowUnsubscribe\n      ? `<a href=\"*|UNSUB|*\">${formatMessage('emails.unsubscribe')}</a>`\n      : '',\n  });\n\nexport const getEmailPart = ({\n  emailId,\n  part,\n  intlValues = {},\n  intlFallback = '',\n}) =>\n  formatMessage(\n    `${EMAIL_I18N_NAMESPACE}.${emailId}.${part}`,\n    intlValues,\n    intlFallback,\n  );\n\n/**\n * getEmailContent - Returns all the fields for an email\n *\n * @param {String} emailId an id representing what email this is, example:\n * auctionEnded, verificationRequested\n *\n * @return {Object} contains all the fields\n */\nexport const getEmailContent = (emailId, intlValues) => {\n  const subject = getEmailPart({ emailId, part: EMAIL_PARTS.SUBJECT });\n  const title = getEmailPart({ emailId, part: EMAIL_PARTS.TITLE });\n  const body = getEmailPart({\n    emailId,\n    part: EMAIL_PARTS.BODY,\n    intlValues: {\n      verticalSpace: '<span><br/><br/></span>',\n      ...intlValues,\n    },\n  });\n  const cta = getEmailPart({\n    emailId,\n    part: EMAIL_PARTS.CTA,\n    intlValues,\n    intlFallback: CTA_URL_DEFAULT,\n  });\n  const customFrom = getEmailPart({\n    emailId,\n    part: EMAIL_PARTS.FROM,\n    intlValues,\n    intlFallback: FROM_DEFAULT,\n  });\n\n  return {\n    subject,\n    title,\n    body,\n    cta,\n    from: customFrom,\n  };\n};\n\nexport const getEnrollmentUrl = (user, url) => {\n  if (user.roles === 'user' || user.roles.indexOf('user') >= 0) {\n    const enrollToken = url.split('/enroll-account/')[1];\n\n    return `${APP_URL}/enroll-account/${enrollToken}`;\n  }\n\n  return url;\n};\n\n/**\n * This is a default override function for the NOTIFICATION template\n *\n * @export\n * @param {Object} params The params passed by the mutation\n * @param {Object} { title, body } The strings extracted from i18n files\n * @returns a template override object\n */\nexport function notificationTemplateDefaultOverride(params, { title, body }) {\n  const { variables } = this.template;\n\n  return {\n    variables: [\n      { name: variables.TITLE, content: title },\n      { name: variables.BODY, content: body },\n    ],\n  };\n}\n\n/**\n * This is a default override function for the NOTIFICATION_AND_CTA template\n *\n * @export\n * @param {Object} params The params passed by the mutation\n * @param {Object} { title, body, cta } The strings extracted from i18n files\n * @returns a template override object\n */\nexport function notificationAndCtaTemplateDefaultOverride(\n  params,\n  { title, body, cta },\n) {\n  const { variables } = this.template;\n\n  return {\n    variables: [\n      { name: variables.TITLE, content: title },\n      { name: variables.BODY, content: body },\n      { name: variables.CTA, content: cta },\n      { name: variables.CTA_URL, content: CTA_URL_DEFAULT },\n    ],\n  };\n}\n","import moment from 'moment';\nimport EventService from '../../events';\nimport { mutations } from '../../mutations';\nimport { Loans } from '../..';\nimport { EMAIL_IDS } from '../emailConstants';\nimport { sendEmail } from './emailMethods';\nimport { getAuctionEndTime } from '../../../utils/loanFunctions';\n\nEventService.addMutationListener(\n  mutations.REQUEST_LOAN_VERIFICATION,\n  (params) => {\n    const { loanId } = params;\n    const { userId } = Loans.findOne(loanId);\n\n    return sendEmail({\n      emailId: EMAIL_IDS.VERIFICATION_REQUESTED,\n      userId,\n      params,\n    });\n  },\n);\n\nEventService.addMutationListener(mutations.START_AUCTION, (params) => {\n  const { loanId } = params;\n  const { userId } = Loans.findOne(loanId);\n\n  return sendEmail({\n    emailId: EMAIL_IDS.AUCTION_STARTED,\n    userId,\n    params: { ...params, auctionEndTime: getAuctionEndTime(moment()) },\n  });\n});\n\nEventService.addMutationListener(mutations.END_AUCTION, (params) => {\n  const { loanId } = params;\n  const { userId } = Loans.findOne(loanId);\n\n  return sendEmail({\n    emailId: EMAIL_IDS.AUCTION_ENDED,\n    userId,\n    params,\n  });\n});\n\nEventService.addMutationListener(mutations.CANCEL_AUCTION, (params) => {\n  const { loanId } = params;\n  const { userId } = Loans.findOne(loanId);\n\n  return sendEmail({\n    emailId: EMAIL_IDS.AUCTION_CANCELLED,\n    userId,\n    params,\n  });\n});\n","import { Meteor } from 'meteor/meteor';\nimport EmailService from './EmailService';\n\nconst SEND_EMAIL = 'SEND_EMAIL';\n\nMeteor.methods({\n  [SEND_EMAIL]({ emailId, userId, params }) {\n    this.unblock();\n    try {\n      EmailService.sendEmailToUser(emailId, userId, params);\n    } catch (error) {\n      throw error;\n    }\n  },\n});\n\nexport const sendEmail = params => Meteor.call(SEND_EMAIL, params);\n","import './accountsEmails';\nimport './emailMethods';\nimport { setupMandrill } from './mandrill';\n\nsetupMandrill();\n","import { Mandrill } from 'meteor/wylio:mandrill';\nimport { Meteor } from 'meteor/meteor';\n\nimport { getEmailFooter } from './emailHelpers';\n\nexport const setupMandrill = () => {\n  let key = '';\n  if (Meteor.isTest) {\n    key = Meteor.settings.MANDRILL_API_KEY_TEST;\n  } else {\n    key = Meteor.settings.MANDRILL_API_KEY;\n  }\n\n  Mandrill.config({\n    username: Meteor.settings.MANDRILL_LOGIN, // the email address you log into Mandrill with. Only used to set MAIL_URL.\n    key, // get your Mandrill key from https://mandrillapp.com/settings/index\n    port: 587, // defaults to 465 for SMTP over TLS\n    host: 'smtps.mandrillapp.com', // the SMTP host\n    // baseUrl: 'https://mandrillapp.com/api/1.0/'  // update this in case Mandrill changes its API endpoint URL or version\n  });\n};\n\n// Used for Meteor Accounts emails\nexport const getSimpleMandrillTemplate = (options) => {\n  const { templateName, allowUnsubscribe, variables } = options;\n\n  return {\n    template_name: templateName,\n    template_content: [\n      { name: 'footer', content: getEmailFooter(allowUnsubscribe) },\n    ],\n    merge_vars: variables,\n  };\n};\n\n// Used for all other emails\nexport const getMandrillTemplate = ({\n  templateName,\n  allowUnsubscribe,\n  variables,\n  recipientAddress,\n  senderAddress,\n  senderName,\n  subject,\n  sendAt,\n}) => ({\n  template_name: templateName,\n  template_content: [\n    { name: 'footer', content: getEmailFooter(allowUnsubscribe) },\n  ],\n  message: {\n    from_email: senderAddress,\n    from_name: senderName,\n    subject,\n    to: [{ email: recipientAddress, type: 'to' }],\n    merge_vars: [{ rcpt: recipientAddress, vars: variables }],\n  },\n  send_at: sendAt ? sendAt.toISOString() : undefined,\n});\n\nexport const renderMandrillTemplate = mandrillTemplate =>\n  Mandrill.templates.render(mandrillTemplate);\n\nexport const sendMandrillTemplate = mandrillTemplate =>\n  new Promise((resolve, reject) => {\n    Mandrill.messages.sendTemplate(mandrillTemplate, (error, result) => {\n      if (error) {\n        reject(error);\n      }\n      const content = JSON.parse(result.content)[0];\n      resolve(content);\n    });\n  });\n","import { Meteor } from 'meteor/meteor';\n\nexport const FROM_NAME = \"Yannis d'e-Potek\";\nexport const FROM_EMAIL = 'info@e-potek.ch';\nexport const FROM_DEFAULT = `${FROM_NAME} <${FROM_EMAIL}>`;\nexport const CTA_URL_DEFAULT = Meteor.settings.public.subdomains.app;\n\nexport const EMAIL_I18N_NAMESPACE = 'emails';\n\nexport const EMAIL_PARTS = {\n  SUBJECT: 'SUBJECT',\n  TITLE: 'TITLE',\n  BODY: 'BODY',\n  CTA: 'CTA',\n  FROM: 'FROM',\n};\n\nexport const EMAIL_TEMPLATES = {\n  WELCOME: {\n    name: 'WELCOME',\n    mandrillId: 'welcome',\n    variables: {\n      VERIFICATION_URL: 'VERIFICATION_URL',\n    },\n  },\n  NOTIFICATION: {\n    name: 'NOTIFICATION',\n    mandrillId: 'notification',\n    variables: {\n      TITLE: 'TITLE',\n      BODY: 'BODY',\n    },\n  },\n  NOTIFICATION_AND_CTA: {\n    name: 'NOTIFICATION_AND_CTA',\n    mandrillId: 'notification-cta',\n    variables: {\n      TITLE: 'TITLE',\n      BODY: 'BODY',\n      CTA: 'CTA',\n      CTA_URL: 'CTA_URL',\n    },\n  },\n};\n\nexport const EMAIL_IDS = {\n  VERIFY_EMAIL: 'VERIFY_EMAIL',\n  RESET_PASSWORD: 'RESET_PASSWORD',\n  ENROLL_ACCOUNT: 'ENROLL_ACCOUNT',\n  VERIFICATION_REQUESTED: 'VERIFICATION_REQUESTED',\n  VERIFICATION_ERROR: 'VERIFICATION_ERROR',\n  VERIFICATION_PASSED: 'VERIFICATION_PASSED',\n  AUCTION_STARTED: 'AUCTION_STARTED',\n  AUCTION_ENDED: 'AUCTION_ENDED',\n  AUCTION_CANCELLED: 'AUCTION_CANCELLED',\n};\n","import { Meteor } from 'meteor/meteor';\nimport AWS from 'aws-sdk';\nimport { check } from 'meteor/check';\nimport { Roles } from 'meteor/alanning:roles';\nimport rateLimit from '../../../utils/rate-limit.js';\n\nimport Loans from 'core/api/loans/loans';\nimport Borrowers from 'core/api/borrowers/borrowers';\n\n/* eslint import/prefer-default-export: 0 */\nexport const isAllowed = (key) => {\n  // Check if this user is the owner of the document he's trying to delete a\n  // file from\n  const keyId = key.split('/')[0];\n  const loanFound = !!Loans.findOne({\n    _id: keyId,\n    userId: Meteor.userId(),\n  });\n  const borrowerFound = !!Borrowers.findOne({\n    _id: keyId,\n    userId: Meteor.userId(),\n  });\n\n  if (\n    Roles.userIsInRole(Meteor.userId(), 'admin') ||\n    Roles.userIsInRole(Meteor.userId(), 'dev')\n  ) {\n    return true;\n  } else if (!(loanFound || borrowerFound)) {\n    throw new Meteor.Error('unauthorized email');\n  }\n\n  return true;\n};\n\nconst setupS3 = () => {\n  AWS.config.update({\n    accessKeyId: Meteor.settings.AWS.users.accessKeyId,\n    secretAccessKey: Meteor.settings.AWS.users.secretAccesskey,\n  });\n\n  return new AWS.S3({ signatureVersion: 'v4' });\n};\n\nMeteor.methods({\n  deleteFile(key) {\n    check(key, String);\n    isAllowed(key);\n\n    const s3 = setupS3();\n    const params = { Bucket: Meteor.settings.S3Bucket, Key: key };\n\n    // bind s3 to avoid an error of context 'makeLoan is not a function'\n    const async = Meteor.wrapAsync(s3.deleteObject.bind(s3));\n    return async(params);\n  },\n  downloadFile(key) {\n    check(key, String);\n    isAllowed(key);\n\n    const s3 = setupS3();\n    const params = { Bucket: Meteor.settings.S3Bucket, Key: key };\n\n    // Don't ask me why this works...\n    // https://gist.github.com/rclai/b9331afd2fbabadb0074\n    const async = Meteor.wrapAsync((parameters, callback) =>\n      s3.getObject(parameters, (error, data) => {\n        callback(error, data);\n      }));\n\n    return async(params);\n  },\n});\n\nrateLimit({ methods: ['deleteFile', 'downloadFile'] });\n","export const FILE_STATUS = {\n  UNVERIFIED: 'UNVERIFIED',\n  VALID: 'VALID',\n  ERROR: 'ERROR',\n};\n","import SimpleSchema from 'simpl-schema';\nimport { FILE_STATUS, PURCHASE_TYPE, USAGE_TYPE } from '../constants';\n\nexport const borrowerFiles = (b = {}) => ({\n  auction: [\n    {\n      id: 'identity',\n    },\n    {\n      id: 'residencyPermit',\n      condition: !b.isSwiss,\n    },\n    {\n      id: 'taxes',\n      // condition: true, //TODO: implement married couple logic\n    },\n    {\n      id: 'salaryCertificate',\n    },\n    {\n      id: 'bonus',\n      condition: !!b.bonus && Object.keys(b.bonus).length > 0,\n    },\n    {\n      id: 'otherIncome',\n      condition: b.otherIncome && !!(b.otherIncome.length > 0),\n    },\n    {\n      id: 'ownCompanyFinancialStatements',\n      condition: !!b.worksForOwnCompany,\n    },\n    {\n      id: 'divorceJudgment',\n      condition: !b.civilStatus === 'divorced',\n      noTooltips: true,\n    },\n    {\n      id: 'expenses',\n      condition: !!b.otherIncome && !!(b.otherIncome.length > 0),\n    },\n  ],\n  contract: [\n    {\n      id: 'nonPursuitExtract',\n      doubleTooltip: true,\n    },\n    {\n      id: 'lastSalaries',\n      noTooltips: true,\n    },\n    {\n      id: 'currentMortgages',\n      condition: !!b.realEstate && !!b.realEstate.length > 0,\n    },\n    {\n      id: 'bankAssetsChange',\n      condition: b.fortuneChange,\n    },\n    {\n      id: 'pensionFundYearlyStatement',\n      condition: b.insuranceSecondPillar > 0,\n      doubleTooltip: true,\n    },\n    {\n      id: 'retirementInsurancePlan',\n      condition: b.insuranceThirdPillar > 0, // TODO, separate from insurance and other below\n      doubleTooltip: true,\n    },\n    {\n      id: 'retirementPlanOther',\n      // condition: true, TODO\n      condition: false,\n      doubleTooltip: true,\n    },\n  ],\n  closing: [],\n  all() {\n    return [...this.auction, ...this.contract, ...this.closing];\n  },\n});\n\nexport const loanFiles = (r = {}) => ({\n  auction: [\n    // {\n    //   id: 'plans',\n    // },\n    // {\n    //   id: 'cubage',\n    //   doubleTooltip: true,\n    //   condition: r.propertyId && r.propertyId.style === 'villa',\n    // },\n    // {\n    //   id: 'pictures',\n    // },\n    // {\n    //   id: 'marketingBrochure',\n    //   condition: !!r.general && r.general.purchaseType === 'acquisition',\n    //   required: false,\n    // },\n  ],\n  contract: [\n    {\n      id: 'buyersContract',\n      tooltipSuffix:\n        !!r.general && r.general.purchaseType === 'refinancing' ? 'a' : 'b',\n    },\n    {\n      id: 'reimbursementStatement',\n      condition: !!r.general && r.general.purchaseType === 'refinancing',\n    },\n    {\n      id: 'rent',\n      condition: !!r.general && r.general.usageType === 'investment',\n      doubleTooltip: true,\n    },\n    {\n      id: 'coownershipAllocationAgreement',\n      condition: !!r.propertyId && !!r.propertyId.isCoproperty,\n      doubleTooltip: true,\n    },\n    {\n      id: 'coownershipAgreement',\n      condition: !!r.propertyId && !!r.propertyId.isCoproperty,\n      doubleTooltip: true,\n    },\n    {\n      id: 'fireAndWaterInsurance',\n      condition: !!(r.propertyId && r.propertyId.isNew),\n    },\n  ],\n  closing: [],\n  // closing: [\n  //   {\n  //     id: 'retirementWithdrawalStatement',\n  //     label: 'Attestation LPP - après retrait',\n  //     help1: 'Certificat émis sur votre demande par votre caisse de pension démontrant votre situation LPP après retrait',\n  //     help2: 'Vous pouvez obtenir ce document, sur demande, auprès de votre caisse de pension',\n  //     condition: !!r.logic && r.insuranceUsePreset === 'withdrawal',\n  //   },\n  // ],\n  other: [\n    { id: 'upload0' },\n    { id: 'upload1' },\n    { id: 'upload2' },\n    { id: 'upload3' },\n    { id: 'upload4' },\n  ],\n  admin: [{ id: 'contract' }, { id: 'signedContract' }],\n  all() {\n    return [\n      ...this.auction,\n      ...this.contract,\n      ...this.closing,\n      ...this.admin,\n      ...this.other,\n    ];\n  },\n});\n\nexport const propertyFiles = (property = {}, loan = {}) => ({\n  auction: [\n    {\n      id: 'plans',\n    },\n    {\n      id: 'cubage',\n      doubleTooltip: true,\n      condition: property.style === 'villa',\n    },\n    {\n      id: 'pictures',\n    },\n    {\n      id: 'marketingBrochure',\n      condition: !!(\n        loan &&\n        loan.general &&\n        loan.general.purchaseType === PURCHASE_TYPE.ACQUISITION\n      ),\n      required: false,\n    },\n  ],\n  contract: [\n    {\n      id: 'rent',\n      condition:\n        !!loan.general && loan.general.usageType === USAGE_TYPE.INVESTMENT,\n      doubleTooltip: true,\n    },\n    {\n      id: 'landRegisterExtract',\n      doubleTooltip: true,\n    },\n  ],\n  all() {\n    return [...this.auction, ...this.contract];\n  },\n});\n\nexport const getFileIDs = (list) => {\n  let files;\n  const ids = [];\n  switch (list) {\n  case 'borrower':\n    files = borrowerFiles();\n    break;\n  case 'loan':\n    files = loanFiles();\n    break;\n  case 'property':\n    files = propertyFiles();\n    break;\n  default:\n    throw new Error('invalid file list');\n  }\n\n  files.all().forEach(f => ids.push(f.id));\n\n  return ids;\n};\n\n// Schema used for every file\nexport const FileSchema = new SimpleSchema({\n  name: String,\n  initialName: String,\n  size: Number,\n  type: String,\n  url: {\n    type: String,\n    regEx: SimpleSchema.RegEx.Url,\n  },\n  key: String,\n  fileCount: Number,\n  status: {\n    type: String,\n    allowedValues: Object.values(FILE_STATUS),\n  },\n  error: { optional: true, type: String },\n});\n\n// Generates a schema given a list name (loan, or borrowers)\nexport const getFileSchema = (list) => {\n  const schema = {};\n\n  const arr = getFileIDs(list);\n\n  arr.forEach((id) => {\n    schema[id] = {\n      type: Array,\n      optional: true,\n      maxCount: 100,\n    };\n    schema[`${id}.$`] = FileSchema;\n  });\n\n  return schema;\n};\n\nexport const fakeFile = {\n  name: 'fakeFile.pdf',\n  initialName: 'fakeFile.pdf',\n  size: 10000,\n  type: 'application/pdf',\n  url: 'https://www.fake-url.com',\n  key: 'asdf/fakeKey/fakeFile.pdf',\n  fileCount: 0,\n  status: FILE_STATUS.VALID,\n  error: '',\n};\n\nexport const getFileCount = (currentValue) => {\n  let fileCountString = '00';\n  let fileCount = 0;\n  if (currentValue && currentValue.length > 0) {\n    // If something goes wrong, minimum should be -1 + 1 = 0\n    fileCount = Math.max(...currentValue.map(f => f.fileCount), -1) + 1;\n    fileCountString = fileCount < 10 ? `0${fileCount}` : `${fileCount}`;\n  }\n  return { fileCount, fileCountString };\n};\n","import { Meteor } from 'meteor/meteor';\nimport { Slingshot } from 'meteor/edgee:slingshot';\nimport { Roles } from 'meteor/alanning:roles';\n\nimport Loans from 'core/api/loans/loans';\nimport Borrowers from 'core/api/borrowers/borrowers';\nimport { getFileCount } from './files';\nimport './meteor-slingshot';\n\nSlingshot.createDirective('myFileUploads', Slingshot.S3Storage, {\n  authorize(file, { collection, docId }) {\n    // Don't use arrow function, this is the current object here\n\n    // Check for devs and admins\n    if (\n      Roles.userIsInRole(this.userId, 'admin') ||\n      Roles.userIsInRole(this.userId, 'dev')\n    ) {\n      return true;\n    }\n\n    // Deny uploads if user is not logged in.\n    if (!this.userId) {\n      throw new Meteor.Error(\n        'Login Required',\n        'Please login before uploading files',\n      );\n    }\n\n    // Make sure this user is the owner of the document\n    if (collection === 'borrowers') {\n      const doc = Borrowers.findOne(docId);\n\n      if (doc.userId !== this.userId) {\n        throw new Meteor.Error('Invalid user', \"You're not allowed to do this\");\n      }\n    } else if (collection === 'loans') {\n      const doc = Loans.findOne(docId);\n      if (doc.userId !== this.userId) {\n        throw new Meteor.Error('Invalid user', \"You're not allowed to do this\");\n      }\n    } else {\n      throw new Meteor.Error('Invalid collection', \"Collection doesn't exist\");\n    }\n\n    return true;\n  },\n  key(file, { currentValue, docId, id }) {\n    const { fileCountString } = getFileCount(currentValue);\n\n    return `${docId}/${id}/${fileCountString}${file.name}`;\n  },\n});\n","import { Slingshot } from 'meteor/edgee:slingshot';\n\nexport const allowedFileTypes = ['image/png', 'image/jpeg', 'application/pdf'];\nexport const maxSize = 50 * 1024 * 1024; // 50 MB (use null for unlimited).\n\nSlingshot.fileRestrictions('myFileUploads', { allowedFileTypes, maxSize });\n","import { Job } from 'meteor/vsivsi:job-collection';\nimport Jobs from './jobs';\nimport { SCHEDULE_METHOD } from './jobConstants';\n\nclass JobService {\n  scheduleMethod = ({ method, params, date }) => {\n    const jobId = new Job(Jobs, SCHEDULE_METHOD, { method, params })\n      .after(date)\n      .save();\n    return jobId;\n  };\n\n  scheduleMutation = ({ mutation: { name }, params, date }) =>\n    this.scheduleMethod({ method: name, params, date });\n\n  cancelJob = ({ jobId }) => Jobs.cancelJobs([jobId]);\n\n  removeJob = ({ jobId }) => Jobs.removeJobs([jobId]);\n\n  cancelExistingJob = ({ method, params }) => {\n    const job = Jobs.findOne({ 'data.method': method, 'data.params': params });\n    if (job && job._id) {\n      this.cancelJob({ jobId: job._id });\n    }\n  };\n\n  cancelExistingMutationJob = ({ mutation: { name }, params }) => {\n    this.cancelExistingJob({ method: name, params });\n  };\n}\n\nexport default new JobService();\n","export { default } from './jobs';\n","export const SCHEDULE_METHOD = 'SCHEDULE_METHOD';\nexport const CANCEL_JOB = 'CANCEL_JOB';\nexport const REMOVE_JOB = 'REMOVE_JOB';\n","import moment from 'moment';\nimport EventService from '../../events';\nimport { mutations } from '../../mutations';\nimport JobService from './JobService';\nimport { getAuctionEndTime } from '../../../utils/loanFunctions';\n\nEventService.addMutationListener(mutations.START_AUCTION, (params) => {\n  JobService.cancelExistingMutationJob({\n    mutation: mutations.END_AUCTION,\n    params,\n  });\n\n  JobService.scheduleMutation({\n    mutation: mutations.END_AUCTION,\n    params,\n    date: getAuctionEndTime(moment()),\n  });\n});\n","import { Meteor } from 'meteor/meteor';\nimport { JobCollection } from 'meteor/vsivsi:job-collection';\nimport { SCHEDULE_METHOD } from './jobConstants';\n\nconst Jobs = new JobCollection('jobs');\n\nconst jobList = [\n  {\n    type: SCHEDULE_METHOD,\n    options: { pollInterval: 5000 },\n    run: (data, callback) => {\n      console.log('calling scheduled method..');\n\n      const { method, params } = data;\n\n      if (typeof method !== 'string') {\n        throw new Error('invalid method name');\n      }\n\n      Meteor.call(method, ...params, (err, result) => {\n        if (err) {\n          callback(err, undefined);\n        } else {\n          callback(err, result);\n        }\n      });\n    },\n  },\n];\n\njobList.forEach((jobObject) => {\n  Jobs.processJobs(\n    jobObject.type,\n    { pollInterval: 5000, ...jobObject.options },\n    (job, callback) => {\n      const { type, data, done, fail } = job;\n      try {\n        jobObject.run(data, (err, result) => {\n          if (err) {\n            fail(err);\n          } else {\n            done(result);\n          }\n          callback();\n        });\n      } catch (error) {\n        fail(error);\n        callback();\n      }\n    },\n  );\n});\n\nexport default Jobs;\n","import Security from 'core/api/security';\nimport query from './adminLoanView';\n\nquery.expose({\n  firewall(userId, params) {\n    Security.checkCurrentUserIsAdmin(userId);\n  },\n});\n","import { Loans } from '../../';\nimport { LOAN_QUERIES } from '../loanConstants';\n\nexport default Loans.createQuery(LOAN_QUERIES.ADMIN_LOAN, {\n  $filter({ filters, params }) {\n    filters._id = params._id;\n  },\n  name: 1,\n  logic: 1,\n  general: 1,\n  createdAt: 1,\n  updatedAt: 1,\n  files: 1,\n  property: {\n    userId: 1,\n    createdAt: 1,\n    updatedAt: 1,\n    status: 1,\n    value: 1,\n    propertyWork: 1,\n    usageType: 1,\n    investmentRent: 1,\n    style: 1,\n    address: 1,\n    address1: 1,\n    address2: 1,\n    zipCode: 1,\n    city: 1,\n    constructionYear: 1,\n    renovationYear: 1,\n    insideArea: 1,\n    landArea: 1,\n    balconyArea: 1,\n    terraceArea: 1,\n    roomCount: 1,\n    bathroomCount: 1,\n    toiletCount: 1,\n    volume: 1,\n    volumeNorm: 1,\n    parking: 1,\n    minergie: 1,\n    isCoproperty: 1,\n    isNew: 1,\n    copropertyPercentage: 1,\n    cityPlacementQuality: 1,\n    buildingPlacementQuality: 1,\n    buildingQuality: 1,\n    flatQuality: 1,\n    materialsQuality: 1,\n    otherNotes: 1,\n    pictures: 1,\n    name: 1,\n    latitude: 1,\n    longitude: 1,\n    nearestBusStation: 1,\n    nearestTrainStation: 1,\n    customFields: 1,\n    adminValidation: 1,\n    files: 1,\n  },\n  borrowers: {\n    firstName: 1,\n    lastName: 1,\n    gender: 1,\n    address1: 1,\n    zipCode: 1,\n    city: 1,\n    age: 1,\n    birthPlace: 1,\n    civilStatus: 1,\n    childrenCount: 1,\n    company: 1,\n    personalBank: 1,\n    isSwiss: 1,\n    isUSPerson: 1,\n    worksForOwnCompany: 1,\n    sameAddress: 1,\n    salary: 1,\n    bonusExists: 1,\n    bonus: 1,\n    otherIncome: 1,\n    expenses: 1,\n    realEstate: 1,\n    bankFortune: 1,\n    insuranceSecondPillar: 1,\n    insuranceThirdPillar: 1,\n    files: 1,\n    logic: 1,\n    otherFortune: 1,\n    corporateBankExists: 1,\n    adminValidation: 1,\n  },\n  tasks: {\n    status: 1,\n    createdAt: 1,\n    updatedAt: 1,\n    dueAt: 1,\n    assignedUser: {\n      emails: 1,\n      roles: 1,\n    },\n  },\n});\n","import Security from 'core/api/security';\nimport query from './adminLoansList';\n\nquery.expose({\n  firewall(userId) {\n    Security.checkCurrentUserIsAdmin(userId);\n  },\n});\n","import Loans from '..';\nimport { LOAN_QUERIES } from '../loanConstants';\n\nexport default Loans.createQuery(LOAN_QUERIES.ADMIN_LOANS, {\n  $options: {\n    sort: {\n      createdAt: -1,\n    },\n  },\n  name: 1,\n  logic: 1,\n  general: 1,\n  createdAt: 1,\n  updatedAt: 1,\n  property: {\n    value: 1,\n  },\n});\n","import './adminLoansList.expose';\nimport './adminLoanView.expose';\n","import { Meteor } from 'meteor/meteor';\nimport { ValidatedMethod } from 'meteor/mdg:validated-method';\nimport { check, Match } from 'meteor/check';\nimport moment from 'moment';\nimport { Roles } from 'meteor/alanning:roles';\nimport { CallPromiseMixin } from 'meteor/didericis:callpromise-mixin';\nimport rateLimit from '../../../utils/rate-limit.js';\nimport { getAuctionEndTime } from '../../../utils/loanFunctions';\n\nimport {\n  insertAdminAction,\n  completeActionByType,\n  removeParentLoan,\n} from 'core/api/adminActions/server/methods';\n\nimport Loans from '../loans';\nimport {\n  ADMIN_ACTION_TYPE,\n  ADMIN_ACTION_STATUS,\n  LOAN_STATUS,\n  AUCTION_STATUS,\n} from '../../constants';\n\nconst importServerMethods = () => {\n  if (Meteor.isServer || (!!this && !this.isSimulation)) {\n    const {\n      scheduleMethod,\n      rescheduleJob,\n    } = require('core/api/jobs/server/methods');\n    const {\n      sendEmail,\n      cancelScheduledEmail,\n      rescheduleEmail,\n    } = require('core/api/email/server/email-methods');\n\n    return {\n      scheduleMethod,\n      sendEmail,\n      cancelScheduledEmail,\n      rescheduleEmail,\n    };\n  }\n};\n\nexport const insertLoan = new ValidatedMethod({\n  name: 'insertLoan',\n  mixins: [CallPromiseMixin],\n  validate() {},\n  run({ object, userId }) {\n    // const loanCount = Loans.find({ userId: Meteor.userId() }).count();\n    //\n    // if (loanCount > 3) {\n    //   throw new Meteor.Error(\n    //     'maxLoans',\n    //     'Vous ne pouvez pas avoir plus de 3 requêtes à la fois',\n    //   );\n    // }\n    //\n    // console.log(object);\n\n    // Allow adding a userId for testing purposes\n    return Loans.insert({\n      ...object,\n      // Do this to allow userId to be null\n      userId: userId === undefined ? Meteor.userId() : userId,\n    });\n  },\n});\n\n\n// Lets you set an entire object in the document\nexport const updateLoan = new ValidatedMethod({\n  name: 'updateLoan',\n  mixins: [CallPromiseMixin],\n  validate({ id }) {\n    check(id, String);\n  },\n  run({ object, id }) {\n    return Loans.update(id, { $set: object });\n  },\n});\n\n// Increments the step of the loan, if conditions are true\nexport const incrementStep = new ValidatedMethod({\n  name: 'incrementStep',\n  mixins: [CallPromiseMixin],\n  validate({ id }) {\n    check(id, String);\n  },\n  run({ id }) {\n    const loan = Loans.findOne(id);\n    const currentStep = loan.logic.step;\n\n\n\n    return Loans.update(id, { $set: { 'logic.step': currentStep + 1 } });\n  },\n});\n\nexport const startAuction = new ValidatedMethod({\n  name: 'startAuction',\n  mixins: [CallPromiseMixin],\n  validate({ id, object }) {\n    check(id, String);\n    check(object, Match.Optional(Object));\n  },\n  run({ object, id }) {\n    let auctionEndTime;\n\n    // object parameter only contains the isDemo value\n    if (object.isDemo) {\n      auctionEndTime = moment()\n        .add(30, 's')\n        .toDate();\n      console.log(`Temps de fin réel: ${getAuctionEndTime(moment())}`);\n    } else {\n      auctionEndTime = getAuctionEndTime(moment());\n    }\n\n    const auctionObject = {\n      'logic.auction.status': AUCTION_STATUS.STARTED,\n      'logic.auction.startTime': moment().toDate(),\n      'logic.auction.endTime': auctionEndTime,\n    };\n\n    if (Meteor.isServer) {\n      const { scheduleMethod, sendEmail } = importServerMethods();\n\n      Loans.update(id, { $set: auctionObject });\n      return insertAdminAction\n        .callPromise({\n          loanId: id,\n          type: ADMIN_ACTION_TYPE.AUCTION,\n          extra: { auctionEndTime },\n        })\n        .then(() =>\n          sendEmail.callPromise({\n            emailId: 'auctionStarted',\n            loanId: id,\n            intlValues: { date: auctionEndTime },\n          }))\n        .then(() =>\n          scheduleMethod.callPromise({\n            method: 'loans.endAuction',\n            params: [{ id }],\n            date: auctionEndTime,\n          }))\n        .then(() => 'success')\n        .catch((e) => {\n          throw e;\n        });\n    }\n  },\n});\n\n// Lets you push a value to an array\nexport const pushLoanValue = new ValidatedMethod({\n  name: 'pushLoanValue',\n  mixins: [CallPromiseMixin],\n  validate({ id }) {\n    check(id, String);\n  },\n  run({ object, id }) {\n    const result = Loans.update(id, { $push: object });\n    return result;\n  },\n});\n\n// Lets you pop a value from the end of an array\nexport const popLoanValue = new ValidatedMethod({\n  name: 'popLoanValue',\n  mixins: [CallPromiseMixin],\n  validate({ id }) {\n    check(id, String);\n  },\n  run({ object, id }) {\n    return Loans.update(id, { $pop: object });\n  },\n});\n\nexport const loanVerification = new ValidatedMethod({\n  name: 'loanVerification',\n  mixins: [CallPromiseMixin],\n  validate({ id }) {\n    check(id, String);\n  },\n  run({ id }) {\n    const loan = Loans.findOne(id);\n\n    if (loan.logic.verification.requested) {\n      // Don't do anything if this loan is already in requested mode\n      return false;\n    }\n\n    // Insert an admin action and set the proper keys in the loan\n    Loans.update(\n      id,\n      {\n        $set: {\n          'logic.verification.requested': true,\n          'logic.verification.requestedTime': new Date(),\n        },\n      },\n      (err) => {\n        if (!err && Meteor.isServer) {\n          const {\n            scheduleMethod,\n            sendEmail,\n            cancelScheduledEmail,\n            rescheduleEmail,\n          } = importServerMethods();\n\n          sendEmail.call({\n            emailId: 'verificationRequested',\n            loanId: id,\n          });\n        }\n      },\n    );\n    return Meteor.wrapAsync(insertAdminAction.call({\n      type: ADMIN_ACTION_TYPE.VERIFY,\n      loanId: id,\n    }));\n  },\n});\n\nexport const deleteLoan = new ValidatedMethod({\n  name: 'deleteLoan',\n  mixins: [CallPromiseMixin],\n  validate({ id }) {\n    check(id, String);\n  },\n  run({ id }) {\n    if (\n      Roles.userIsInRole(Meteor.userId(), 'dev') ||\n      Roles.userIsInRole(Meteor.userId(), 'admin')\n    ) {\n      return Loans.remove(id, (err) => {\n        if (!err) {\n          removeParentLoan.call({ loanId: id });\n        }\n      });\n    }\n\n    throw new Meteor.Error('not authorized');\n  },\n});\n\nexport const endAuction = new ValidatedMethod({\n  name: 'endAuction',\n  mixins: [CallPromiseMixin],\n  validate({ id }) {\n    check(id, String);\n  },\n  run({ id }) {\n    console.log('ending loan..');\n    const loan = Loans.findOne(id);\n\n    // This method is called in the future, so make sure that it isn't\n    // executed again if this has already been done\n    if (!loan || loan.logic.auction.status === AUCTION_STATUS.ENDED) {\n      return;\n    }\n\n    Loans.update(id, {\n      $set: {\n        'logic.auction.status': AUCTION_STATUS.ENDED,\n        'logic.auction.endTime': new Date(),\n      },\n    });\n\n    completeActionByType.call({\n      loanId: id,\n      type: ADMIN_ACTION_TYPE.AUCTION,\n    });\n\n    if (Meteor.isServer) {\n      const {\n        scheduleMethod,\n        sendEmail,\n        cancelScheduledEmail,\n        rescheduleEmail,\n      } = importServerMethods();\n\n      const loan = Loans.findOne(id);\n      const email = loan.emails.find(e => e && e.emailId === 'auctionEnded' && e.scheduledAt >= new Date());\n      if (email) {\n        cancelScheduledEmail.call('email.cancelScheduled', {\n          id: email._id,\n\n          loanId: id,\n          template: 'notification+CTA',\n        });\n      }\n    }\n  },\n});\n\nexport const cancelAuction = new ValidatedMethod({\n  name: 'cancelAuction',\n  mixins: [CallPromiseMixin],\n  validate({ id }) {\n    check(id, String);\n  },\n  run({ id }) {\n    if (\n      Roles.userIsInRole(Meteor.userId(), 'admin') ||\n      Roles.userIsInRole(Meteor.userId(), 'dev')\n    ) {\n      return Loans.update(\n        id,\n        {\n          $set: {\n            'logic.auction.endTime': undefined,\n            'logic.auction.status': '',\n            'logic.auction.startTime': undefined,\n          },\n        },\n        (error) => {\n          if (!error && Meteor.isServer) {\n            const {\n              scheduleMethod,\n              sendEmail,\n              cancelScheduledEmail,\n              rescheduleEmail,\n            } = importServerMethods();\n\n            const loan = Loans.findOne(id);\n            const email = loan.emails.find(e =>\n              e && e.emailId === 'auctionEnded' && e.scheduledAt >= new Date());\n            if (email) {\n              cancelScheduledEmail.call('email.cancelScheduled', {\n                id: email._id,\n                loanId: id,\n              });\n            }\n          }\n\n          completeActionByType.call({\n            loanId: id,\n            type: ADMIN_ACTION_TYPE.AUCTION,\n            newStatus: ADMIN_ACTION_STATUS.CANCELLED,\n          });\n        },\n      );\n    }\n\n    throw new Meteor.Error('not authorized');\n  },\n});\n\nexport const confirmClosing = new ValidatedMethod({\n  name: 'confirmClosing',\n  mixins: [CallPromiseMixin],\n  validate({ id }) {\n    check(id, String);\n  },\n  run({ id, object }) {\n    // TODO: Send email to user, clean up, etc.\n\n    if (\n      Roles.userIsInRole(Meteor.userId(), 'admin') ||\n      Roles.userIsInRole(Meteor.userId(), 'dev')\n    ) {\n      return Loans.update(id, {\n        $set: { status: LOAN_STATUS.DONE, ...object },\n      });\n    }\n\n    throw new Meteor.Error('not authorized');\n  },\n});\n\nexport const addEmail = new ValidatedMethod({\n  name: 'addEmail',\n  mixins: [CallPromiseMixin],\n  validate({ loanId, emailId, _id, status, sendAt }) {\n    check(loanId, String);\n    check(emailId, String);\n    check(_id, String);\n    check(status, String);\n    check(sendAt, Match.Optional(Date));\n  },\n  run({ loanId, emailId, _id, status, sendAt }) {\n    const object = {\n      emailId,\n      _id,\n      status,\n      updatedAt: new Date(),\n    };\n\n    if (sendAt) {\n      object.scheduledAt = sendAt;\n    }\n\n    return Loans.update(loanId, { $push: { emails: object } });\n  },\n});\n\nexport const modifyEmail = new ValidatedMethod({\n  name: 'modifyEmail',\n  mixins: [CallPromiseMixin],\n  validate({ loanId, _id, status, sendAt }) {\n    check(loanId, String);\n    check(_id, String);\n    check(status, Match.Optional(String));\n    check(sendAt, Match.Optional(Date));\n  },\n  run({ loanId, _id, status, sendAt }) {\n    const object = {\n      'emails.$.status': status,\n      'emails.$.updatedAt': new Date(),\n    };\n\n    if (sendAt) {\n      object['emails.$.scheduledAt'] = sendAt;\n    }\n\n    return Loans.update({ _id: loanId, 'emails._id': _id }, { $set: object });\n  },\n});\n\nrateLimit({\n  methods: [\n    insertLoan,\n    updateLoan,\n    incrementStep,\n    startAuction,\n    pushLoanValue,\n    popLoanValue,\n    loanVerification,\n    // deleteLoan,\n    cancelAuction,\n    confirmClosing,\n    addEmail,\n    modifyEmail,\n  ],\n});\n","import { Meteor } from 'meteor/meteor';\n\nimport SecurityService from '../../security';\nimport { createMutator } from '../../mutations';\nimport LoanService from '../LoanService';\nimport * as defs from '../mutationDefinitions';\n\ncreateMutator(defs.LOAN_INSERT, ({ object, userId }) => {\n  const userIdIsDefined = userId !== undefined;\n  if (userIdIsDefined) {\n    SecurityService.checkCurrentUserIsAdmin();\n  } else {\n    SecurityService.loans.isAllowedToInsert();\n  }\n\n  return LoanService.insert({\n    object,\n    userId: userIdIsDefined ? userId : Meteor.userId(),\n  });\n});\n\ncreateMutator(defs.LOAN_UPDATE, ({ loanId, object }) => {\n  SecurityService.loans.isAllowedToUpdate(loanId);\n  return LoanService.update({ loanId, object });\n});\n\ncreateMutator(defs.LOAN_DELETE, ({ loanId }) => {\n  SecurityService.loans.isAllowedToDelete(loanId);\n  return LoanService.delete({ loanId });\n});\n\ncreateMutator(defs.INCREMENT_LOAN_STEP, ({ loanId }) => {\n  SecurityService.loans.isAllowedToUpdate(loanId);\n  return LoanService.incrementStep({ loanId });\n});\n\ncreateMutator(defs.REQUEST_LOAN_VERIFICATION, ({ loanId }) => {\n  SecurityService.loans.isAllowedToUpdate(loanId);\n  return LoanService.askVerification({ loanId });\n});\n\ncreateMutator(defs.START_AUCTION, ({ loanId }) => {\n  SecurityService.loans.isAllowedToUpdate(loanId);\n  return LoanService.startAuction({ loanId });\n});\n\ncreateMutator(defs.END_AUCTION, ({ loanId }) => {\n  SecurityService.checkCurrentUserIsAdmin();\n  return LoanService.startAuction({ loanId });\n});\n\ncreateMutator(defs.CANCEL_AUCTION, ({ loanId }) => {\n  SecurityService.checkCurrentUserIsAdmin();\n  return LoanService.startAuction({ loanId });\n});\n\ncreateMutator(defs.CONFIRM_CLOSING, ({ loanId, object }) => {\n  SecurityService.checkCurrentUserIsAdmin();\n  return LoanService.confirmClosing({ loanId, object });\n});\n","import { Meteor } from 'meteor/meteor';\nimport { check } from 'meteor/check';\nimport Loans from '../loans';\nimport { Roles } from 'meteor/alanning:roles';\n\n// Publish a specific loan with an ID\nMeteor.publish('loan', function publish(id) {\n  // Verify if user is logged In\n  if (!Meteor.userId()) {\n    return this.ready();\n  }\n\n  check(id, String);\n\n  if (\n    Roles.userIsInRole(Meteor.userId(), 'admin') ||\n    Roles.userIsInRole(Meteor.userId(), 'dev')\n  ) {\n    return Loans.find({\n      _id: id,\n    });\n  }\n\n  return Loans.find({\n    userId: Meteor.userId(),\n    _id: id,\n  });\n\n  // Throw unauthorized error\n});\n\n// Publish all loans from the current user\nMeteor.publish('loans', function publish() {\n  // Verify if user is logged In\n  if (!Meteor.userId()) {\n    return this.ready();\n  }\n\n  return Loans.find({\n    userId: Meteor.userId(),\n  });\n});\n\n// Publish all loans for a user\nMeteor.publish('userLoans', (userId) => {\n  check(userId, String);\n\n  // Verify if user is logged In\n  if (\n    Roles.userIsInRole(Meteor.userId(), 'admin') ||\n    Roles.userIsInRole(Meteor.userId(), 'dev')\n  ) {\n    // Return all users\n    return Loans.find({ userId });\n  }\n\n  return this.ready();\n});\n\n// Publish all loans in the database for admins\nMeteor.publish('allLoans', function publish() {\n  // Verify if user is logged In\n  if (\n    Roles.userIsInRole(Meteor.userId(), 'admin') ||\n    Roles.userIsInRole(Meteor.userId(), 'dev')\n  ) {\n    // Return all users\n    return Loans.find();\n  }\n\n  return this.ready();\n});\n\n// The fields visible to partners\nconst partnerVisibleFields = organization => ({\n  // TODO: Complete this\n  'general.purchaseType': 1,\n  'general.usageType': 1,\n  'general.fortuneUsed': 1,\n  'general.insuranceFortuneUsed': 1,\n  'general.incomeUsed': 1,\n\n  'borrowers.age': 1,\n  'borrowers.gender': 1,\n  'borrowers.birthDate': 1,\n  'borrowers.grossIncome': 1,\n  'borrowers.bonusExists': 1,\n  'borrowers.bonus': 1,\n  'borrowers.otherIncome': 1,\n  'borrowers.currentRentExists': 1,\n  'borrowers.currentRent': 1,\n  'borrowers.realEstateFortune': 1,\n  'borrowers.cashAndSecurities': 1,\n  'borrowers.existingDebt': 1,\n  'borrowers.otherFortune': 1,\n  'borrowers.insuranceLpp': 1,\n  'borrowers.insurance3A': 1,\n  'borrowers.insurance3B': 1,\n  'borrowers.insurancePureRisk': 1,\n\n  property: 1,\n\n  // partnerOffers: {\n  //   $elemMatch: { $eq: { name: organization } },\n  // },\n\n  'logic.step': 1,\n  'logic.uploadTaxesLater': 1,\n  'logic.auction.status': 1,\n  'logic.auction.startTime': 1,\n  'logic.auction.endTime': 1,\n});\n\n// Publish all loans this partner has access to\nMeteor.publish('partnerLoansAuction', function publish() {\n  if (Roles.userIsInRole(Meteor.userId(), 'partner')) {\n    const user = Meteor.users.findOne(Meteor.userId());\n\n    // Show loans where the canton matches this partner's cantons\n    // and the auction has started\n    // and the auctionEndTime is greater than this date\n    // and this partner's organization is not in the partnersToAvoid\n    return Loans.find(\n      {\n        $and: [\n          { 'general.canton': { $in: user.profile.cantons } },\n          { 'logic.auction.status': 'started' },\n          {\n            $or: [\n              { 'general.partnersToAvoidExists': false },\n              {\n                'general.partnersToAvoid.0': { $ne: user.profile.organization },\n              },\n            ],\n          },\n        ],\n      },\n      {\n        fields: partnerVisibleFields(user.profile.organization),\n      },\n    );\n  }\n\n  return this.ready();\n});\n\n// Publish all loans this partner has access to\nMeteor.publish('partnerLoansCompleted', function publish() {\n  if (Roles.userIsInRole(Meteor.userId(), 'partner')) {\n    // Get the current partner user\n    const user = Meteor.users.findOne(Meteor.userId());\n\n    // Return the loans where this partner has been selected\n    return Loans.find(\n      {\n        'general.selectedPartner': user.profile.organization,\n      },\n      {\n        fields: partnerVisibleFields(user.profile.organization),\n      },\n    );\n  }\n\n  return this.ready();\n});\n\n// Publish the loan with a specific ID, and only show the fields for an anonymous offer\nMeteor.publish('partnerSingleLoan', function publish(id) {\n  check(id, String);\n\n  // Verify if this is a partner account\n  if (Roles.userIsInRole(Meteor.userId(), 'partner')) {\n    const user = Meteor.users.findOne(Meteor.userId());\n\n    return Loans.find(\n      {\n        $and: [\n          { _id: id },\n          { 'general.canton': { $in: user.profile.cantons } },\n          { 'logic.auction.status': 'started' },\n          {\n            $or: [\n              { 'general.partnersToAvoidExists': false },\n              {\n                'general.partnersToAvoid.0': { $ne: user.profile.organization },\n              },\n            ],\n          },\n        ],\n      },\n      {\n        fields: partnerVisibleFields(user.profile.organization),\n      },\n    );\n  }\n\n  return this.ready();\n});\n","import moment from 'moment';\nimport Loans from '../loans';\n\nimport { LOAN_STATUS, AUCTION_STATUS } from '../constants';\nimport { getAuctionEndTime } from '../../utils/loanFunctions';\n\nclass LoanServiceModel {\n  insert = ({ loan, userId }) =>\n    Loans.insert({\n      ...loan,\n      // Do this to allow userId to be null\n      userId,\n    });\n\n  update = ({ loanId, object }) => Loans.update(loanId, { $set: object });\n\n  remove = ({ loanId }) => Loans.remove(loanId);\n\n  // TODO: make sure step is really done\n  incrementStep = ({ loanId }) =>\n    Loans.update(loanId, { $inc: { 'logic.step': 1 } });\n\n  askVerification = ({ loanId }) => {\n    const loan = Loans.findOne(loanId);\n\n    if (loan.logic.verification.requested) {\n      // Don't do anything if this loan is already in requested mode\n      return false;\n    }\n\n    return Loans.update(loanId, {\n      $set: {\n        'logic.verification.requested': true,\n        'logic.verification.requestedTime': new Date(),\n      },\n    });\n  };\n\n  startAuction = ({ loanId }) => {\n    const loan = Loans.findOne(loanId);\n\n    if (loan.logic.auction.status !== AUCTION_STATUS.NONE) {\n      // Don't do anything if this auction has already started or ended\n      return false;\n    }\n\n    return Loans.update(loanId, {\n      $set: {\n        'logic.auction.status': AUCTION_STATUS.STARTED,\n        'logic.auction.startTime': moment().toDate(),\n        'logic.auction.endTime': getAuctionEndTime(moment()),\n      },\n    });\n  };\n\n  endAuction = ({ loanId }) => {\n    const loan = Loans.findOne(loanId);\n\n    // This method is called in the future (through a job),\n    // so only call this if the auction is ongoing\n    if (!loan || loan.logic.auction.status !== AUCTION_STATUS.STARTED) {\n      return false;\n    }\n\n    return Loans.update(id, {\n      $set: {\n        'logic.auction.status': AUCTION_STATUS.ENDED,\n        'logic.auction.endTime': new Date(),\n      },\n    });\n  };\n\n  cancelAuction = ({ loanId }) =>\n    this.update(loanId, {\n      $set: {\n        'logic.auction.endTime': undefined,\n        'logic.auction.status': '',\n        'logic.auction.startTime': undefined,\n      },\n    });\n\n  confirmClosing = ({ loanId, object }) =>\n    Loans.update(loanId, {\n      $set: {\n        status: LOAN_STATUS.DONE,\n        ...object,\n      },\n    });\n}\n\nconst LoanService = new LoanServiceModel({});\n\nexport { LoanServiceModel };\nexport default LoanService;\n","import SimpleSchema from 'simpl-schema';\nimport {\n  PURCHASE_TYPE,\n  INTEREST_RATES,\n  OWNER,\n  CANTONS,\n  AUCTION_STATUS,\n  OFFER_TYPE,\n  CLOSING_STEPS_TYPE,\n  CLOSING_STEPS_STATUS,\n  AUCTION_MOST_IMPORTANT,\n  INSURANCE_USE_PRESET,\n  LOAN_STRATEGY_PRESET,\n  AMORTIZATION_STRATEGY_PRESET,\n  PAYMENT_SCHEDULES,\n  GENDER,\n  USAGE_TYPE,\n} from '../constants';\n\nexport const GeneralSchema = new SimpleSchema({\n  purchaseType: {\n    type: String,\n    defaultValue: PURCHASE_TYPE.ACQUISITION,\n    allowedValues: Object.values(PURCHASE_TYPE),\n  },\n  usageType: {\n    type: String,\n    defaultValue: USAGE_TYPE.PRIMARY,\n    allowedValues: Object.values(USAGE_TYPE),\n  },\n  fortuneUsed: {\n    type: Number,\n    min: 0,\n    max: 100000000,\n    defaultValue: 0,\n  },\n  insuranceFortuneUsed: {\n    type: Number,\n    min: 0,\n    max: 100000000,\n    optional: true,\n  },\n  propertyWork: {\n    type: Number,\n    min: 0,\n    max: 100000000,\n    defaultValue: 0,\n  },\n  oldestAge: {\n    type: SimpleSchema.Integer,\n    optional: true,\n    min: 18,\n    max: 120,\n  },\n  oldestGender: {\n    type: String,\n    optional: true,\n    allowedValues: Object.values(GENDER),\n  },\n  partnersToAvoidExists: {\n    type: Boolean,\n    defaultValue: false,\n  },\n  partnersToAvoid: {\n    type: Array,\n    defaultValue: [],\n  },\n  'partnersToAvoid.$': String,\n  selectedPartner: {\n    type: String,\n    optional: true,\n  },\n  canton: {\n    type: String,\n    optional: true,\n    allowedValues: Object.keys(CANTONS),\n  },\n  loanTranches: {\n    type: Array,\n    // minCount: 1,\n    defaultValue: [\n      {\n        type: INTEREST_RATES.LIBOR,\n        value: 100000,\n      },\n    ],\n  },\n  'loanTranches.$': Object,\n  'loanTranches.$.type': {\n    type: String,\n    optional: true,\n    allowedValues: Object.values(INTEREST_RATES),\n  },\n  'loanTranches.$.value': {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 100000000,\n  },\n  currentOwner: {\n    type: String,\n    defaultValue: OWNER.FIRST,\n    allowedValues: Object.values(OWNER),\n  },\n  futureOwner: {\n    type: String,\n    defaultValue: OWNER.FIRST,\n    allowedValues: Object.values(OWNER),\n  },\n  otherOwner: {\n    type: String,\n    optional: true,\n  },\n  wantedClosingDate: {\n    type: Date,\n    optional: true,\n  },\n  auctionMostImportant: {\n    type: String,\n    optional: true,\n    allowedValues: Object.values(AUCTION_MOST_IMPORTANT),\n  },\n});\n\n// All logic fields required by the app to trigger the right things at the right time\nexport const LogicSchema = new SimpleSchema({\n  step: {\n    type: Number,\n    defaultValue: 1,\n    min: 1,\n    max: 5,\n  },\n  verification: {\n    type: Object,\n    defaultValue: {},\n  },\n  'verification.requested': {\n    type: Boolean,\n    optional: true,\n  },\n  'verification.requestedTime': {\n    type: Date,\n    optional: true,\n  },\n  'verification.validated': {\n    type: Boolean,\n    optional: true,\n  },\n  'verification.comments': {\n    type: Array,\n    defaultValue: [],\n  },\n  'verification.comments.$': String,\n  expertiseRequired: {\n    type: Boolean,\n    defaultValue: true,\n  },\n  expertiseDone: {\n    type: Boolean,\n    defaultValue: false,\n  },\n  expertiseValid: {\n    type: Boolean,\n    defaultValue: false,\n  },\n  auction: {\n    type: Object,\n    defaultValue: {},\n  },\n  'auction.status': {\n    type: String,\n    optional: true,\n    defaultValue: AUCTION_STATUS.NONE,\n    allowedValues: Object.values(AUCTION_STATUS),\n  },\n  'auction.startTime': {\n    type: Date,\n    optional: true,\n  },\n  'auction.endTime': {\n    type: Date,\n    optional: true,\n  },\n  hasValidatedStructure: {\n    type: Boolean,\n    defaultValue: false,\n    optional: true,\n  },\n  insuranceUsePreset: {\n    type: String,\n    // defaultValue: '',\n    optional: true,\n    allowedValues: Object.values(INSURANCE_USE_PRESET),\n  },\n  loanStrategyPreset: {\n    type: String,\n    // defaultValue: '',\n    optional: true,\n    allowedValues: Object.values(LOAN_STRATEGY_PRESET),\n  },\n  amortizationStrategyPreset: {\n    type: String,\n    // defaultValue: '',\n    optional: true,\n    allowedValues: Object.values(AMORTIZATION_STRATEGY_PRESET),\n  },\n  lender: {\n    type: Object,\n    defaultValue: {},\n  },\n  'lender.type': {\n    type: String,\n    optional: true,\n    allowedValues: Object.values(OFFER_TYPE),\n  },\n  'lender.offerId': {\n    type: String,\n    optional: true,\n  },\n  'lender.chosenTime': {\n    type: Date,\n    optional: true,\n  },\n  'lender.contacted': {\n    type: Boolean,\n    defaultValue: false,\n  },\n  'lender.nextSteps': {\n    type: Array,\n    defaultValue: [],\n  },\n  'lender.nextSteps.$': String,\n  'lender.contractRequested': {\n    type: Boolean,\n    defaultValue: false,\n  },\n  'lender.contractLoanSent': {\n    type: Boolean,\n    defaultValue: false,\n  },\n  'lender.contract': {\n    type: String,\n    defaultValue: '',\n    optional: true,\n  },\n  acceptedClosing: {\n    type: Boolean,\n    defaultValue: false,\n  },\n  recommendationCode: {\n    type: String,\n    defaultValue: '',\n    optional: true,\n  },\n  firstPaymentDate: {\n    type: Date,\n    optional: true,\n  },\n  paymentSchedule: {\n    type: String,\n    optional: true,\n    allowedValues: Object.values(PAYMENT_SCHEDULES),\n  },\n  closingSteps: {\n    type: Array,\n    defaultValue: [],\n  },\n  'closingSteps.$': Object,\n  'closingSteps.$.id': String,\n  'closingSteps.$.type': {\n    type: String,\n    allowedValues: Object.values(CLOSING_STEPS_TYPE),\n  },\n  'closingSteps.$.title': String,\n  'closingSteps.$.description': { type: String, optional: true },\n  'closingSteps.$.status': {\n    type: String,\n    optional: true,\n    allowedValues: Object.values(CLOSING_STEPS_STATUS),\n  },\n  'closingSteps.$.error': { type: String, optional: true },\n});\n","import * as mutations from './mutationDefinitions';\n\nexport { default } from './loans';\nexport const loanMutations = mutations;\n","import { Loans, Properties, Borrowers, Users, Tasks } from '../';\n\nLoans.addLinks({\n  property: {\n    field: 'propertyId',\n    collection: Properties,\n    type: 'one',\n  },\n  borrowers: {\n    field: 'borrowerIds',\n    collection: Borrowers,\n    type: 'many',\n  },\n  user: {\n    field: 'userId',\n    collection: Users,\n    type: 'one',\n  },\n  tasks: {\n    collection: Tasks,\n    inversedBy: 'loan',\n  },\n});\n","export const LOAN_STATUS = {\n  ACTIVE: 'ACTIVE',\n  DONE: 'DONE',\n};\n\nexport const PURCHASE_TYPE = {\n  ACQUISITION: 'ACQUISITION',\n  REFINANCING: 'REFINANCING',\n  CONSTRUCTION: 'CONSTRUCTION',\n};\n\nexport const CANTONS = {\n  AG: 'Aargau',\n  AR: 'Appenzell Ausserrhoden',\n  AI: 'Appenzell Innerrhoden',\n  BL: 'Basel-Land',\n  BS: 'Basel-Stadt',\n  BE: 'Bern',\n  FR: 'Fribourg',\n  GE: 'Genève',\n  GL: 'Glarus',\n  GR: 'Graubünden',\n  JU: 'Jura',\n  LU: 'Luzern',\n  NE: 'Neuchâtel',\n  NW: 'Nidwalden',\n  OW: 'Obwalden',\n  SG: 'St. Gallen',\n  SH: 'Schaffhausen',\n  SZ: 'Schwyz',\n  SO: 'Solothurn',\n  TG: 'Thurgau',\n  TI: 'Ticino',\n  UR: 'Uri',\n  VD: 'Vaud',\n  VS: 'Valais',\n  ZG: 'Zug',\n  ZH: 'Zürich',\n};\n\nexport const INTEREST_RATES = {\n  LIBOR: 'interestLibor',\n  YEARS_1: 'interest1',\n  YEARS_2: 'interest2',\n  YEARS_5: 'interest5',\n  YEARS_10: 'interest10',\n  YEARS_15: 'interest15',\n};\n\nexport const OWNER = {\n  FIRST: '0',\n  SECOND: '1',\n  BOTH: 'BOTH',\n  OTHER: 'OTHER',\n};\n\nexport const AUCTION_STATUS = {\n  NONE: '',\n  STARTED: 'STARTED',\n  ENDED: 'ENDED',\n};\n\nexport const CLOSING_STEPS_TYPE = {\n  TODO: 'TODO',\n  UPLOAD: 'UPLOAD',\n};\n\nexport const CLOSING_STEPS_STATUS = {\n  UNVERIFIED: 'UNVERIFIED',\n  VALID: 'VALID',\n  ERROR: 'ERROR',\n};\n\nexport const AUCTION_MOST_IMPORTANT = {\n  SPEED: 'SPEED',\n  PRICE: 'PRICE',\n  NOTHING: 'NOTHING',\n};\n\nexport const INSURANCE_USE_PRESET = {\n  WITHDRAWAL: 'WITHDRAWAL',\n  COLLATERAL: 'COLLATERAL',\n};\n\nexport const LOAN_STRATEGY_PRESET = {\n  FIXED: 'FIXED',\n  MANUAL: 'MANUAL',\n};\n\nexport const AMORTIZATION_STRATEGY_PRESET = {\n  INDIRECT: 'INDIRECT',\n  DIRECT: 'DIRECT',\n};\n\nexport const PAYMENT_SCHEDULES = {\n  MONTHLY: 'MONTHLY',\n  YEARLY: 'YEARLY',\n  SEMESTERLY: 'SEMESTERLY',\n};\n\nexport const LOAN_QUERIES = {\n  ADMIN_LOAN: 'ADMIN_LOAN',\n  ADMIN_LOANS: 'ADMIN_LOANS',\n  ASSIGNED_TO: 'ASSIGNED_TO',\n};\n","import { Mongo } from 'meteor/mongo';\nimport SimpleSchema from 'simpl-schema';\n\nimport { getFileSchema } from '../files/files';\nimport {\n  GeneralSchema,\n  PropertySchema,\n  LogicSchema,\n} from './additionalSchemas';\nimport { LOAN_STATUS } from './loanConstants';\n\nconst Loans = new Mongo.Collection('loans');\n\nconst LoanFilesSchema = new SimpleSchema(getFileSchema('loan'));\n\n// Prevent all client side modifications of mongoDB\nLoans.deny({\n  insert: () => true,\n  update: () => true,\n  remove: () => true,\n});\nLoans.allow({\n  insert: () => true,\n  update: () => false,\n  remove: () => false,\n});\n\n// Documentation is in the google drive dev/MongoDB Schemas\nconst LoanSchema = new SimpleSchema({\n  userId: {\n    type: String,\n    optional: true,\n  },\n  createdAt: {\n    type: Date,\n    autoValue() {\n      if (this.isInsert) {\n        return new Date();\n      }\n    },\n  },\n  updatedAt: {\n    type: Date,\n    autoValue() {\n      // Verify the update is from the user owning this doc, ignoring admin/partner updates\n      const doc = Loans.findOne({ _id: this.docId }, { fields: { userId: 1 } });\n\n      if (this.isInsert) {\n        return new Date();\n      } else if (this.isUpdate && doc && this.userId === doc.userId) {\n        return new Date();\n      }\n    },\n  },\n  status: {\n    type: String,\n    defaultValue: LOAN_STATUS.ACTIVE,\n    allowedValues: Object.values(LOAN_STATUS),\n  },\n  name: { type: String, optional: true, defaultValue: '' },\n  general: { type: GeneralSchema, defaultValue: {} },\n  borrowerIds: { type: Array, defaultValue: [] },\n  'borrowerIds.$': String,\n  // property: PropertySchema,\n  propertyId: { type: String },\n  files: { type: LoanFilesSchema, defaultValue: {} },\n  logic: { type: LogicSchema, defaultValue: {} },\n  adminValidation: { type: Object, defaultValue: {}, blackbox: true },\n  emails: { type: Array, defaultValue: [] },\n  'emails.$': Object,\n  'emails.$._id': String,\n  'emails.$.emailId': String,\n  'emails.$.status': String,\n  'emails.$.updatedAt': Date,\n  'emails.$.scheduledAt': { type: Date, optional: true },\n});\n\n// Finally, attach schema to the Mongo collection and export\nLoans.attachSchema(LoanSchema);\nexport default Loans;\n","export const LOAN_INSERT = {\n  name: 'LOAN_INSERT',\n  params: {\n    loan: { type: Object },\n    userId: { type: String, optional: true },\n  },\n};\n\nexport const LOAN_UPDATE = {\n  name: 'LOAN_UPDATE',\n  params: {\n    loanId: { type: String },\n    object: { type: Object },\n  },\n};\n\nexport const LOAN_DELETE = {\n  name: 'LOAN_DELETE',\n  params: {\n    loanId: { type: String },\n  },\n};\n\nexport const INCREMENT_LOAN_STEP = {\n  name: 'INCREMENT_LOAN_STEP',\n  params: {\n    loanId: { type: String },\n  },\n};\n\nexport const REQUEST_LOAN_VERIFICATION = {\n  name: 'REQUEST_LOAN_VERIFICATION',\n  params: {\n    loanId: { type: String },\n  },\n};\n\nexport const START_AUCTION = {\n  name: 'START_AUCTION',\n  params: {\n    loanId: { type: String },\n  },\n};\n\nexport const END_AUCTION = {\n  name: 'END_AUCTION',\n  params: {\n    loanId: { type: String },\n  },\n};\n\nexport const CANCEL_AUCTION = {\n  name: 'CANCEL_AUCTION',\n  params: {\n    loanId: { type: String },\n  },\n};\n\nexport const CONFIRM_CLOSING = {\n  name: 'CONFIRM_CLOSING',\n  params: {\n    loanId: { type: String },\n    object: { type: Object },\n  },\n};\n","import React from 'react';\nimport InlineCss from 'react-inline-css';\n\nexport const AnonymousLoanPDF = (loan, borrowers) => (\n  <InlineCss\n    stylesheet={`\n      .Document {\n        font-family: \"Helvetica Neue\", \"Helvetica\", \"Arial\", sans-serif;\n      }\n\n      h1 {\n        color: red;\n      }`}\n  >\n    <div className=\"Document\">\n      <h1>Hello Yannis! (Anonymisé)</h1>\n    </div>\n  </InlineCss>\n);\n\nexport const LoanPDF = (loan, borrowers) => (\n  <InlineCss\n    stylesheet={`\n      .Document {\n        font-family: \"Helvetica Neue\", \"Helvetica\", \"Arial\", sans-serif;\n      }\n\n      h1 {\n        color: red;\n      }`}\n  >\n    <div className=\"Document\">\n      <h1>Hello Yannis!</h1>\n    </div>\n  </InlineCss>\n);\n","import { Meteor } from 'meteor/meteor';\nimport { check } from 'meteor/check';\n\nimport Loans from '../../loans/loans';\nimport Borrowers from '../../borrowers/borrowers';\n\nMeteor.methods({\n  setUserToLoan: ({ loanId }) => {\n    check(loanId, String);\n\n    if (!Meteor.userId()) {\n      throw new Meteor.Error('not authorized');\n    }\n\n    const loan = Loans.findOne(loanId);\n    const { borrowers } = loan;\n\n    Loans.update(loanId, { $set: { userId: Meteor.userId() } });\n    borrowers.forEach((borrowerId) => {\n      Borrowers.update(borrowerId, { $set: { userId: Meteor.userId() } });\n    });\n\n    return true;\n  },\n  addBorrower({ loanId }) {\n    // TODO: Secure this\n    const loan = Loans.findOne(loanId);\n\n    // A loan can't have more than 2 borrowers at the moment\n    if (loan.borrowerIds.length >= 2) {\n      return false;\n    }\n\n    const newBorrowerId = Borrowers.insert({ userId: Meteor.userId() });\n\n    return Loans.update(loanId, {\n      $push: { borrowerIds: newBorrowerId },\n    });\n  },\n  removeBorrower({ loanId, borrowerId }) {\n    // TODO: Secure this\n    const loan = Loans.findOne(loanId);\n\n    // A loan has to have at least 1 borrower\n    if (loan.borrowerIds.length <= 1) {\n      return false;\n    }\n\n    Borrowers.remove(borrowerId);\n    return Loans.update(loanId, {\n      $pull: { borrowerIds: borrowerId },\n    });\n  },\n});\n","import { Meteor } from 'meteor/meteor';\nimport { Accounts } from 'meteor/accounts-base';\nimport saveStartForm from 'core/utils/saveStartForm';\nimport { addUserTracking } from 'core/utils/analytics';\n\nMeteor.methods({\n  createUserAndLoan({ email, formState }) {\n    console.log('creating user and loan...', email, formState);\n    // Create the new user without a password\n    let newUserId;\n    try {\n      newUserId = Accounts.createUser({ email });\n    } catch (e) {\n      throw new Meteor.Error(\"Couldn't create new user\", e);\n    }\n\n    // Send an enrollment email\n    Accounts.sendEnrollmentEmail(newUserId);\n\n    // Insert the formdata to loan and borrower(s)\n    return saveStartForm(formState, newUserId);\n  },\n});\n","export * from './compoundMethods';\nexport * from './createUserAndLoan';\nexport * from './miscellaneous';\n","import { Meteor } from 'meteor/meteor';\nimport { Roles } from 'meteor/alanning:roles';\nimport { check } from 'meteor/check';\nimport { ValidatedMethod } from 'meteor/mdg:validated-method';\n\nimport Loans from '../../loans/loans';\nimport Borrowers from '../../borrowers/borrowers';\n\nimport { generateComponentAsPDF } from '../../../utils/generate-pdf';\nimport { LoanPDF, AnonymousLoanPDF } from '../../loans/pdf.js';\nimport rateLimit from '../../../utils/rate-limit.js';\n\nMeteor.methods({\n  getServerTime: () => new Date(),\n  getMixpanelAuthorization() {\n    if (\n      Roles.userIsInRole(Meteor.userId(), 'dev') ||\n      Roles.userIsInRole(Meteor.userId(), 'admin')\n    ) {\n      const btoa = require('btoa');\n\n      const API_KEY = Meteor.settings.MIXPANEL_API_KEY;\n      const API_SECRET = Meteor.settings.MIXPANEL_API_SECRET;\n\n      return `Basic ${btoa(`${API_SECRET}:${API_KEY}`)}`;\n    }\n\n    throw new Meteor.Error('Unauthorized access to getMixpanelAuthorization');\n  },\n});\n\nexport const downloadPDF = new ValidatedMethod({\n  name: 'downloadPDF',\n  validate({ loanId, type }) {\n    check(loanId, String);\n    check(type, String);\n  },\n  run({ loanId, type }) {\n    const loan = Loans.findOne(loanId);\n    const borrowers = Borrowers.find({ _id: { $in: loan.borrowerIds } });\n    const prefix = type === 'anonymous' ? 'Anonyme' : 'Complet';\n    const fileName = `${prefix} ${loan.propertyId.address1}.pdf`;\n\n    // If type is anonymous, loan the anonymous pdf\n    const component = type === 'anonymous' ? AnonymousLoanPDF : LoanPDF;\n\n    return generateComponentAsPDF({\n      component,\n      props: { loan, borrowers },\n      fileName,\n    })\n      .then(result => result)\n      .catch((error) => {\n        throw new Meteor.Error('500', error);\n      });\n  },\n});\n\nrateLimit({ methods: [downloadPDF] });\n","import '../../users/server/mutations';\nimport '../../loans/server/mutations';\nimport '../../offers/server/mutations';\nimport '../../properties/server/mutations';\nimport '../../borrowers/server/mutations';\nimport '../../tasks/server/mutations';\n","import { Meteor } from 'meteor/meteor';\nimport { Bert } from 'meteor/themeteorchef:bert';\n\nimport { checkParams } from './createMutator';\n\nconst handleError = (error, mutationName) => {\n  if (Meteor.isClient) {\n    Bert.defaults.hideDelay = 7500;\n    Bert.alert({\n      title: 'Misère, une erreur!',\n      message: `<h3 class=\"bert\">${error.message} in ${mutationName}</h3>`,\n      type: 'danger',\n      style: 'fixed-top',\n    });\n  }\n\n  console.log('callMutation error:', error);\n  // Throw the error again so that it can be catched again via promise chaining\n  // All uses of this module should catch and implement proper fail-safe logic\n  throw error;\n};\n\nconst callMutation = (mutationOptions, callParams = {}) => {\n  const { name, params } = mutationOptions;\n  checkParams(callParams, params);\n\n  return new Promise((resolve, reject) => {\n    Meteor.call(name, callParams, (error, result) => {\n      if (error) {\n        reject(handleError(error, name));\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n\nexport default callMutation;\n","import { Meteor } from 'meteor/meteor';\nimport { check, Match } from 'meteor/check';\n\nimport EventService from '../events';\n\nconst INVALID_MUTATION_OPTIONS = 'INVALID_MUTATION_OPTIONS';\nconst MUTATION_ERROR = 'MUTATION_ERROR';\n\nexport const beforeLogger = (callParameters, name) => {\n  if (Meteor.isDevelopment && !Meteor.isTest) {\n    console.log(`Executing method ${name} with the following params:`);\n    console.log(callParameters);\n  }\n};\n\nexport const afterLogger = (result, name) => {\n  if (Meteor.isDevelopment && !Meteor.isTest) {\n    console.log(`Executed ${name} and got result:`);\n    console.log(result);\n  }\n};\n\nexport const validateMutationOptions = ({ name, params }) => {\n  if (!name || typeof name !== 'string') {\n    throw new Meteor.Error(INVALID_MUTATION_OPTIONS, 'name has to be a string');\n  }\n\n  if (params) {\n    Object.keys(params).forEach((param) => {\n      const { type } = params[param];\n      if (!type) {\n        throw new Meteor.Error(\n          INVALID_MUTATION_OPTIONS,\n          `you have to provide a type for parameter: \"${param}\" in ${name}`,\n        );\n      }\n    });\n  }\n};\n\nexport const checkParams = (callParameters, params) => {\n  check(\n    callParameters,\n    Object.keys(params).reduce((matchPattern, param) => {\n      const { optional, type } = params[param];\n\n      // Return a Match Pattern and check for optionals\n      return {\n        ...matchPattern,\n        [param]: optional ? Match.Optional(type) : type,\n      };\n    }, {}),\n  );\n};\n\nconst createMutator = (options, functionBody) => {\n  validateMutationOptions(options);\n  const { name, params } = options;\n\n  Meteor.methods({\n    [name](callParameters) {\n      beforeLogger(callParameters, name);\n      checkParams(callParameters, params, name);\n\n      let result;\n      try {\n        result = functionBody(callParameters);\n        EventService.emitMutation(options, callParameters);\n      } catch (error) {\n        throw error;\n      }\n\n      afterLogger(result, name);\n\n      return result;\n    },\n  });\n};\n\nexport default createMutator;\n","import { userMutations } from '../users';\nimport { loanMutations } from '../loans';\nimport { borrowerMutations } from '../borrowers';\nimport { offerMutations } from '../offers';\nimport { propertyMutations } from '../properties';\nimport { taskMutations } from '../tasks';\n\nexport { default as createMutator } from './createMutator';\nexport { default as callMutation } from './callMutation';\n\n// Export all mutation definitions here\nexport const mutations = {\n  ...loanMutations,\n  ...borrowerMutations,\n  ...offerMutations,\n  ...propertyMutations,\n  ...userMutations,\n  ...taskMutations,\n};\n","import { Meteor } from 'meteor/meteor';\nimport { ValidatedMethod } from 'meteor/mdg:validated-method';\nimport { Roles } from 'meteor/alanning:roles';\nimport { check, Match } from 'meteor/check';\nimport { CallPromiseMixin } from 'meteor/didericis:callpromise-mixin';\nimport rateLimit from '../../../utils/rate-limit.js';\n\nimport Loans from '../../loans';\nimport Offers from '../offers';\n\n// Insert a new offer\nexport const insertOffer = new ValidatedMethod({\n  name: 'insertOffer',\n  mixins: [CallPromiseMixin],\n  validate({ object, userId }) {\n    check(object, Object);\n    check(userId, Match.Optional(String));\n  },\n  run({ object, userId }) {\n    // Make sure there isn't already an offer for this loan\n    const user = Meteor.user();\n    const offer = Offers.findOne({\n      loanId: object.loanId,\n      organization: user.profile.organization,\n    });\n    if (offer) {\n      throw new Meteor.Error(\n        'noTwoOffers',\n        'Your organization has already made an offer on this loan',\n      );\n    }\n\n    const loan = Loans.findOne(object.loanId);\n\n    object.userId = userId || Meteor.userId();\n    object.organization = user.profile.organization;\n    object.canton = user.profile.cantons[0];\n    object.auctionEndTime = loan.logic.auction.endTime;\n\n    return Offers.insert(object);\n  },\n});\n\nexport const insertAdminOffer = new ValidatedMethod({\n  name: 'insertAdminOffer',\n  mixins: [CallPromiseMixin],\n  validate: null,\n  run({ object }) {\n    if (\n      !(\n        Roles.userIsInRole(Meteor.userId(), 'admin') ||\n        Roles.userIsInRole(Meteor.userId(), 'dev')\n      )\n    ) {\n      return false;\n    }\n\n    const loan = Loans.findOne(object.loanId);\n\n    return Offers.insert({\n      ...object,\n      userId: Meteor.userId(),\n      isAdmin: true,\n      auctionEndTime: loan.logic.auction.endTime, // this doesn't update when the loan is ended prematurely by an admin\n      canton: 'GE',\n    });\n  },\n});\n\nexport const updateOffer = new ValidatedMethod({\n  name: 'updateOffer',\n  mixins: [CallPromiseMixin],\n  validate({ id, object }) {\n    check(id, String);\n    check(object, Object);\n  },\n  run({ id, object }) {\n    return Offers.update(id, { $set: object });\n  },\n});\n\nexport const insertFakeOffer = new ValidatedMethod({\n  name: 'insertFakeOffer',\n  mixins: [CallPromiseMixin],\n  validate: null,\n  run({ object }) {\n    return Offers.insert({ ...object, userId: Meteor.userId() });\n  },\n});\n\nexport const deleteOffer = new ValidatedMethod({\n  name: 'deleteOffer',\n  mixins: [CallPromiseMixin],\n  validate() {},\n  run({ id }) {\n    if (\n      Roles.userIsInRole(Meteor.userId(), 'dev') ||\n      Roles.userIsInRole(Meteor.userId(), 'admin')\n    ) {\n      return Offers.remove(id);\n    }\n\n    return false;\n  },\n});\n\nrateLimit({\n  methods: [\n    insertOffer,\n    insertAdminOffer,\n    updateOffer,\n    insertFakeOffer,\n    // deleteOffer,\n  ],\n});\n","import { Meteor } from 'meteor/meteor';\n\nimport { SecurityService, createMutator } from '../..';\nimport OfferService from '../OfferService';\nimport * as defs from '../mutationDefinitions';\n\ncreateMutator(defs.OFFER_INSERT, ({ offer, userId }) => {\n  const userIdIsDefined = userId !== undefined;\n  if (userIdIsDefined) {\n    SecurityService.checkCurrentUserIsAdmin();\n  } else {\n    SecurityService.offers.isAllowedToInsert();\n  }\n\n  return OfferService.insert({\n    offer,\n    userId: userIdIsDefined ? userId : Meteor.userId(),\n  });\n});\n\ncreateMutator(defs.OFFER_INSERT_ADMIN, ({ offer, loan }) => {\n  SecurityService.checkLoggedIn();\n  if (SecurityService.currentUserIsAdmin()) {\n    return OfferService.insertAdminOffer({ offer, loan });\n  }\n  return null;\n});\n\ncreateMutator(defs.OFFER_UPDATE, ({ offerId, offer }) => {\n  SecurityService.offers.isAllowedToUpdate(offerId);\n  return OfferService.update({ offerId, offer });\n});\n\ncreateMutator(defs.OFFER_DELETE, ({ offerId }) => {\n  SecurityService.offers.isAllowedToDelete(offerId);\n  return OfferService.remove({ offerId });\n});\n","import { Meteor } from 'meteor/meteor';\nimport { check } from 'meteor/check';\nimport { Roles } from 'meteor/alanning:roles';\n\nimport Offers from '../offers';\nimport Loans from '../../loans/loans';\n\n// Get all offers for the currently active loan\nMeteor.publish('activeOffers', () => {\n  const activeLoan = Loans.findOne({\n    userId: Meteor.userId(),\n    active: true,\n  });\n\n  return Offers.find({\n    loanId: activeLoan._id,\n  });\n});\n\n// Get all offers for the currently active loan\nMeteor.publish('userOffers', () => {\n  const loans = Loans.find({\n    userId: Meteor.userId(),\n  });\n\n  const IDs = loans.map(r => r._id);\n\n  return Offers.find({\n    loanId: { $in: IDs },\n  });\n});\n\n// Get all offers the partner has made\nMeteor.publish('partnerOffers', function publish() {\n  const user = Meteor.users.findOne(Meteor.userId());\n\n  if (Roles.userIsInRole(Meteor.userId(), 'partner')) {\n    return Offers.find({\n      organization: user.profile && user.profile.organization,\n      // auctionEndTime: { $lt: new Date() },\n    });\n  }\n\n  return this.ready();\n});\n\n// Publish all offers in the database for admins\nMeteor.publish('allOffers', function publish() {\n  // Verify if user is logged In\n  if (\n    Roles.userIsInRole(Meteor.userId(), 'admin') ||\n    Roles.userIsInRole(Meteor.userId(), 'dev')\n  ) {\n    // Return all users\n    return Offers.find();\n  }\n\n  return this.ready();\n});\n\n// Publish all offers for a loan for admins\nMeteor.publish('loanOffers', function publish(loanId) {\n  check(loanId, String);\n  // Verify if user is logged In\n  if (\n    Roles.userIsInRole(Meteor.userId(), 'admin') ||\n    Roles.userIsInRole(Meteor.userId(), 'dev')\n  ) {\n    return Offers.find({ loanId });\n  }\n\n  return this.ready();\n});\n","import { Offers } from 'core/api';\nimport Security from 'core/api/security';\n\nexport default class {\n  static update = ({ offerId, offer }) =>\n    Offers.update(offerId, { $set: offer });\n\n  static insert = ({ offer, userId }) => Offers.insert({ ...offer, userId });\n\n  static insertAdminOffer = ({ offer, loan, userId }) =>\n    Offers.insert({\n      ...offer,\n      userId,\n      isAdmin: true,\n      auctionEndTime: loan.logic.auction.endTime,\n      // this doesn't update when the loan is ended prematurely by an admin\n      canton: 'GE',\n      loanId: loan._id,\n    });\n\n  static remove = ({ offerId }) => Offers.remove(offerId);\n}\n","import { getLoanValue, getPropAndWork } from 'core/utils/loanFunctions';\n\nconst getRandomCondition = () => {\n  const conditions = [\n    'Expertise additionelle requise',\n    '',\n    '',\n    '',\n    '',\n    '',\n    '',\n    '',\n    '',\n  ];\n\n  return conditions[Math.floor(Math.random() * conditions.length)];\n};\n\nconst getRandomCounterpart = () => {\n  const counterparts = [\n    'Gestion de toute la fortune',\n    'Souscrire à une assurance vie',\n    \"Gestion de CHF 100'000 de patrimoine minimum\",\n    'Souscrire à une assurance voiture',\n    '',\n    '',\n    '',\n    '',\n    '',\n    '',\n    '',\n    '',\n  ];\n\n  return counterparts[Math.floor(Math.random() * counterparts.length)];\n};\n\nconst round = v => Math.round(v * 10000) / 10000;\n\nconst rand = (min, max) => round(Math.random() * (max - min) + min);\n\nexport const getRandomOffer = ({ loan, property }, matchLoanWanted = false) => {\n  const rate1 = rand(0.007, 0.012);\n  const rate2 = rand(0.005, 0.009);\n\n  // Randomly add rank 1 offers 25% of the time\n  const loanWanted =\n    Math.random() > 0.75 && !matchLoanWanted\n      ? 0.65 * getPropAndWork({ loan, property })\n      : getLoanValue({ loan, property });\n  const maxAmoutLimited = loanWanted > 100000000 ? 100000000 : loanWanted;\n  const counterpart = getRandomCounterpart();\n  const condition = getRandomCondition();\n  return {\n    organization: 'fake',\n    canton: 'GE',\n    loanId: loan._id,\n    auctionEndTime: new Date(),\n    isSwiss: true,\n    worksForOwnCompany: true,\n    standardOffer: {\n      maxAmount: maxAmoutLimited,\n      amortization: 0.01,\n      interestLibor: rate1,\n      interest1: round(rate1 + rand(0.0004, 0.0016)),\n      interest2: round(rate1 + rand(0.0016, 0.004)),\n      interest5: round(rate1 + rand(0.004, 0.006)),\n      interest10: round(rate1 + rand(0.006, 0.01)),\n    },\n    counterpartOffer: {\n      maxAmount: maxAmoutLimited,\n      amortization: 0.01,\n      interestLibor: rate2,\n      interest1: round(rate2 + rand(0.0004, 0.0016)),\n      interest2: round(rate2 + rand(0.0016, 0.004)),\n      interest5: round(rate2 + rand(0.004, 0.006)),\n      interest10: round(rate2 + rand(0.006, 0.01)),\n    },\n    counterparts: counterpart ? [counterpart] : [],\n    conditions: condition ? [condition] : [],\n  };\n};\n","import * as mutationDefinitions from './mutationDefinitions';\n\nexport { default } from './offers';\nexport const offerMutations = mutationDefinitions;\n","export const OFFER_INSERT = {\n  name: 'OFFER_INSERT',\n  params: {\n    offer: { type: Object },\n    userId: { type: String, optional: true },\n    loanId: { type: String },\n  },\n};\n\nexport const OFFER_INSERT_ADMIN = {\n  name: 'OFFER_INSERT_ADMIN',\n  params: {\n    offer: { type: Object },\n    loan: { type: Object },\n  },\n};\n\nexport const OFFER_UPDATE = {\n  name: 'OFFER_UPDATE',\n  params: {\n    offerId: { type: String },\n    offer: { type: Object },\n  },\n};\n\nexport const OFFER_DELETE = {\n  name: 'OFFER_DELETE',\n  params: {\n    offerId: { type: String },\n  },\n};\n","export const OFFER_TYPE = {\n  STANDARD: 'STANDARD',\n  COUNTERPARTS: 'COUNTERPARTS',\n};\n","import { Mongo } from 'meteor/mongo';\nimport SimpleSchema from 'simpl-schema';\nimport { INTEREST_RATES, CANTONS } from '../constants';\n\nconst Offers = new Mongo.Collection('offers');\n\n// Prevent all client side modifications of mongoDB\nOffers.deny({\n  insert: () => true,\n  update: () => true,\n  remove: () => true,\n});\nOffers.allow({\n  insert: () => false,\n  update: () => false,\n  remove: () => false,\n});\n\nconst singleOffer = new SimpleSchema({\n  maxAmount: {\n    type: Number,\n    min: 0,\n    max: 100000000,\n  },\n  amortization: {\n    type: Number,\n  },\n  // For each existing rate, insert an allowed value in the schema\n  ...Object.values(INTEREST_RATES).reduce(\n    (object, interestKey) => ({\n      ...object,\n      [interestKey]: {\n        type: Number,\n        min: 0,\n        max: 100,\n        optional: true,\n      },\n    }),\n    {},\n  ),\n});\n\nexport const OfferSchema = new SimpleSchema({\n  loanId: {\n    type: String,\n  },\n  userId: {\n    type: String,\n  },\n  createdAt: {\n    type: Date,\n    autoValue() {\n      if (this.isInsert) {\n        return new Date();\n      }\n    },\n  },\n  updatedAt: {\n    type: Date,\n    autoValue() {\n      if (this.isInsert || this.isUpdate) {\n        return new Date();\n      }\n    },\n  },\n  isAdmin: {\n    type: Boolean,\n    defaultValue: false,\n  },\n  organization: String,\n  canton: {\n    type: String,\n    allowedValues: Object.keys(CANTONS),\n  },\n  auctionEndTime: {\n    type: Date,\n    optional: true,\n  },\n  standardOffer: {\n    type: singleOffer,\n  },\n  counterpartOffer: {\n    type: singleOffer,\n    optional: true,\n  },\n  counterparts: {\n    type: Array,\n    defaultValue: [],\n    optional: true,\n  },\n  'counterparts.$': String,\n  conditions: {\n    type: Array,\n    defaultValue: [],\n  },\n  'conditions.$': String,\n});\n\n// Attach schema\nOffers.attachSchema(OfferSchema);\nexport default Offers;\n","import './propertyAsignee.expose';\n","import Security from 'core/api/security';\nimport query from './propertyAsignee';\n\nquery.expose({\n  firewall(userId) {\n    Security.checkCurrentUserIsAdmin(userId);\n  },\n});\n","import Property from '..';\nimport { PROPERTY_QUERIES } from '../propertyConstants';\n\nexport default Property.createQuery(PROPERTY_QUERIES.PROPERTY_ASSIGNED_TO, {\n  $filter({ filters, params }) {\n    filters.userId = params.userId;\n  },\n  assignedTo: 1,\n});\n","import { Meteor } from 'meteor/meteor';\nimport { ValidatedMethod } from 'meteor/mdg:validated-method';\nimport { check, Match } from 'meteor/check';\nimport { Roles } from 'meteor/alanning:roles';\nimport { CallPromiseMixin } from 'meteor/didericis:callpromise-mixin';\n\nimport Properties from '../properties';\n\nexport const insertProperty = new ValidatedMethod({\n  name: 'insertProperty',\n  mixins: [CallPromiseMixin],\n  validate({ object, userId }) {\n    check(object, Object);\n    if (userId) {\n      check(userId, String);\n    }\n  },\n  run({ object, userId }) {\n    return Properties.insert({\n      ...object,\n      userId: userId === undefined ? Meteor.userId() : userId,\n    });\n  },\n});\n\nexport const deleteProperty = new ValidatedMethod({\n  name: 'deleteProperty',\n  mixins: [CallPromiseMixin],\n  validate({ id }) {\n    check(id, String);\n  },\n  run({ id }) {\n    return Properties.remove(id);\n  },\n});\n\nexport const updateProperty = new ValidatedMethod({\n  name: 'updateProperty',\n  mixins: [CallPromiseMixin],\n  validate({ id, object }) {\n    check(id, String);\n    check(object, Object);\n  },\n  run({ id, object }) {\n    return Properties.update(id, { $set: object });\n  },\n});\n\n// Lets you push a value to an array\nexport const pushPropertyValue = new ValidatedMethod({\n  name: 'pushPropertyValue',\n  mixins: [CallPromiseMixin],\n  validate({ id }) {\n    check(id, String);\n  },\n  run({ object, id }) {\n    return Properties.update(id, { $push: object });\n  },\n});\n\n// Lets you pop a value from the end of an array\nexport const popPropertyValue = new ValidatedMethod({\n  name: 'popPropertyValue',\n  mixins: [CallPromiseMixin],\n  validate({ id }) {\n    check(id, String);\n  },\n  run({ object, id }) {\n    return Properties.update(id, { $pop: object }, { getAutoValues: false });\n  },\n});\n\nexport const setPropertyField = new ValidatedMethod({\n  name: 'setPropertyField',\n  mixins: [CallPromiseMixin],\n  validate({ id, key }) {\n    check(id, String);\n    check(key, String);\n  },\n  run({ id, key, value }) {\n    return Properties.update(id, { $set: { [`fields.${key}`]: value } });\n  },\n});\n","import { Meteor } from 'meteor/meteor';\n\nimport SecurityService from '../../security';\nimport { createMutator } from '../../mutations';\nimport PropertyService from '../PropertyService';\nimport * as defs from '../mutationDefinitions';\n\ncreateMutator(defs.PROPERTY_INSERT, ({ object, userId }) => {\n  const userIdIsDefined = userId !== undefined;\n  if (userIdIsDefined) {\n    SecurityService.checkCurrentUserIsAdmin();\n  } else {\n    SecurityService.properties.isAllowedToInsert();\n  }\n\n  return PropertyService.insert({\n    object,\n    userId: userIdIsDefined ? userId : Meteor.userId(),\n  });\n});\n\ncreateMutator(defs.PROPERTY_UPDATE, ({ propertyId, object }) => {\n  SecurityService.properties.isAllowedToUpdate(propertyId);\n  return PropertyService.update({ propertyId, object });\n});\n\ncreateMutator(defs.PROPERTY_DELETE, ({ propertyId }) => {\n  SecurityService.properties.isAllowedToDelete(propertyId);\n  return PropertyService.remove({ propertyId });\n});\n","import { Meteor } from 'meteor/meteor';\nimport { Roles } from 'meteor/alanning:roles';\nimport { check } from 'meteor/check';\n\nimport Properties from '../properties';\n\n// Get all properties for the current user\nMeteor.publish('properties', function publish() {\n  // Verify if user is logged In\n  if (!Meteor.userId()) {\n    return this.ready();\n  }\n\n  return Properties.find({ userId: Meteor.userId() });\n});\n\n// Get all properties for the current user\nMeteor.publish('userProperties', function publish(userId, propertyIds) {\n  check(userId, String);\n  check(propertyIds, [String]);\n  if (\n    Roles.userIsInRole(Meteor.userId(), 'admin') ||\n    Roles.userIsInRole(Meteor.userId(), 'dev')\n  ) {\n    // Return all properties owned by this user, or pointed at by a loan\n    return Properties.find({\n      $or: [{ userId }, { _id: { $in: propertyIds } }],\n    });\n  }\n\n  // Return an empy cursor if not logged in\n  return this.ready();\n});\n\n// Get a property\nMeteor.publish('property', function publish(propertyId) {\n  check(propertyId, String);\n\n  if (\n    Roles.userIsInRole(Meteor.userId(), 'admin') ||\n    Roles.userIsInRole(Meteor.userId(), 'dev')\n  ) {\n    return Properties.find({ _id: propertyId });\n  }\n\n  // Return an empy cursor if not logged in\n  return this.ready();\n});\n\nMeteor.publish('allProperties', function publish() {\n  // Verify if user is an admin\n  if (\n    Roles.userIsInRole(Meteor.userId(), 'admin') ||\n    Roles.userIsInRole(Meteor.userId(), 'dev')\n  ) {\n    // Return all\n    return Properties.find();\n  }\n\n  return this.ready();\n});\n","import Properties from '../properties';\n\nexport default class {\n  static update = ({ propertyId, property }) =>\n    Properties.update(propertyId, { $set: property });\n\n  static insert = ({ property, userId }) =>\n    Properties.insert({ ...property, userId });\n\n  static remove = ({ propertyId }) => Properties.remove(propertyId);\n\n  static pushValue = ({ propertyId, property }) =>\n    Properties.update(propertyId, { $push: property });\n\n  static popValue = ({ propertyId, property }) =>\n    Properties.update(propertyId, { $pop: property });\n}\n","import * as mutations from './mutationDefinitions';\n\nexport { default } from './properties';\nexport const propertyMutations = mutations;\n","import { Properties, Users } from '../';\n\nProperties.addLinks({\n  asignee: {\n    field: 'userId',\n    collection: Users,\n    type: 'one',\n  },\n});\n","export const PROPERTY_INSERT = {\n  name: 'PROPERTY_INSERT',\n  params: {\n    property: { type: Object },\n    userId: { type: String, optional: true },\n  },\n};\n\nexport const PROPERTY_UPDATE = {\n  name: 'PROPERTY_UPDATE',\n  params: {\n    propertyId: { type: String },\n    property: { type: Object },\n  },\n};\n\nexport const PROPERTY_DELETE = {\n  name: 'PROPERTY_DELETE',\n  params: {\n    propertyId: { type: String },\n  },\n};\n","import { Mongo } from 'meteor/mongo';\nimport SimpleSchema from 'simpl-schema';\nimport { getFileSchema } from '../files/files';\nimport {\n  PROPERTY_STATUS,\n  USAGE_TYPE,\n  PROPERTY_STYLE,\n  VOLUME_NORM,\n} from './propertyConstants';\n\nconst Properties = new Mongo.Collection('properties');\n\n// Prevent all client side modifications of mongoDB\nProperties.deny({\n  insert: () => true,\n  update: () => true,\n  remove: () => true,\n});\nProperties.allow({\n  insert: () => false,\n  update: () => false,\n  remove: () => false,\n});\n\nconst PropertyFilesSchema = new SimpleSchema(getFileSchema('property'));\n\nexport const PropertySchema = new SimpleSchema({\n  userId: {\n    type: String,\n    optional: true,\n  },\n  createdAt: {\n    type: Date,\n    autoValue() {\n      if (this.isInsert) {\n        return new Date();\n      }\n    },\n  },\n  updatedAt: {\n    type: Date,\n    autoValue() {\n      if (this.isInsert || this.isUpdate) {\n        return new Date();\n      }\n    },\n  },\n  status: {\n    type: String,\n    defaultValue: PROPERTY_STATUS.FOR_SALE,\n    allowedValues: Object.values(PROPERTY_STATUS),\n  },\n  value: {\n    // Cost of the property\n    type: Number,\n    min: 0,\n    max: 100000000,\n    optional: true,\n  },\n  propertyWork: {\n    // Additional work on property\n    type: Number,\n    min: 0,\n    max: 100000000,\n    optional: true,\n  },\n  usageType: {\n    type: String,\n    defaultValue: USAGE_TYPE.PRIMARY,\n    allowedValues: Object.values(USAGE_TYPE),\n  },\n  investmentRent: {\n    // Rent of property if investment\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 100000000,\n  },\n  style: {\n    type: String,\n    optional: true,\n    defaultValue: PROPERTY_STYLE.FLAT,\n    allowedValues: Object.values(PROPERTY_STYLE),\n  },\n  address: {\n    // For condensed, google places addresses\n    type: String,\n    optional: true,\n  },\n  address1: {\n    type: String,\n    optional: true,\n  },\n  address2: {\n    type: String,\n    optional: true,\n  },\n  zipCode: {\n    type: Number,\n    optional: true,\n    min: 1000,\n    max: 9999,\n  },\n  city: {\n    type: String,\n    optional: true,\n  },\n  constructionYear: {\n    type: Number,\n    min: 0,\n    max: 2030,\n    optional: true,\n  },\n  renovationYear: {\n    type: Number,\n    min: 0,\n    max: 2030,\n    optional: true,\n  },\n  insideArea: {\n    type: Number,\n    optional: true,\n    min: 0,\n  },\n  landArea: {\n    type: Number,\n    optional: true,\n    min: 0,\n  },\n  balconyArea: {\n    type: Number,\n    optional: true,\n    min: 0,\n  },\n  terraceArea: {\n    type: Number,\n    optional: true,\n    min: 0,\n  },\n  roomCount: {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 100,\n  },\n  bathroomCount: {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 100,\n  },\n  toiletCount: {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 100,\n  },\n  volume: {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 5000,\n  },\n  volumeNorm: {\n    type: String,\n    defaultValue: VOLUME_NORM.SIA,\n    allowedValues: Object.keys(VOLUME_NORM),\n  },\n  parking: {\n    type: Object,\n    defaultValue: {},\n  },\n  'parking.box': {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 100,\n  },\n  'parking.inside': {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 100,\n  },\n  'parking.outside': {\n    type: Number,\n    optional: true,\n    min: 0,\n    max: 100,\n  },\n  minergie: {\n    type: Boolean,\n    defaultValue: false,\n  },\n  isCoproperty: {\n    type: Boolean,\n    defaultValue: false,\n  },\n  isNew: {\n    type: Boolean,\n    defaultValue: false,\n  },\n  copropertyPercentage: {\n    type: Number,\n    min: 0,\n    max: 1000,\n    optional: true,\n  },\n  cityPlacementQuality: {\n    type: Number,\n    min: 0,\n    max: 5,\n    optional: true,\n  },\n  buildingPlacementQuality: {\n    type: Number,\n    min: 0,\n    max: 5,\n    optional: true,\n  },\n  buildingQuality: {\n    type: Number,\n    min: 0,\n    max: 5,\n    optional: true,\n  },\n  flatQuality: {\n    type: Number,\n    min: 0,\n    max: 5,\n    optional: true,\n  },\n  materialsQuality: {\n    type: Number,\n    min: 0,\n    max: 5,\n    optional: true,\n  },\n  otherNotes: {\n    type: String,\n    optional: true,\n  },\n  name: {\n    type: String,\n    optional: true,\n  },\n  latitude: {\n    type: Number,\n    optional: true,\n    min: -90,\n    max: 90,\n  },\n  longitude: {\n    type: Number,\n    optional: true,\n    min: -180,\n    max: 180,\n  },\n  nearestBusStation: {\n    type: Object,\n    blackbox: true,\n    optional: true,\n  },\n  nearestTrainStation: {\n    type: Object,\n    blackbox: true,\n    optional: true,\n  },\n  customFields: {\n    // Allows storing custom fields that aren't allowed by the default schema\n    type: Object,\n    blackbox: true,\n    defaultValue: {},\n  },\n  adminValidation: { type: Object, defaultValue: {}, blackbox: true },\n  files: {\n    type: PropertyFilesSchema,\n    defaultValue: {},\n  },\n});\n\n// Attach schema\nProperties.attachSchema(PropertySchema);\nexport default Properties;\n","export const PROPERTY_STATUS = {\n  SOLD: 'SOLD',\n  FOR_SALE: 'FOR_SALE',\n};\n\nexport const USAGE_TYPE = {\n  PRIMARY: 'PRIMARY',\n  SECONDARY: 'SECONDARY',\n  INVESTMENT: 'INVESTMENT',\n};\n\nexport const PROPERTY_STYLE = {\n  FLAT: 'FLAT',\n  VILLA: 'VILLA',\n};\n\nexport const VOLUME_NORM = {\n  SIA: 'SIA',\n};\n\nexport const EXPERTISE_RATING = {\n  0: 0,\n  1: 1,\n  2: 2,\n  3: 3,\n};\n\nexport const PROPERTY_QUERIES = {\n  PROPERTY_ASSIGNED_TO: 'PROPERTY_ASSIGNED_TO',\n};\n","import Security from '../Security';\nimport { Borrowers } from '../..';\n\nclass BorrowerSecurity {\n  static isAllowedToInsert() {\n    Security.checkLoggedIn();\n  }\n\n  static isAllowedToUpdate(loanId) {\n    if (Security.currentUserIsAdmin()) {\n      return;\n    }\n\n    const loan = Borrowers.findOne(loanId);\n    Security.checkOwnership(loan);\n  }\n\n  static isAllowedToDelete() {\n    Security.checkCurrentUserIsAdmin();\n  }\n}\n\nexport default BorrowerSecurity;\n","import Security from '../Security';\nimport { Loans } from '../..';\n\nclass LoanSecurity {\n  static isAllowedToInsert() {\n    Security.checkLoggedIn();\n  }\n\n  static isAllowedToUpdate(loanId) {\n    if (Security.currentUserIsAdmin()) {\n      return;\n    }\n\n    const loan = Loans.findOne(loanId);\n    Security.checkOwnership(loan);\n  }\n\n  static isAllowedToDelete() {\n    Security.checkCurrentUserIsAdmin();\n  }\n}\n\nexport default LoanSecurity;\n","import Security from '../Security';\nimport { Offers } from '../..';\n\nclass OfferSecurity {\n  static isAllowedToInsert() {\n    Security.checkLoggedIn();\n  }\n\n  static isAllowedToUpdate(loanId) {\n    if (Security.currentUserIsAdmin()) {\n      return;\n    }\n\n    const loan = Offers.findOne(loanId);\n    Security.checkOwnership(loan);\n  }\n\n  static isAllowedToDelete() {\n    Security.checkCurrentUserIsAdmin();\n  }\n}\n\nexport default OfferSecurity;\n","import Security from '../Security';\nimport { Properties } from '../..';\n\nclass PropertySecurity {\n  static isAllowedToInsert() {\n    Security.checkLoggedIn();\n  }\n\n  static isAllowedToUpdate(loanId) {\n    if (Security.currentUserIsAdmin()) {\n      return;\n    }\n\n    const loan = Properties.findOne(loanId);\n    Security.checkOwnership(loan);\n  }\n\n  static isAllowedToDelete() {\n    Security.checkCurrentUserIsAdmin();\n  }\n}\n\nexport default PropertySecurity;\n","import Security from '../Security';\nimport { Tasks } from '../..';\n\nclass TaskSecurity {\n  static isAllowedToInsert() {\n    Security.checkLoggedIn();\n  }\n\n  static isAllowedToUpdate() {\n    Security.checkCurrentUserIsAdmin();\n  }\n\n  static isAllowedToDelete() {\n    Security.checkCurrentUserIsAdmin();\n  }\n}\n\nexport default TaskSecurity;\n","export { default as LoanSecurity } from './LoanSecurity';\nexport { default as OfferSecurity } from './OfferSecurity';\nexport { default as BorrowerSecurity } from './BorrowerSecurity';\nexport { default as PropertySecurity } from './PropertySecurity';\nexport { default as TaskSecurity } from './TaskSecurity';\n","import { Meteor } from 'meteor/meteor';\nimport { Roles } from 'meteor/alanning:roles';\n\nimport { ROLES } from '../constants';\n\nexport const SECURITY_ERROR = 'NOT_AUTHORIZED';\n\nexport default class Security {\n  static hasRole(userId, role) {\n    return Roles.userIsInRole(userId, role);\n  }\n\n  static handleUnauthorized(message) {\n    throw new Meteor.Error(SECURITY_ERROR, message);\n  }\n\n  static checkRole(userId, role) {\n    if (!this.hasRole(userId, role)) {\n      this.handleUnauthorized(`Checking role: ${role}`);\n    }\n  }\n\n  static checkLoggedIn() {\n    if (!Meteor.userId()) {\n      this.handleUnauthorized('Checking if logged in');\n    }\n  }\n\n  static currentUserHasRole(role) {\n    return this.hasRole(Meteor.userId(), role);\n  }\n\n  static currentUserIsAdmin() {\n    return (\n      this.hasRole(Meteor.userId(), ROLES.ADMIN) ||\n      this.hasRole(Meteor.userId(), ROLES.DEV)\n    );\n  }\n\n  static checkCurrentUserIsAdmin() {\n    if (!this.currentUserIsAdmin()) {\n      this.handleUnauthorized('Checking if current user is admin');\n    }\n  }\n\n  static checkOwnership(doc) {\n    if (Meteor.userId() !== doc.userId) {\n      this.handleUnauthorized('Checking ownership');\n    }\n  }\n}\n","import Security from './Security';\nimport {\n  LoanSecurity,\n  OfferSecurity,\n  BorrowerSecurity,\n  PropertySecurity,\n  TaskSecurity,\n} from './collections';\n\nclass SecurityService extends Security {\n  static get loans() {\n    return LoanSecurity;\n  }\n\n  static get offers() {\n    return OfferSecurity;\n  }\n\n  static get properties() {\n    return PropertySecurity;\n  }\n\n  static get borrowers() {\n    return BorrowerSecurity;\n  }\n\n  static get tasks() {\n    return TaskSecurity;\n  }\n}\n\nexport { SECURITY_ERROR } from './Security';\nexport default SecurityService;\n","import './tasksList.expose';\n","import Security from 'core/api/security';\nimport query from './tasksList';\n\nquery.expose({\n  firewall(userId) {\n    Security.checkCurrentUserIsAdmin(userId);\n  },\n});\n","import { Tasks } from '../../';\nimport { TASK_QUERIES } from '../tasksConstants';\n\nexport default Tasks.createQuery(TASK_QUERIES.TASKS, {\n  $filter({ filters, options, params }) {\n    if (params.userId) {\n      filters.assignedTo = params.userId;\n    }\n    // filters.assignedUser.roles = {$in: ['admin']};\n  },\n  $options: {\n    sort: {\n      createdAt: -1,\n    },\n  },\n  $paginate: true,\n  status: 1,\n  type: 1,\n  createdAt: 1,\n  updatedAt: 1,\n  dueAt: 1,\n  assignedUser: {\n    emails: 1,\n    roles: 1,\n  },\n  // borrowerAssignee: 1,\n  // loanAssignee: 1,\n  // propertyAssignee: 1,\n  userId: 1,\n});\n","import { SecurityService, createMutator } from '../..';\nimport TaskService from '../TaskService';\nimport * as defs from '../mutationDefinitions';\n\ncreateMutator(defs.TASK_INSERT, ({ type, loanId }) => {\n  SecurityService.tasks.isAllowedToInsert();\n  return TaskService.insert({ type, loanId });\n});\n\ncreateMutator(defs.TASK_UPDATE, ({ taskId, task }) => {\n  SecurityService.tasks.isAllowedToUpdate();\n  return TaskService.insert({ taskId, task });\n});\n\ncreateMutator(defs.TASK_COMPLETE, ({ taskId }) => {\n  SecurityService.tasks.isAllowedToUpdate(taskId);\n  return TaskService.complete({ taskId });\n});\n\ncreateMutator(defs.TASK_COMPLETE_BY_TYPE, ({ type, loanId, newStatus }) => {\n  SecurityService.tasks.isAllowedToUpdate();\n  return TaskService.completeByType({ type, loanId, newStatus });\n});\n\ncreateMutator(defs.TASK_CHANGE_STATUS, ({ taskId, newStatus }) => {\n  SecurityService.tasks.isAllowedToUpdate(taskId);\n  return TaskService.changeStatus({ taskId, newStatus });\n});\n\ncreateMutator(defs.TASK_CHANGE_USER, ({ taskId, newUser }) => {\n  SecurityService.tasks.isAllowedToUpdate(taskId);\n  return TaskService.changeUser({ taskId, newUser });\n});\n","import { USER_EVENTS } from 'core/api/users/userConstants';\nimport EventService from '../../events';\nimport { mutations } from '../../mutations';\nimport TaskService from '../TaskService';\nimport { TASK_TYPE } from '../tasksConstants';\n\nEventService.addMutationListener(mutations.LOAN_DELETE, (params) => {\n  // TODO: remove parent loan for these tasks\n});\n\nEventService.addMutationListener(\n  mutations.REQUEST_LOAN_VERIFICATION,\n  (params) => {\n    // TODO: ADMIN_ACTION_TYPE.VERIFY\n  },\n);\n\nEventService.addMutationListener(mutations.START_AUCTION, (params) => {\n  // TODO: ADMIN_ACTION_TYPE.AUCTION\n});\n\nEventService.addMutationListener(mutations.END_AUCTION, (params) => {\n  // TODO: complete auction task\n});\n\nEventService.addMutationListener(mutations.CANCEL_AUCTION, (params) => {\n  // TODO: remove auction task\n});\n\nEventService.addMutationListener(mutations.ASSIGN_ADMIN_TO_USER, (params) => {\n  // TODO: reassign all tasks created by user\n  const { adminId, userId } = params;\n  TaskService.assignAllTasksToAdmin({ userId, adminId });\n});\n\nEventService.addListener(USER_EVENTS.USER_CREATED, (params) => {\n  const { userId } = params;\n  const type = TASK_TYPE.ADD_ASSIGNED_TO;\n  TaskService.insert({ type, userId: { userId } });\n});\n","import { Meteor } from 'meteor/meteor';\nimport Tasks from '../tasks';\nimport { TASK_STATUS, TASK_TYPE } from './tasksConstants';\n\nclass TaskService {\n  insert = ({ type, loanId, assignedTo, createdBy }) => {\n    if (type !== TASK_TYPE.ADD_ASSIGNED_TO) {\n      const existingTask = Tasks.findOne({\n        type,\n        loanId,\n        status: TASK_STATUS.ACTIVE,\n      });\n      if (existingTask) {\n        throw new Meteor.Error('duplicate active task');\n      }\n    }\n    // check userId in loan and pass it as assignedTo\n    return Tasks.insert({\n      type,\n      loanId,\n      assignedTo,\n      createdBy,\n    });\n  };\n\n  remove = ({ taskId }) => Tasks.remove(taskId);\n\n  update = ({ taskId, task }) => Tasks.update(taskId, { $set: task });\n\n  complete = ({ taskId }) =>\n    this.update({\n      taskId,\n      task: {\n        status: TASK_STATUS.COMPLETED,\n        completedAt: new Date(),\n      },\n    });\n\n  completeByType = ({ type, loanId, newStatus }) => {\n    const taskToComplete = Tasks.findOne({\n      loanId,\n      type,\n      status: TASK_STATUS.ACTIVE,\n    });\n\n    if (!taskToComplete) {\n      throw new Meteor.Error(\"task couldn't be found\");\n    }\n\n    return this.update({\n      taskId: taskToComplete._id,\n      task: {\n        status: newStatus || TASK_STATUS.COMPLETED,\n        completedAt: new Date(),\n      },\n    });\n  };\n\n  changeStatus = ({ taskId, newStatus }) =>\n    this.update({ taskId, task: { status: newStatus } });\n\n  changeUser = ({ taskId, newUser }) =>\n    this.update({\n      taskId,\n      task: { userId: newUser },\n    });\n\n  changeAssignedTo = ({ taskId, userId, newAssignee }) =>\n    this.update({\n      taskId,\n      task: { userId, assignedTo: newAssignee },\n    });\n}\n\nexport default new TaskService();\n","import * as mutationDefinitions from './mutationDefinitions';\n\nexport { default } from './tasks';\nexport const taskMutations = mutationDefinitions;\n","import { Tasks, Users, Loans, Borrowers, Properties } from '../';\n\nTasks.addLinks({\n  assignedUser: {\n    field: 'assignedTo',\n    collection: Users,\n    type: 'one',\n  },\n\n  loan: {\n    field: 'loanId',\n    collection: Loans,\n    type: 'one',\n  },\n\n  property: {\n    field: 'propertyId',\n    collection: Properties,\n    type: 'one',\n  },\n\n  borrower: {\n    field: 'borrowerId',\n    collection: Borrowers,\n    type: 'one',\n  },\n\n  user: {\n    field: 'userId',\n    collection: Users,\n    type: 'one',\n  },\n});\n","export const TASK_INSERT = {\n  name: 'TASK_INSERT',\n  params: {\n    loanId: { type: String },\n    type: { type: String },\n  },\n};\n\nexport const TASK_UPDATE = {\n  name: 'TASK_UPDATE',\n  params: {\n    taskId: { type: String },\n    task: { type: Object },\n  },\n};\n\nexport const TASK_COMPLETE = {\n  name: 'TASK_COMPLETE',\n  params: {\n    taskId: { type: String },\n  },\n};\n\nexport const TASK_COMPLETE_BY_TYPE = {\n  name: 'TASK_COMPLETE_BY_TYPE',\n  params: {\n    type: { type: String },\n    loanId: { type: String },\n    newStatus: { type: String, optional: true },\n  },\n};\n\nexport const TASK_CHANGE_STATUS = {\n  name: 'TASK_CHANGE_STATUS',\n  params: {\n    taskId: { type: String },\n    newStatus: { type: String },\n  },\n};\n\nexport const TASK_CHANGE_USER = {\n  name: 'TASK_CHANGE_USER',\n  params: {\n    taskId: { type: String },\n    newUser: { type: String },\n  },\n};\n","import { Mongo } from 'meteor/mongo';\nimport SimpleSchema from 'simpl-schema';\nimport { TASK_STATUS, TASK_TYPE } from './tasksConstants';\n\nconst Tasks = new Mongo.Collection('tasks');\n\n// Prevent all client side modifications of mongoDB\nTasks.deny({\n  insert: () => true,\n  update: () => true,\n  remove: () => true,\n});\n\nTasks.allow({\n  insert: () => false,\n  update: () => false,\n  remove: () => false,\n});\n\nconst TasksSchema = new SimpleSchema({\n  createdAt: {\n    type: Date,\n    autoValue() {\n      if (this.isInsert) {\n        return new Date();\n      }\n    },\n  },\n  updatedAt: {\n    type: Date,\n    optional: true,\n  },\n  status: {\n    type: String,\n    defaultValue: TASK_STATUS.ACTIVE,\n    allowedValues: Object.values(TASK_STATUS),\n  },\n  completedAt: {\n    type: Date,\n    optional: true,\n  },\n  dueAt: {\n    type: Date,\n    optional: true,\n  },\n  createdBy: {\n    type: String,\n    optional: true,\n  },\n  assignedTo: {\n    type: String,\n    optional: true,\n  },\n  type: {\n    type: String,\n    allowedValues: Object.values(TASK_TYPE),\n    optional: true,\n  },\n  title: {\n    type: String,\n    optional: true,\n  },\n  description: {\n    type: String,\n    optional: true,\n  },\n  loanId: {\n    type: String,\n    optional: true,\n  },\n  propertyId: {\n    type: String,\n    optional: true,\n  },\n  borrowerId: {\n    type: String,\n    optional: true,\n  },\n  userId: {\n    type: String,\n    optional: true,\n  },\n});\n\nTasks.attachSchema(TasksSchema);\nexport default Tasks;\n","export const TASK_STATUS = {\n  ACTIVE: 'ACTIVE',\n  COMPLETED: 'COMPLETED',\n  CANCELLED: 'CANCELLED',\n};\n\nexport const TASK_TYPE = {\n  VERIFY: 'VERIFY',\n  AUCTION: 'AUCTION',\n  LENDER_CHOSEN: 'LENDER_CHOSEN',\n  CUSTOM: 'CUSTOM',\n  ADD_ASSIGNED_TO: 'ADD_ASSIGNED_TO',\n};\n\nexport const TASK_QUERIES = {\n  TASKS: 'TASKS',\n};\n","import Security from 'core/api/security';\nimport query from './adminUserView';\n\nquery.expose({\n  firewall(userId) {\n    Security.checkCurrentUserIsAdmin(userId);\n  },\n});\n","import { Users } from '../../';\nimport { USER_QUERIES } from '../userConstants';\n\nexport default Users.createQuery(USER_QUERIES.ADMIN_USER, {\n  $filter({ filters, options, params }) {\n    filters._id = params._id;\n  },\n  $options: {\n    sort: {\n      createdAt: -1,\n    },\n  },\n  emails: 1,\n  createdAt: 1,\n  loans: {\n    logic: { step: 1 },\n    createdAt: 1,\n    updatedAt: 1,\n    general: { insuranceFortuneUsed: 1, fortuneUsed: 1 },\n    property: {\n      value: 1,\n      address1: 1,\n    },\n    borrowers: {\n      firstName: 1,\n      lastName: 1,\n    },\n  },\n});\n","import Security from 'core/api/security';\nimport query from './adminUsersList';\n\nquery.expose({\n  firewall(userId) {\n    Security.checkCurrentUserIsAdmin(userId);\n  },\n});\n","import { Users } from '../../';\nimport { USER_QUERIES } from '../userConstants';\n\nexport default Users.createQuery(USER_QUERIES.ADMIN_USERS, {\n  $options: {\n    sort: {\n      createdAt: -1,\n    },\n  },\n  emails: 1,\n  createdAt: 1,\n  roles: 1,\n});\n","import Security from 'core/api/security';\nimport query from './admins';\n\nquery.expose({\n  firewall(userId) {\n    Security.checkCurrentUserIsAdmin(userId);\n  },\n});\n","import { Users } from '../../';\nimport { USER_QUERIES } from '../userConstants';\n\nexport default Users.createQuery(USER_QUERIES.ADMINS, {\n  $filter({ filters, options, params }) {\n    filters.roles = { $in: ['admin'] };\n  },\n  $options: {\n    sort: {\n      createdAt: -1,\n    },\n  },\n  emails: 1,\n});\n","import './adminUsersList.expose';\nimport './adminUserView.expose';\nimport './admins.expose';\n","import { Meteor } from 'meteor/meteor';\nimport { Accounts } from 'meteor/accounts-base';\n\nAccounts.onCreateUser((options, user) => {\n  const newUser = user;\n\n  if (Meteor.isDevelopment) {\n    newUser.roles = 'dev';\n  } else {\n    newUser.roles = 'user';\n  }\n\n  return newUser;\n});\n\nAccounts.config({\n  forbidClientAccountCreation: false,\n});\n","import { Meteor } from 'meteor/meteor';\nimport { Accounts } from 'meteor/accounts-base';\n\nimport UserService from 'core/api/users/UserService';\nimport { SecurityService, createMutator } from '../..';\nimport * as defs from '../mutationDefinitions';\n\ncreateMutator(\n  defs.DOES_USER_EXIST,\n  ({ email }) => Accounts.findUserByEmail(email) != null,\n);\n\ncreateMutator(defs.SEND_VERIFICATION_LINK, ({ userId }) => {\n  if (userId) {\n    SecurityService.checkCurrentUserIsAdmin();\n  } else {\n    SecurityService.checkLoggedIn();\n  }\n  const id = userId || Meteor.userId();\n\n  if (Meteor.isDevelopment) {\n    console.log(`Not sending verification link in development for userId: ${id}`);\n    return false;\n  }\n\n  return Accounts.sendVerificationEmail(id);\n});\n\ncreateMutator(defs.ASSIGN_ADMIN_TO_USER, ({ userId, adminId }) =>\n  UserService.assignAdminToUser({ userId, adminId }));\n","import { Meteor } from 'meteor/meteor';\nimport { Roles } from 'meteor/alanning:roles';\nimport { check } from 'meteor/check';\n\nMeteor.publish('allUsers', function publish() {\n  // Verify if the current user is an admin\n  if (\n    Roles.userIsInRole(Meteor.userId(), 'admin') ||\n    Roles.userIsInRole(Meteor.userId(), 'dev')\n  ) {\n    // Return all users\n    return Meteor.users.find();\n  }\n\n  return this.ready();\n});\n\nMeteor.publish('currentUser', function publish() {\n  if (Meteor.userId()) {\n    return Meteor.users.find({ _id: Meteor.userId() });\n  }\n  // Return an empy cursor if not logged in\n  return this.ready();\n});\n\nMeteor.publish('user', function publish(userId) {\n  check(userId, String);\n  if (\n    Roles.userIsInRole(Meteor.userId(), 'admin') ||\n    Roles.userIsInRole(Meteor.userId(), 'dev')\n  ) {\n    return Meteor.users.find({ _id: userId });\n  }\n  // Return an empy cursor if not logged in\n  return this.ready();\n});\n","import { Accounts } from 'meteor/accounts-base';\nimport { Roles } from 'meteor/alanning:roles';\n// import { Emitter, Events } from '/core/api/users';\nimport EventService from 'core/api/events';\nimport { USER_EVENTS } from './userConstants';\nimport Users from '../users';\n\nclass UserService {\n  createUser = ({ options, role }) => {\n    const newUserId = Accounts.createUser(options, (err) => {\n      if (err) console.log(err);\n      else {\n        Roles.addUsersToRoles(newUserId, role);\n        // Emitter.emit(Events.ITEM_CREATED, { newUserId });\n        if (role === 'user') {\n          EventService.emit(USER_EVENTS.USER_CREATED, { newUserId });\n        }\n        return newUserId;\n      }\n      return null;\n    });\n  };\n\n  remove = ({ userId }) => {\n    Users.remove(userId);\n  };\n\n  update = ({ userId, user }) => {\n    Users.update(userId, { $set: user });\n  };\n\n  assignAdminToUser = ({ userId, adminId }) => {\n    this.update({\n      userId,\n      user: { assignedTo: adminId },\n    });\n  };\n\n  getAdmins = () => Users.find({ roles: { $in: ['admin'] } }).fetch();\n}\n\nexport default new UserService();\n","import * as mutationDefinitions from './mutationDefinitions';\n\nexport const userMutations = mutationDefinitions;\nexport { default } from './users';\n","import { Loans, Users, Borrowers } from '../';\n\nUsers.addLinks({\n  loans: {\n    collection: Loans,\n    inversedBy: 'user',\n  },\n});\n","export const DOES_USER_EXIST = {\n  name: 'DOES_USER_EXIST',\n  params: {\n    email: { type: String },\n  },\n};\n\nexport const SEND_VERIFICATION_LINK = {\n  name: 'SEND_VERIFICATION_LINK',\n  params: {\n    userId: { type: String, optional: true },\n  },\n};\n\nexport const ASSIGN_ADMIN_TO_USER = {\n  name: 'ASSIGN_ADMIN_TO_USER',\n  params: {\n    userId: { type: String },\n    adminId: { type: String },\n  },\n};\n","export const ROLES = {\n  USER: 'user',\n  ADMIN: 'admin',\n  DEV: 'dev',\n  LENDER: 'lender',\n};\n\nexport const USER_QUERIES = {\n  ADMIN_USERS: 'ADMIN_USERS',\n  ADMIN_USER: 'ADMIN_USER',\n  ADMINS: 'ADMINS',\n};\n\nexport const USER_EVENTS = {\n  USER_CREATED: 'user_created',\n};\n","import SimpleSchema from 'simpl-schema';\nimport { Meteor } from 'meteor/meteor';\n\nimport { ROLES } from './userConstants';\n\nconst UserSchema = new SimpleSchema({\n  username: {\n    type: String,\n    // For accounts-password, either emails or username is required, but not both. It is OK to make this\n    // optional here because the accounts-password package does its own validation.\n    // Third-party login packages may not require either. Adjust this schema as necessary for your usage.\n    optional: true,\n  },\n  emails: {\n    type: Array,\n    // For accounts-password, either emails or username is required, but not both. It is OK to make this\n    // optional here because the accounts-password package does its own validation.\n    // Third-party login packages may not require either. Adjust this schema as necessary for your usage.\n    optional: true,\n  },\n  'emails.$': {\n    type: Object,\n  },\n  'emails.$.address': {\n    type: String,\n    regEx: SimpleSchema.RegEx.Email,\n  },\n  'emails.$.verified': {\n    type: Boolean,\n  },\n  createdAt: {\n    type: Date,\n  },\n  // Make sure this services field is in your schema if you're using any of the accounts packages\n  services: {\n    type: Object,\n    optional: true,\n    blackbox: true,\n  },\n  // Add `roles` to your schema if you use the meteor-roles package.\n  // Option 1: Object type\n  // If you specify that type as Object, you must also specify the\n  // `Roles.GLOBAL_GROUP` group whenever you add a user to a role.\n  // Example:\n  // Roles.addUsersToRoles(userId, [\"admin\"], Roles.GLOBAL_GROUP);\n  // You can't mix and match adding with and without a group since\n  // you will fail validation in some cases.\n  // roles: {\n  //   type: Object,\n  //   optional: true,\n  //   blackbox: true,\n  // },\n  // Option 2: [String] type\n  // If you are sure you will never need to use role groups, then\n  // you can specify [String] as the type\n  roles: {\n    type: Array,\n    optional: true,\n  },\n  'roles.$': {\n    type: String,\n    allowedValues: Object.values(ROLES),\n  },\n  // In order to avoid an 'Exception in setInterval callback' from Meteor\n  heartbeat: {\n    type: Date,\n    optional: true,\n  },\n  assignedTo: {\n    type: String,\n    optional: true,\n  },\n});\n\nMeteor.users.attachSchema(UserSchema);\n\nconst Users = Meteor.users;\nexport default Users;\n","import { EventEmitter } from 'events';\nimport { Meteor } from 'meteor/meteor';\n\nconst IS_LOGGING = true;\n\nexport class EventService {\n  constructor({ emmitter }) {\n    this.emmitter = emmitter;\n    this.addErrorListener();\n  }\n\n  emit(eventName, params) {\n    this.logEmittedEvent(eventName, params);\n    this.emmitter.emit(eventName, params);\n  }\n\n  emitMutation({ name }, params) {\n    this.emit(name, params);\n  }\n\n  addListener(eventName, listenerFunction) {\n    this.emmitter.addListener(eventName, (params) => {\n      this.logListener(eventName, params);\n      listenerFunction(params);\n    });\n  }\n\n  addMutationListener({ name }, listenerFunction) {\n    this.addListener(name, listenerFunction);\n  }\n\n  addErrorListener() {\n    this.addListener('error', (error) => {\n      console.log('An error occured in an event listener:');\n      console.log(error);\n      throw error;\n    });\n  }\n\n  logEmittedEvent(eventName, params) {\n    if (IS_LOGGING && Meteor.isDevelopment && !Meteor.isTest) {\n      console.log(`Event \"${eventName}\" triggered with params:`);\n      console.log(params);\n    }\n  }\n\n  logListener(eventName, params) {\n    if (IS_LOGGING && Meteor.isDevelopment && !Meteor.isTest) {\n      console.log(`Event \"${eventName}\" listened to with params:`);\n      console.log(params);\n    }\n  }\n}\n\nconst defaultEmmitter = new EventEmitter();\nexport default new EventService({ emmitter: defaultEmmitter });\n","export { default } from './EventService';\n","// Import all event listener files here\nimport '../email/server/emailListeners';\nimport '../tasks/server/taskListeners';\nimport '../jobs/server/jobListeners';\n","import 'core/fixtures/methods';\n// generateTestData\n\nimport './adminActions/server/publications';\nimport './adminActions/server/methods';\n\nimport './borrowers/server/publications';\nimport './borrowers/server/methods';\n\nimport './comparators/server/publications';\nimport './comparators/server/methods';\n\nimport './loans/server/publications';\nimport './loans/server/methods';\n\nimport './offers/server/publications';\nimport './offers/server/methods';\n\nimport './properties/server/publications';\nimport './properties/server/methods';\n\nimport './users/server/publications';\nimport './users/server/accounts-server-config';\n\nimport './methods/server';\n\nimport './factories';\n\nimport './jobs/server';\n\nimport './files/server/methods';\nimport './files/meteor-slingshot-server';\n\nimport '../utils/logismata/methods';\n\nimport './email/server';\n\nimport './mutations/server';\n\nimport './events/registerListeners';\n\n// Exposures\nimport './loans/queries/exposures';\nimport './users/queries/exposures';\n// import \"./adminActions/queries/exposures\";\nimport './tasks/queries/exposures';\nimport './borrowers/queries/exposures';\nimport './properties/queries/exposures';\n\nimport { Loans, Borrowers, Offers, Properties } from '.';\n\nLoans._ensureIndex({ userId: 1 });\nBorrowers._ensureIndex({ userId: 1 });\nOffers._ensureIndex({ loanId: 1 });\nProperties._ensureIndex({ userId: 1 });\n","import './factories';\n\nimport './files/meteor-slingshot';\n","import { Meteor } from 'meteor/meteor';\nimport { Bert } from 'meteor/themeteorchef:bert';\n\n// Passed to all methods, shows a Bert error when it happens\nconst handleResult = (result, bertObject) => {\n  if (Meteor.isClient && !!bertObject) {\n    const { delay, title, message, type, style } = bertObject;\n    if (delay) {\n      Bert.defaults.hideDelay = delay;\n    }\n\n    Bert.alert({\n      title: title || \"C'est réussi\",\n      message:\n        message === undefined ? '<h3 class=\"bert\">Bien joué!</h3>' : message,\n      type: type || 'success',\n      style: style || 'growl-top-right',\n    });\n  }\n\n  return result;\n};\n\n// Passed to all methods, shows a bert alert\nconst handleError = (error) => {\n  if (Meteor.isClient) {\n    Bert.defaults.hideDelay = 7500;\n    Bert.alert({\n      title: 'Misère, une erreur!',\n      message: `<h3 class=\"bert\">${error.message}</h3>`,\n      type: 'danger',\n      style: 'fixed-top',\n    });\n  }\n\n  console.log(error);\n\n  // Throw the error again so that it can be catched again via promise chaining\n  // All uses of this module should catch and implement proper fail-safe logic\n  throw error;\n};\n\n// A wrapper method that displays an error if it occurs\nconst cleanMethod = (name, params, bertObject) => {\n  console.log('cleanmethod!', name, params);\n\n  return new Promise((resolve, reject) => {\n    Meteor.call(name, params, (error, result) => {\n      if (error) {\n        reject(handleError(error));\n      } else {\n        resolve(handleResult(result, bertObject));\n      }\n    });\n  });\n};\n\nexport default cleanMethod;\n","export * from './adminActions/adminActionConstants';\nexport * from './borrowers/borrowerConstants';\nexport * from './loans/loanConstants';\nexport * from './offers/offerConstants';\nexport * from './users/userConstants';\nexport * from './properties/propertyConstants';\nexport * from './files/fileConstants';\nexport * from './tasks/tasksConstants';\n","import { Meteor } from 'meteor/meteor';\nimport { Factory } from 'meteor/dburles:factory';\nimport {\n  Loans,\n  Borrowers,\n  Offers,\n  Comparators,\n  Properties,\n  AdminActions,\n} from '.';\n\nconst TEST_EMAIL = 'test@test.com';\n\nFactory.define('user', Meteor.users, {\n  roles: () => 'user',\n  emails: () => [{ address: TEST_EMAIL, verified: false }],\n  profile: {},\n});\n\nFactory.define('dev', Meteor.users, {\n  roles: () => 'dev',\n  emails: () => [{ address: TEST_EMAIL, verified: false }],\n  profile: {},\n});\n\nFactory.define('admin', Meteor.users, {\n  roles: () => 'admin',\n  emails: () => [{ address: TEST_EMAIL, verified: false }],\n  profile: {},\n});\n\nFactory.define('lender', Meteor.users, {\n  roles: () => 'lender',\n  emails: () => [{ address: TEST_EMAIL, verified: false }],\n  profile: () => ({ organization: 'bankName', cantons: ['GE'] }),\n});\n\nFactory.define('borrower', Borrowers, {\n  createdAt: () => new Date(),\n  expenses: () => [{ description: 'test', value: 1 }],\n  files: () => ({}),\n  logic: () => ({}),\n  age: 18,\n});\n\nFactory.define('loan', Loans, {\n  createdAt: () => new Date(),\n  general: () => ({\n    fortuneUsed: 250000,\n    insuranceFortuneUsed: 0,\n    partnersToAvoid: ['joe', 'john'],\n  }),\n  borrowers: [],\n  status: 'ACTIVE',\n  files: () => ({}),\n  logic: () => ({\n    auction: {},\n    lender: {},\n    verification: {},\n    step: 1,\n  }),\n  name: () => 'loan name',\n  emails: () => [],\n});\n\nFactory.define('property', Properties, {\n  value: 1000000,\n  files: () => ({}),\n});\n\nFactory.define('offer', Offers, {\n  createdAt: () => new Date(),\n  organization: 'bankName',\n  canton: 'GE',\n  auctionEndTime: () => new Date(),\n  standardOffer: () => ({\n    maxAmount: 800000,\n    amortization: 0.01,\n    interestLibor: 0.01,\n    interest1: 0.01,\n    interest2: 0.01,\n    interest5: 0.01,\n    interest10: 0.01,\n  }),\n});\n\nFactory.define('adminAction', AdminActions, {\n  type: 'test',\n  status: 'ACTIVE',\n});\n\nFactory.define('comparator', Comparators, {\n  customFields: [],\n  customFieldCount: 0,\n  hiddenFields: [],\n  borrowRatio: 0.8,\n});\n\nFactory.define('comparatorProperty', Properties, {\n  name: 'testName',\n  address: 'testAddress',\n  value: 100000,\n  latitude: 10,\n  longitude: 20,\n});\n","import * as _constants from './constants';\n\nexport { default as Loans } from './loans';\nexport { default as Borrowers } from './borrowers';\nexport { default as Offers } from './offers';\nexport { default as Properties } from './properties';\nexport { default as Comparators } from './comparators';\nexport { default as AdminActions } from './adminActions';\nexport { default as Users } from './users';\nexport { default as Tasks } from './tasks';\n\nexport { default as SecurityService } from './security';\nexport { default as EventService } from './events';\nexport * from './mutations';\n\n// Do this for autocompletion...\nexport const constants = _constants;\n","import './loans/links';\nimport './users/links';\n// import \"./adminActions/links\";\nimport './tasks/links';\nimport './properties/links';\nimport './borrowers/links';\n","// Use old-school javascript in this file to make it work nicely\n\nconst packageStubs = [\n  {\n    expose: 'meteor',\n    src: 'imports/core/utils/testHelpers/meteorStubs',\n  },\n];\n\nfunction setWallabyConfig(name, overrides = {}) {\n  return function setupWallaby(wallaby) {\n    return {\n      name,\n      // debug: true, // Use this if things go wrong\n      testFramework: 'mocha',\n      files: [\n        // load all files in imports\n        'imports/**/**.js*',\n        // Don't load node_modules twice\n        '!imports/core/node_modules/**',\n        // Don't import unnecessary folders\n        '!imports/core/assets/**',\n        // Don't load tests here, but in the next variable\n        '!imports/**/*.spec.js*',\n        // For a weird reason wallaby fucks up on .json files\n        '!**/*.json',\n      ],\n      tests: ['imports/**/*.spec.js*', '!imports/core/node_modules/**'],\n      compilers: {\n        '**/*.js*': wallaby.compilers.babel({\n          presets: ['env', 'react', 'stage-0'],\n          plugins: [\n            [\n              'module-alias',\n              [{ src: 'imports/core', expose: 'core' }, ...packageStubs],\n            ],\n          ],\n        }),\n      },\n      env: { type: 'node' },\n      setup() {\n        global.IS_WALLABY = true;\n        global.fetch = require('node-fetch');\n      },\n      ...overrides,\n    };\n  };\n}\n\nmodule.exports = setWallabyConfig;\n","import { _ } from 'lodash';\nimport { Meteor } from 'meteor/meteor';\n\nlet fetch;\nif (Meteor.isServer) {\n  fetch = require('node-fetch');\n} else {\n  fetch = global.fetch;\n}\n\nimport constants, { logismataValues } from './constants';\n\n// Where the current token will be stored\nlet token;\n\nexport const handleResponse = (response) => {\n  if (response.status !== 200) {\n    throw response;\n  }\n\n  return response.json();\n};\n\n/**\n * getAuthToken - verifies if the token exists, and fetches a new one if not\n *\n * @param {String} testKey an optional string used for testing\n *\n * @return {String} The authentication token\n */\nexport const getAuthToken = testKey =>\n  (token\n    ? Promise.resolve(token)\n    : fetch(constants.authUrl(testKey), { method: 'GET' })\n      .then(handleResponse)\n      .then((body) => {\n        token = body.authToken;\n        return body.authToken;\n      }));\n\nexport const setToken = authToken =>\n  Promise.resolve(authToken).then(() => {\n    token = authToken;\n  });\n\nexport const convertParamsToLogismata = (params = {}) => {\n  const newParams = { ...params };\n\n  Object.keys(logismataValues).forEach((key) => {\n    if (params[key] !== undefined) {\n      const newValue = _.findKey(\n        logismataValues[key],\n        val => val === params[key],\n      );\n\n      if (!newValue) {\n        throw new Error('invalid logismata value provided');\n      }\n\n      newParams[key] = Number(newValue);\n    } else {\n      newParams[key] = logismataValues[key].default;\n    }\n  });\n\n  return newParams;\n};\n\nexport const convertToLogismataTaxBase = (taxBase) => {\n  const params = convertParamsToLogismata(taxBase);\n\n  return {\n    age: params.age,\n    children: params.childrenCount,\n    civil: params.civilStatus,\n    confession: params.confession,\n    gross_fortune: params.grossFortune,\n    gross_income: params.grossIncome,\n    income_type: params.incomeBase,\n    locationid: params.locationId,\n    sex: params.sex,\n  };\n};\n\n/**\n * getParamsArray - Returns an array of parameters in the right order\n * for logismata's API\n *\n * @param {String} method the name of the logismata method\n * @param {Object} params an object of values\n *\n * @return {Array}\n */\n\nexport const getParamsArray = (method, params) => {\n  const logismataParams = convertParamsToLogismata(params);\n  switch (method) {\n  case 'getLocationInfo':\n    return [logismataParams.locationId];\n  case 'searchLocations':\n    return [\n      logismataParams.search,\n      logismataParams.language,\n      logismataParams.country,\n    ];\n  case 'calcTaxableIncomeState':\n    // Same as calcTaxableIncomeCountry\n  case 'calcTaxableIncomeCountry':\n    return [\n      logismataParams.locationId,\n      logismataParams.age,\n      logismataParams.civilStatus,\n      logismataParams.confession,\n      logismataParams.childrenCount,\n      logismataParams.grossIncome,\n      logismataParams.isEmployee,\n    ];\n  case 'calcTaxableFortune':\n    return [\n      logismataParams.locationId,\n      logismataParams.age,\n      logismataParams.civilStatus,\n      logismataParams.childrenCount,\n      logismataParams.grossFortune,\n    ];\n  case 'calcDirectAmortization':\n    return [\n      '', // customization\n      convertToLogismataTaxBase(params.taxBase),\n      {\n        amortization_goal: logismataParams.amortizationGoal,\n        duration: logismataParams.duration,\n        has_detailed_amortization: logismataParams.isDetailed,\n        rental_value: logismataParams.rentalValue,\n        maintenance_costs: logismataParams.maintenanceCosts,\n        mortgages: logismataParams.mortgages,\n        new_mortgages: logismataParams.newMortgages,\n      },\n    ];\n  case 'calcIndirectAmortization':\n    return [\n      '', // customization\n      convertToLogismataTaxBase(params.taxBase),\n      {\n        amortization_goal: logismataParams.amortizationGoal,\n        duration: logismataParams.duration,\n        saving_type: logismataParams.savingType,\n        saving_interestrate: logismataParams.savingRate,\n        saving_amount_manual: false,\n        saving_amount: logismataParams.savingAmount,\n        rental_value: logismataParams.rentalValue,\n        maintenance_costs: logismataParams.maintenanceCosts,\n        mortgages: logismataParams.mortgages,\n        new_mortgages: logismataParams.newMortgages,\n      },\n    ];\n  default:\n    throw new Error('invalid logismata method name');\n  }\n};\n\nexport const getTaxBase = (data) => {};\n\nexport const callApi = (method, params) => {\n  const data = JSON.stringify({\n    authToken: token,\n    loan: {\n      method,\n      // Stringify objects in the array, do not stringify strings once again\n      params: [\n        ...getParamsArray(method, params).map(i => (typeof i === 'object' ? JSON.stringify(i) : i)),\n      ],\n    },\n  });\n  return fetch(constants.calcUrl(), {\n    method: 'PUT',\n    headers: { 'Content-Type': 'application/json', Accept: '*/*' },\n    body: data,\n  }).then(response => response.json());\n};\n\nexport const getLocationId = search =>\n  callApi('searchLocations', {\n    search,\n    country: 'CH',\n    language: 'all',\n  }).then((result) => {\n    if (result.response && result.response.length) {\n      return result.response[result.response.length - 1].id;\n    }\n    throw new Error('Could not find locationId through logismata');\n  });\n\nexport const getIndirectAmortization = () => {};\n\nexport const getDirectAmortization = () => {};\n","export default 'standard';\n","import api_key from './api_key';\n\nconst key = api_key;\n\nexport default {\n  host: 'https://uat.logismata.ch',\n  authUrl(testKey) {\n    return `${this.host}/puma/authentication/${testKey || key}/createToken`;\n  },\n  calcUrl() {\n    return `${this.host}/puma/calculator/onlinetax/calculate`;\n  },\n  calcUrl2: () => 'https://hookb.in/vLNmVA3y',\n};\n\nexport const logismataValues = {\n  civilStatus: {\n    default: 2,\n    2: 'single',\n    3: 'concubinage',\n    4: 'married',\n    7: 'registered partnership',\n  },\n  confession: {\n    default: 'other',\n    1: 'reformed',\n    2: 'roman catholic',\n    3: 'christian catholic',\n    4: 'undenominational',\n    5: 'other',\n  },\n  incomeBase: {\n    default: 1,\n    1: 'gross income',\n    2: 'taxable income',\n  },\n  sex: {\n    default: 1,\n    1: 'male',\n    2: 'female',\n  },\n  country: {\n    default: 0,\n    0: 'all',\n    756: 'CH',\n    438: 'LI',\n  },\n  language: {\n    default: 0,\n    0: 'all',\n    1: 'german',\n    2: 'french',\n    3: 'italien',\n  },\n  mortgageType: {\n    default: 2,\n    1: 'Variable Rate',\n    2: 'Fixed Rate',\n    3: 'Libor',\n  },\n  savingType: {\n    default: 1,\n    1: 'Saving 3a',\n    2: 'Saving 3b/Assets',\n  },\n  existingOrNew: {\n    default: 1,\n    0: 'existing',\n    1: 'new',\n  },\n};\n","import { Meteor } from 'meteor/meteor';\nimport { ValidatedMethod } from 'meteor/mdg:validated-method';\nimport { CallPromiseMixin } from 'meteor/didericis:callpromise-mixin';\n\nimport { getAuthToken } from './api';\n\nexport const getLogismataToken = new ValidatedMethod({\n  name: 'getLogismataToken',\n  mixins: [CallPromiseMixin],\n  validate: null,\n  run: () => Meteor.isServer && getAuthToken(),\n});\n","import { Meteor } from 'meteor/meteor';\nimport { analytics } from 'meteor/okgrow:analytics';\nimport { storageAvailable, isDemo } from './browserFunctions';\n\n/**\n * allowTracking - Prevents tracking during tests and on a demo website\n *\n * @return {Boolean}\n */\nexport const allowTracking = () => {\n  if (isDemo()) {\n    return false;\n  } else if (Meteor.isTest) {\n    return false;\n  }\n\n  return true;\n};\n\nexport const addUserTracking = (userId, metadata) => {\n  if (!userId) {\n    throw new Error('no tracking identification userId provided');\n  }\n  if (allowTracking()) {\n    analytics.identify(userId, metadata);\n  }\n};\n\nconst track = (eventName, metadata) => {\n  if (!eventName) {\n    throw new Error('no tracking eventName provided');\n  }\n  if (allowTracking()) {\n    analytics.track(eventName, metadata);\n  }\n};\n\nexport default track;\n\nexport const trackOncePerSession = (eventName, metadata) => {\n  const localId = `epotek-tracking.${eventName}`;\n\n  // Make sure we can use sessionStorage\n  if (storageAvailable('sessionStorage')) {\n    const localTracked = sessionStorage.getItem(localId);\n\n    if (!localTracked) {\n      // If this id has never been tracked in localStorage, track\n      track(eventName, metadata);\n      sessionStorage.setItem(localId, eventName);\n    } else {\n      return false;\n    }\n  }\n};\n","import { personalInfoPercent, filesPercent } from '../arrays/steps';\nimport { borrowerFiles } from '../api/files/files';\nimport { arrayify } from './general';\n\nexport const getFortune = ({ borrowers }) => {\n  const array = [];\n\n  arrayify(borrowers).forEach((b) => {\n    array.push(b.bankFortune);\n  });\n  return array.reduce((tot, val) => (val > 0 && tot + val) || tot, 0);\n};\n\nexport const getInsuranceFortune = ({ borrowers }) => {\n  const array = [];\n\n  arrayify(borrowers).forEach((b) => {\n    array.push(b.insuranceSecondPillar);\n    array.push(b.insuranceThirdPillar);\n  });\n  return array.reduce((tot, val) => (val > 0 && tot + val) || tot, 0);\n};\n\nexport const getBorrowerCompletion = ({ borrower }) =>\n  (filesPercent([borrower], borrowerFiles, 'auction') +\n    personalInfoPercent([borrower]) +\n    (borrower.logic.hasValidatedFinances ? 1 : 0)) /\n  3;\n\nexport const getBonusIncome = ({ borrowers }) => {\n  let total = 0;\n  arrayify(borrowers).forEach((borrower) => {\n    if (borrower.bonus) {\n      let arr = Object.keys(borrower.bonus).map(key => borrower.bonus[key]);\n      if (arr.length < 1) {\n        return;\n      } else if (arr.length > 4) {\n        throw new Error('too many bonuses provided');\n      }\n\n      arr = arr.map(v => v || 0);\n      // Sum all values, remove the lowest one, and return 50% of their average\n      let sum = arr.reduce((tot, val) => tot + val, 0);\n\n      if (arr.length > 3) {\n        sum -= Math.min(...arr);\n      }\n      total = 0.5 * (sum / Math.min(3, arr.length)) || 0;\n    }\n  });\n\n  return Math.max(0, Math.round(total));\n};\n\nexport const getArrayValues = ({ borrowers }, key, mapFunc) => {\n  let sum = 0;\n\n  arrayify(borrowers).forEach((borrower) => {\n    if (!borrower[key]) {\n      return 0;\n    }\n    sum += [\n      ...(borrower[key] ? borrower[key].map(mapFunc || (i => i.value)) : []),\n    ].reduce((tot, val) => (val > 0 && tot + val) || tot, 0);\n  });\n\n  return Math.max(0, Math.round(sum));\n};\n\nexport const getOtherIncome = ({ borrowers }) =>\n  getArrayValues({ borrowers }, 'otherIncome');\n\nexport const getExpenses = ({ borrowers }) =>\n  getArrayValues({ borrowers }, 'expenses');\n\nexport const getBorrowerIncome = ({ borrowers }) => {\n  let sum = 0;\n\n  arrayify(borrowers).forEach((borrower) => {\n    sum += borrower.salary || 0;\n    sum += getBonusIncome({ borrowers: borrower }) || 0;\n    sum += getOtherIncome({ borrowers: borrower }) || 0;\n    sum -= getExpenses({ borrowers: borrower }) || 0;\n  });\n\n  return Math.max(sum, 0);\n};\n\nexport const getTotalFortune = ({ borrowers }) => {\n  let sum = 0;\n\n  arrayify(borrowers).forEach((borrower) => {\n    sum += borrower.bankFortune || 0;\n    sum += borrower.insuranceSecondPillar || 0;\n    sum += borrower.insuranceThirdPillar || 0;\n\n    // TODO: Complete with all fortune fields !!\n  });\n\n  return Math.max(0, Math.round(sum));\n};\n\nexport const getRealEstateFortune = ({ borrowers }) =>\n  getArrayValues({ borrowers }, 'realEstate', i => i.value - i.loan);\n\nexport const getRealEstateValue = ({ borrowers }) =>\n  getArrayValues({ borrowers }, 'realEstate');\n\nexport const getRealEstateDebt = ({ borrowers }) =>\n  getArrayValues({ borrowers }, 'realEstate', i => i.loan);\n\nexport const getBorrowerSalary = ({ borrowers }) =>\n  arrayify(borrowers).reduce((t, b) => t + (b.salary || 0), 0);\n","export const getWidth = () => {\n  if (global.window) {\n    const w = window;\n    const d = document;\n    const documentElement = d.documentElement;\n    const body = d.getElementsByTagName('body')[0];\n    return w.innerWidth || documentElement.clientWidth || body.clientWidth;\n  }\n};\n\nconst getSubdomain = () => {\n  if (global.window) {\n    const fullPath = window.location.host;\n    // window.location.host is subdomain.domain.com\n    return fullPath.split('.')[0];\n  }\n};\n\nexport const isDemo = () => getSubdomain() === 'demo';\nexport const isWww = () => getSubdomain() === 'www';\nexport const isApp = () => getSubdomain() === 'app';\nexport const isAdmin = () => getSubdomain() === 'admin';\nexport const isLender = () => getSubdomain() === 'lender';\n\nexport const storageAvailable = (type) => {\n  try {\n    const storage = window[type];\n    const x = '__storage_test__';\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return true;\n  } catch (e) {\n    return false;\n  }\n};\n\nexport const easeOut = (min, max, intervals) => {\n  const diff = 1 / intervals;\n  const difference = max - min;\n  const curve = [];\n\n  for (let i = diff; i <= 1; i += diff) {\n    curve.push(min + difference * Math.pow(i, 0.48));\n  }\n  return curve;\n};\n","import { GENDER, USAGE_TYPE } from '../api/constants';\nimport constants from '../config/constants';\nimport {\n  getLoanValue,\n  getPropAndWork,\n  getMaintenance,\n  getFees,\n} from './loanFunctions';\nimport {\n  getFortune,\n  getInsuranceFortune,\n  getTotalFortune,\n  getBorrowerIncome,\n} from './borrowerFunctions';\nimport { arrayify } from './general';\n\n// Determine retirement age depending on the gender of the borrowers\n// Return a positive value only, negative values rounded to 0\nexport const getYearsToRetirement = (age1, age2, gender1, gender2) => {\n  const retirement1 = gender1 === GENDER.F ? 64 : 65;\n  let retirement2 = null;\n  if (gender2) {\n    retirement2 = gender2 === GENDER.F ? 64 : 65;\n  }\n\n  // Substract age to determine remaining time to retirement for both borrowers\n  const toRetirement1 = retirement1 - age1;\n  let toRetirement2;\n  if (retirement2 && age2) {\n    toRetirement2 = retirement2 - age2;\n  }\n\n  // Get the most limiting time to retirement for both borrowers, in years\n  let yearsToRetirement;\n  if (toRetirement2) {\n    yearsToRetirement = Math.min(toRetirement1, toRetirement2);\n  } else {\n    yearsToRetirement = toRetirement1;\n  }\n\n  return Math.max(yearsToRetirement, 0);\n};\n\n// get monthly amortization for a loan loan\nexport const getAmortization = ({ loan, borrowers, property }) => {\n  const loanValue = getLoanValue({ loan, property });\n  const propAndWork = getPropAndWork({ loan, property });\n  const safeBorrowers = arrayify(borrowers);\n  const yearsToRetirement = getYearsToRetirement(\n    safeBorrowers[0] ? Number(safeBorrowers[0].age) : undefined,\n    safeBorrowers[1] && safeBorrowers[1].age ? Number(safeBorrowers[1].age) : 0,\n    safeBorrowers[0] ? safeBorrowers[0].gender : undefined,\n    safeBorrowers[1] && safeBorrowers[1].gender,\n  );\n\n  // fallback if the loan is smaller than 0\n  if (loanValue <= 0) {\n    return 0;\n  }\n\n  const loanPercent = loanValue / propAndWork;\n\n  let yearlyAmortization = 0;\n  const remainingYears = Math.min(yearsToRetirement, 15);\n  if (loanPercent > 0.65) {\n    // The loan has to be below 65% before 15 years or before retirement,\n    // whichever comes first\n    const amountToAmortize = (loanPercent - 0.65) * propAndWork;\n\n    // Make sure we don't create a black hole, or use negative values by error\n    if (remainingYears > 0) {\n      // Amortization is the amount to amortize divided by the amount\n      // of years before the deadline\n      yearlyAmortization = amountToAmortize / remainingYears;\n    }\n  } else {\n    // For projects below 65%, stop amortizing\n    // yearlyAmortization = propAndWork * constants.amortization;\n  }\n\n  return { amortization: yearlyAmortization / 12, years: remainingYears };\n};\n\n// get interest to pay for a loan every month\nexport const getInterests = ({ loan, property }, rate, loanValue) => {\n  loanValue = loanValue || getLoanValue({ loan, property });\n\n  if (loanValue <= 0) {\n    throw new Error('negative loan');\n  }\n\n  // Use a base interest rate of 1.5%\n  const interests = rate || 0.015;\n\n  return loanValue * interests / 12;\n};\n\nexport const getMonthlyPayment = ({ loan, borrowers, property }) => {\n  const interests = getInterests({ loan, property });\n  const { amortization } = getAmortization({\n    loan,\n    borrowers,\n    property,\n  });\n  const maintenance = getMaintenance({ loan, property });\n\n  return {\n    total: amortization + interests + maintenance,\n    amortization,\n    interests,\n    maintenance,\n  };\n};\n\nexport const getTheoreticalMonthly = ({ loan, borrowers, property }) => {\n  const maintenance =\n    getPropAndWork({ loan, property }) * constants.maintenance / 12;\n  const loanValue = getLoanValue({ loan, property });\n\n  const interests = loanValue * constants.interests / 12;\n  const { amortization } = getAmortization({\n    loan,\n    borrowers,\n    property,\n  });\n\n  return {\n    total: amortization + interests + maintenance,\n    amortization,\n    interests,\n    maintenance,\n  };\n};\n\nexport const getIncomeRatio = ({ loan, borrowers, property }) => {\n  const monthlyPayment = getTheoreticalMonthly({\n    loan,\n    borrowers,\n    property,\n  }).total;\n  const borrowerIncome = getBorrowerIncome({ borrowers }) / 12;\n\n  // Add infinity check\n  if (borrowerIncome > 0) {\n    return monthlyPayment / borrowerIncome;\n  }\n  return '-';\n};\n\nexport const canAffordRank1 = ({ loan, borrowers, property }) => {\n  const propAndWork = getPropAndWork({ loan, property });\n  const totalFortune = getTotalFortune({ borrowers });\n  const fortune = getFortune({ borrowers });\n  const insuranceFortune = getInsuranceFortune({ borrowers });\n  const fortuneRequired =\n    0.35 * propAndWork + property.value * constants.notaryFees;\n\n  if (fortune >= fortuneRequired) {\n    return true;\n  }\n\n  if (loan.general && loan.general.usageType === USAGE_TYPE.PRIMARY) {\n    if (fortune + insuranceFortune >= fortuneRequired) {\n      // ignore lppFees\n      return true;\n    }\n  }\n  return false;\n};\n","import isArray from 'lodash/isArray';\n\nexport const arrayify = value =>\n  (value ? (isArray(value) ? value : [value]) : []);\n","import ReactDOMServer from 'react-dom/server';\nimport pdf from 'html-pdf';\nimport fs from 'fs';\n\nlet thisModule;\n\nconst getBase64String = (path) => {\n  try {\n    const file = fs.readFileSync(path);\n    return new Buffer(file).toString('base64');\n  } catch (exception) {\n    thisModule.reject(exception);\n  }\n};\n\nconst generatePDF = (html, fileName) => {\n  try {\n    pdf\n      .create(html, {\n        format: 'A4',\n        border: { top: '1in', right: '1in', bottom: '1in', left: '1in' },\n      })\n      .toFile(`./tmp/${fileName}`, (error, response) => {\n        if (error) {\n          thisModule.reject(error);\n        } else {\n          thisModule.resolve({\n            fileName,\n            base64: getBase64String(response.filename),\n          });\n          fs.unlink(response.filename);\n        }\n      });\n  } catch (exception) {\n    thisModule.reject(exception);\n  }\n};\n\nconst getComponentAsHTML = (component, props) => {\n  try {\n    return ReactDOMServer.renderToStaticMarkup(component(props));\n  } catch (exception) {\n    thisModule.reject(exception);\n  }\n};\n\nconst handler = ({ component, props, fileName }, promise) => {\n  thisModule = promise;\n  const html = getComponentAsHTML(component, props);\n  if (html && fileName) {\n    generatePDF(html, fileName);\n  }\n};\n\nexport const generateComponentAsPDF = options =>\n  new Promise((resolve, reject) => handler(options, { resolve, reject }));\n","import IntlMessageFormat from 'intl-messageformat';\nimport { getUserLocale, getFormats } from 'core/utils/localization';\nimport messagesFR from 'core/lang/fr.json';\n\n/**\n * formatMessage - A server-side method to use the intl package\n *\n * @param {type}   id          the id of the message\n * @param {object} [values={}] any additional values you want to use in the\n * string\n *\n * @return {type} The formatted string\n */\nconst formatMessage = (id, values = {}, customFallback) => {\n  if (id === undefined) {\n    throw new Error('an id is required in formatMessage');\n  }\n  const message = new IntlMessageFormat(\n    messagesFR[id] || (customFallback !== undefined ? customFallback : id),\n    getUserLocale(),\n    // getFormats(),\n  );\n  return message.format(values);\n};\n\nexport default formatMessage;\n","import Loadable from 'react-loadable';\nimport { LoadingComponent } from 'core/components/Loading';\n\nexport default function MyLoadable(options) {\n  return Loadable({\n    loading: LoadingComponent,\n    delay: 200, // Hides the loading component for 200ms, to avoid flickering\n    ...options,\n  });\n}\n","import moment from 'moment';\n\nimport constants from '../config/constants';\nimport { USAGE_TYPE, LOAN_STRATEGY_PRESET, OFFER_TYPE } from '../api/constants';\nimport { getIncomeRatio } from './finance-math';\nimport { propertyPercent, filesPercent } from '../arrays/steps';\nimport { loanFiles, propertyFiles } from '../api/files/files';\n\nexport const getProjectValue = ({ loan, property }) => {\n  if (!property || !property.value) {\n    return 0;\n  } else if (property.value <= 0) {\n    return 0;\n  }\n\n  let value =\n    property.value * (1 + constants.notaryFees) +\n    (loan.general.propertyWork || 0);\n\n  if (loan.general.usageType === USAGE_TYPE.PRIMARY) {\n    value += (loan.general.insuranceFortuneUsed || 0) * constants.lppFees;\n  }\n\n  return Math.max(0, Math.round(value));\n};\n\nexport const getLoanValue = ({ loan, property }, roundedTo10000) => {\n  if (!loan || !loan.general) {\n    return 0;\n  }\n\n  let value =\n    getProjectValue({ loan, property }) - (loan.general.fortuneUsed || 0);\n\n  if (loan.general.usageType === USAGE_TYPE.PRIMARY) {\n    value -= loan.general.insuranceFortuneUsed || 0;\n  }\n\n  // Do this when picking tranches\n  if (roundedTo10000) {\n    value = Math.round(value / 10000) * 10000;\n  }\n\n  // Check negative values\n  return Math.max(0, Math.round(value));\n};\n\nexport const loanStrategySuccess = (loanTranches = [], loanValue) => {\n  if (!Number.isInteger(loanValue)) {\n    throw new Error('loanValue must be an integer');\n  }\n  if (loanTranches.length < 1) {\n    return false;\n  }\n\n  // User has to choose a preset\n  const trancheSum = loanTranches.reduce(\n    (tot, tranche) => tranche.value + tot,\n    0,\n  );\n  if (trancheSum === loanValue) {\n    // If the sum of all tranches is equal to the loan, success!\n    return true;\n  }\n\n  return false;\n};\n\nexport const strategiesChosen = ({ loan, property }) =>\n  loanStrategySuccess(\n    loan.general.loanTranches,\n    getLoanValue({ loan, property }),\n  ) &&\n  loan.logic.amortizationStrategyPreset &&\n  loan.logic.hasValidatedCashStrategy;\n\n/**\n * getInterestsWithOffer - Get the aggregate monthly interest rate for a\n * loan and an offer\n *\n * @param {type}    loan              Description\n * @param {type}    offer                    Description\n * @param {boolean} [withCounterparts=false] Description\n *\n * @return {Number} min 0\n */\nexport const getInterestsWithOffer = ({ loan, offer }, isStandard = true) => {\n  if (!offer) {\n    return 0;\n  }\n\n  const tranches = loan.general.loanTranches;\n  const interestRates = isStandard\n    ? offer.standardOffer\n    : offer.counterpartOffer;\n\n  let interests = 0;\n  tranches.every((tranche) => {\n    const rate = interestRates[tranche.type];\n\n    // If the lender doesn't have this interest rate, return false\n    if (!rate) {\n      interests = -1;\n      // break loop\n      return false;\n    }\n\n    interests += tranche.value * rate;\n    return true;\n  });\n\n  return interests >= 0 ? Math.round(interests / 12) : interests;\n};\n\nexport const getMonthlyWithOffer = (\n  { loan, property, offer },\n  isStandard = true,\n  fortuneUsed = 0,\n  insuranceFortuneUsed = 0,\n) => {\n  // Return undefined if the counterpartOffer doesn't exist\n  if (!isStandard && !offer.counterpartOffer) {\n    return undefined;\n  }\n\n  // Make a copy of the loan\n  const r = {\n    ...loan,\n    general: {\n      ...loan.general,\n      fortuneUsed: fortuneUsed || loan.general.fortuneUsed,\n      insuranceFortuneUsed:\n        insuranceFortuneUsed || loan.general.insuranceFortuneUsed,\n    },\n  };\n\n  // Modify it to include additional parameters\n  // r.general.fortuneUsed = fortuneUsed || r.general.fortuneUsed;\n  // r.general.insuranceFortuneUsed =\n  //   insuranceFortuneUsed || r.general.insuranceFortuneUsed;\n  const loanValue = getLoanValue({ loan: r, property });\n\n  const maintenance =\n    constants.maintenanceReal *\n    (property.value + (r.general.propertyWork || 0));\n\n  let amortization = isStandard\n    ? offer.standardOffer.amortization\n    : offer.counterpartOffer.amortization;\n  amortization = amortization || constants.amortization;\n\n  const interests = getInterestsWithOffer({ loan: r, offer }, isStandard);\n\n  return interests >= 0\n    ? Math.round((maintenance + loanValue * amortization + interests) / 12) || 0\n    : 0;\n};\n\nexport const getMonthlyWithExtractedOffer = ({ loan, offer, property }) =>\n  getMonthlyWithOffer(\n    {\n      loan,\n      property,\n      offer: {\n        [offer.type === OFFER_TYPE.STANDARD\n          ? 'standardOffer'\n          : 'counterpartOffer']: offer,\n      },\n    },\n    offer.type === OFFER_TYPE.STANDARD,\n  );\n\nexport const getPropAndWork = ({ loan, property }) =>\n  (property &&\n    property.value +\n      ((loan && loan.general && loan.general.propertyWork) || 0)) ||\n  0;\n\nexport const getTotalUsed = ({ loan }) =>\n  Math.round(loan.general.fortuneUsed + (loan.general.insuranceFortuneUsed || 0));\n\nexport const getBorrowRatio = ({ loan, property }) => {\n  const loanValue = getLoanValue({ loan, property });\n  const propAndWork = getPropAndWork({ loan, property });\n\n  return loanValue / propAndWork;\n};\n\nexport const getLenderCount = ({ loan, borrowers, property }) => {\n  const incomeRatio = getIncomeRatio({ loan, borrowers, property });\n  const borrowRatio = getBorrowRatio({ loan, property });\n  if (incomeRatio > 0.38) {\n    return 0;\n  } else if (incomeRatio > 1 / 3) {\n    return 4;\n  } else if (borrowRatio <= 0.65) {\n    return 20;\n  } else if (borrowRatio > 0.65 && borrowRatio <= 0.9) {\n    return 10;\n  }\n\n  return 0;\n};\n\nexport const disableForms = ({ loan }) =>\n  !!(\n    loan.logic &&\n    (loan.logic.step > 1 ||\n      (loan.logic.verification &&\n        (loan.logic.verification.requested ||\n          loan.logic.verification.validated !== undefined)))\n  );\n\nexport const getFees = ({ loan, property }) => {\n  const notaryFees = property.value * constants.notaryFees;\n  let insuranceFees = 0;\n\n  if (loan.general.usageType === USAGE_TYPE.PRIMARY) {\n    insuranceFees = loan.general.insuranceFortuneUsed * constants.lppFees;\n  }\n\n  return notaryFees + (insuranceFees || 0);\n};\n\nexport const isLoanValid = ({ loan, borrowers, property }) => {\n  const incomeRatio = getIncomeRatio({ loan, borrowers, property });\n  const borrowRatio = getBorrowRatio({ loan, borrowers, property });\n  const fees = getFees({ loan, property });\n  const propAndWork = getPropAndWork({ loan, property });\n\n  const cashRequired = constants.minCash * propAndWork + fees;\n\n  if (incomeRatio > 0.38) {\n    throw new Error('income');\n  } else if (loan.general.fortuneUsed < cashRequired) {\n    throw new Error('cash');\n  } else if (borrowRatio > 0.8) {\n    throw new Error('ownFunds');\n  }\n\n  return true;\n};\n\nexport const getPropertyCompletion = ({ loan, borrowers, property }) => {\n  const formsProgress = propertyPercent(loan, borrowers, property);\n  const filesProgress = filesPercent(property, propertyFiles, 'auction');\n\n  return (formsProgress + filesProgress) / 2;\n};\nexport const validateRatios = (\n  incomeRatio,\n  borrowRatio,\n  allowInsurance = true,\n  borrowRatioWanted,\n) => {\n  // To prevent rounding errors\n  const incomeRatioSafe = incomeRatio - 0.001;\n  const borrowRatioSafe = borrowRatio - 0.001;\n\n  if (borrowRatioWanted && borrowRatioWanted !== 0.8) {\n    if (borrowRatioSafe > borrowRatioWanted) {\n      throw new Error('fortune');\n    }\n  }\n\n  if (incomeRatioSafe > 0.38) {\n    throw new Error('income');\n  } else if (!allowInsurance && borrowRatioSafe > 0.8) {\n    throw new Error('fortune');\n  } else if (borrowRatioSafe > 0.9) {\n    throw new Error('fortune');\n  } else if (incomeRatioSafe > 1 / 3) {\n    throw new Error('incomeTight');\n  } else if (borrowRatioSafe > 0.8) {\n    throw new Error('fortuneTight');\n  }\n\n  return true;\n};\n\nexport const validateRatiosCompletely = (\n  incomeRatio,\n  borrowRatio,\n  allowInsurance = true,\n  borrowRatioWanted = 0.9,\n) => {\n  try {\n    validateRatios(incomeRatio, borrowRatio, borrowRatioWanted, allowInsurance);\n    return {\n      isValid: true,\n      message: 'valid',\n      message2: '',\n      icon: 'check',\n      className: 'success',\n    };\n  } catch (error) {\n    const isTight = error.message.indexOf('Tight') >= 0;\n    return {\n      isValid: false,\n      message: `${error.message}`,\n      message2: `${error.message}2`,\n      icon: isTight ? 'warning' : 'close',\n      className: isTight ? 'warning' : 'error',\n    };\n  }\n};\n\n// Returns the maintenance to pay every month, i.e. 1% of the property divided by 12 months\nexport const getMaintenance = ({ property }) => property.value * 0.01 / 12;\n\nexport const strategyDone = ({ loan, property }) => {\n  const { general, logic } = loan;\n  if (general.insuranceFortuneUsed > 0 && !logic.insuranceUsePreset) {\n    return false;\n  }\n\n  if (!logic.amortizationStrategyPreset) {\n    return false;\n  }\n\n  if (!logic.loanStrategyPreset) {\n    return false;\n  }\n\n  if (\n    logic.loanStrategyPreset === LOAN_STRATEGY_PRESET.MANUAL &&\n    !loanStrategySuccess(\n      general.loanTranches,\n      getLoanValue({ loan, property }, true),\n    )\n  ) {\n    return false;\n  }\n\n  return true;\n};\n\n// Gives the end time of an auction, given the start time\nexport const getAuctionEndTime = (startTime) => {\n  const time = moment(startTime);\n\n  if (time.isoWeekday() === 6) {\n    // On saturdays, go to Tuesday\n    time.add(3, 'd');\n  } else if (time.isoWeekday() === 7) {\n    // On saturdays, go to Tuesday\n    time.add(2, 'd');\n  } else if (time.hour() >= 0 && time.hour() < 7) {\n    // If the start time is between midnight and 7:00,\n    // set endtime to be tomorrow night\n    time.add(1, 'd');\n  } else {\n    // Else, set endtime in 2 days from now\n    time.add(2, 'd');\n  }\n\n  // Skip weekends\n  if (time.isoWeekday() === 6 || time.isoWeekday() === 7) {\n    // Saturday or Sunday\n    time.add(2, 'd');\n  }\n\n  // Auctions always end at midnight\n  time.hours(23);\n  time.minutes(59);\n  time.seconds(59);\n  time.milliseconds(0);\n\n  return time.toDate();\n};\n","// This file is shared between client and server to allow server-side tests to have access to it\n\nimport { addLocaleData } from 'react-intl';\nimport { T9n } from 'meteor/softwarerero:accounts-t9n';\nimport moment from 'moment';\nimport Loadable from 'core/utils/loadable';\nimport fr from 'react-intl/locale-data/fr';\n\nexport const getUserLocale = () => 'fr-CH';\n\nexport const getFormats = () => ({\n  number: {\n    money: {\n      style: 'currency',\n      currency: 'CHF',\n      maximumFractionDigits: 0,\n      minimumFractionDigits: 0,\n    },\n    moneyWithoutCurrency: {\n      style: 'decimal',\n      useGrouping: true,\n      maximumFractionDigits: 0,\n      minimumFractionDigits: 0,\n    },\n    percentage: {\n      style: 'percent',\n      minimumFractionDigits: 2,\n      maximumFractionDigits: 2,\n    },\n    percentageRounded: {\n      style: 'percent',\n      minimumFractionDigits: 0,\n      maximumFractionDigits: 0,\n    },\n  },\n});\n\nexport const localizationStartup = () => {\n  // Add locales used in app here\n  addLocaleData(fr);\n  T9n.setLanguage('fr');\n  setupMoment();\n  moment.locale('fr');\n};\n\nconst setupMoment = () => {\n  moment.locale('fr', {\n    months: 'Janvier_Février_Mars_Avril_Mai_Juin_Juillet_Août_Septembre_Octobre_Novembre_Décembre'.split('_'),\n    monthsShort: 'Janv._Févr._Mars_Avr._Mai_Juin_Juil._Août_Sept._Oct._Nov._Déc.'.split('_'),\n    monthsParseExact: true,\n    weekdays: 'Dimanche_Lundi_Mardi_Mercredi_Jeudi_Vendredi_Samedi'.split('_'),\n    weekdaysShort: 'Dim._Lun._Mar._Mer._Jeu._Ven._Sam.'.split('_'),\n    weekdaysMin: 'Di_Lu_Ma_Me_Je_Ve_Sa'.split('_'),\n    weekdaysParseExact: true,\n    longDateFormat: {\n      LT: 'HH:mm',\n      LTS: 'HH:mm:ss',\n      L: 'DD/MM/YYYY',\n      LL: 'D MMMM YYYY',\n      LLL: 'D MMMM YYYY HH:mm',\n      LLLL: 'dddd D MMMM YYYY HH:mm',\n    },\n    calendar: {\n      sameDay: '[Aujourd’hui à] LT',\n      nextDay: '[Demain à] LT',\n      nextWeek: 'dddd [à] LT',\n      lastDay: '[Hier à] LT',\n      lastWeek: 'dddd [dernier à] LT',\n      sameElse: 'L',\n    },\n    relativeTime: {\n      future: 'dans %s',\n      past: 'il y a %s',\n      s: 'quelques secondes',\n      m: 'une minute',\n      mm: '%d minutes',\n      h: 'une heure',\n      hh: '%d heures',\n      d: 'un jour',\n      dd: '%d jours',\n      M: 'un mois',\n      MM: '%d mois',\n      y: 'un an',\n      yy: '%d ans',\n    },\n    dayOfMonthOrdinalParse: /\\d{1,2}(er|e)/,\n    ordinal(number) {\n      return number + (number === 1 ? 'er' : 'e');\n    },\n    meridiemParse: /PD|MD/,\n    isPM(input) {\n      return input.charAt(0) === 'M';\n    },\n    // In case the meridiem units are not separated around 12, then implement\n    // this function (look at locale/id.js for an example).\n    // meridiemHour : function (hour, meridiem) {\n    //     return /* 0-23 hour, given meridiem token and hour 1-12 */ ;\n    // },\n    meridiem(hours, minutes, isLower) {\n      return hours < 12 ? 'PD' : 'MD';\n    },\n    week: {\n      dow: 1, // Monday is the first day of the week.\n      doy: 4, // The week that contains Jan 4th is the first week of the year.\n    },\n  });\n};\n","import { Meteor } from 'meteor/meteor';\nimport { DDPRateLimiter } from 'meteor/ddp-rate-limiter';\nimport { _ } from 'meteor/underscore';\n\n// DDPRateLimiter.setErrorMessage(({ timeToReset }) => {\n//   const time = Math.ceil(timeToReset / 1000);\n//   const seconds = time === 1 ? 'second' : 'seconds';\n//   return `Easy on the gas, buddy. Too many loans. Try again in ${time} ${seconds}.`;\n// });\n\nconst fetchMethodNames = methods => _.pluck(methods, 'name');\n\nconst assignLimits = ({ methods, limit = 5, timeRange = 1000 }) => {\n  const methodNames = fetchMethodNames(methods);\n\n  if (Meteor.isServer) {\n    DDPRateLimiter.addRule(\n      {\n        name(name) {\n          return _.contains(methodNames, name);\n        },\n        connectionId() {\n          return true;\n        },\n      },\n      limit,\n      timeRange,\n    );\n  }\n};\n\nexport default function rateLimit(options) {\n  return assignLimits(options);\n}\n","import cleanMethod from 'core/api/cleanMethods';\n\n// The final function that inserts the documents once the form is finished\nconst saveStartForm = (f, userId) => {\n  const multiple = f.borrowerCount > 1;\n  const borrowerOne = {\n    age: f.age,\n    gender: f.gender,\n    salary: f.income1,\n    bonusExists: f.bonusExists,\n    bonus: {\n      bonus2014: f.bonus11,\n      bonus2015: f.bonus21,\n      bonus2016: f.bonus31,\n      bonus2017: f.bonus41,\n    },\n    otherIncome: f.otherIncome || [],\n    expenses: f.expenses || [],\n    realEstate: f.realEstate || [],\n    bankFortune: f.fortune1,\n    insuranceSecondPillar: f.insurance11,\n    insuranceThirdPillar: f.insurance21,\n  };\n  let borrowerTwo = {};\n  if (multiple) {\n    borrowerTwo = {\n      salary: f.income2,\n      bonusExists: f.bonusExists,\n      bonus: {\n        bonus2014: f.bonus12,\n        bonus2015: f.bonus22,\n        bonus2016: f.bonus32,\n        bonus2017: f.bonus42,\n      },\n      bankFortune: f.fortune2,\n      insuranceSecondPillar: f.insurance12,\n      insuranceThirdPillar: f.insurance22,\n      sameAddress: true,\n    };\n  }\n\n  const loan = {\n    general: {\n      usageType: f.usageType,\n      purchaseType: f.purchaseType,\n      oldestAge: multiple ? f.oldestAge : f.age,\n      oldestGender: multiple ? f.oldestGender : f.gender,\n      fortuneUsed: f.fortuneUsed,\n      insuranceFortuneUsed: f.insuranceFortuneUsed,\n      propertyWork: f.propertyWork || 0,\n    },\n    // property: {\n    //   usageType: f.usageType,\n    //   value: f.propertyValue,\n    //   propertyWork: f.propertyWork || 0,\n    //   investmentRent: f.propertyRent,\n    // },\n    borrowerIds: [],\n  };\n\n  const property = {\n    value: f.propertyValue,\n    investmentRent: f.propertyRent,\n  };\n\n  return (\n    cleanMethod('insertBorrower', { object: borrowerOne, userId })\n      .then(id1 => loan.borrowerIds.push(id1))\n      .then(() =>\n        !!multiple &&\n          cleanMethod('insertBorrower', {\n            object: borrowerTwo,\n            userId,\n          }))\n      .then(id2 => !!id2 && loan.borrowerIds.push(id2))\n      .then(() => cleanMethod('insertProperty', { object: property, userId }))\n      .then((propertyId) => {\n        loan.propertyId = propertyId;\n        return cleanMethod('insertLoan', { object: loan, userId });\n      })\n      // If no userId is provided, return the loanId\n      .then(loanId => userId || loanId)\n      .catch((error) => {\n        console.warn(error);\n        throw error;\n      })\n  );\n};\n\nexport default saveStartForm;\n","import { constants } from 'core/api';\n\nexport const getBorrowerInfoArray = ({ borrowers, borrowerId: id }) => {\n  const b = borrowers.find(borrower => borrower._id === id);\n  const multiple = borrowers.length > 1;\n  // If this is the first borrower in the array of borrowers, don't ask for same address\n  const isFirst = borrowers[0]._id === id;\n\n  if (!b) {\n    throw new Error(\"couldn't find borrower\");\n  }\n\n  const disableAddress = !!b.sameAddress && !isFirst;\n\n  return [\n    { id: 'firstName', type: 'textInput' },\n    { id: 'lastName', type: 'textInput' },\n    {\n      id: 'gender',\n      type: 'radioInput',\n      options: Object.values(constants.GENDER),\n    },\n    {\n      type: 'h3',\n      id: 'yourAddress',\n      ignore: true,\n      required: false,\n    },\n    {\n      id: 'sameAddress',\n      type: 'radioInput',\n      intlValues: { name: borrowers[0].firstName || 'Emprunteur 1' },\n      options: [true, false],\n      condition: multiple && !isFirst,\n    },\n    {\n      id: 'address1',\n      type: 'textInput',\n      disabled: disableAddress,\n      placeholder: disableAddress && borrowers[0].address1,\n      noIntl: disableAddress,\n    },\n    {\n      id: 'address2',\n      type: 'textInput',\n      disabled: !!b.sameAddress && !isFirst,\n      required: false,\n      placeholder: disableAddress && borrowers[0].address2,\n      noIntl: disableAddress,\n    },\n    {\n      id: 'zipCode',\n      type: 'custom',\n      component: 'ZipAutoComplete',\n      componentProps: {\n        savePath: '',\n        initialValue: b.zipCode && b.city ? `${b.zipCode} ${b.city}` : '',\n      },\n      disabled: !!b.sameAddress && !isFirst,\n      placeholder:\n        disableAddress &&\n        (borrowers[0].zipCode && borrowers[0].city\n          ? `${borrowers[0].zipCode} ${borrowers[0].city}`\n          : ''),\n      noIntl: disableAddress,\n    },\n    {\n      type: 'conditionalInput',\n      conditionalTrueValue: false,\n      inputs: [\n        {\n          id: 'isSwiss',\n          type: 'radioInput',\n          options: [true, false],\n        },\n        {\n          id: 'residencyPermit',\n          type: 'selectFieldInput',\n          options: Object.values(constants.RESIDENCY_PERMIT),\n        },\n      ],\n    },\n    {\n      id: 'age',\n      type: 'textInput',\n      number: true,\n      saveOnChange: false,\n    },\n    { id: 'birthPlace', type: 'textInput', condition: !!b.isSwiss },\n    { id: 'citizenship', type: 'textInput', condition: !b.isSwiss },\n    { id: 'isUSPerson', type: 'radioInput', options: [true, false] },\n    {\n      id: 'civilStatus',\n      type: 'radioInput',\n      options: Object.values(constants.CIVIL_STATUS).map(value => ({\n        id: value,\n        intlValues: { gender: b.gender },\n      })),\n    },\n    { id: 'childrenCount', type: 'textInput', number: true },\n    {\n      id: 'company',\n      type: 'textInput',\n      required: false,\n      autoComplete: 'organization',\n    },\n    {\n      id: 'worksForOwnCompany',\n      type: 'radioInput',\n      options: [true, false],\n    },\n    { id: 'personalBank', type: 'textInput' },\n  ];\n};\n\nexport const getBorrowerFinanceArray = ({\n  borrowers,\n  borrowerId: id,\n  loan,\n}) => {\n  const b = borrowers.find(borr => borr._id === id);\n  const multiple = borrowers.length > 1;\n  // If this is the first borrower in the array of borrowers, don't ask for same address\n  const isFirst = borrowers[0]._id === id;\n\n  if (!b) {\n    throw new Error(\"couldn't find borrower\");\n  }\n\n  const incomeArray = [\n    {\n      type: 'h3',\n      id: 'incomeAndExpenses',\n      ignore: true,\n      required: false,\n    },\n    { id: 'salary', type: 'textInput', money: true },\n    {\n      type: 'conditionalInput',\n      conditionalTrueValue: true,\n      inputs: [\n        {\n          id: 'bonusExists',\n          type: 'radioInput',\n          options: [true, false],\n        },\n        ...[2017, 2016, 2015, 2014].map(year => ({\n          id: `bonus.bonus${year}`,\n          type: 'textInput',\n          money: true,\n        })),\n      ],\n    },\n    {\n      id: 'expenses',\n      type: 'arrayInput',\n      required: false,\n      inputs: [\n        {\n          id: 'description',\n          type: 'selectInput',\n          options: Object.values(constants.EXPENSES),\n        },\n        { id: 'value', type: 'textInput', money: true },\n      ],\n    },\n    {\n      id: 'otherIncome',\n      type: 'arrayInput',\n      required: false,\n      inputs: [\n        {\n          id: 'description',\n          type: 'selectInput',\n          options: Object.values(constants.OTHER_INCOME),\n        },\n        { id: 'value', type: 'textInput', money: true },\n      ],\n    },\n  ];\n\n  const fortuneArray = [\n    {\n      type: 'h3',\n      id: 'fortune',\n      ignore: true,\n      required: false,\n    },\n    {\n      id: 'bankFortune',\n      type: 'textInput',\n      money: true,\n    },\n    {\n      id: 'realEstate',\n      type: 'arrayInput',\n      inputs: [\n        {\n          id: 'description',\n          type: 'selectInput',\n          options: Object.values(constants.REAL_ESTATE),\n        },\n        {\n          id: 'value',\n          type: 'textInput',\n          money: true,\n        },\n        {\n          id: 'loan',\n          type: 'textInput',\n          money: true,\n        },\n      ],\n    },\n    {\n      id: 'otherFortune',\n      type: 'arrayInput',\n      required: false,\n      inputs: [\n        {\n          id: 'description',\n          type: 'selectInput',\n          options: Object.values(constants.OTHER_FORTUNE),\n        },\n        {\n          id: 'value',\n          type: 'textInput',\n          money: true,\n        },\n      ],\n    },\n  ];\n\n  const insuranceArray = [\n    {\n      type: 'h3',\n      id: 'insurance',\n      required: false,\n      ignore: true,\n    },\n    {\n      id: 'insuranceSecondPillar',\n      type: 'textInput',\n      money: true,\n      required: false,\n    },\n    {\n      id: 'insuranceThirdPillar',\n      type: 'textInput',\n      money: true,\n      required: false,\n    },\n    {\n      id: 'insurance3B',\n      type: 'textInput',\n      money: true,\n      required: false,\n    },\n    {\n      id: 'insurancePureRisk',\n      type: 'textInput',\n      money: true,\n      required: false,\n    },\n  ];\n\n  return incomeArray.concat([...fortuneArray, ...insuranceArray]);\n};\n","import {\n  PROPERTY_STYLE,\n  PURCHASE_TYPE,\n  OWNER,\n  USAGE_TYPE,\n  EXPERTISE_RATING,\n} from 'core/api/constants';\n\nconst mapInput = (input) => {\n  const intlSafeObject = { ...input };\n  // If the id contains a dot in it, split it and add a intlId\n  // This makes it easier to write intl messages\n  if (input.id && input.id.indexOf('.') > 0) {\n    // Perform some additional slicing to make sure ids with multiple dots\n    // work by removing only the first part\n    intlSafeObject.intlId = input.id\n      .split('.')\n      .slice(1)\n      .join('.');\n  }\n\n  if (input.inputs) {\n    // If there are nested inputs, give them an intlId too\n    intlSafeObject.inputs = input.inputs.map(obj =>\n      (obj.id && obj.id.indexOf('.') > 0\n        ? { ...obj, intlId: obj.id.split('.')[1] }\n        : obj));\n  }\n\n  return intlSafeObject;\n};\n\nexport const getPropertyLoanArray = ({ loan, borrowers }) => {\n  const r = loan;\n\n  if (!r) {\n    throw new Error('requires a loan');\n  }\n\n  const array = [\n    {\n      type: 'h3',\n      id: 'propertyInfo',\n      ignore: true,\n      required: false,\n    },\n    {\n      id: 'general.usageType',\n      type: 'radioInput',\n      options: Object.values(USAGE_TYPE),\n    },\n    {\n      id: 'general.propertyWork',\n      type: 'textInput',\n      money: true,\n      required: false,\n    },\n    {\n      type: 'conditionalInput',\n      conditionalTrueValue: OWNER.OTHER,\n      condition:\n        borrowers.length > 1 &&\n        r.general.purchaseType === PURCHASE_TYPE.REFINANCING,\n      inputs: [\n        {\n          id: 'general.currentOwner',\n          type: 'radioInput',\n          options: Object.values(OWNER)\n            .filter(value => (borrowers.length === 1 ? value !== OWNER.SECOND : true))\n            .map((value) => {\n              const isFirst = value === OWNER.FIRST;\n              const isSecond = value === OWNER.SECOND;\n              return isFirst || isSecond\n                ? {\n                  id: isFirst ? 0 : 1,\n                  intlValues: {\n                    name:\n                        borrowers[isFirst ? 0 : 1].firstName ||\n                        `Emprunteur ${isFirst ? 1 : 2}`,\n                  },\n                }\n                : value;\n            }),\n        },\n        { id: 'general.otherOwner', type: 'textInput' },\n      ],\n    },\n    {\n      type: 'conditionalInput',\n      conditionalTrueValue: OWNER.OTHER,\n      condition:\n        borrowers.length > 1 &&\n        r.general.purchaseType !== PURCHASE_TYPE.REFINANCING,\n      inputs: [\n        {\n          id: 'general.futureOwner',\n          type: 'radioInput',\n          options: Object.values(OWNER)\n            .filter(value => (borrowers.length === 1 ? value !== OWNER.SECOND : true))\n            .map((value) => {\n              const isFirst = value === OWNER.FIRST;\n              const isSecond = value === OWNER.SECOND;\n              return isFirst || isSecond\n                ? {\n                  id: isFirst ? 0 : 1,\n                  intlValues: {\n                    name:\n                        borrowers[isFirst ? 0 : 1].firstName ||\n                        `Emprunteur ${isFirst ? 1 : 2}`,\n                  },\n                }\n                : value;\n            }),\n        },\n        {\n          id: 'general.otherOwner',\n          type: 'textInput',\n        },\n      ],\n    },\n  ];\n\n  return array.map(mapInput);\n};\n\nexport const getPropertyArray = ({ loan, borrowers, property }) => {\n  const r = loan;\n\n  if (!r) {\n    throw new Error('requires a loan');\n  }\n\n  const array = [\n    { id: 'value', type: 'textInput', money: true },\n    {\n      id: 'style',\n      type: 'radioInput',\n      options: Object.values(PROPERTY_STYLE),\n    },\n    {\n      id: 'isNew',\n      type: 'radioInput',\n      options: [true, false],\n      condition: r.general.purchaseType === PURCHASE_TYPE.ACQUISITION,\n    },\n    {\n      type: 'h3',\n      id: 'propertyAddress',\n      ignore: true,\n      required: false,\n    },\n    {\n      id: 'address1',\n      type: 'textInput',\n    },\n    {\n      id: 'address2',\n      type: 'textInput',\n      required: false,\n    },\n    {\n      id: 'zipCode',\n      type: 'custom',\n      component: 'ZipAutoComplete',\n      componentProps: {\n        savePath: '',\n        initialValue:\n          property.zipCode && property.city\n            ? `${property.zipCode} ${property.city}`\n            : '',\n      },\n    },\n    {\n      type: 'h3',\n      id: 'propertyDetails',\n      ignore: true,\n      required: false,\n    },\n    { id: 'constructionYear', type: 'textInput', number: true },\n    {\n      id: 'renovationYear',\n      type: 'textInput',\n      number: true,\n      required: false,\n      info: true,\n    },\n    {\n      id: 'landArea',\n      type: 'textInput',\n      number: true,\n      condition: property.style === PROPERTY_STYLE.VILLA,\n    },\n    { id: 'insideArea', type: 'textInput', number: true },\n    {\n      id: 'balconyArea',\n      type: 'textInput',\n      number: true,\n      required: false,\n    },\n    {\n      id: 'terraceArea',\n      type: 'textInput',\n      number: true,\n      required: false,\n    },\n    {\n      id: 'volume',\n      type: 'textInput',\n      number: true,\n      condition: property.style === PROPERTY_STYLE.VILLA,\n    },\n    {\n      id: 'volumeNorm',\n      type: 'textInput',\n      condition: property.style === PROPERTY_STYLE.VILLA,\n    },\n    {\n      id: 'roomCount',\n      type: 'textInput',\n      decimal: true,\n      info: true,\n    },\n    {\n      id: 'bathroomCount',\n      type: 'textInput',\n      number: true,\n      info: true,\n    },\n    { id: 'toiletCount', type: 'textInput', number: true },\n    { id: 'parking.box', type: 'textInput', number: true },\n    { id: 'parking.inside', type: 'textInput', number: true },\n    { id: 'parking.outside', type: 'textInput', number: true },\n    { id: 'minergie', type: 'radioInput', options: [true, false] },\n    {\n      type: 'conditionalInput',\n      conditionalTrueValue: true,\n      condition: property.style === PROPERTY_STYLE.VILLA,\n      inputs: [\n        {\n          id: 'isCoproperty',\n          type: 'radioInput',\n          options: [true, false],\n        },\n        {\n          id: 'copropertyPercentage',\n          type: 'textInput',\n          number: true,\n          info: true,\n        },\n      ],\n    },\n    {\n      id: 'copropertyPercentage',\n      type: 'textInput',\n      number: true,\n      condition: property.style === PROPERTY_STYLE.FLAT,\n      info: true,\n    },\n    {\n      type: 'h3',\n      id: 'propertyQuality',\n      ignore: true,\n      required: false,\n    },\n    {\n      id: 'cityPlacementQuality',\n      type: 'radioInput',\n      options: Object.values(EXPERTISE_RATING),\n    },\n    {\n      id: 'buildingPlacementQuality',\n      type: 'radioInput',\n      options: Object.values(EXPERTISE_RATING),\n      condition: property.style === PROPERTY_STYLE.FLAT,\n    },\n    {\n      id: 'buildingQuality',\n      type: 'radioInput',\n      options: Object.values(EXPERTISE_RATING),\n    },\n    {\n      id: 'flatQuality',\n      type: 'radioInput',\n      options: Object.values(EXPERTISE_RATING),\n      condition: property.style === PROPERTY_STYLE.FLAT,\n    },\n    {\n      id: 'materialsQuality',\n      type: 'radioInput',\n      options: Object.values(EXPERTISE_RATING),\n    },\n    {\n      id: 'otherNotes',\n      type: 'textInput',\n      multiline: true,\n      rows: 3,\n      required: false,\n    },\n  ];\n\n  return array.map(mapInput);\n};\n","import React from 'react';\nimport get from 'lodash/get';\nimport isArray from 'lodash/isArray';\n\nimport { getBorrowerInfoArray } from './BorrowerFormArray';\nimport { borrowerFiles, loanFiles, propertyFiles } from '../api/files/files';\nimport { getPropertyArray, getPropertyLoanArray } from './PropertyFormArray';\nimport { strategyDone, getPropertyCompletion } from 'core/utils/loanFunctions';\nimport { arrayify } from '../utils/general';\nimport { isDemo } from 'core/utils/browserFunctions';\nimport {\n  LOAN_STATUS,\n  AUCTION_STATUS,\n  FILE_STATUS,\n  CLOSING_STEPS_STATUS,\n  CLOSING_STEPS_TYPE,\n} from '../api/constants';\n\nconst getSteps = (props) => {\n  const { loan, borrowers, property, serverTime } = props;\n\n  const steps = [\n    {\n      nb: 0,\n      items: [],\n    },\n\n    {\n      nb: 1,\n      items: [\n        {\n          id: 'personal',\n          link: `/loans/${loan._id}/borrowers/${borrowers[0]._id}/personal`,\n          percent: () => personalInfoPercent(borrowers),\n          isDone() {\n            return this.percent() >= 1;\n          },\n        },\n        {\n          id: 'finance',\n          link: `/loans/${loan._id}/borrowers/${borrowers[0]._id}/finance`,\n\n          isDone: () =>\n            borrowers.reduce(\n              (res, b) => res && b.logic.hasValidatedFinances,\n              true,\n            ),\n          percent: () =>\n            borrowers.reduce(\n              (res, b) => (b.logic.hasValidatedFinances ? res + 1 : res),\n              0,\n            ) / borrowers.length,\n        },\n        {\n          id: 'files',\n          link: `/loans/${loan._id}/borrowers/${borrowers[0]._id}/files`,\n          percent: () => filesPercent(borrowers, borrowerFiles, 'auction'),\n          isDone() {\n            return this.percent() >= 1;\n          },\n        },\n        {\n          id: 'property',\n          link: `/loans/${loan._id}/property`,\n          percent: () => getPropertyCompletion(props),\n          isDone() {\n            return this.percent() >= 1;\n          },\n        },\n        {\n          id: 'verification',\n          link: `/loans/${loan._id}/verification`,\n          waiting: () =>\n            loan.logic.verification.requested &&\n            !loan.logic.verification.validated,\n          isDone: () => loan.logic.verification.validated === true,\n        },\n      ],\n    },\n\n    {\n      nb: 2,\n      items: [\n        {\n          id: 'structure',\n          link: `/loans/${loan._id}/structure`,\n          isDone: () => loan.logic.hasValidatedStructure,\n          disabled: loan.logic.step < 2,\n        },\n        {\n          id: 'auction',\n          link: `/loans/${loan._id}/auction`,\n          waiting: () => loan.logic.auction.status === AUCTION_STATUS.STARTED,\n          isDone: () => loan.logic.auction.status === AUCTION_STATUS.ENDED,\n          disabled: loan.logic.step < 2,\n        },\n        {\n          id: 'strategy',\n          link: `/loans/${loan._id}/strategy`,\n          isDone: () => strategyDone({ loan }),\n        },\n        {\n          id: 'offerPicker',\n          link: `/loans/${loan._id}/offerpicker`,\n          isDone: () => !!(loan.logic.lender && loan.logic.lender.offerId),\n        },\n      ],\n    },\n\n    {\n      nb: 3,\n      items: [\n        {\n          id: 'contract',\n          link: `/loans/${loan._id}/contract`,\n          disabled:\n            loan.logic.step < 3 &&\n            !(loan.logic.lender && loan.logic.lender.offerId),\n          percent: () =>\n            getAllFilesPercent({ loan, borrowers, property }, 'contract'),\n          waiting: () =>\n            loan.logic.lender.contractRequested && !loan.logic.lender.contract,\n          isDone() {\n            return loan.files.contract && loan.files.contract.length;\n          },\n        },\n        {\n          id: 'closing',\n          link: `/loans/${loan._id}/closing`,\n          // FIXME: true && value used because of weird linting...\n          disabled:\n            (true &&\n              getAllFilesPercent({ loan, borrowers, property }, 'contract')) <\n              1 || loan.logic.step < 3,\n          percent: () => closingPercent(loan),\n          isDone: () => loan.status === LOAN_STATUS.DONE,\n        },\n      ],\n    },\n\n    {\n      nb: 4,\n      title: (\n        <span\n          className=\"fa fa-home fa-2x\"\n          style={{ color: '#ADB5BD', paddingLeft: 8 }}\n        />\n      ),\n      disabled: true, // TODO\n      subtitle: null,\n      items: [],\n    },\n  ];\n\n  // Make sure these indices correspond\n  // Verify all 3 items before item 4 are done\n  steps[1].items[4].disabled = !previousDone(steps, 1, 4); // Vérification e-Potek\n  // steps[0].items[6].disabled = !previousDone(steps, 0, 6); // Expertise\n\n  steps[2].items[1].disabled = !previousDone(steps, 2, 1); // Enchères\n  steps[2].items[2].disabled = !previousDone(steps, 2, 2); // Stratégie\n  steps[2].items[3].disabled = !previousDone(steps, 2, 3); // Choix du prêteur\n\n  return steps;\n};\n\nexport default getSteps;\n\n// Returns the current value of an autoForm input\nconst getCurrentValue = (input, doc) => get(doc, input.id);\n\n/**\n * previousDone - Checks if all previous subSteps have been finished upto this\n * item\n *\n * @param {array} steps  An array of subSteps/items\n * @param {number} stepNb The step Number\n * @param {number} itemNb The number of the item that is concerned\n *\n * @return {boolean} Description\n */\nexport const previousDone = (steps, stepNb, itemNb) => {\n  if (stepNb >= steps.length) {\n    throw new Error('invalid stepNb');\n  } else if (itemNb >= steps[stepNb].items.length) {\n    throw new Error('invalid itemNb');\n  }\n\n  return steps[stepNb].items\n    .slice(0, itemNb)\n    .reduce((res, i) => res && i.isDone(), true);\n};\n\n/**\n * getPercent - Given an array of values, any value that is undefined or null\n * will be counted as incomplete, make sure we don't divide by 0\n *\n * @param {array} array Array of numbers, strings, or dates\n *\n * @return {number} a value between 0 and 1\n */\nexport const getPercent = (array = []) => {\n  const percent =\n    array.reduce((tot, val) => {\n      if (isArray(val)) {\n        return tot + (val.length ? 1 : 0);\n      } else if (val !== undefined && val !== null) {\n        return tot + 1;\n      }\n      return tot;\n    }, 0) / array.length;\n  return isFinite(percent) ? percent : 0;\n};\n\n/**\n * shouldCountField - A boolean to determine if a field in an array\n * should be counted or not\n *\n * @param {object} f A formArray field object\n *\n * @return {boolean} Description\n */\nexport const shouldCountField = f =>\n  (f.condition === undefined || f.condition === true) &&\n  f.required !== false &&\n  !f.disabled &&\n  f.type !== 'h3';\n\n/**\n * getCountedArray - Returns an array of values that are mandatory and should\n * be counted to determine a completion percentage of a form\n *\n * @param {array}  formArray Description\n * @param {object}  doc       Description\n * @param {array} [arr=[]]  Description\n *\n * @return {array} an array with all the currentValues that are mandatory\n */\nexport const getCountedArray = (formArray, doc, arr = []) => {\n  formArray.forEach((i) => {\n    if (shouldCountField(i)) {\n      if (i.type === 'conditionalInput') {\n        if (getCurrentValue(i.inputs[0], doc) === i.conditionalTrueValue) {\n          // If the conditional input is triggering the next input, add all values\n          i.inputs.forEach(input => arr.push(getCurrentValue(input, doc)));\n        } else {\n          // If conditional value is not triggering\n          arr.push(getCurrentValue(i.inputs[0], doc));\n        }\n      } else {\n        arr.push(getCurrentValue(i, doc));\n      }\n    }\n  });\n\n  return arr;\n};\n\n/**\n * personalInfoPercent - Determines the completion rate of the borrower's\n * personal information forms\n *\n * @param {object} borrowers Description\n *\n * @return {number} A value between 0 and 1\n */\nexport const personalInfoPercent = (borrowers) => {\n  const a = [];\n  arrayify(borrowers).forEach((b) => {\n    const formArray = getBorrowerInfoArray({\n      borrowers: arrayify(borrowers),\n      borrowerId: b._id,\n    });\n    getCountedArray(formArray, b, a);\n  });\n\n  return getPercent(a);\n};\n\n/**\n * propertyPercent - Determines the completion rate of the property forms\n *\n * @param {object} loan Description\n * @param {object} borrowers   Description\n *\n * @return {number} A percentage between 0 and 1\n */\nexport const propertyPercent = (loan, borrowers, property) => {\n  const formArray1 = getPropertyArray({ loan, borrowers, property });\n  const formArray2 = getPropertyLoanArray({\n    loan,\n    borrowers,\n    property,\n  });\n\n  let a = getCountedArray(formArray1, property);\n  a = [...a, getCountedArray(formArray2, loan)];\n\n  return getPercent(a);\n};\n\nexport const auctionFilesPercent = (borrowers) => {\n  const a = [];\n  arrayify(borrowers).forEach((b) => {\n    const fileArray = borrowerFiles(b).auction;\n\n    if (isDemo()) {\n      a.push(b.files[fileArray[0].id]);\n    } else {\n      fileArray.forEach(f => f.condition !== false && a.push(b.files[f.id]));\n    }\n  });\n\n  return getPercent(a);\n};\n\n/**\n * filesPercent - Determines the completion rate of file upload for a given\n * step, doc and array of files\n *\n * @param {object} doc           The mongoDB document where files are saved\n * @param {function} fileArrayFunc A function that returns an array of files\n * @param {number} step          The step that determines which files are\n * required at this moment\n *\n * @return {number} a value between 0 and 1 indicating the percentage of\n * completion, 1 is complete, 0 is not started\n */\nexport const filesPercent = (doc, fileArrayFunc, step, checkValidity) => {\n  const a = [];\n  const iterate = (files, doc2) => {\n    if (!doc2 || !doc2.files) {\n      return;\n    }\n\n    if (isDemo()) {\n      a.push(doc2.files[files[0].id]);\n    } else {\n      files.forEach((f) => {\n        if (!(f.required === false || f.condition === false)) {\n          if (checkValidity) {\n            a.push(isArray(doc2.files[f.id]) &&\n              doc2.files[f.id].every(file => file.status === FILE_STATUS.VALID)\n              ? true\n              : undefined);\n          } else {\n            a.push(doc2.files[f.id]);\n          }\n        }\n      });\n    }\n  };\n\n  if (isArray(doc)) {\n    doc.forEach((item) => {\n      const fileArray = fileArrayFunc(item)[step];\n      iterate(fileArray, item);\n    });\n  } else {\n    const fileArray = fileArrayFunc(doc)[step];\n    iterate(fileArray, doc);\n  }\n\n  return getPercent(a);\n};\n\nexport const getAllFilesPercent = ({ loan, borrowers, property }, step) => {\n  const array = [];\n  if (loan) {\n    array.push(filesPercent(loan, loanFiles, step));\n  }\n\n  if (borrowers) {\n    array.push(filesPercent(borrowers, borrowerFiles, step));\n  }\n\n  if (property) {\n    array.push(filesPercent(property, propertyFiles, step));\n  }\n\n  // Sum and divide by amount of them\n  return array.reduce((a, b) => a + b, 0) / array.length;\n};\n\nexport const closingPercent = (loan) => {\n  const { closingSteps } = loan.logic;\n  const arr = [];\n\n  closingSteps.forEach((step) => {\n    if (step.type === CLOSING_STEPS_TYPE.TODO) {\n      arr.push(step.status === CLOSING_STEPS_STATUS.VALID ? true : undefined);\n    } else {\n      arr.push(isArray(loan.files[step.id]) &&\n        loan.files[step.id].every(file => file.status === CLOSING_STEPS_STATUS.VALID)\n        ? true\n        : undefined);\n    }\n  });\n\n  return getPercent(arr);\n};\n","import React from 'react';\n\n// http://codepen.io/TaniaLD/pen/oKxep\nexport const LoadingComponent = () => (\n  // Fade it in so that the loader doesn't show up if loading is super fast\n  <div className=\"loading-container animated fadeIn\">\n    <div className=\"loading-box\">\n      <div className=\"loader2\" />\n    </div>\n  </div>\n);\n\nconst options = {\n  loadingHandler: LoadingComponent,\n};\n\nexport default options;\n","import { USAGE_TYPE } from 'core/api/constants';\n\nconst constants = {\n  cpsLimit: 300, // Average characters typed per second\n  amortization: 0.0125,\n  interests: 0.05,\n  interestsReal: 0.015,\n  maintenance: 0.01,\n  maintenanceReal: 0.005,\n  notaryFees: 0.05,\n  lppFees: 0.1,\n  maxRatio: 0.38,\n  minCash: 0.1,\n  getCurrency: () => 'CHF',\n  loanCost(borrowRatio, toRetirement) {\n    return this.interests + this.getAmortization(borrowRatio, toRetirement);\n  },\n  loanCostReal(borrowRatio, toRetirement, interestRate) {\n    return (\n      (interestRate || this.interestsReal) +\n      this.getAmortization(borrowRatio, toRetirement)\n    );\n  },\n  propertyToIncome(usageType = USAGE_TYPE.PRIMARY, borrowRatio, toRetirement) {\n    return (\n      3 *\n      (this.maintenance +\n        this.maxLoan(usageType, toRetirement) *\n          this.loanCost(borrowRatio, toRetirement))\n    );\n  },\n  propertyToIncomeReal(\n    usageType = USAGE_TYPE.PRIMARY,\n    borrowRatio,\n    toRetirement,\n  ) {\n    return (\n      3 *\n      (this.maintenanceReal +\n        this.maxLoan(usageType, toRetirement) *\n          this.loanCostReal(borrowRatio, toRetirement))\n    );\n  },\n  maxProperty(\n    income,\n    fortune,\n    insuranceFortune = 0,\n    usageType = USAGE_TYPE.PRIMARY,\n    toRetirement = 15,\n  ) {\n    let r = toRetirement;\n    // Make sure toRetirement is capped between 0 and 15 years\n    if (toRetirement < 0) {\n      r = 0;\n    } else if (toRetirement > 15) {\n      r = 15;\n    }\n\n    const fortuneLimited = fortuneLimitedProperty(\n      income,\n      fortune,\n      insuranceFortune,\n      usageType,\n      r,\n    );\n    const incomeLimited = incomeLimitedProperty(\n      income,\n      fortune,\n      insuranceFortune,\n      usageType,\n      r,\n    );\n\n    // Use floor to make sure the ratios are respected and avoid edge cases\n    return Math.round(Math.min(fortuneLimited, incomeLimited));\n  },\n  maxLoan(usageType = USAGE_TYPE.PRIMARY, toRetirement = 15) {\n    if (toRetirement <= 0) {\n      return 0.65;\n    }\n    if (usageType === USAGE_TYPE.SECONDARY) {\n      return 0.7;\n    }\n\n    return 0.8;\n  },\n  getAmortization: (borrowRatio = 0.8, toRetirement = 15) => {\n    if (borrowRatio > 0.65) {\n      const toAmortize = borrowRatio - 0.65;\n      if (toRetirement > 15) {\n        // use parseFloat, to round to 15 decimals, which is the maximal guaranteed precision of floating pt. numbers\n        return Math.max(parseFloat(toAmortize / borrowRatio / 15).toPrecision(15));\n      } else if (toRetirement >= 0) {\n        // use parseFloat, to round to 15 decimals, which is the maximal guaranteed precision of floating pt. numbers\n        return Math.max(parseFloat(toAmortize / borrowRatio / toRetirement).toPrecision(15));\n      }\n      return parseFloat(toAmortize / borrowRatio).toPrecision(15);\n    }\n\n    return 0;\n  },\n};\n\nexport const fortuneLimitedProperty = (\n  income,\n  fortune,\n  insuranceFortune = 0,\n  usageType = USAGE_TYPE.PRIMARY,\n  toRetirement = 15,\n) => {\n  let fortuneLimited = 0;\n\n  if (usageType === USAGE_TYPE.PRIMARY) {\n    // Use insuranceFortune to calculate more complicated value which\n    // includes lppFees\n    fortuneLimited = calculatePrimaryProperty(fortune, insuranceFortune);\n  } else {\n    // Fortune should cover 20% and notary fees\n    fortuneLimited =\n      fortune / (1 - constants.maxLoan(usageType, toRetirement) + 0.05);\n  }\n  return fortuneLimited;\n};\n\nexport const incomeLimitedProperty = (\n  income,\n  fortune,\n  insuranceFortune = 0,\n  usageType = USAGE_TYPE.PRIMARY,\n  toRetirement = 15,\n) => {\n  // The arithmetic relation to have the cost of the loan be at exactly the max ratio of income\n  // Derive it like this:\n  // maxRatio * salary >= property * maintenance + loan * loanCost\n  // loan = (property + notaryFees + lppFees) - totalFortune\n  // Extract property from this relation\n  const totalFortune = fortune + insuranceFortune;\n  const lppFees = insuranceFortune * constants.lppFees;\n  const nF = constants.notaryFees;\n  const i = constants.interests;\n  const mR = constants.maxRatio;\n  const m = constants.maintenance;\n  const r = toRetirement;\n\n  // The first one is with 0 amortization\n  const incomeLimited1 =\n    (mR * income + (totalFortune - lppFees) * i) / (m + (1 + nF) * i);\n\n  // The second is with amortization factored in (and it could be negative due to math)\n  const incomeLimited2 =\n    ((1 + r * i) * (totalFortune - lppFees) + mR * r * income) /\n    (r * (m + i) + nF * (1 + r * i) + 0.35);\n\n  // Therefore, take the minimum value of both, which is the most limiting one\n  // Because of the ratios, round this value down\n  return Math.floor(Math.min(incomeLimited1, incomeLimited2));\n};\n\nexport const calculatePrimaryProperty = (fortune, insuranceFortune) => {\n  if (fortune <= 0 || insuranceFortune < 0) {\n    return 0;\n  }\n\n  const lppFees = insuranceFortune * constants.lppFees;\n  const notaryFees = constants.notaryFees;\n\n  // Make sure cash can pay for lppFees, and fortune can cover notaryfees\n  const totalFortuneLimitedValue =\n    (fortune - lppFees + insuranceFortune) / (0.2 + notaryFees);\n\n  // Make sure cash can pay for lppfees and notaryfees\n  const cashLimitedValue = (fortune - lppFees) / (0.1 + notaryFees);\n\n  return Math.max(\n    Math.round(Math.min(cashLimitedValue, totalFortuneLimitedValue)),\n    0,\n  );\n};\n\nexport default constants;\n","import BorrowerService from 'core/api/borrowers/BorrowerService';\nimport {\n  RESIDENCY_PERMIT,\n  GENDER,\n  CIVIL_STATUS,\n  OTHER_FORTUNE,\n  OTHER_INCOME,\n  EXPENSES,\n  REAL_ESTATE,\n} from 'core/api/borrowers/borrowerConstants';\nimport { fakeFile } from 'core/api/files/files';\n\nconst firstNames = [\n  'Marie',\n  'Camille',\n  'Léa',\n  'Manon',\n  'Thomas',\n  'Nicolas',\n  'Julien',\n];\n\nconst lastNames = ['Arsenault', 'Babel', 'Rochat'];\n\nconst generateSecondBorrowerProbabillity = () => Math.random() < 0.8;\n\nconst insertFakeBorrower = (userId) => {\n  const borrower = {\n    firstName: firstNames[Math.floor(Math.random() * firstNames.length)],\n    lastName: lastNames[Math.floor(Math.random() * lastNames.length)],\n    gender: 'F',\n    address1: 'Chemin du Mont 3',\n    zipCode: 1400,\n    city: 'Yverdon-les-Bains',\n    citizenships: 'Suisse, Français',\n    age: 35,\n    birthPlace: 'Lausanne',\n    civilStatus: 'SINGLE',\n    childrenCount: 2,\n    company: 'Deloitte',\n    personalBank: 'BCGE',\n    isSwiss: true,\n    isUSPerson: false,\n    worksForOwnCompany: false,\n    sameAddress: true,\n\n    salary: 300000,\n    bonusExists: true,\n    bonus: {\n      bonus2014: 12300,\n      bonus2015: 15490,\n      bonus2016: 11140,\n      bonus2017: 13780,\n    },\n    otherIncome: [\n      {\n        value: 10000,\n        description: 'PENSION',\n      },\n      {\n        value: 15000,\n        description: 'RENT',\n      },\n    ],\n    expenses: [\n      {\n        value: 3000,\n        description: 'LEASING',\n      },\n      {\n        value: 4000,\n        description: 'PERSONAL_LOAN',\n      },\n    ],\n    realEstate: [\n      {\n        value: 433000,\n        loan: 240000,\n        description: 'PRIMARY',\n      },\n    ],\n    bankFortune: 300000,\n    insuranceSecondPillar: 120000,\n    insuranceThirdPillar: 50000,\n    files: {\n      identity: [fakeFile],\n      taxes: [fakeFile],\n      salaryCertificate: [fakeFile],\n      bonus: [fakeFile],\n      otherIncome: [fakeFile],\n      expenses: [fakeFile],\n      nonPursuitExtract: [fakeFile],\n      lastSalaries: [fakeFile],\n      currentMortgages: [fakeFile],\n      bankAssetsChange: [fakeFile],\n      pensionFundYearlyStatement: [fakeFile],\n      retirementInsurancePlan: [fakeFile],\n    },\n    logic: {\n      financeEthics: true,\n      hasValidatedFinances: true,\n    },\n  };\n  \n  return BorrowerService.insert({ borrower, userId });\n};\n\nconst createFakeBorrowers = (userId) => {\n  const borrowerIds = [insertFakeBorrower(userId)];\n  if (generateSecondBorrowerProbabillity()) {\n    borrowerIds.push(insertFakeBorrower(userId));\n  }\n  return borrowerIds;\n};\n\nexport default createFakeBorrowers;\n","export const USER_COUNT = 10;\nexport const ADMIN_COUNT = 10;\nexport const DEV_COUNT = 5;\nexport const MAX_LOANS_PER_USER = 2;\nexport const STEPS_PER_LOAN = 3;\nexport const MAX_OFFERS_PER_LOAN = 10;\nexport const MIN_OFFERS_PER_LOAN = 5;\n","import { Meteor } from 'meteor/meteor';\nimport createFakeUsers from './users';\nimport { DEV_COUNT } from './config';\n\nMeteor.startup(() => {\n  if (Meteor.users.find({ roles: { $in: ['dev'] } }).count() === 0) {\n    console.log('creating devs');\n    createFakeUsers(DEV_COUNT, 'dev');\n  }\n});\n","import moment from 'moment';\nimport LoanService from 'core/api/loans/LoanService';\nimport {\n  LOAN_STATUS,\n  PURCHASE_TYPE,\n  CANTONS,\n  INTEREST_RATES,\n  OWNER,\n  AUCTION_STATUS,\n  CLOSING_STEPS_TYPE,\n  CLOSING_STEPS_STATUS,\n  AUCTION_MOST_IMPORTANT,\n  INSURANCE_USE_PRESET,\n  LOAN_STRATEGY_PRESET,\n  AMORTIZATION_STRATEGY_PRESET,\n  PAYMENT_SCHEDULES,\n} from 'core/api/loans/loanConstants';\nimport { fakeFile } from 'core/api/files/files';\nimport { STEPS_PER_LOAN } from './config';\nimport createFakeBorrowers from './borrowers';\nimport createFakeProperty from './properties';\n\nconst purchaseTypes = Object.values(PURCHASE_TYPE);\n\nconst generateRandomNumber = maxSteps =>\n  Math.floor(Math.random() * maxSteps + 1);\n\nconst fakeGeneral = {\n  purchaseType: purchaseTypes[Math.floor(Math.random() * purchaseTypes.length)],\n  fortuneUsed: 250000,\n  insuranceFortuneUsed: 100000,\n  wantedClosingDate: moment()\n    .add(15, 'd')\n    .toDate(),\n};\n\nconst logic1 = {};\n\nconst logic2 = {\n  step: 2,\n  verification: {\n    requested: false,\n    validated: true,\n    comments: [],\n  },\n  auction: {},\n};\n\nconst logic3 = {\n  step: 3,\n  verification: {\n    requested: false,\n    validated: true,\n    comments: [],\n  },\n  // auctionStarted: true,\n  auction: {\n    status: 'ENDED',\n    startTime: new Date(),\n    endTime: new Date(),\n  },\n  // auctionEndTime: new Date(),\n  hasValidatedStructure: true,\n  insuranceUsePreset: 'WITHDRAWAL',\n  loanStrategyPreset: 'FIXED',\n  amortizationStrategyPreset: 'INDIRECT',\n  lender: {},\n  closingSteps: [\n    { id: 'upload0', title: 'Contrat de prêt signé', type: 'UPLOAD' },\n    {\n      id: 'todo0',\n      title: 'Ouverture de compte chez votre prêteur',\n      description:\n        'Il faut ouvrir un compte bancaire chez votre prêteur où les fonds de votre hypothèque résideront.',\n      type: 'TODO',\n      status: 'VALID',\n    },\n    {\n      id: 'todo1',\n      title: 'Versement des fonds propres',\n      description:\n        'Vous devez aller chez le notaire et verser les fonds propres nécessaires sur un compte escrow.',\n      type: 'TODO',\n      status: 'UNVERIFIED',\n    },\n    {\n      id: 'todo2',\n      title: 'Engagement du notaire relative aux cédules hypothécaires',\n      description: '',\n      type: 'TODO',\n      status: 'ERROR',\n      error: 'Le notaire doit vous convier à un 2ème rendez-vous',\n    },\n  ],\n};\n\nconst fakeFiles = {\n  plans: [fakeFile],\n  cubage: [fakeFile],\n  pictures: [fakeFile],\n  buyersContract: [fakeFile],\n  landRegisterExtract: [fakeFile],\n  coownershipAllocationAgreement: [fakeFile],\n  coownershipAgreement: [fakeFile],\n  upload0: [fakeFile],\n};\n\nconst fakeFiles2 = {\n  plans: [fakeFile],\n  cubage: [fakeFile],\n  pictures: [fakeFile],\n  // buyersContract: [fakeFile],\n  // landRegisterExtract: [fakeFile],\n  // marketingBrochure: [fakeFile],\n  // coownershipAllocationAgreement: [fakeFile],\n  // coownershipAgreement: [fakeFile],\n};\n\nconst createFakeLoans = (userId) => {\n  const completeFiles = Math.random() > 0.5;\n  const borrowerIds = createFakeBorrowers(userId);\n  const propertyId = createFakeProperty(userId);\n  const loan = {\n    name: `Rue du Test ${Math.floor(Math.random())}`,\n    borrowerIds,\n    propertyId,\n    general: fakeGeneral,\n    files: fakeFiles,\n  };\n\n  switch (generateRandomNumber(STEPS_PER_LOAN)) {\n  case 3:\n    loan.logic = logic3;\n    loan.files = completeFiles ? fakeFiles : fakeFiles2;\n    loan.loanTranches = [\n      {\n        value: 750000,\n        type: 'interest10',\n        // TODO add tranches here\n      },\n    ];\n    break;\n  case 2:\n    loan.logic = logic2;\n    break;\n  default:\n    loan.logic = logic1;\n  }\n\n  return LoanService.insert({ loan, userId });\n};\n\nexport default createFakeLoans;\n","import { Meteor } from 'meteor/meteor';\nimport { check } from 'meteor/check';\nimport {\n  Borrowers,\n  Loans,\n  Offers,\n  Properties,\n  Tasks,\n  Users,\n  SecurityService,\n} from 'core/api';\nimport UserService from 'core/api/users/UserService';\nimport { USER_COUNT, ADMIN_COUNT, MAX_LOANS_PER_USER } from './config';\nimport createFakeLoan from './loans';\nimport createFakeTask from './tasks';\nimport createFakeUsers from './users';\nimport createFakeOffer from './offers';\n\nconst generateNumberOfLoans = max => Math.floor(Math.random() * max + 1);\n\nconst getAdmins = () => {\n  const admins = Users.find({ roles: { $in: ['admin'] } }).fetch();\n  if (admins.length === 0) {\n    const newAdmins = createFakeUsers(ADMIN_COUNT, 'admin');\n    return newAdmins;\n  }\n  return admins.map(admin => admin._id);\n};\n\nMeteor.methods({\n  generateTestData() {\n    if (SecurityService.currentUserHasRole('dev') && !Meteor.isProduction) {\n      const admins = getAdmins();\n      const newUsers = createFakeUsers(USER_COUNT, 'user');\n      newUsers.map((userId) => {\n        const adminId = admins[Math.floor(Math.random() * admins.length)];\n        UserService.assignAdminToUser({ userId, adminId });\n        const numberOfLoans = generateNumberOfLoans(MAX_LOANS_PER_USER);\n        for (let i = 0; i < numberOfLoans; i += 1) {\n          const loanId = createFakeLoan(userId, adminId);\n          createFakeTask(loanId, adminId);\n          createFakeOffer(loanId, userId);\n        }\n        return userId;\n      });\n    }\n  },\n\n  purgeDatabase(currentUserId) {\n    check(currentUserId, String);\n    if (SecurityService.currentUserHasRole('dev') && !Meteor.isProduction) {\n      Borrowers.remove({});\n      Loans.remove({});\n      Offers.remove({});\n      Properties.remove({});\n      Tasks.remove({});\n      Users.remove({ _id: { $ne: currentUserId } });\n    }\n  },\n});\n","import OfferService from 'core/api/offers/OfferService';\nimport { getRandomOffer } from 'core/api/offers/fakes';\nimport { Loans, Properties } from 'core/api';\n\nconst createFakeOffers = (loanId, userId) => {\n  const loan = Loans.findOne(loanId);\n  const property = Properties.findOne(loan.propertyId);\n  const offer = getRandomOffer(\n    { loan: { ...loan, _id: loan._id }, property },\n    true,\n  );\n\n  return OfferService.insertAdminOffer({ offer, loan, userId });\n};\n\nexport default createFakeOffers;\n","import PropertyService from 'core/api/properties/PropertyService';\nimport {\n  PROPERTY_STATUS,\n  USAGE_TYPE,\n  PROPERTY_STYLE,\n  VOLUME_NORM,\n} from 'core/api/properties/propertyConstants';\nimport { fakeFile } from 'core/api/files/files';\n\nconst statuses = Object.values(PROPERTY_STATUS);\nconst usageTypes = Object.values(USAGE_TYPE);\nconst styles = Object.values(PROPERTY_STYLE);\nconst volumeNorms = Object.values(VOLUME_NORM);\n\nconst createFakeProperties = (userId) => {\n  const object = {\n    status: statuses[Math.floor(Math.random() * statuses.length)],\n    value: Math.floor(Math.random() * 100000000 + 1),\n    address1: `Rue du Succès ${Math.floor(Math.random())}`,\n    propertyWork: 40000,\n    zipCode: Math.floor(Math.random() * 1000 + 1000),\n    city: 'Lausanne',\n    usageType: usageTypes[Math.floor(Math.random() * usageTypes.length)],\n    style: styles[Math.floor(Math.random() * styles.length)],\n    futureOwner: 0,\n    constructionYear: 2010,\n    landArea: 300,\n    insideArea: 140,\n    volume: 1500,\n    volumeNorm: volumeNorms[Math.floor(Math.random() * volumeNorms.length)],\n    roomCount: 5,\n    bathroomCount: 2,\n    toiletCount: 0,\n    parking: {\n      box: 0,\n      inside: 1,\n      outside: 2,\n    },\n    minergie: true,\n    isCoproperty: true,\n    copropertyPercentage: 400,\n    cityPlacementQuality: 2,\n    buildingPlacementQuality: 3,\n    buildingQuality: 1,\n    flatQuality: 2,\n    materialsQuality: 2,\n    files: {\n      plans: [fakeFile],\n      cubage: [fakeFile],\n      pictures: [fakeFile],\n      landRegisterExtract: [fakeFile],\n    },\n  };\n  return PropertyService.insert({ object, userId });\n};\n\nexport default createFakeProperties;\n","import TaskService from 'core/api/tasks/TaskService';\nimport { TASK_TYPE } from 'core/api/tasks/tasksConstants';\n\nconst types = Object.values(TASK_TYPE);\n\nconst createFakeTasks = (loanId, assignedTo) => {\n  const type = types[Math.floor(Math.random() * types.length)];\n\n  return TaskService.insert({\n    type,\n    loanId,\n    assignedTo,\n    // createdByUserId: Meteor.userId(),\n  });\n};\n\nexport default createFakeTasks;\n","import { Accounts } from 'meteor/accounts-base';\nimport { Roles } from 'meteor/alanning:roles';\n// import { Emitter, Events } from '/core/api/users';\nimport EventService from 'core/api/events';\nimport { USER_EVENTS } from 'core/api/users/userConstants';\n\nconst createFakeUsers = (count, role) => {\n  const insertedUsers = [];\n  for (let i = 0; i < count; i += 1) {\n    const userId = Accounts.createUser({\n      email: `${role}-${i + 1}@epotek.ch`,\n      password: '12345',\n    });\n    Roles.addUsersToRoles(userId, [role]);\n    EventService.emit(USER_EVENTS.USER_CREATED, { userId });\n    insertedUsers.push(userId);\n  }\n  return insertedUsers;\n};\n\nexport default createFakeUsers;\n","import { Meteor } from 'meteor/meteor';\nimport { Inject } from 'meteor/meteorhacks:inject-initial';\n\nimport 'core/fixtures';\nimport 'core/api/api';\nimport 'core/api/api-server';\nimport jc from 'core/api/jobs/server';\n// Grapher Links\nimport 'core/api/links';\nimport '../accounts-config';\n\nMeteor.startup(() => {\n  // Do something on startup if necessary\n  // Add password protection\n  // if (Meteor.settings.public.environment === 'staging') {\n  //   setupAuth();\n  // }\n\n  jc.startJobServer();\n});\n\n// Inject a loader before client is ready, is removed in the on startup function on the client\nInject.rawHead('loader', Assets.getText('loader.html'));\n\n// Make sure this is passed a function, so that it gets random strings for\n// every client, instead of once on server-startup\n\n// FIXME: This gets picked up by google crawlers..! Very bad\n// Inject.rawHead('loadingText', getHtml);\n","import { Meteor } from 'meteor/meteor';\nimport { Accounts as AccountsUI } from 'meteor/std:accounts-ui';\nimport { Accounts } from 'meteor/accounts-base';\nimport { Roles } from 'meteor/alanning:roles';\n\nAccountsUI.ui.config({\n  passwordSignupFields: 'EMAIL_ONLY',\n  loginPath: '/login',\n  homeRoutePath: '/',\n  profilePath: '/',\n  minimumPasswordLength: 1,\n});\n\n// Accounts.onCreateUser((options, user) => {\n//   const newUser = user;\n//   newUser.roles = 'user';\n//   return newUser;\n// });\n","const setWallabyConfig = require('./imports/core/utils/testHelpers/wallaby/wallabyDefaults');\n\nmodule.exports = setWallabyConfig('e-Potek admin tests - Client');\n","import '/imports/startup/server';\n"]}}]