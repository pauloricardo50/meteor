{"metadata":{"usedHelpers":["extends","interopRequireDefault"],"marked":[],"modules":{"imports":[{"source":"./loanFunctions","imported":["getMonthlyWithExtractedOffer"],"specifiers":[{"kind":"named","imported":"getMonthlyWithExtractedOffer","local":"getMonthlyWithExtractedOffer"}]},{"source":"../api/constants","imported":["OFFER_TYPE","INTEREST_RATES"],"specifiers":[{"kind":"named","imported":"OFFER_TYPE","local":"OFFER_TYPE"},{"kind":"named","imported":"INTEREST_RATES","local":"INTEREST_RATES"}]}],"exports":{"exported":["getRange","extractOffers","getBestRate"],"specifiers":[{"kind":"local","local":"getRange","exported":"getRange"},{"kind":"local","local":"extractOffers","exported":"extractOffers"},{"kind":"local","local":"getBestRate","exported":"getBestRate"}]}}},"options":{"filename":"imports/core/utils/offerFunctions.js","filenameRelative":"imports/core/utils/offerFunctions.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"useNativeAsyncAwait":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"imports/core/utils/offerFunctions.js.map","sourceFileName":"imports/core/utils/offerFunctions.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"offerFunctions"},"ignored":false,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getRange = undefined;\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nmodule.export({\n  getRange: function getRange() {\n    return _getRange;\n  },\n  extractOffers: function extractOffers() {\n    return _extractOffers;\n  },\n  getBestRate: function getBestRate() {\n    return _getBestRate;\n  }\n});\n\nvar _getMonthlyWithExtractedOffer = void 0;\n\nmodule.watch(require(\"./loanFunctions\"), {\n  getMonthlyWithExtractedOffer: function getMonthlyWithExtractedOffer(v) {\n    _getMonthlyWithExtractedOffer = v;\n  }\n}, 0);\nexports.getRange = _getRange;\n\nvar _OFFER_TYPE = void 0,\n    _INTEREST_RATES = void 0;\n\nmodule.watch(require(\"../api/constants\"), {\n  OFFER_TYPE: function OFFER_TYPE(v) {\n    _OFFER_TYPE = v;\n  },\n  INTEREST_RATES: function INTEREST_RATES(v) {\n    _INTEREST_RATES = v;\n  }\n}, 1);\n\nvar _getRange = function _getRange(_ref, key) {\n  var offers = _ref.offers;\n  return offers.reduce(function (accumulator, offer) {\n    var standard = offer.standardOffer[key];\n    var counterpart = offer.counterpartOffer && offer.counterpartOffer[key];\n\n    if (standard < accumulator.min) {\n      accumulator.min = standard;\n    }\n\n    if (standard > accumulator.max) {\n      accumulator.max = standard;\n    }\n\n    if (counterpart) {\n      if (counterpart < accumulator.min) {\n        accumulator.min = counterpart;\n      }\n\n      if (counterpart > accumulator.max) {\n        accumulator.max = counterpart;\n      }\n    }\n\n    return accumulator;\n  }, {\n    min: Infinity,\n    max: 0\n  });\n};\n\nvar _extractOffers = function _extractOffers(_ref2) {\n  var offers = _ref2.offers,\n      loan = _ref2.loan,\n      property = _ref2.property;\n  var array = [];\n  offers.forEach(function (offer) {\n    var meta = {\n      organization: offer.organization,\n      canton: offer.canton,\n      id: offer._id,\n      rating: 5\n    };\n    array.push((0, _extends3.default)({}, offer.standardOffer, meta, {\n      conditions: offer.conditions,\n      uid: \"standard\" + offer._id,\n      type: _OFFER_TYPE.STANDARD\n    }));\n    array[array.length - 1].monthly = _getMonthlyWithExtractedOffer({\n      loan: loan,\n      property: property,\n      offer: array[array.length - 1]\n    });\n\n    if (offer.counterpartOffer) {\n      array.push((0, _extends3.default)({}, offer.counterpartOffer, meta, {\n        conditions: offer.conditions,\n        counterparts: offer.counterparts,\n        uid: \"counterparts\" + offer._id,\n        type: _OFFER_TYPE.COUNTERPARTS\n      }));\n      array[array.length - 1].monthly = _getMonthlyWithExtractedOffer({\n        loan: loan,\n        property: property,\n        offer: array[array.length - 1]\n      });\n    }\n  });\n  return array;\n};\n\nvar _getBestRate = function _getBestRate(_ref3) {\n  var _ref3$offers = _ref3.offers,\n      offers = _ref3$offers === undefined ? [] : _ref3$offers;\n  var duration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : _INTEREST_RATES.YEARS_10;\n  return offers.length ? Math.min.apply(Math, _toConsumableArray(offers.reduce(function (acc, offer) {\n    if (offer.standardOffer[duration]) {\n      acc.push(offer.standardOffer[duration]);\n    }\n\n    if (offer.counterpartOffer && offer.counterpartOffer[duration]) {\n      acc.push(offer.counterpartOffer[duration]);\n    }\n\n    return acc;\n  }, []))) : undefined;\n};","map":{"version":3,"sources":["imports/core/utils/offerFunctions.js"],"names":["module","export","getRange","extractOffers","getBestRate","getMonthlyWithExtractedOffer","watch","require","v","OFFER_TYPE","INTEREST_RATES","key","offers","reduce","accumulator","offer","standard","standardOffer","counterpart","counterpartOffer","min","max","Infinity","loan","property","array","forEach","meta","organization","canton","id","_id","rating","push","conditions","uid","type","STANDARD","length","monthly","counterparts","COUNTERPARTS","duration","YEARS_10","Math","acc","undefined"],"mappings":";;;;;;;;;;;;;;;AAAAA,OAAOC,MAAP,CAAc;AAACC,YAAS;AAAA,WAAIA,SAAJ;AAAA,GAAV;AAAuBC,iBAAc;AAAA,WAAIA,cAAJ;AAAA,GAArC;AAAuDC,eAAY;AAAA,WAAIA,YAAJ;AAAA;AAAnE,CAAd;;AAAmG,IAAIC,sCAAJ;;AAAiCL,OAAOM,KAAP,CAAaC,QAAQ,iBAAR,CAAb,EAAwC;AAACF,8BAAD,wCAA8BG,CAA9B,EAAgC;AAACH,oCAA6BG,CAA7B;AAA+B;AAAhE,CAAxC,EAA0G,CAA1G;;;AAA6G,IAAIC,oBAAJ;AAAA,IAAeC,wBAAf;;AAA8BV,OAAOM,KAAP,CAAaC,QAAQ,kBAAR,CAAb,EAAyC;AAACE,YAAD,sBAAYD,CAAZ,EAAc;AAACC,kBAAWD,CAAX;AAAa,GAA5B;AAA6BE,gBAA7B,0BAA4CF,CAA5C,EAA8C;AAACE,sBAAeF,CAAf;AAAiB;AAAhE,CAAzC,EAA2G,CAA3G;;AAGxQ,IAAMN,YAAW,SAAXA,SAAW,OAAaS,GAAb;AAAA,MAAGC,MAAH,QAAGA,MAAH;AAAA,SACtBA,OAAOC,MAAP,CACE,UAACC,WAAD,EAAcC,KAAd,EAAwB;AACtB,QAAMC,WAAWD,MAAME,aAAN,CAAoBN,GAApB,CAAjB;AACA,QAAMO,cAAcH,MAAMI,gBAAN,IAA0BJ,MAAMI,gBAAN,CAAuBR,GAAvB,CAA9C;;AAEA,QAAIK,WAAWF,YAAYM,GAA3B,EAAgC;AAC9BN,kBAAYM,GAAZ,GAAkBJ,QAAlB;AACD;;AACD,QAAIA,WAAWF,YAAYO,GAA3B,EAAgC;AAC9BP,kBAAYO,GAAZ,GAAkBL,QAAlB;AACD;;AACD,QAAIE,WAAJ,EAAiB;AACf,UAAIA,cAAcJ,YAAYM,GAA9B,EAAmC;AACjCN,oBAAYM,GAAZ,GAAkBF,WAAlB;AACD;;AACD,UAAIA,cAAcJ,YAAYO,GAA9B,EAAmC;AACjCP,oBAAYO,GAAZ,GAAkBH,WAAlB;AACD;AACF;;AAED,WAAOJ,WAAP;AACD,GArBH,EAsBE;AAAEM,SAAKE,QAAP;AAAiBD,SAAK;AAAtB,GAtBF,CADsB;AAAA,CAAjB;;AA0BA,IAAMlB,iBAAgB,SAAhBA,cAAgB,QAAgC;AAAA,MAA7BS,MAA6B,SAA7BA,MAA6B;AAAA,MAArBW,IAAqB,SAArBA,IAAqB;AAAA,MAAfC,QAAe,SAAfA,QAAe;AAC3D,MAAMC,QAAQ,EAAd;AACAb,SAAOc,OAAP,CAAe,UAACX,KAAD,EAAW;AACxB,QAAMY,OAAO;AACXC,oBAAcb,MAAMa,YADT;AAEXC,cAAQd,MAAMc,MAFH;AAGXC,UAAIf,MAAMgB,GAHC;AAIXC,cAAQ;AAJG,KAAb;AAOAP,UAAMQ,IAAN,4BACKlB,MAAME,aADX,EAEKU,IAFL;AAGEO,kBAAYnB,MAAMmB,UAHpB;AAIEC,wBAAgBpB,MAAMgB,GAJxB;AAKEK,YAAM3B,YAAW4B;AALnB;AAOAZ,UAAMA,MAAMa,MAAN,GAAe,CAArB,EAAwBC,OAAxB,GAAkClC,8BAA6B;AAC7DkB,gBAD6D;AAE7DC,wBAF6D;AAG7DT,aAAOU,MAAMA,MAAMa,MAAN,GAAe,CAArB;AAHsD,KAA7B,CAAlC;;AAMA,QAAIvB,MAAMI,gBAAV,EAA4B;AAC1BM,YAAMQ,IAAN,4BACKlB,MAAMI,gBADX,EAEKQ,IAFL;AAGEO,oBAAYnB,MAAMmB,UAHpB;AAIEM,sBAAczB,MAAMyB,YAJtB;AAKEL,8BAAoBpB,MAAMgB,GAL5B;AAMEK,cAAM3B,YAAWgC;AANnB;AAQAhB,YAAMA,MAAMa,MAAN,GAAe,CAArB,EAAwBC,OAAxB,GAAkClC,8BAA6B;AAC7DkB,kBAD6D;AAE7DC,0BAF6D;AAG7DT,eAAOU,MAAMA,MAAMa,MAAN,GAAe,CAArB;AAHsD,OAA7B,CAAlC;AAKD;AACF,GApCD;AAqCA,SAAOb,KAAP;AACD,CAxCM;;AA0CA,IAAMrB,eAAc,SAAdA,YAAc;AAAA,2BACvBQ,MADuB;AAAA,MACvBA,MADuB,gCACd,EADc;AAAA,MAEzB8B,QAFyB,uEAEdhC,gBAAeiC,QAFD;AAAA,SAIxB/B,OAAO0B,MAAP,GACGM,KAAKxB,GAAL,gCAAYR,OAAOC,MAAP,CAAc,UAACgC,GAAD,EAAM9B,KAAN,EAAgB;AAC1C,QAAIA,MAAME,aAAN,CAAoByB,QAApB,CAAJ,EAAmC;AACjCG,UAAIZ,IAAJ,CAASlB,MAAME,aAAN,CAAoByB,QAApB,CAAT;AACD;;AACD,QAAI3B,MAAMI,gBAAN,IAA0BJ,MAAMI,gBAAN,CAAuBuB,QAAvB,CAA9B,EAAgE;AAC9DG,UAAIZ,IAAJ,CAASlB,MAAMI,gBAAN,CAAuBuB,QAAvB,CAAT;AACD;;AACD,WAAOG,GAAP;AACD,GARa,EAQX,EARW,CAAZ,EADH,GAUGC,SAdqB;AAAA,CAApB","file":"imports/core/utils/offerFunctions.js.map","sourcesContent":["import { getMonthlyWithExtractedOffer } from './loanFunctions';\nimport { OFFER_TYPE, INTEREST_RATES } from '../api/constants';\n\nexport const getRange = ({ offers }, key) =>\n  offers.reduce(\n    (accumulator, offer) => {\n      const standard = offer.standardOffer[key];\n      const counterpart = offer.counterpartOffer && offer.counterpartOffer[key];\n\n      if (standard < accumulator.min) {\n        accumulator.min = standard;\n      }\n      if (standard > accumulator.max) {\n        accumulator.max = standard;\n      }\n      if (counterpart) {\n        if (counterpart < accumulator.min) {\n          accumulator.min = counterpart;\n        }\n        if (counterpart > accumulator.max) {\n          accumulator.max = counterpart;\n        }\n      }\n\n      return accumulator;\n    },\n    { min: Infinity, max: 0 },\n  );\n\nexport const extractOffers = ({ offers, loan, property }) => {\n  const array = [];\n  offers.forEach((offer) => {\n    const meta = {\n      organization: offer.organization,\n      canton: offer.canton,\n      id: offer._id,\n      rating: 5,\n    };\n\n    array.push({\n      ...offer.standardOffer,\n      ...meta,\n      conditions: offer.conditions,\n      uid: `standard${offer._id}`,\n      type: OFFER_TYPE.STANDARD,\n    });\n    array[array.length - 1].monthly = getMonthlyWithExtractedOffer({\n      loan,\n      property,\n      offer: array[array.length - 1],\n    });\n\n    if (offer.counterpartOffer) {\n      array.push({\n        ...offer.counterpartOffer,\n        ...meta,\n        conditions: offer.conditions,\n        counterparts: offer.counterparts,\n        uid: `counterparts${offer._id}`,\n        type: OFFER_TYPE.COUNTERPARTS,\n      });\n      array[array.length - 1].monthly = getMonthlyWithExtractedOffer({\n        loan,\n        property,\n        offer: array[array.length - 1],\n      });\n    }\n  });\n  return array;\n};\n\nexport const getBestRate = (\n  { offers = [] },\n  duration = INTEREST_RATES.YEARS_10,\n) =>\n  (offers.length\n    ? Math.min(...offers.reduce((acc, offer) => {\n      if (offer.standardOffer[duration]) {\n        acc.push(offer.standardOffer[duration]);\n      }\n      if (offer.counterpartOffer && offer.counterpartOffer[duration]) {\n        acc.push(offer.counterpartOffer[duration]);\n      }\n      return acc;\n    }, []))\n    : undefined);\n"]},"hash":"1d7e8fc251ad744665c1cb14ef41e6bc68a0bc0f"}
