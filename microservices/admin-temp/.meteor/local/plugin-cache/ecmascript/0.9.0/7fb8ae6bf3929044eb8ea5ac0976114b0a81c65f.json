{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"meteor/meteor","imported":["Meteor"],"specifiers":[{"kind":"named","imported":"Meteor","local":"Meteor"}]},{"source":"meteor/okgrow:analytics","imported":["analytics"],"specifiers":[{"kind":"named","imported":"analytics","local":"analytics"}]},{"source":"./browserFunctions","imported":["storageAvailable","isDemo"],"specifiers":[{"kind":"named","imported":"storageAvailable","local":"storageAvailable"},{"kind":"named","imported":"isDemo","local":"isDemo"}]}],"exports":{"exported":["allowTracking","addUserTracking","trackOncePerSession"],"specifiers":[{"kind":"local","local":"allowTracking","exported":"allowTracking"},{"kind":"local","local":"addUserTracking","exported":"addUserTracking"},{"kind":"local","local":"trackOncePerSession","exported":"trackOncePerSession"}]}}},"options":{"filename":"imports/core/utils/analytics.js","filenameRelative":"imports/core/utils/analytics.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"imports/core/utils/analytics.js.map","sourceFileName":"imports/core/utils/analytics.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"analytics"},"ignored":false,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nmodule.export({\n  allowTracking: function () {\n    function allowTracking() {\n      return _allowTracking;\n    }\n\n    return allowTracking;\n  }(),\n  addUserTracking: function () {\n    function addUserTracking() {\n      return _addUserTracking;\n    }\n\n    return addUserTracking;\n  }(),\n  trackOncePerSession: function () {\n    function trackOncePerSession() {\n      return _trackOncePerSession;\n    }\n\n    return trackOncePerSession;\n  }()\n});\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function () {\n    function Meteor(v) {\n      _Meteor = v;\n    }\n\n    return Meteor;\n  }()\n}, 0);\n\nvar _analytics = void 0;\n\nexports.allowTracking = _allowTracking;\nmodule.watch(require(\"meteor/okgrow:analytics\"), {\n  analytics: function () {\n    function analytics(v) {\n      _analytics = v;\n    }\n\n    return analytics;\n  }()\n}, 1);\n\nvar _storageAvailable = void 0,\n    _isDemo = void 0;\n\nmodule.watch(require(\"./browserFunctions\"), {\n  storageAvailable: function () {\n    function storageAvailable(v) {\n      _storageAvailable = v;\n    }\n\n    return storageAvailable;\n  }(),\n  isDemo: function () {\n    function isDemo(v) {\n      _isDemo = v;\n    }\n\n    return isDemo;\n  }()\n}, 2);\n\n/**\n * allowTracking - Prevents tracking during tests and on a demo website\n *\n * @return {Boolean}\n */var _allowTracking = function () {\n  function _allowTracking() {\n    if (_isDemo()) {\n      return false;\n    } else if (_Meteor.isTest) {\n      return false;\n    }\n\n    return true;\n  }\n\n  return _allowTracking;\n}();\n\nvar _addUserTracking = function () {\n  function _addUserTracking(userId, metadata) {\n    if (!userId) {\n      throw new Error('no tracking identification userId provided');\n    }\n\n    if (_allowTracking()) {\n      _analytics.identify(userId, metadata);\n    }\n  }\n\n  return _addUserTracking;\n}();\n\nvar track = function () {\n  function track(eventName, metadata) {\n    if (!eventName) {\n      throw new Error('no tracking eventName provided');\n    }\n\n    if (_allowTracking()) {\n      _analytics.track(eventName, metadata);\n    }\n  }\n\n  return track;\n}();\n\nmodule.exportDefault(track);\n\nvar _trackOncePerSession = function () {\n  function _trackOncePerSession(eventName, metadata) {\n    var localId = \"epotek-tracking.\" + eventName; // Make sure we can use sessionStorage\n\n    if (_storageAvailable('sessionStorage')) {\n      var localTracked = sessionStorage.getItem(localId);\n\n      if (!localTracked) {\n        // If this id has never been tracked in localStorage, track\n        track(eventName, metadata);\n        sessionStorage.setItem(localId, eventName);\n      } else {\n        return false;\n      }\n    }\n  }\n\n  return _trackOncePerSession;\n}();","map":{"version":3,"sources":["imports/core/utils/analytics.js"],"names":["module","export","allowTracking","addUserTracking","trackOncePerSession","Meteor","watch","require","v","analytics","storageAvailable","isDemo","isTest","userId","metadata","Error","identify","track","eventName","exportDefault","localId","localTracked","sessionStorage","getItem","setItem"],"mappings":";;;;;AAAAA,OAAOC,MAAP,CAAc;AAACC;AAAc;AAAA,aAAIA,cAAJ;AAAA;;AAAd;AAAA,KAAD;AAAiCC;AAAgB;AAAA,aAAIA,gBAAJ;AAAA;;AAAhB;AAAA,KAAjC;AAAqEC;AAAoB;AAAA,aAAIA,oBAAJ;AAAA;;AAApB;AAAA;AAArE,CAAd;;AAAiI,IAAIC,gBAAJ;;AAAWL,OAAOM,KAAP,CAAaC,QAAQ,eAAR,CAAb,EAAsC;AAACF,QAAD;AAAA,oBAAQG,CAAR,EAAU;AAACH,gBAAOG,CAAP;AAAS;;AAApB;AAAA;AAAA,CAAtC,EAA4D,CAA5D;;AAA+D,IAAIC,mBAAJ;;;AAAcT,OAAOM,KAAP,CAAaC,QAAQ,yBAAR,CAAb,EAAgD;AAACE,WAAD;AAAA,uBAAWD,CAAX,EAAa;AAACC,mBAAUD,CAAV;AAAY;;AAA1B;AAAA;AAAA,CAAhD,EAA4E,CAA5E;;AAA+E,IAAIE,0BAAJ;AAAA,IAAqBC,gBAArB;;AAA4BX,OAAOM,KAAP,CAAaC,QAAQ,oBAAR,CAAb,EAA2C;AAACG,kBAAD;AAAA,8BAAkBF,CAAlB,EAAoB;AAACE,0BAAiBF,CAAjB;AAAmB;;AAAxC;AAAA;AAAyCG,QAAzC;AAAA,oBAAgDH,CAAhD,EAAkD;AAACG,gBAAOH,CAAP;AAAS;;AAA5D;AAAA;AAAA,CAA3C,EAAyG,CAAzG;;AAIpU;;;;GAKO,IAAMN;AAAgB,WAAhBA,cAAgB,GAAM;AACjC,QAAIS,SAAJ,EAAc;AACZ,aAAO,KAAP;AACD,KAFD,MAEO,IAAIN,QAAOO,MAAX,EAAmB;AACxB,aAAO,KAAP;AACD;;AAED,WAAO,IAAP;AACD;;AARY;AAAA,GAAN;;AAUA,IAAMT;AAAkB,WAAlBA,gBAAkB,CAACU,MAAD,EAASC,QAAT,EAAsB;AACnD,QAAI,CAACD,MAAL,EAAa;AACX,YAAM,IAAIE,KAAJ,CAAU,4CAAV,CAAN;AACD;;AACD,QAAIb,gBAAJ,EAAqB;AACnBO,iBAAUO,QAAV,CAAmBH,MAAnB,EAA2BC,QAA3B;AACD;AACF;;AAPY;AAAA,GAAN;;AASP,IAAMG;AAAQ,WAARA,KAAQ,CAACC,SAAD,EAAYJ,QAAZ,EAAyB;AACrC,QAAI,CAACI,SAAL,EAAgB;AACd,YAAM,IAAIH,KAAJ,CAAU,gCAAV,CAAN;AACD;;AACD,QAAIb,gBAAJ,EAAqB;AACnBO,iBAAUQ,KAAV,CAAgBC,SAAhB,EAA2BJ,QAA3B;AACD;AACF;;AAPK;AAAA,GAAN;;AA5BAd,OAAOmB,aAAP,CAqCeF,KArCf;;AAuCO,IAAMb;AAAsB,WAAtBA,oBAAsB,CAACc,SAAD,EAAYJ,QAAZ,EAAyB;AAC1D,QAAMM,+BAA6BF,SAAnC,CAD0D,CAG1D;;AACA,QAAIR,kBAAiB,gBAAjB,CAAJ,EAAwC;AACtC,UAAMW,eAAeC,eAAeC,OAAf,CAAuBH,OAAvB,CAArB;;AAEA,UAAI,CAACC,YAAL,EAAmB;AACjB;AACAJ,cAAMC,SAAN,EAAiBJ,QAAjB;AACAQ,uBAAeE,OAAf,CAAuBJ,OAAvB,EAAgCF,SAAhC;AACD,OAJD,MAIO;AACL,eAAO,KAAP;AACD;AACF;AACF;;AAfY;AAAA,GAAN","file":"imports/core/utils/analytics.js.map","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { analytics } from 'meteor/okgrow:analytics';\nimport { storageAvailable, isDemo } from './browserFunctions';\n\n/**\n * allowTracking - Prevents tracking during tests and on a demo website\n *\n * @return {Boolean}\n */\nexport const allowTracking = () => {\n  if (isDemo()) {\n    return false;\n  } else if (Meteor.isTest) {\n    return false;\n  }\n\n  return true;\n};\n\nexport const addUserTracking = (userId, metadata) => {\n  if (!userId) {\n    throw new Error('no tracking identification userId provided');\n  }\n  if (allowTracking()) {\n    analytics.identify(userId, metadata);\n  }\n};\n\nconst track = (eventName, metadata) => {\n  if (!eventName) {\n    throw new Error('no tracking eventName provided');\n  }\n  if (allowTracking()) {\n    analytics.track(eventName, metadata);\n  }\n};\n\nexport default track;\n\nexport const trackOncePerSession = (eventName, metadata) => {\n  const localId = `epotek-tracking.${eventName}`;\n\n  // Make sure we can use sessionStorage\n  if (storageAvailable('sessionStorage')) {\n    const localTracked = sessionStorage.getItem(localId);\n\n    if (!localTracked) {\n      // If this id has never been tracked in localStorage, track\n      track(eventName, metadata);\n      sessionStorage.setItem(localId, eventName);\n    } else {\n      return false;\n    }\n  }\n};\n"]},"hash":"7fb8ae6bf3929044eb8ea5ac0976114b0a81c65f"}
