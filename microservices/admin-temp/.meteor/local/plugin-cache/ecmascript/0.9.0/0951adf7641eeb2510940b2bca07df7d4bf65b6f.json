{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"meteor/okgrow:analytics","imported":["analytics"],"specifiers":[{"kind":"named","imported":"analytics","local":"analytics"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"packages/okgrow:analytics/examples/iron-router/iron-router.js","filenameRelative":"packages/okgrow:analytics/examples/iron-router/iron-router.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"useNativeAsyncAwait":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"packages/okgrow:analytics/examples/iron-router/iron-router.js.map","sourceFileName":"packages/okgrow:analytics/examples/iron-router/iron-router.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"iron-router"},"ignored":false,"code":"let analytics;\nmodule.watch(require(\"meteor/okgrow:analytics\"), {\n  analytics(v) {\n    analytics = v;\n  }\n\n}, 0);\n\n// eslint-disable-line import/no-extraneous-dependencies, import/extensions\nif (Meteor.isClient) {\n  Router.route('/', function routeRoot() {\n    this.layout('mainLayout');\n    this.render('one');\n  }, {\n    name: 'home'\n  });\n  Router.route('/one', function routeOne() {\n    this.layout('mainLayout');\n    this.render('one');\n  }, {\n    name: 'one'\n  });\n  Router.route('/two', function routeTwo() {\n    this.layout('mainLayout');\n    this.render('two');\n  }, {\n    name: 'two'\n  });\n  Router.route('/three', function routeThree() {\n    this.layout('mainLayout');\n    this.render('three');\n  }, {\n    name: 'three'\n  });\n  Template.mainLayout.onCreated(function mainLayoutOnCreated() {\n    Meteor.subscribe('oauthInfo');\n    const self = this;\n    self.log = new ReactiveVar([]);\n    self.currentIdentity = new ReactiveVar('No Identity Set'); // We don't want to register analytics if it has been blocked by an adblocker.\n\n    if (typeof analytics === 'undefined') return;\n    self.currentIdentity.set(analytics._user._getTraits().email || 'No Identity Set');\n    analytics.on('page', (event, properties, options) => {\n      const latest = self.log.get();\n      latest.push(`Page: ${options.path}`);\n      self.log.set(latest);\n    });\n    analytics.on('identify', (event, properties) => {\n      const latest = self.log.get();\n      latest.push(`Identify: ${properties.email}`);\n      self.log.set(latest);\n      self.currentIdentity.set(properties.email);\n    });\n    analytics.on('track', event => {\n      const latest = self.log.get();\n      latest.push(`Track: ${event}`);\n      self.log.set(latest);\n    });\n  });\n  Template.mainLayout.helpers({\n    log() {\n      return Template.instance().log.get();\n    },\n\n    currentIdentity() {\n      return Template.instance().currentIdentity.get();\n    },\n\n    isOauth() {\n      const user = Meteor.user();\n      let message = 'Not Signed In.';\n\n      if (user && user.services) {\n        if (user.services.facebook) {\n          message = `Signed in with Facebook as ${user.services.facebook.name} (${user.services.facebook.email})`;\n        } else if (user.services.github) {\n          message = `Signed in with Github as ${user.services.github.username} (${user.services.github.email})`;\n        } else if (user.services.google) {\n          message = `Signed in with Google as ${user.services.google.name} (${user.services.google.email})`;\n        }\n      } else if (user) {\n        message = 'Not an oauth login';\n      }\n\n      return message;\n    }\n\n  });\n  Template.mainLayout.onRendered(function mainLayoutOnRendered() {\n    Tracker.autorun(() => {\n      document.title = Router.current().route.getName();\n    });\n  });\n}\n\nif (Meteor.isServer) {\n  Meteor.publish('oauthInfo', function publishOAuthInfo() {\n    return Meteor.users.find({\n      _id: this.userId\n    }, {\n      fields: {\n        'services.facebook.name': 1,\n        'services.facebook.email': 1,\n        'services.github.username': 1,\n        'services.github.email': 1,\n        'services.google.name': 1,\n        'services.google.email': 1\n      }\n    });\n  });\n}","map":{"version":3,"sources":["packages/okgrow:analytics/examples/iron-router/iron-router.js"],"names":["analytics","module","watch","require","v","Meteor","isClient","Router","route","routeRoot","layout","render","name","routeOne","routeTwo","routeThree","Template","mainLayout","onCreated","mainLayoutOnCreated","subscribe","self","log","ReactiveVar","currentIdentity","set","_user","_getTraits","email","on","event","properties","options","latest","get","push","path","helpers","instance","isOauth","user","message","services","facebook","github","username","google","onRendered","mainLayoutOnRendered","Tracker","autorun","document","title","current","getName","isServer","publish","publishOAuthInfo","users","find","_id","userId","fields"],"mappings":"AAAA,IAAIA,SAAJ;AAAcC,OAAOC,KAAP,CAAaC,QAAQ,yBAAR,CAAb,EAAgD;AAACH,YAAUI,CAAV,EAAY;AAACJ,gBAAUI,CAAV;AAAY;;AAA1B,CAAhD,EAA4E,CAA5E;;AAAuC;AAErD,IAAIC,OAAOC,QAAX,EAAqB;AACnBC,SAAOC,KAAP,CAAa,GAAb,EAAkB,SAASC,SAAT,GAAqB;AACrC,SAAKC,MAAL,CAAY,YAAZ;AACA,SAAKC,MAAL,CAAY,KAAZ;AACD,GAHD,EAGG;AACDC,UAAM;AADL,GAHH;AAOAL,SAAOC,KAAP,CAAa,MAAb,EAAqB,SAASK,QAAT,GAAoB;AACvC,SAAKH,MAAL,CAAY,YAAZ;AACA,SAAKC,MAAL,CAAY,KAAZ;AACD,GAHD,EAGG;AACDC,UAAM;AADL,GAHH;AAOAL,SAAOC,KAAP,CAAa,MAAb,EAAqB,SAASM,QAAT,GAAoB;AACvC,SAAKJ,MAAL,CAAY,YAAZ;AACA,SAAKC,MAAL,CAAY,KAAZ;AACD,GAHD,EAGG;AACDC,UAAM;AADL,GAHH;AAOAL,SAAOC,KAAP,CAAa,QAAb,EAAuB,SAASO,UAAT,GAAsB;AAC3C,SAAKL,MAAL,CAAY,YAAZ;AACA,SAAKC,MAAL,CAAY,OAAZ;AACD,GAHD,EAGG;AACDC,UAAM;AADL,GAHH;AAOAI,WAASC,UAAT,CAAoBC,SAApB,CAA8B,SAASC,mBAAT,GAA+B;AAC3Dd,WAAOe,SAAP,CAAiB,WAAjB;AACA,UAAMC,OAAO,IAAb;AACAA,SAAKC,GAAL,GAAW,IAAIC,WAAJ,CAAgB,EAAhB,CAAX;AACAF,SAAKG,eAAL,GAAuB,IAAID,WAAJ,CAAgB,iBAAhB,CAAvB,CAJ2D,CAM3D;;AACA,QAAI,OAAOvB,SAAP,KAAqB,WAAzB,EAAsC;AAEtCqB,SAAKG,eAAL,CAAqBC,GAArB,CAAyBzB,UAAU0B,KAAV,CAAgBC,UAAhB,GAA6BC,KAA7B,IAAsC,iBAA/D;AAEA5B,cAAU6B,EAAV,CAAa,MAAb,EAAqB,CAACC,KAAD,EAAQC,UAAR,EAAoBC,OAApB,KAAgC;AACnD,YAAMC,SAASZ,KAAKC,GAAL,CAASY,GAAT,EAAf;AACAD,aAAOE,IAAP,CAAa,SAAQH,QAAQI,IAAK,EAAlC;AACAf,WAAKC,GAAL,CAASG,GAAT,CAAaQ,MAAb;AACD,KAJD;AAMAjC,cAAU6B,EAAV,CAAa,UAAb,EAAyB,CAACC,KAAD,EAAQC,UAAR,KAAuB;AAC9C,YAAME,SAASZ,KAAKC,GAAL,CAASY,GAAT,EAAf;AACAD,aAAOE,IAAP,CAAa,aAAYJ,WAAWH,KAAM,EAA1C;AACAP,WAAKC,GAAL,CAASG,GAAT,CAAaQ,MAAb;AACAZ,WAAKG,eAAL,CAAqBC,GAArB,CAAyBM,WAAWH,KAApC;AACD,KALD;AAOA5B,cAAU6B,EAAV,CAAa,OAAb,EAAuBC,KAAD,IAAW;AAC/B,YAAMG,SAASZ,KAAKC,GAAL,CAASY,GAAT,EAAf;AACAD,aAAOE,IAAP,CAAa,UAASL,KAAM,EAA5B;AACAT,WAAKC,GAAL,CAASG,GAAT,CAAaQ,MAAb;AACD,KAJD;AAKD,GA7BD;AA+BAjB,WAASC,UAAT,CAAoBoB,OAApB,CAA4B;AAC1Bf,UAAM;AAAE,aAAON,SAASsB,QAAT,GAAoBhB,GAApB,CAAwBY,GAAxB,EAAP;AAAuC,KADrB;;AAE1BV,sBAAkB;AAAE,aAAOR,SAASsB,QAAT,GAAoBd,eAApB,CAAoCU,GAApC,EAAP;AAAmD,KAF7C;;AAG1BK,cAAU;AACR,YAAMC,OAAOnC,OAAOmC,IAAP,EAAb;AACA,UAAIC,UAAU,gBAAd;;AACA,UAAID,QAAQA,KAAKE,QAAjB,EAA2B;AACzB,YAAIF,KAAKE,QAAL,CAAcC,QAAlB,EAA4B;AAC1BF,oBAAW,8BAA6BD,KAAKE,QAAL,CAAcC,QAAd,CAAuB/B,IAAK,KAAI4B,KAAKE,QAAL,CAAcC,QAAd,CAAuBf,KAAM,GAArG;AACD,SAFD,MAEO,IAAIY,KAAKE,QAAL,CAAcE,MAAlB,EAA0B;AAC/BH,oBAAW,4BAA2BD,KAAKE,QAAL,CAAcE,MAAd,CAAqBC,QAAS,KAAIL,KAAKE,QAAL,CAAcE,MAAd,CAAqBhB,KAAM,GAAnG;AACD,SAFM,MAEA,IAAIY,KAAKE,QAAL,CAAcI,MAAlB,EAA0B;AAC/BL,oBAAW,4BAA2BD,KAAKE,QAAL,CAAcI,MAAd,CAAqBlC,IAAK,KAAI4B,KAAKE,QAAL,CAAcI,MAAd,CAAqBlB,KAAM,GAA/F;AACD;AACF,OARD,MAQO,IAAIY,IAAJ,EAAU;AACfC,kBAAU,oBAAV;AACD;;AACD,aAAOA,OAAP;AACD;;AAlByB,GAA5B;AAqBAzB,WAASC,UAAT,CAAoB8B,UAApB,CAA+B,SAASC,oBAAT,GAAgC;AAC7DC,YAAQC,OAAR,CAAgB,MAAM;AACpBC,eAASC,KAAT,GAAiB7C,OAAO8C,OAAP,GAAiB7C,KAAjB,CAAuB8C,OAAvB,EAAjB;AACD,KAFD;AAGD,GAJD;AAKD;;AAED,IAAIjD,OAAOkD,QAAX,EAAqB;AACnBlD,SAAOmD,OAAP,CAAe,WAAf,EAA4B,SAASC,gBAAT,GAA4B;AACtD,WAAOpD,OAAOqD,KAAP,CAAaC,IAAb,CACL;AAAEC,WAAK,KAAKC;AAAZ,KADK,EAEL;AACEC,cAAQ;AACN,kCAA0B,CADpB;AAEN,mCAA2B,CAFrB;AAGN,oCAA4B,CAHtB;AAIN,iCAAyB,CAJnB;AAKN,gCAAwB,CALlB;AAMN,iCAAyB;AANnB;AADV,KAFK,CAAP;AAaD,GAdD;AAeD","file":"packages/okgrow:analytics/examples/iron-router/iron-router.js.map","sourcesContent":["import { analytics } from 'meteor/okgrow:analytics'; // eslint-disable-line import/no-extraneous-dependencies, import/extensions\n\nif (Meteor.isClient) {\n  Router.route('/', function routeRoot() {\n    this.layout('mainLayout');\n    this.render('one');\n  }, {\n    name: 'home',\n  });\n\n  Router.route('/one', function routeOne() {\n    this.layout('mainLayout');\n    this.render('one');\n  }, {\n    name: 'one',\n  });\n\n  Router.route('/two', function routeTwo() {\n    this.layout('mainLayout');\n    this.render('two');\n  }, {\n    name: 'two',\n  });\n\n  Router.route('/three', function routeThree() {\n    this.layout('mainLayout');\n    this.render('three');\n  }, {\n    name: 'three',\n  });\n\n  Template.mainLayout.onCreated(function mainLayoutOnCreated() {\n    Meteor.subscribe('oauthInfo');\n    const self = this;\n    self.log = new ReactiveVar([]);\n    self.currentIdentity = new ReactiveVar('No Identity Set');\n\n    // We don't want to register analytics if it has been blocked by an adblocker.\n    if (typeof analytics === 'undefined') return;\n\n    self.currentIdentity.set(analytics._user._getTraits().email || 'No Identity Set');\n\n    analytics.on('page', (event, properties, options) => {\n      const latest = self.log.get();\n      latest.push(`Page: ${options.path}`);\n      self.log.set(latest);\n    });\n\n    analytics.on('identify', (event, properties) => {\n      const latest = self.log.get();\n      latest.push(`Identify: ${properties.email}`);\n      self.log.set(latest);\n      self.currentIdentity.set(properties.email);\n    });\n\n    analytics.on('track', (event) => {\n      const latest = self.log.get();\n      latest.push(`Track: ${event}`);\n      self.log.set(latest);\n    });\n  });\n\n  Template.mainLayout.helpers({\n    log() { return Template.instance().log.get(); },\n    currentIdentity() { return Template.instance().currentIdentity.get(); },\n    isOauth() {\n      const user = Meteor.user();\n      let message = 'Not Signed In.';\n      if (user && user.services) {\n        if (user.services.facebook) {\n          message = `Signed in with Facebook as ${user.services.facebook.name} (${user.services.facebook.email})`;\n        } else if (user.services.github) {\n          message = `Signed in with Github as ${user.services.github.username} (${user.services.github.email})`;\n        } else if (user.services.google) {\n          message = `Signed in with Google as ${user.services.google.name} (${user.services.google.email})`;\n        }\n      } else if (user) {\n        message = 'Not an oauth login';\n      }\n      return message;\n    },\n  });\n\n  Template.mainLayout.onRendered(function mainLayoutOnRendered() {\n    Tracker.autorun(() => {\n      document.title = Router.current().route.getName();\n    });\n  });\n}\n\nif (Meteor.isServer) {\n  Meteor.publish('oauthInfo', function publishOAuthInfo() {\n    return Meteor.users.find(\n      { _id: this.userId },\n      {\n        fields: {\n          'services.facebook.name': 1,\n          'services.facebook.email': 1,\n          'services.github.username': 1,\n          'services.github.email': 1,\n          'services.google.name': 1,\n          'services.google.email': 1,\n        },\n      },\n    );\n  });\n}\n"]},"hash":"0951adf7641eeb2510940b2bca07df7d4bf65b6f"}
