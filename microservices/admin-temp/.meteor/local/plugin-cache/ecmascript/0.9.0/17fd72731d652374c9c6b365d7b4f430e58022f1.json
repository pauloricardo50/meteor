{"metadata":{"usedHelpers":["extends","defineProperty","interopRequireDefault"],"marked":[],"modules":{"imports":[{"source":"meteor/mongo","imported":["Mongo"],"specifiers":[{"kind":"named","imported":"Mongo","local":"Mongo"}]},{"source":"simpl-schema","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"SimpleSchema"}]},{"source":"../constants","imported":["INTEREST_RATES","CANTONS"],"specifiers":[{"kind":"named","imported":"INTEREST_RATES","local":"INTEREST_RATES"},{"kind":"named","imported":"CANTONS","local":"CANTONS"}]}],"exports":{"exported":["OfferSchema"],"specifiers":[{"kind":"local","local":"OfferSchema","exported":"OfferSchema"}]}}},"options":{"filename":"imports/core/api/offers/offers.js","filenameRelative":"imports/core/api/offers/offers.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"imports/core/api/offers/offers.js.map","sourceFileName":"imports/core/api/offers/offers.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"offers"},"ignored":false,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.OfferSchema = undefined;\n\nvar _defineProperty2 = require(\"babel-runtime/helpers/defineProperty\");\n\nvar _defineProperty3 = _interopRequireDefault(_defineProperty2);\n\nvar _extends3 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends4 = _interopRequireDefault(_extends3);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nmodule.export({\n  OfferSchema: function () {\n    function OfferSchema() {\n      return _OfferSchema;\n    }\n\n    return OfferSchema;\n  }()\n});\n\nvar _Mongo = void 0;\n\nmodule.watch(require(\"meteor/mongo\"), {\n  Mongo: function () {\n    function Mongo(v) {\n      _Mongo = v;\n    }\n\n    return Mongo;\n  }()\n}, 0);\nvar SimpleSchema = void 0;\nmodule.watch(require(\"simpl-schema\"), {\n  \"default\": function () {\n    function _default(v) {\n      SimpleSchema = v;\n    }\n\n    return _default;\n  }()\n}, 1);\n\nvar _INTEREST_RATES = void 0,\n    _CANTONS = void 0;\n\nmodule.watch(require(\"../constants\"), {\n  INTEREST_RATES: function () {\n    function INTEREST_RATES(v) {\n      _INTEREST_RATES = v;\n    }\n\n    return INTEREST_RATES;\n  }(),\n  CANTONS: function () {\n    function CANTONS(v) {\n      _CANTONS = v;\n    }\n\n    return CANTONS;\n  }()\n}, 2);\nvar Offers = new _Mongo.Collection('offers'); // Prevent all client side modifications of mongoDB\n\nexports.OfferSchema = _OfferSchema;\nOffers.deny({\n  insert: function () {\n    function insert() {\n      return true;\n    }\n\n    return insert;\n  }(),\n  update: function () {\n    function update() {\n      return true;\n    }\n\n    return update;\n  }(),\n  remove: function () {\n    function remove() {\n      return true;\n    }\n\n    return remove;\n  }()\n});\nOffers.allow({\n  insert: function () {\n    function insert() {\n      return false;\n    }\n\n    return insert;\n  }(),\n  update: function () {\n    function update() {\n      return false;\n    }\n\n    return update;\n  }(),\n  remove: function () {\n    function remove() {\n      return false;\n    }\n\n    return remove;\n  }()\n});\nvar singleOffer = new SimpleSchema((0, _extends4.default)({\n  maxAmount: {\n    type: Number,\n    min: 0,\n    max: 100000000\n  },\n  amortization: {\n    type: Number\n  }\n}, Object.values(_INTEREST_RATES).reduce(function (object, interestKey) {\n  return (0, _extends4.default)({}, object, (0, _defineProperty3.default)({}, interestKey, {\n    type: Number,\n    min: 0,\n    max: 100,\n    optional: true\n  }));\n}, {})));\n\nvar _OfferSchema = new SimpleSchema({\n  loanId: {\n    type: String,\n    index: true\n  },\n  userId: {\n    type: String,\n    index: true\n  },\n  createdAt: {\n    type: Date,\n    autoValue: function () {\n      function autoValue() {\n        if (this.isInsert) {\n          return new Date();\n        }\n      }\n\n      return autoValue;\n    }()\n  },\n  updatedAt: {\n    type: Date,\n    autoValue: function () {\n      function autoValue() {\n        if (this.isInsert || this.isUpdate) {\n          return new Date();\n        }\n      }\n\n      return autoValue;\n    }()\n  },\n  isAdmin: {\n    type: Boolean,\n    defaultValue: false\n  },\n  organization: String,\n  canton: {\n    type: String,\n    allowedValues: Object.keys(_CANTONS)\n  },\n  auctionEndTime: Date,\n  standardOffer: {\n    type: singleOffer\n  },\n  counterpartOffer: {\n    type: singleOffer,\n    optional: true\n  },\n  counterparts: {\n    type: Array,\n    defaultValue: [],\n    optional: true\n  },\n  'counterparts.$': String,\n  conditions: {\n    type: Array,\n    defaultValue: []\n  },\n  'conditions.$': String\n}); // Attach schema\n\n\nOffers.attachSchema(_OfferSchema);\nmodule.exportDefault(Offers);","map":{"version":3,"sources":["imports/core/api/offers/offers.js"],"names":["module","export","OfferSchema","Mongo","watch","require","v","SimpleSchema","INTEREST_RATES","CANTONS","Offers","Collection","deny","insert","update","remove","allow","singleOffer","maxAmount","type","Number","min","max","amortization","Object","values","reduce","object","interestKey","optional","loanId","String","index","userId","createdAt","Date","autoValue","isInsert","updatedAt","isUpdate","isAdmin","Boolean","defaultValue","organization","canton","allowedValues","keys","auctionEndTime","standardOffer","counterpartOffer","counterparts","Array","conditions","attachSchema","exportDefault"],"mappings":"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","file":"imports/core/api/offers/offers.js.map","sourcesContent":["import { Mongo } from 'meteor/mongo';\nimport SimpleSchema from 'simpl-schema';\nimport { INTEREST_RATES, CANTONS } from '../constants';\n\nconst Offers = new Mongo.Collection('offers');\n\n// Prevent all client side modifications of mongoDB\nOffers.deny({\n  insert: () => true,\n  update: () => true,\n  remove: () => true,\n});\nOffers.allow({\n  insert: () => false,\n  update: () => false,\n  remove: () => false,\n});\n\nconst singleOffer = new SimpleSchema({\n  maxAmount: {\n    type: Number,\n    min: 0,\n    max: 100000000,\n  },\n  amortization: {\n    type: Number,\n  },\n  // For each existing rate, insert an allowed value in the schema\n  ...Object.values(INTEREST_RATES).reduce(\n    (object, interestKey) => ({\n      ...object,\n      [interestKey]: {\n        type: Number,\n        min: 0,\n        max: 100,\n        optional: true,\n      },\n    }),\n    {},\n  ),\n});\n\nexport const OfferSchema = new SimpleSchema({\n  loanId: {\n    type: String,\n    index: true,\n  },\n  userId: {\n    type: String,\n    index: true,\n  },\n  createdAt: {\n    type: Date,\n    autoValue() {\n      if (this.isInsert) {\n        return new Date();\n      }\n    },\n  },\n  updatedAt: {\n    type: Date,\n    autoValue() {\n      if (this.isInsert || this.isUpdate) {\n        return new Date();\n      }\n    },\n  },\n  isAdmin: {\n    type: Boolean,\n    defaultValue: false,\n  },\n  organization: String,\n  canton: {\n    type: String,\n    allowedValues: Object.keys(CANTONS),\n  },\n  auctionEndTime: Date,\n  standardOffer: {\n    type: singleOffer,\n  },\n  counterpartOffer: {\n    type: singleOffer,\n    optional: true,\n  },\n  counterparts: {\n    type: Array,\n    defaultValue: [],\n    optional: true,\n  },\n  'counterparts.$': String,\n  conditions: {\n    type: Array,\n    defaultValue: [],\n  },\n  'conditions.$': String,\n});\n\n// Attach schema\nOffers.attachSchema(OfferSchema);\nexport default Offers;\n"]},"hash":"17fd72731d652374c9c6b365d7b4f430e58022f1"}
