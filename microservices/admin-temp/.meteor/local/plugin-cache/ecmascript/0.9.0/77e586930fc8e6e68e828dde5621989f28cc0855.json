{"metadata":{"usedHelpers":["inherits","possibleConstructorReturn","createClass","classCallCheck","interopRequireDefault"],"marked":[],"modules":{"imports":[{"source":"prop-types","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"PropTypes"}]},{"source":"react","imported":["default","Component"],"specifiers":[{"kind":"named","imported":"default","local":"React"},{"kind":"named","imported":"Component","local":"Component"}]},{"source":"../../core/components/Button","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"Button"}]},{"source":"../../core/components/Checkbox","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"Checkbox"}]},{"source":"../../core/components/TextInput","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"TextInput"}]},{"source":"../../core/utils/conversionFunctions","imported":["toMoney","toNumber"],"specifiers":[{"kind":"named","imported":"toMoney","local":"toMoney"},{"kind":"named","imported":"toNumber","local":"toNumber"}]},{"source":"../../core/api/cleanMethods","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"cleanMethod"}]}],"exports":{"exported":["OfferForm"],"specifiers":[{"kind":"local","local":"OfferForm","exported":"default"}]}}},"options":{"filename":"imports/ui/components/OfferForm.jsx","filenameRelative":"imports/ui/components/OfferForm.jsx","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"imports/ui/components/OfferForm.jsx.map","sourceFileName":"imports/ui/components/OfferForm.jsx","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"OfferForm"},"ignored":false,"code":"\"use strict\";\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require(\"babel-runtime/helpers/createClass\");\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require(\"babel-runtime/helpers/possibleConstructorReturn\");\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require(\"babel-runtime/helpers/inherits\");\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nmodule.export({\n  \"default\": function () {\n    function _default() {\n      return OfferForm;\n    }\n\n    return _default;\n  }()\n});\nvar PropTypes = void 0;\nmodule.watch(require(\"prop-types\"), {\n  \"default\": function () {\n    function _default(v) {\n      PropTypes = v;\n    }\n\n    return _default;\n  }()\n}, 0);\n\nvar React = void 0,\n    _Component = void 0;\n\nmodule.watch(require(\"react\"), {\n  \"default\": function () {\n    function _default(v) {\n      React = v;\n    }\n\n    return _default;\n  }(),\n  Component: function () {\n    function Component(v) {\n      _Component = v;\n    }\n\n    return Component;\n  }()\n}, 1);\nvar Button = void 0;\nmodule.watch(require(\"../../core/components/Button\"), {\n  \"default\": function () {\n    function _default(v) {\n      Button = v;\n    }\n\n    return _default;\n  }()\n}, 2);\nvar Checkbox = void 0;\nmodule.watch(require(\"../../core/components/Checkbox\"), {\n  \"default\": function () {\n    function _default(v) {\n      Checkbox = v;\n    }\n\n    return _default;\n  }()\n}, 3);\nvar TextInput = void 0;\nmodule.watch(require(\"../../core/components/TextInput\"), {\n  \"default\": function () {\n    function _default(v) {\n      TextInput = v;\n    }\n\n    return _default;\n  }()\n}, 4);\n\nvar _toMoney = void 0,\n    _toNumber = void 0;\n\nmodule.watch(require(\"../../core/utils/conversionFunctions\"), {\n  toMoney: function () {\n    function toMoney(v) {\n      _toMoney = v;\n    }\n\n    return toMoney;\n  }(),\n  toNumber: function () {\n    function toNumber(v) {\n      _toNumber = v;\n    }\n\n    return toNumber;\n  }()\n}, 5);\nvar cleanMethod = void 0;\nmodule.watch(require(\"../../core/api/cleanMethods\"), {\n  \"default\": function () {\n    function _default(v) {\n      cleanMethod = v;\n    }\n\n    return _default;\n  }()\n}, 6);\nvar styles = {\n  article: {\n    marginTop: 40\n  },\n  buttons: {\n    marginTop: 40,\n    textAlign: 'right'\n  },\n  button: {\n    marginRight: 16\n  },\n  h4: {\n    marginTop: 40,\n    display: 'inline-block'\n  },\n  checkbox: {\n    margin: '20px 0'\n  }\n};\n\nvar getFormArray = function () {\n  function getFormArray(i) {\n    return [{\n      label: 'Libor',\n      name: \"libor_\" + i\n    }, {\n      label: 'Fixe 1 an',\n      name: \"interest1_\" + i\n    }, {\n      label: 'Fixe 2 ans',\n      name: \"interest2_\" + i\n    }, {\n      label: 'Fixe 5 ans',\n      name: \"interest5_\" + i\n    }, {\n      label: 'Fixe 10 ans',\n      name: \"interest10_\" + i\n    }, {\n      label: 'Fixe 15 ans',\n      name: \"interest15_\" + i\n    }];\n  }\n\n  return getFormArray;\n}();\n\nvar fix = function () {\n  function fix(val) {\n    return parseFloat(val) / 100 || undefined;\n  }\n\n  return fix;\n}();\n\nvar OfferForm = function (_Component2) {\n  (0, _inherits3.default)(OfferForm, _Component2);\n\n  function OfferForm(props) {\n    (0, _classCallCheck3.default)(this, OfferForm);\n\n    var _this = (0, _possibleConstructorReturn3.default)(this, (OfferForm.__proto__ || Object.getPrototypeOf(OfferForm)).call(this, props));\n\n    _this.handleChange = function (name, newValue) {\n      var object = {};\n      object[name] = newValue;\n\n      _this.setState(object);\n    };\n\n    _this.handleSubmit = function (event) {\n      console.log('submitting..');\n      event.preventDefault();\n\n      if (!_this.validate()) {\n        return;\n      } // Prevent enter key from submitting form\n\n\n      if (event.keyCode === 13) {\n        event.preventDefault();\n        return false;\n      }\n\n      var object = {\n        loanId: _this.props.loan._id,\n        organization: _this.state.organization,\n        standardOffer: {\n          maxAmount: _toNumber(_this.state.maxAmount),\n          amortization: parseFloat(_this.state.amortization),\n          interestLibor: parseFloat(_this.state.libor_0) || undefined,\n          interest1: parseFloat(_this.state.interest1_0) || undefined,\n          interest2: parseFloat(_this.state.interest2_0) || undefined,\n          interest5: parseFloat(_this.state.interest5_0) || undefined,\n          interest10: parseFloat(_this.state.interest10_0) || undefined,\n          interest15: parseFloat(_this.state.interest15_0) || undefined\n        },\n        conditions: [_this.state.conditions]\n      };\n\n      if (_this.state.showCounterpart) {\n        object.counterpartOffer = {\n          maxAmount: _toNumber(_this.state.maxAmount),\n          amortization: parseFloat(_this.state.amortization),\n          interestLibor: parseFloat(_this.state.libor_1) || undefined,\n          interest1: parseFloat(_this.state.interest1_1) || undefined,\n          interest2: parseFloat(_this.state.interest2_1) || undefined,\n          interest5: parseFloat(_this.state.interest5_1) || undefined,\n          interest10: parseFloat(_this.state.interest10_1) || undefined,\n          interest15: parseFloat(_this.state.interest15_1) || undefined\n        };\n        object.counterparts = [_this.state.counterparts];\n      }\n\n      console.log(object);\n      cleanMethod(_this.props.method, {\n        object: object\n      }).then(_this.props.callback).catch(function (error) {\n        console.log('OfferForm error:', error);\n\n        if (!error) {\n          _this.props.callback();\n        }\n      });\n    };\n\n    _this.validate = function () {\n      var _this$state = _this.state,\n          showCounterpart = _this$state.showCounterpart,\n          counterparts = _this$state.counterparts;\n\n      if (showCounterpart && !counterparts) {\n        _this.setState({\n          error: 'Il faut des contreparties'\n        });\n\n        return false;\n      }\n\n      _this.setState({\n        error: ''\n      });\n\n      return true;\n    };\n\n    _this.state = {\n      showCounterpart: false,\n      organization: '',\n      maxAmount: '',\n      amortization: '',\n      libor_0: '',\n      interest1_0: '',\n      interest2_0: '',\n      interest5_0: '',\n      interest10_0: '',\n      interest15_0: '',\n      conditions: '',\n      counterparts: '',\n      libor_1: '',\n      interest1_1: '',\n      interest2_1: '',\n      interest5_1: '',\n      interest10_1: '',\n      interest15_1: '',\n      error: ''\n    };\n    return _this;\n  }\n\n  (0, _createClass3.default)(OfferForm, [{\n    key: \"render\",\n    value: function () {\n      function render() {\n        var _this2 = this;\n\n        var _props = this.props,\n            admin = _props.admin,\n            loan = _props.loan,\n            handleCancel = _props.handleCancel,\n            property = _props.property;\n        var _state = this.state,\n            organization = _state.organization,\n            conditions = _state.conditions,\n            maxAmount = _state.maxAmount,\n            amortization = _state.amortization,\n            showCounterpart = _state.showCounterpart,\n            counterparts = _state.counterparts,\n            error = _state.error;\n        return React.createElement(\n          \"article\",\n          {\n            className: \"flex-col\",\n            style: styles.article\n          },\n          React.createElement(\n            \"form\",\n            {\n              onSubmit: this.handleSubmit,\n              noValidate: true\n            },\n            admin && React.createElement(TextInput, {\n              id: \"organization\",\n              label: \"Institution *\",\n              placeholder: \"UBS\",\n              onChange: this.handleChange,\n              value: organization,\n              noIntl: true\n            }),\n            React.createElement(TextInput, {\n              id: \"conditions\",\n              label: \"Condition(s) minimum\",\n              placeholder: \"Laisser vide si pas de conditions\",\n              type: \"text\",\n              multiline: true,\n              rows: 3,\n              onChange: this.handleChange,\n              value: conditions,\n              noIntl: true\n            }),\n            React.createElement(\n              \"div\",\n              null,\n              React.createElement(TextInput, {\n                id: \"maxAmount\",\n                label: \"Pr\\xEAt Maximal *\",\n                placeholder: \"CHF \" + _toMoney(Math.round(property.value * 0.8)),\n                onChange: this.handleChange,\n                type: \"money\",\n                value: maxAmount,\n                noIntl: true\n              })\n            ),\n            React.createElement(\n              \"div\",\n              null,\n              React.createElement(TextInput, {\n                id: \"amortization\",\n                label: \"Amortissement *\",\n                placeholder: \"1%\",\n                onChange: this.handleChange,\n                type: \"percent\",\n                value: amortization,\n                noIntl: true\n              })\n            ),\n            React.createElement(\n              \"h4\",\n              {\n                className: \"text-center\",\n                style: styles.h4\n              },\n              \"Taux Standard\"\n            ),\n            React.createElement(\n              \"div\",\n              {\n                className: \"flex\",\n                style: {\n                  flexWrap: 'wrap'\n                }\n              },\n              getFormArray(0).map(function (_ref) {\n                var name = _ref.name,\n                    label = _ref.label;\n                return React.createElement(\n                  \"div\",\n                  {\n                    key: name,\n                    style: {\n                      marginRight: 8\n                    }\n                  },\n                  React.createElement(TextInput, {\n                    id: name,\n                    label: label // placeholder=\"1%\"\n                    ,\n                    type: \"percent\",\n                    onChange: _this2.handleChange,\n                    value: _this2.state[name],\n                    noIntl: true\n                  })\n                );\n              })\n            ),\n            React.createElement(Checkbox, {\n              label: \"Ajouter une offre avec contrepartie\",\n              style: styles.checkbox,\n              onChange: function () {\n                function onChange(_, newValue) {\n                  return _this2.setState({\n                    showCounterpart: newValue\n                  });\n                }\n\n                return onChange;\n              }(),\n              value: showCounterpart,\n              id: \"showCounterpart\"\n            }),\n            showCounterpart && React.createElement(\n              \"div\",\n              null,\n              React.createElement(\n                \"h4\",\n                {\n                  className: \"text-center\",\n                  style: styles.h4\n                },\n                \"Taux d'int\\xE9r\\xEAt avec contrepartie\"\n              ),\n              React.createElement(\n                \"div\",\n                null,\n                React.createElement(TextInput, {\n                  id: \"counterparts\",\n                  label: \"Contrepartie(s) sp\\xE9ciale(s) *\",\n                  placeholder: \"Gestion de Fortune, Assurance Voiture\",\n                  type: \"text\",\n                  multiline: true,\n                  fullWidth: true,\n                  rows: 3,\n                  onChange: this.handleChange,\n                  value: counterparts,\n                  noIntl: true\n                })\n              ),\n              React.createElement(\n                \"div\",\n                {\n                  className: \"flex\",\n                  style: {\n                    flexWrap: 'wrap'\n                  }\n                },\n                getFormArray(1).map(function (_ref2) {\n                  var name = _ref2.name,\n                      label = _ref2.label;\n                  return React.createElement(\n                    \"div\",\n                    {\n                      key: name,\n                      style: {\n                        marginRight: 8\n                      }\n                    },\n                    React.createElement(TextInput, {\n                      id: name,\n                      label: label,\n                      placeholder: \"1%\",\n                      type: \"percent\",\n                      fullWidth: true,\n                      onChange: _this2.handleChange,\n                      value: _this2.state[name],\n                      noIntl: true\n                    })\n                  );\n                })\n              )\n            ),\n            error && React.createElement(\n              \"div\",\n              {\n                className: \"description\"\n              },\n              React.createElement(\n                \"p\",\n                {\n                  className: \"error\"\n                },\n                error\n              )\n            ),\n            React.createElement(\n              \"div\",\n              {\n                style: styles.buttons\n              },\n              !!handleCancel && React.createElement(Button, {\n                raised: true,\n                label: \"Annuler\",\n                style: styles.button,\n                onClick: handleCancel\n              }),\n              React.createElement(Button, {\n                raised: true,\n                label: \"Envoyer\",\n                type: \"submit\",\n                primary: true\n              })\n            )\n          )\n        );\n      }\n\n      return render;\n    }()\n  }]);\n  return OfferForm;\n}(_Component);\n\nOfferForm.propTypes = {\n  callback: PropTypes.func.isRequired,\n  handleCancel: PropTypes.func,\n  method: PropTypes.string.isRequired,\n  admin: PropTypes.bool\n};\nOfferForm.defaultProps = {\n  handleCancel: undefined,\n  admin: false\n};","map":{"version":3,"sources":["imports/ui/components/OfferForm.jsx"],"names":["module","export","OfferForm","PropTypes","watch","require","v","React","Component","Button","Checkbox","TextInput","toMoney","toNumber","cleanMethod","styles","article","marginTop","buttons","textAlign","button","marginRight","h4","display","checkbox","margin","getFormArray","label","name","i","fix","parseFloat","val","undefined","props","handleChange","newValue","object","setState","handleSubmit","event","console","log","preventDefault","validate","keyCode","loanId","loan","_id","organization","state","standardOffer","maxAmount","amortization","interestLibor","libor_0","interest1","interest1_0","interest2","interest2_0","interest5","interest5_0","interest10","interest10_0","interest15","interest15_0","conditions","showCounterpart","counterpartOffer","libor_1","interest1_1","interest2_1","interest5_1","interest10_1","interest15_1","counterparts","method","then","callback","catch","error","admin","handleCancel","property","Math","round","value","flexWrap","map","_","propTypes","func","isRequired","string","bool","defaultProps"],"mappings":"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","file":"imports/ui/components/OfferForm.jsx.map","sourcesContent":["import PropTypes from 'prop-types';\nimport React, { Component } from 'react';\n\nimport Button from 'core/components/Button';\nimport Checkbox from 'core/components/Checkbox';\nimport TextInput from 'core/components/TextInput';\n\nimport { toMoney, toNumber } from 'core/utils/conversionFunctions';\nimport cleanMethod from 'core/api/cleanMethods';\n\nconst styles = {\n  article: {\n    marginTop: 40,\n  },\n  buttons: {\n    marginTop: 40,\n    textAlign: 'right',\n  },\n  button: {\n    marginRight: 16,\n  },\n  h4: {\n    marginTop: 40,\n    display: 'inline-block',\n  },\n  checkbox: {\n    margin: '20px 0',\n  },\n};\n\nconst getFormArray = i => [\n  {\n    label: 'Libor',\n    name: `libor_${i}`,\n  },\n  {\n    label: 'Fixe 1 an',\n    name: `interest1_${i}`,\n  },\n  {\n    label: 'Fixe 2 ans',\n    name: `interest2_${i}`,\n  },\n  {\n    label: 'Fixe 5 ans',\n    name: `interest5_${i}`,\n  },\n  {\n    label: 'Fixe 10 ans',\n    name: `interest10_${i}`,\n  },\n  {\n    label: 'Fixe 15 ans',\n    name: `interest15_${i}`,\n  },\n];\n\nconst fix = val => parseFloat(val) / 100 || undefined;\n\nexport default class OfferForm extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      showCounterpart: false,\n      organization: '',\n      maxAmount: '',\n      amortization: '',\n      libor_0: '',\n      interest1_0: '',\n      interest2_0: '',\n      interest5_0: '',\n      interest10_0: '',\n      interest15_0: '',\n      conditions: '',\n      counterparts: '',\n      libor_1: '',\n      interest1_1: '',\n      interest2_1: '',\n      interest5_1: '',\n      interest10_1: '',\n      interest15_1: '',\n      error: '',\n    };\n  }\n\n  handleChange = (name, newValue) => {\n    const object = {};\n    object[name] = newValue;\n    this.setState(object);\n  };\n\n  handleSubmit = (event) => {\n    console.log('submitting..');\n    event.preventDefault();\n\n    if (!this.validate()) {\n      return;\n    }\n\n    // Prevent enter key from submitting form\n    if (event.keyCode === 13) {\n      event.preventDefault();\n      return false;\n    }\n\n    const object = {\n      loanId: this.props.loan._id,\n      organization: this.state.organization,\n      standardOffer: {\n        maxAmount: toNumber(this.state.maxAmount),\n        amortization: parseFloat(this.state.amortization),\n        interestLibor: parseFloat(this.state.libor_0) || undefined,\n        interest1: parseFloat(this.state.interest1_0) || undefined,\n        interest2: parseFloat(this.state.interest2_0) || undefined,\n        interest5: parseFloat(this.state.interest5_0) || undefined,\n        interest10: parseFloat(this.state.interest10_0) || undefined,\n        interest15: parseFloat(this.state.interest15_0) || undefined,\n      },\n\n      conditions: [this.state.conditions],\n    };\n\n    if (this.state.showCounterpart) {\n      object.counterpartOffer = {\n        maxAmount: toNumber(this.state.maxAmount),\n        amortization: parseFloat(this.state.amortization),\n        interestLibor: parseFloat(this.state.libor_1) || undefined,\n        interest1: parseFloat(this.state.interest1_1) || undefined,\n        interest2: parseFloat(this.state.interest2_1) || undefined,\n        interest5: parseFloat(this.state.interest5_1) || undefined,\n        interest10: parseFloat(this.state.interest10_1) || undefined,\n        interest15: parseFloat(this.state.interest15_1) || undefined,\n      };\n\n      object.counterparts = [this.state.counterparts];\n    }\n\n    console.log(object);\n\n    cleanMethod(this.props.method, { object })\n      .then(this.props.callback)\n      .catch((error) => {\n        console.log('OfferForm error:', error);\n\n        if (!error) {\n          this.props.callback();\n        }\n      });\n  };\n\n  validate = () => {\n    const { showCounterpart, counterparts } = this.state;\n    if (showCounterpart && !counterparts) {\n      this.setState({ error: 'Il faut des contreparties' });\n      return false;\n    }\n\n    this.setState({ error: '' });\n    return true;\n  };\n\n  render() {\n    const { admin, loan, handleCancel, property } = this.props;\n    const {\n      organization,\n      conditions,\n      maxAmount,\n      amortization,\n      showCounterpart,\n      counterparts,\n      error,\n    } = this.state;\n\n    return (\n      <article className=\"flex-col\" style={styles.article}>\n        <form onSubmit={this.handleSubmit} noValidate>\n          {admin && (\n            <TextInput\n              id=\"organization\"\n              label=\"Institution *\"\n              placeholder=\"UBS\"\n              onChange={this.handleChange}\n              value={organization}\n              noIntl\n            />\n          )}\n\n          <TextInput\n            id=\"conditions\"\n            label=\"Condition(s) minimum\"\n            placeholder=\"Laisser vide si pas de conditions\"\n            type=\"text\"\n            multiline\n            rows={3}\n            onChange={this.handleChange}\n            value={conditions}\n            noIntl\n          />\n\n          <div>\n            <TextInput\n              id=\"maxAmount\"\n              label=\"Prêt Maximal *\"\n              placeholder={`CHF ${toMoney(Math.round(property.value * 0.8))}`}\n              onChange={this.handleChange}\n              type=\"money\"\n              value={maxAmount}\n              noIntl\n            />\n          </div>\n\n          <div>\n            <TextInput\n              id=\"amortization\"\n              label=\"Amortissement *\"\n              placeholder=\"1%\"\n              onChange={this.handleChange}\n              type=\"percent\"\n              value={amortization}\n              noIntl\n            />\n          </div>\n\n          <h4 className=\"text-center\" style={styles.h4}>\n            Taux Standard\n          </h4>\n\n          <div className=\"flex\" style={{ flexWrap: 'wrap' }}>\n            {getFormArray(0).map(({ name, label }) => (\n              <div key={name} style={{ marginRight: 8 }}>\n                <TextInput\n                  id={name}\n                  label={label}\n                  // placeholder=\"1%\"\n                  type=\"percent\"\n                  onChange={this.handleChange}\n                  value={this.state[name]}\n                  noIntl\n                />\n              </div>\n            ))}\n          </div>\n\n          <Checkbox\n            label=\"Ajouter une offre avec contrepartie\"\n            style={styles.checkbox}\n            onChange={(_, newValue) =>\n              this.setState({ showCounterpart: newValue })\n            }\n            value={showCounterpart}\n            id=\"showCounterpart\"\n          />\n\n          {showCounterpart && (\n            <div>\n              <h4 className=\"text-center\" style={styles.h4}>\n                Taux d'intérêt avec contrepartie\n              </h4>\n\n              <div>\n                <TextInput\n                  id=\"counterparts\"\n                  label=\"Contrepartie(s) spéciale(s) *\"\n                  placeholder=\"Gestion de Fortune, Assurance Voiture\"\n                  type=\"text\"\n                  multiline\n                  fullWidth\n                  rows={3}\n                  onChange={this.handleChange}\n                  value={counterparts}\n                  noIntl\n                />\n              </div>\n\n              <div className=\"flex\" style={{ flexWrap: 'wrap' }}>\n                {getFormArray(1).map(({ name, label }) => (\n                  <div key={name} style={{ marginRight: 8 }}>\n                    <TextInput\n                      id={name}\n                      label={label}\n                      placeholder=\"1%\"\n                      type=\"percent\"\n                      fullWidth\n                      onChange={this.handleChange}\n                      value={this.state[name]}\n                      noIntl\n                    />\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {error && (\n            <div className=\"description\">\n              <p className=\"error\">{error}</p>\n            </div>\n          )}\n\n          <div style={styles.buttons}>\n            {!!handleCancel && (\n              <Button\n                raised\n                label=\"Annuler\"\n                style={styles.button}\n                onClick={handleCancel}\n              />\n            )}\n            <Button raised label=\"Envoyer\" type=\"submit\" primary />\n          </div>\n        </form>\n      </article>\n    );\n  }\n}\n\nOfferForm.propTypes = {\n  callback: PropTypes.func.isRequired,\n  handleCancel: PropTypes.func,\n  method: PropTypes.string.isRequired,\n  admin: PropTypes.bool,\n};\n\nOfferForm.defaultProps = {\n  handleCancel: undefined,\n  admin: false,\n};\n"]},"hash":"77e586930fc8e6e68e828dde5621989f28cc0855"}
