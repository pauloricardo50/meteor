{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"packages/kadira:dochead/lib/both.js","filenameRelative":"packages/kadira:dochead/lib/both.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"packages/kadira:dochead/lib/both.js.map","sourceFileName":"packages/kadira:dochead/lib/both.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"both"},"ignored":false,"code":"var FlowRouter = null;\n\nif (Package['kadira:flow-router-ssr']) {\n  FlowRouter = Package['kadira:flow-router-ssr'].FlowRouter;\n}\n\nif (Meteor.isClient) {\n  var titleDependency = new Tracker.Dependency();\n}\n\nDocHead = {\n  currentTitle: null,\n  setTitle: function (title) {\n    if (Meteor.isClient) {\n      titleDependency.changed();\n      document.title = title;\n    } else {\n      this.currentTitle = title;\n      var titleHtml = \"<title>\" + title + \"</title>\";\n\n      this._addToHead(titleHtml);\n    }\n  },\n  addMeta: function (info) {\n    this._addTag(info, 'meta');\n  },\n  addLink: function (info) {\n    this._addTag(info, 'link');\n  },\n  getTitle: function () {\n    if (Meteor.isClient) {\n      titleDependency.depend();\n      return document.title;\n    }\n\n    return this.currentTitle;\n  },\n  addLdJsonScript: function (jsonObj) {\n    var strObj = JSON.stringify(jsonObj);\n\n    this._addLdJsonScript(strObj);\n  },\n  loadScript: function (url, options, callback) {\n    if (Meteor.isClient) {\n      npmLoadScript(url, options, callback);\n    }\n  },\n  _addTag: function (info, tag) {\n    var meta = this._buildTag(info, tag);\n\n    if (Meteor.isClient) {\n      document.getElementsByTagName('head')[0].insertAdjacentHTML('beforeend', meta);\n    } else {\n      this._addToHead(meta);\n    }\n  },\n  _addToHead: function (html) {\n    // only work there is kadira:flow-router-ssr\n    if (!FlowRouter) {\n      return;\n    }\n\n    var ssrContext = FlowRouter.ssrContext.get();\n\n    if (ssrContext) {\n      ssrContext.addToHead(html);\n    }\n  },\n  _buildTag: function (metaInfo, type) {\n    var props = \"\";\n\n    for (var key in meteorBabelHelpers.sanitizeForInObject(metaInfo)) {\n      props += key + \"=\\\"\" + metaInfo[key] + \"\\\" \";\n    }\n\n    props += 'dochead=\"1\"';\n    var meta = \"<\" + type + \" \" + props + \"/>\";\n    return meta;\n  },\n  _addLdJsonScript: function (stringifiedObject) {\n    var scriptTag = \"<script type=\\\"application/ld+json\\\" dochead=\\\"1\\\">\" + stringifiedObject + \"</script>\";\n\n    if (Meteor.isClient) {\n      document.getElementsByTagName('head')[0].insertAdjacentHTML('beforeend', scriptTag);\n    } else {\n      this._addToHead(scriptTag);\n    }\n  },\n  removeDocHeadAddedTags: function () {\n    if (Meteor.isClient) {\n      var elements = document.querySelectorAll('[dochead=\"1\"]'); // We use for-of here to loop only over iterable objects\n\n      for (var _iterator = elements, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {\n        var _ref;\n\n        if (_isArray) {\n          if (_i >= _iterator.length) break;\n          _ref = _iterator[_i++];\n        } else {\n          _i = _iterator.next();\n          if (_i.done) break;\n          _ref = _i.value;\n        }\n\n        var element = _ref;\n        element.parentNode.removeChild(element);\n      }\n    }\n  }\n};","map":{"version":3,"sources":["packages/kadira:dochead/lib/both.js"],"names":["FlowRouter","Package","Meteor","isClient","titleDependency","Tracker","Dependency","DocHead","currentTitle","setTitle","title","changed","document","titleHtml","_addToHead","addMeta","info","_addTag","addLink","getTitle","depend","addLdJsonScript","jsonObj","strObj","JSON","stringify","_addLdJsonScript","loadScript","url","options","callback","npmLoadScript","tag","meta","_buildTag","getElementsByTagName","insertAdjacentHTML","html","ssrContext","get","addToHead","metaInfo","type","props","key","stringifiedObject","scriptTag","removeDocHeadAddedTags","elements","querySelectorAll","element","parentNode","removeChild"],"mappings":"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","file":"packages/kadira:dochead/lib/both.js.map","sourcesContent":["var FlowRouter = null;\nif (Package['kadira:flow-router-ssr']) {\n  FlowRouter = Package['kadira:flow-router-ssr'].FlowRouter;\n}\n\nif (Meteor.isClient) {\n  var titleDependency = new Tracker.Dependency();\n}\n\nDocHead = {\n  currentTitle: null,\n  setTitle(title) {\n    if (Meteor.isClient) {\n      titleDependency.changed();\n      document.title = title;\n    } else {\n      this.currentTitle = title;\n      const titleHtml = `<title>${title}</title>`;\n      this._addToHead(titleHtml);\n    }\n  },\n  addMeta(info) {\n    this._addTag(info, 'meta');\n  },\n  addLink(info) {\n    this._addTag(info, 'link');\n  },\n  getTitle() {\n    if (Meteor.isClient) {\n      titleDependency.depend();\n      return document.title;\n    }\n    return this.currentTitle;\n  },\n  addLdJsonScript(jsonObj) {\n    const strObj = JSON.stringify(jsonObj);\n    this._addLdJsonScript(strObj);\n  },\n  loadScript(url, options, callback) {\n    if (Meteor.isClient) {\n      npmLoadScript(url, options, callback);\n    }\n  },\n  _addTag(info, tag) {\n    const meta = this._buildTag(info, tag);\n    if (Meteor.isClient) {\n      document.getElementsByTagName('head')[0].insertAdjacentHTML('beforeend', meta);\n    } else {\n      this._addToHead(meta);\n    }\n  },\n  _addToHead(html) {\n    // only work there is kadira:flow-router-ssr\n    if (!FlowRouter) {\n      return;\n    }\n    let ssrContext = FlowRouter.ssrContext.get();\n    if (ssrContext) {\n      ssrContext.addToHead(html);\n    }\n  },\n  _buildTag(metaInfo, type) {\n    let props = \"\";\n    for (let key in metaInfo) {\n      props += `${key}=\"${metaInfo[key]}\" `;\n    }\n    props += 'dochead=\"1\"';\n    var meta = `<${type} ${props}/>`;\n    return meta;\n  },\n  _addLdJsonScript(stringifiedObject) {\n    const scriptTag = `<script type=\"application/ld+json\" dochead=\"1\">${stringifiedObject}</script>`;\n    if (Meteor.isClient) {\n      document.getElementsByTagName('head')[0].insertAdjacentHTML('beforeend', scriptTag);\n    } else {\n      this._addToHead(scriptTag);\n    }\n  },\n  removeDocHeadAddedTags() {\n    if (Meteor.isClient) {\n      const elements = document.querySelectorAll('[dochead=\"1\"]');\n      // We use for-of here to loop only over iterable objects\n      for (let element of elements) {\n        element.parentNode.removeChild(element);\n      }\n    }\n  }\n};\n"]},"hash":"9ddf312037c21ad030c655f7d6460fe16b3a41ef"}
