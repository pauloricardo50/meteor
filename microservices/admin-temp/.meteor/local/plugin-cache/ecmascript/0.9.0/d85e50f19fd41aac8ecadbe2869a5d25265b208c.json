{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"../..","imported":["SecurityService","createMutator"],"specifiers":[{"kind":"named","imported":"SecurityService","local":"SecurityService"},{"kind":"named","imported":"createMutator","local":"createMutator"}]},{"source":"../TaskService","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"TaskService"}]},{"source":"../mutationDefinitions","imported":["*"],"specifiers":[{"kind":"namespace","local":"defs"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"imports/core/api/tasks/server/mutations.js","filenameRelative":"imports/core/api/tasks/server/mutations.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"useNativeAsyncAwait":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"imports/core/api/tasks/server/mutations.js.map","sourceFileName":"imports/core/api/tasks/server/mutations.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"mutations"},"ignored":false,"code":"\"use strict\";\n\nvar _SecurityService = void 0,\n    _createMutator = void 0;\n\nmodule.watch(require(\"../..\"), {\n  SecurityService: function SecurityService(v) {\n    _SecurityService = v;\n  },\n  createMutator: function createMutator(v) {\n    _createMutator = v;\n  }\n}, 0);\nvar TaskService = void 0;\nmodule.watch(require(\"../TaskService\"), {\n  default: function _default(v) {\n    TaskService = v;\n  }\n}, 1);\nvar defs = void 0;\nmodule.watch(require(\"../mutationDefinitions\"), {\n  \"*\": function _(v) {\n    defs = v;\n  }\n}, 2);\n\n_createMutator(defs.TASK_INSERT, function (_ref) {\n  var type = _ref.type;\n\n  _SecurityService.tasks.isAllowedToInsert();\n\n  return TaskService.insert({\n    type: type\n  });\n});\n\n_createMutator(defs.TASK_UPDATE, function (_ref2) {\n  var taskId = _ref2.taskId,\n      task = _ref2.task;\n\n  _SecurityService.tasks.isAllowedToUpdate();\n\n  return TaskService.insert({\n    taskId: taskId,\n    task: task\n  });\n});\n\n_createMutator(defs.TASK_COMPLETE, function (_ref3) {\n  var taskId = _ref3.taskId;\n\n  _SecurityService.tasks.isAllowedToUpdate(taskId);\n\n  return TaskService.complete({\n    taskId: taskId\n  });\n});\n\n_createMutator(defs.TASK_COMPLETE_BY_TYPE, function (_ref4) {\n  var type = _ref4.type,\n      loanId = _ref4.loanId,\n      newStatus = _ref4.newStatus;\n\n  _SecurityService.tasks.isAllowedToUpdate();\n\n  return TaskService.completeByType({\n    type: type,\n    loanId: loanId,\n    newStatus: newStatus\n  });\n});\n\n_createMutator(defs.TASK_CHANGE_STATUS, function (_ref5) {\n  var taskId = _ref5.taskId,\n      newStatus = _ref5.newStatus;\n\n  _SecurityService.tasks.isAllowedToUpdate(taskId);\n\n  return TaskService.changeStatus({\n    taskId: taskId,\n    newStatus: newStatus\n  });\n});\n\n_createMutator(defs.TASK_CHANGE_ASSIGNED_TO, function (_ref6) {\n  var taskId = _ref6.taskId,\n      newAssignee = _ref6.newAssignee;\n\n  _SecurityService.tasks.isAllowedToUpdate(taskId);\n\n  return TaskService.changeAssignedTo({\n    taskId: taskId,\n    newAssignee: newAssignee\n  });\n});\n\n_createMutator(defs.TASK_IS_RELATED_TO, function (_ref7) {\n  var task = _ref7.task,\n      userId = _ref7.userId;\n\n  _SecurityService.tasks.isAllowedToUpdate(task._id);\n\n  return TaskService.isRelatedTo({\n    task: task,\n    userId: userId\n  });\n});\n\n_createMutator(defs.TASK_GET_RELATED_TO, function (_ref8) {\n  var task = _ref8.task;\n\n  _SecurityService.tasks.isAllowedToUpdate(task._id);\n\n  return TaskService.getRelatedTo({\n    task: task\n  });\n});","map":{"version":3,"sources":["imports/core/api/tasks/server/mutations.js"],"names":["SecurityService","createMutator","module","watch","require","v","TaskService","default","defs","TASK_INSERT","type","tasks","isAllowedToInsert","insert","TASK_UPDATE","taskId","task","isAllowedToUpdate","TASK_COMPLETE","complete","TASK_COMPLETE_BY_TYPE","loanId","newStatus","completeByType","TASK_CHANGE_STATUS","changeStatus","TASK_CHANGE_ASSIGNED_TO","newAssignee","changeAssignedTo","TASK_IS_RELATED_TO","userId","_id","isRelatedTo","TASK_GET_RELATED_TO","getRelatedTo"],"mappings":"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","file":"imports/core/api/tasks/server/mutations.js.map","sourcesContent":["import { SecurityService, createMutator } from '../..';\nimport TaskService from '../TaskService';\nimport * as defs from '../mutationDefinitions';\n\ncreateMutator(defs.TASK_INSERT, ({ type }) => {\n  SecurityService.tasks.isAllowedToInsert();\n  return TaskService.insert({ type });\n});\n\ncreateMutator(defs.TASK_UPDATE, ({ taskId, task }) => {\n  SecurityService.tasks.isAllowedToUpdate();\n  return TaskService.insert({ taskId, task });\n});\n\ncreateMutator(defs.TASK_COMPLETE, ({ taskId }) => {\n  SecurityService.tasks.isAllowedToUpdate(taskId);\n  return TaskService.complete({ taskId });\n});\n\ncreateMutator(defs.TASK_COMPLETE_BY_TYPE, ({ type, loanId, newStatus }) => {\n  SecurityService.tasks.isAllowedToUpdate();\n  return TaskService.completeByType({ type, loanId, newStatus });\n});\n\ncreateMutator(defs.TASK_CHANGE_STATUS, ({ taskId, newStatus }) => {\n  SecurityService.tasks.isAllowedToUpdate(taskId);\n  return TaskService.changeStatus({ taskId, newStatus });\n});\n\ncreateMutator(defs.TASK_CHANGE_ASSIGNED_TO, ({ taskId, newAssignee }) => {\n  SecurityService.tasks.isAllowedToUpdate(taskId);\n  return TaskService.changeAssignedTo({ taskId, newAssignee });\n});\n\ncreateMutator(defs.TASK_IS_RELATED_TO, ({ task, userId }) => {\n  SecurityService.tasks.isAllowedToUpdate(task._id);\n  return TaskService.isRelatedTo({ task, userId });\n});\n\ncreateMutator(defs.TASK_GET_RELATED_TO, ({ task }) => {\n  SecurityService.tasks.isAllowedToUpdate(task._id);\n  return TaskService.getRelatedTo({ task });\n});\n"]},"hash":"d85e50f19fd41aac8ecadbe2869a5d25265b208c"}
