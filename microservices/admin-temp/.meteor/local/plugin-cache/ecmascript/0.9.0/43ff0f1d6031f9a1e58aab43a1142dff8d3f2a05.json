{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"meteor/meteor","imported":["Meteor"],"specifiers":[{"kind":"named","imported":"Meteor","local":"Meteor"}]},{"source":"../..","imported":["SecurityService","createMutator"],"specifiers":[{"kind":"named","imported":"SecurityService","local":"SecurityService"},{"kind":"named","imported":"createMutator","local":"createMutator"}]},{"source":"../BorrowerService","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"BorrowerService"}]},{"source":"../mutationDefinitions","imported":["*"],"specifiers":[{"kind":"namespace","local":"defs"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"imports/core/api/borrowers/server/mutations.js","filenameRelative":"imports/core/api/borrowers/server/mutations.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"useNativeAsyncAwait":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"imports/core/api/borrowers/server/mutations.js.map","sourceFileName":"imports/core/api/borrowers/server/mutations.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"mutations"},"ignored":false,"code":"\"use strict\";\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _SecurityService = void 0,\n    _createMutator = void 0;\n\nmodule.watch(require(\"../..\"), {\n  SecurityService: function SecurityService(v) {\n    _SecurityService = v;\n  },\n  createMutator: function createMutator(v) {\n    _createMutator = v;\n  }\n}, 1);\nvar BorrowerService = void 0;\nmodule.watch(require(\"../BorrowerService\"), {\n  default: function _default(v) {\n    BorrowerService = v;\n  }\n}, 2);\nvar defs = void 0;\nmodule.watch(require(\"../mutationDefinitions\"), {\n  \"*\": function _(v) {\n    defs = v;\n  }\n}, 3);\n\n_createMutator(defs.BORROWER_INSERT, function (_ref) {\n  var borrower = _ref.borrower,\n      userId = _ref.userId;\n  var userIdIsDefined = userId !== undefined;\n\n  if (userIdIsDefined) {\n    _SecurityService.checkCurrentUserIsAdmin();\n  } else {\n    _SecurityService.borrowers.isAllowedToInsert();\n  }\n\n  return BorrowerService.insert({\n    borrower: borrower,\n    userId: userIdIsDefined ? userId : _Meteor.userId()\n  });\n});\n\n_createMutator(defs.BORROWER_UPDATE, function (_ref2) {\n  var borrowerId = _ref2.borrowerId,\n      borrower = _ref2.borrower;\n\n  _SecurityService.borrowers.isAllowedToUpdate(borrowerId);\n\n  return BorrowerService.update({\n    borrowerId: borrowerId,\n    borrower: borrower\n  });\n});\n\n_createMutator(defs.BORROWER_DELETE, function (_ref3) {\n  var borrowerId = _ref3.borrowerId;\n\n  _SecurityService.borrowers.isAllowedToDelete(borrowerId);\n\n  return BorrowerService.remove({\n    borrowerId: borrowerId\n  });\n});","map":{"version":3,"sources":["imports/core/api/borrowers/server/mutations.js"],"names":["Meteor","module","watch","require","v","SecurityService","createMutator","BorrowerService","default","defs","BORROWER_INSERT","borrower","userId","userIdIsDefined","undefined","checkCurrentUserIsAdmin","borrowers","isAllowedToInsert","insert","BORROWER_UPDATE","borrowerId","isAllowedToUpdate","update","BORROWER_DELETE","isAllowedToDelete","remove"],"mappings":";;AAAA,IAAIA,gBAAJ;;AAAWC,OAAOC,KAAP,CAAaC,QAAQ,eAAR,CAAb,EAAsC;AAACH,QAAD,kBAAQI,CAAR,EAAU;AAACJ,cAAOI,CAAP;AAAS;AAApB,CAAtC,EAA4D,CAA5D;;AAA+D,IAAIC,yBAAJ;AAAA,IAAoBC,uBAApB;;AAAkCL,OAAOC,KAAP,CAAaC,QAAQ,OAAR,CAAb,EAA8B;AAACE,iBAAD,2BAAiBD,CAAjB,EAAmB;AAACC,uBAAgBD,CAAhB;AAAkB,GAAtC;AAAuCE,eAAvC,yBAAqDF,CAArD,EAAuD;AAACE,qBAAcF,CAAd;AAAgB;AAAxE,CAA9B,EAAwG,CAAxG;AAA2G,IAAIG,wBAAJ;AAAoBN,OAAOC,KAAP,CAAaC,QAAQ,oBAAR,CAAb,EAA2C;AAACK,SAAD,oBAASJ,CAAT,EAAW;AAACG,sBAAgBH,CAAhB;AAAkB;AAA9B,CAA3C,EAA2E,CAA3E;AAA8E,IAAIK,aAAJ;AAASR,OAAOC,KAAP,CAAaC,QAAQ,wBAAR,CAAb,EAA+C;AAAC,KAAD,aAAKC,CAAL,EAAO;AAACK,WAAKL,CAAL;AAAO;AAAf,CAA/C,EAAgE,CAAhE;;AAMlUE,eAAcG,KAAKC,eAAnB,EAAoC,gBAA0B;AAAA,MAAvBC,QAAuB,QAAvBA,QAAuB;AAAA,MAAbC,MAAa,QAAbA,MAAa;AAC5D,MAAMC,kBAAkBD,WAAWE,SAAnC;;AACA,MAAID,eAAJ,EAAqB;AACnBR,qBAAgBU,uBAAhB;AACD,GAFD,MAEO;AACLV,qBAAgBW,SAAhB,CAA0BC,iBAA1B;AACD;;AAED,SAAOV,gBAAgBW,MAAhB,CAAuB;AAC5BP,sBAD4B;AAE5BC,YAAQC,kBAAkBD,MAAlB,GAA2BZ,QAAOY,MAAP;AAFP,GAAvB,CAAP;AAID,CAZD;;AAcAN,eAAcG,KAAKU,eAAnB,EAAoC,iBAA8B;AAAA,MAA3BC,UAA2B,SAA3BA,UAA2B;AAAA,MAAfT,QAAe,SAAfA,QAAe;;AAChEN,mBAAgBW,SAAhB,CAA0BK,iBAA1B,CAA4CD,UAA5C;;AACA,SAAOb,gBAAgBe,MAAhB,CAAuB;AAAEF,0BAAF;AAAcT;AAAd,GAAvB,CAAP;AACD,CAHD;;AAKAL,eAAcG,KAAKc,eAAnB,EAAoC,iBAAoB;AAAA,MAAjBH,UAAiB,SAAjBA,UAAiB;;AACtDf,mBAAgBW,SAAhB,CAA0BQ,iBAA1B,CAA4CJ,UAA5C;;AACA,SAAOb,gBAAgBkB,MAAhB,CAAuB;AAAEL;AAAF,GAAvB,CAAP;AACD,CAHD","file":"imports/core/api/borrowers/server/mutations.js.map","sourcesContent":["import { Meteor } from 'meteor/meteor';\n\nimport { SecurityService, createMutator } from '../..';\nimport BorrowerService from '../BorrowerService';\nimport * as defs from '../mutationDefinitions';\n\ncreateMutator(defs.BORROWER_INSERT, ({ borrower, userId }) => {\n  const userIdIsDefined = userId !== undefined;\n  if (userIdIsDefined) {\n    SecurityService.checkCurrentUserIsAdmin();\n  } else {\n    SecurityService.borrowers.isAllowedToInsert();\n  }\n\n  return BorrowerService.insert({\n    borrower,\n    userId: userIdIsDefined ? userId : Meteor.userId(),\n  });\n});\n\ncreateMutator(defs.BORROWER_UPDATE, ({ borrowerId, borrower }) => {\n  SecurityService.borrowers.isAllowedToUpdate(borrowerId);\n  return BorrowerService.update({ borrowerId, borrower });\n});\n\ncreateMutator(defs.BORROWER_DELETE, ({ borrowerId }) => {\n  SecurityService.borrowers.isAllowedToDelete(borrowerId);\n  return BorrowerService.remove({ borrowerId });\n});\n"]},"hash":"43ff0f1d6031f9a1e58aab43a1142dff8d3f2a05"}
