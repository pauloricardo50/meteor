{"metadata":{"usedHelpers":["extends","interopRequireDefault"],"marked":[],"modules":{"imports":[{"source":"meteor/meteor","imported":["Meteor"],"specifiers":[{"kind":"named","imported":"Meteor","local":"Meteor"}]},{"source":"meteor/mdg:validated-method","imported":["ValidatedMethod"],"specifiers":[{"kind":"named","imported":"ValidatedMethod","local":"ValidatedMethod"}]},{"source":"meteor/check","imported":["check"],"specifiers":[{"kind":"named","imported":"check","local":"check"}]},{"source":"meteor/alanning:roles","imported":["Roles"],"specifiers":[{"kind":"named","imported":"Roles","local":"Roles"}]},{"source":"meteor/didericis:callpromise-mixin","imported":["CallPromiseMixin"],"specifiers":[{"kind":"named","imported":"CallPromiseMixin","local":"CallPromiseMixin"}]},{"source":"../../../utils/rate-limit.js","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"rateLimit"}]},{"source":"../borrowers","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"Borrowers"}]}],"exports":{"exported":["insertBorrower","updateBorrower","pushBorrowerValue","popBorrowerValue","deleteBorrower"],"specifiers":[{"kind":"local","local":"insertBorrower","exported":"insertBorrower"},{"kind":"local","local":"updateBorrower","exported":"updateBorrower"},{"kind":"local","local":"pushBorrowerValue","exported":"pushBorrowerValue"},{"kind":"local","local":"popBorrowerValue","exported":"popBorrowerValue"},{"kind":"local","local":"deleteBorrower","exported":"deleteBorrower"}]}}},"options":{"filename":"imports/core/api/borrowers/server/methods.js","filenameRelative":"imports/core/api/borrowers/server/methods.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"useNativeAsyncAwait":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"imports/core/api/borrowers/server/methods.js.map","sourceFileName":"imports/core/api/borrowers/server/methods.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"methods"},"ignored":false,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.insertBorrower = undefined;\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.export({\n  insertBorrower: function insertBorrower() {\n    return _insertBorrower;\n  },\n  updateBorrower: function updateBorrower() {\n    return _updateBorrower;\n  },\n  pushBorrowerValue: function pushBorrowerValue() {\n    return _pushBorrowerValue;\n  },\n  popBorrowerValue: function popBorrowerValue() {\n    return _popBorrowerValue;\n  },\n  deleteBorrower: function deleteBorrower() {\n    return _deleteBorrower;\n  }\n});\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _ValidatedMethod = void 0;\n\nmodule.watch(require(\"meteor/mdg:validated-method\"), {\n  ValidatedMethod: function ValidatedMethod(v) {\n    _ValidatedMethod = v;\n  }\n}, 1);\n\nvar _check = void 0;\n\nmodule.watch(require(\"meteor/check\"), {\n  check: function check(v) {\n    _check = v;\n  }\n}, 2);\n\nvar _Roles = void 0;\n\nexports.insertBorrower = _insertBorrower;\nmodule.watch(require(\"meteor/alanning:roles\"), {\n  Roles: function Roles(v) {\n    _Roles = v;\n  }\n}, 3);\n\nvar _CallPromiseMixin = void 0;\n\nmodule.watch(require(\"meteor/didericis:callpromise-mixin\"), {\n  CallPromiseMixin: function CallPromiseMixin(v) {\n    _CallPromiseMixin = v;\n  }\n}, 4);\nvar rateLimit = void 0;\nmodule.watch(require(\"../../../utils/rate-limit.js\"), {\n  default: function _default(v) {\n    rateLimit = v;\n  }\n}, 5);\nvar Borrowers = void 0;\nmodule.watch(require(\"../borrowers\"), {\n  default: function _default(v) {\n    Borrowers = v;\n  }\n}, 6);\n\nvar _insertBorrower = new _ValidatedMethod({\n  name: 'insertBorrower',\n  mixins: [_CallPromiseMixin],\n  validate: function validate() {},\n  run: function run(_ref) {\n    var object = _ref.object,\n        userId = _ref.userId;\n    return Borrowers.insert((0, _extends3.default)({}, object, {\n      // Allow null as userId\n      userId: userId === undefined ? _Meteor.userId() : userId\n    }));\n  }\n}); // Lets you set an entire object in the document\n\n\nvar _updateBorrower = new _ValidatedMethod({\n  name: 'updateBorrower',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref2) {\n    var id = _ref2.id;\n\n    _check(id, String);\n  },\n  run: function run(_ref3) {\n    var object = _ref3.object,\n        id = _ref3.id;\n    return Borrowers.update(id, {\n      $set: object\n    });\n  }\n});\n\nvar _pushBorrowerValue = new _ValidatedMethod({\n  name: 'pushBorrowerValue',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref4) {\n    var id = _ref4.id;\n\n    _check(id, String);\n  },\n  run: function run(_ref5) {\n    var object = _ref5.object,\n        id = _ref5.id;\n    return Borrowers.update(id, {\n      $push: object\n    });\n  }\n});\n\nvar _popBorrowerValue = new _ValidatedMethod({\n  name: 'popBorrowerValue',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref6) {\n    var id = _ref6.id;\n\n    _check(id, String);\n  },\n  run: function run(_ref7) {\n    var object = _ref7.object,\n        id = _ref7.id;\n    return Borrowers.update(id, {\n      $pop: object\n    }, {\n      getAutoValues: false\n    });\n  }\n});\n\nvar _deleteBorrower = new _ValidatedMethod({\n  name: 'deleteBorrower',\n  mixins: [_CallPromiseMixin],\n  validate: function validate(_ref8) {\n    var id = _ref8.id;\n\n    _check(id, String);\n  },\n  run: function run(_ref9) {\n    var id = _ref9.id;\n\n    if (_Roles.userIsInRole(_Meteor.userId(), 'dev')) {\n      return Borrowers.remove(id);\n    }\n\n    return false;\n  }\n});\n\nrateLimit({\n  methods: [_insertBorrower, _updateBorrower, _pushBorrowerValue, _popBorrowerValue, _deleteBorrower]\n});","map":{"version":3,"sources":["imports/core/api/borrowers/server/methods.js"],"names":["module","export","insertBorrower","updateBorrower","pushBorrowerValue","popBorrowerValue","deleteBorrower","Meteor","watch","require","v","ValidatedMethod","check","Roles","CallPromiseMixin","rateLimit","default","Borrowers","name","mixins","validate","run","object","userId","insert","undefined","id","String","update","$set","$push","$pop","getAutoValues","userIsInRole","remove","methods"],"mappings":"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","file":"imports/core/api/borrowers/server/methods.js.map","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { ValidatedMethod } from 'meteor/mdg:validated-method';\nimport { check } from 'meteor/check';\nimport { Roles } from 'meteor/alanning:roles';\nimport { CallPromiseMixin } from 'meteor/didericis:callpromise-mixin';\nimport rateLimit from '../../../utils/rate-limit.js';\n\nimport Borrowers from '../borrowers';\n\nexport const insertBorrower = new ValidatedMethod({\n  name: 'insertBorrower',\n  mixins: [CallPromiseMixin],\n  validate() {},\n  run({ object, userId }) {\n    return Borrowers.insert({\n      ...object,\n      // Allow null as userId\n      userId: userId === undefined ? Meteor.userId() : userId,\n    });\n  },\n});\n\n// Lets you set an entire object in the document\nexport const updateBorrower = new ValidatedMethod({\n  name: 'updateBorrower',\n  mixins: [CallPromiseMixin],\n  validate({ id }) {\n    check(id, String);\n  },\n  run({ object, id }) {\n    return Borrowers.update(id, { $set: object });\n  },\n});\n\n// Lets you push a value to an array\nexport const pushBorrowerValue = new ValidatedMethod({\n  name: 'pushBorrowerValue',\n  mixins: [CallPromiseMixin],\n  validate({ id }) {\n    check(id, String);\n  },\n  run({ object, id }) {\n    return Borrowers.update(id, { $push: object });\n  },\n});\n\n// Lets you pop a value from the end of an array\nexport const popBorrowerValue = new ValidatedMethod({\n  name: 'popBorrowerValue',\n  mixins: [CallPromiseMixin],\n  validate({ id }) {\n    check(id, String);\n  },\n  run({ object, id }) {\n    return Borrowers.update(id, { $pop: object }, { getAutoValues: false });\n  },\n});\n\nexport const deleteBorrower = new ValidatedMethod({\n  name: 'deleteBorrower',\n  mixins: [CallPromiseMixin],\n  validate({ id }) {\n    check(id, String);\n  },\n  run({ id }) {\n    if (Roles.userIsInRole(Meteor.userId(), 'dev')) {\n      return Borrowers.remove(id);\n    }\n\n    return false;\n  },\n});\n\nrateLimit({\n  methods: [\n    insertBorrower,\n    updateBorrower,\n    pushBorrowerValue,\n    popBorrowerValue,\n    deleteBorrower,\n  ],\n});\n"]},"hash":"cc56debf0e8d2c4ab33bc9220b7b6f091317d51b"}
