{"metadata":{"usedHelpers":["inherits","possibleConstructorReturn","createClass","classCallCheck","defineProperty","objectWithoutProperties","extends","interopRequireDefault"],"marked":[],"modules":{"imports":[{"source":"prop-types","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"PropTypes"}]},{"source":"react","imported":["default","Component"],"specifiers":[{"kind":"named","imported":"default","local":"React"},{"kind":"named","imported":"Component","local":"Component"}]},{"source":"../../api/cleanMethods","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"cleanMethod"}]},{"source":"../Translation","imported":["T"],"specifiers":[{"kind":"named","imported":"T","local":"T"}]},{"source":"../Select","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"Select"}]},{"source":"./ValidIcon","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"ValidIcon"}]},{"source":"./FormValidator","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"FormValidator"}]}],"exports":{"exported":["SelectFieldInput"],"specifiers":[{"kind":"local","local":"SelectFieldInput","exported":"default"}]}}},"options":{"filename":"imports/core/components/AutoForm/SelectFieldInput.jsx","filenameRelative":"imports/core/components/AutoForm/SelectFieldInput.jsx","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"useNativeAsyncAwait":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"imports/core/components/AutoForm/SelectFieldInput.jsx.map","sourceFileName":"imports/core/components/AutoForm/SelectFieldInput.jsx","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"SelectFieldInput"},"ignored":false,"code":"\"use strict\";\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _objectWithoutProperties2 = require(\"babel-runtime/helpers/objectWithoutProperties\");\n\nvar _objectWithoutProperties3 = _interopRequireDefault(_objectWithoutProperties2);\n\nvar _defineProperty2 = require(\"babel-runtime/helpers/defineProperty\");\n\nvar _defineProperty3 = _interopRequireDefault(_defineProperty2);\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require(\"babel-runtime/helpers/createClass\");\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require(\"babel-runtime/helpers/possibleConstructorReturn\");\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require(\"babel-runtime/helpers/inherits\");\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.export({\n  default: function _default() {\n    return SelectFieldInput;\n  }\n});\nvar PropTypes = void 0;\nmodule.watch(require(\"prop-types\"), {\n  default: function _default(v) {\n    PropTypes = v;\n  }\n}, 0);\n\nvar React = void 0,\n    _Component = void 0;\n\nmodule.watch(require(\"react\"), {\n  default: function _default(v) {\n    React = v;\n  },\n  Component: function Component(v) {\n    _Component = v;\n  }\n}, 1);\nvar cleanMethod = void 0;\nmodule.watch(require(\"../../api/cleanMethods\"), {\n  default: function _default(v) {\n    cleanMethod = v;\n  }\n}, 2);\n\nvar _T = void 0;\n\nmodule.watch(require(\"../Translation\"), {\n  T: function T(v) {\n    _T = v;\n  }\n}, 3);\nvar Select = void 0;\nmodule.watch(require(\"../Select\"), {\n  default: function _default(v) {\n    Select = v;\n  }\n}, 4);\nvar ValidIcon = void 0;\nmodule.watch(require(\"./ValidIcon\"), {\n  default: function _default(v) {\n    ValidIcon = v;\n  }\n}, 5);\nvar FormValidator = void 0;\nmodule.watch(require(\"./FormValidator\"), {\n  default: function _default(v) {\n    FormValidator = v;\n  }\n}, 6);\nvar styles = {\n  div: {\n    position: 'relative'\n  },\n  savingIcon: {\n    position: 'absolute',\n    top: 16,\n    right: -25\n  }\n};\n\nvar SelectFieldInput = function (_Component2) {\n  (0, _inherits3.default)(SelectFieldInput, _Component2);\n\n  function SelectFieldInput(props) {\n    (0, _classCallCheck3.default)(this, SelectFieldInput);\n\n    var _this = (0, _possibleConstructorReturn3.default)(this, (SelectFieldInput.__proto__ || Object.getPrototypeOf(SelectFieldInput)).call(this, props));\n\n    _this.handleChange = function (_, value) {\n      _this.setState({\n        value: value\n      }, function () {\n        return _this.saveValue();\n      });\n    };\n\n    _this.saveValue = function () {\n      var _this$props = _this.props,\n          id = _this$props.inputProps.id,\n          updateFunc = _this$props.updateFunc,\n          docId = _this$props.docId;\n      var value = _this.state.value;\n      var object = (0, _defineProperty3.default)({}, id, value);\n      cleanMethod(updateFunc, {\n        object: object,\n        id: docId\n      }).then(function (result) // on success, set saving briefly to true, before setting it to false again to trigger icon\n      {\n        _this.setState({\n          errorText: '',\n          saving: true\n        }, _this.setState({\n          saving: false\n        }));\n      }).catch(function (error) {\n        _this.setState({\n          saving: false,\n          errorText: error.message\n        });\n      });\n    };\n\n    _this.mapOptions = function () {\n      return _this.props.inputProps.options.map(function (_ref) {\n        var id = _ref.id,\n            intlId = _ref.intlId,\n            intlValues = _ref.intlValues,\n            label = _ref.label,\n            otherProps = (0, _objectWithoutProperties3.default)(_ref, [\"id\", \"intlId\", \"intlValues\", \"label\"]);\n        return (0, _extends3.default)({\n          label: label || React.createElement(_T, {\n            id: \"Forms.\" + (intlId || _this.props.inputProps.id) + \".\" + id,\n            values: intlValues\n          }),\n          id: id\n        }, otherProps);\n      });\n    };\n\n    _this.state = {\n      value: _this.props.inputProps.currentValue || null,\n      errorText: '',\n      saving: false\n    };\n    return _this;\n  }\n\n  (0, _createClass3.default)(SelectFieldInput, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _props = this.props,\n          _props$inputProps = _props.inputProps,\n          style = _props$inputProps.style,\n          label = _props$inputProps.label,\n          disabled = _props$inputProps.disabled,\n          options = _props$inputProps.options,\n          noValidator = _props$inputProps.noValidator,\n          id = _props$inputProps.id,\n          required = _props$inputProps.required,\n          admin = _props.admin;\n      var _state = this.state,\n          value = _state.value,\n          saving = _state.saving,\n          errorText = _state.errorText;\n      return React.createElement(\n        \"div\",\n        {\n          style: (0, _extends3.default)({}, styles.div, style)\n        },\n        React.createElement(Select, {\n          id: id,\n          label: label,\n          value: value || null,\n          onChange: this.handleChange,\n          style: (0, _extends3.default)({}, style, {\n            marginBottom: 8\n          }),\n          disabled: disabled,\n          renderValue: function renderValue(val) {\n            return _this2.mapOptions().find(function (o) {\n              return o.id === val;\n            }).label;\n          },\n          options: this.mapOptions()\n        }),\n        React.createElement(ValidIcon, {\n          saving: saving,\n          error: errorText !== '',\n          style: styles.savingIcon,\n          value: value,\n          required: required,\n          hide: admin\n        }),\n        !noValidator && React.createElement(FormValidator, this.props)\n      );\n    }\n  }]);\n  return SelectFieldInput;\n}(_Component);\n\nSelectFieldInput.propTypes = {\n  currentValue: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  docId: PropTypes.string.isRequired,\n  updateFunc: PropTypes.string.isRequired,\n  inputProps: PropTypes.shape({\n    label: PropTypes.node.isRequired,\n    disabled: PropTypes.bool,\n    options: PropTypes.arrayOf(PropTypes.object).isRequired,\n    id: PropTypes.string.isRequired\n  }).isRequired\n};\nSelectFieldInput.defaultProps = {\n  currentValue: undefined,\n  disabled: false\n};","map":{"version":3,"sources":["imports/core/components/AutoForm/SelectFieldInput.jsx"],"names":["module","export","default","SelectFieldInput","PropTypes","watch","require","v","React","Component","cleanMethod","T","Select","ValidIcon","FormValidator","styles","div","position","savingIcon","top","right","props","handleChange","_","value","setState","saveValue","id","inputProps","updateFunc","docId","state","object","then","result","errorText","saving","catch","error","message","mapOptions","options","map","intlId","intlValues","label","otherProps","currentValue","style","disabled","noValidator","required","admin","marginBottom","find","o","val","propTypes","oneOfType","number","string","isRequired","shape","node","bool","arrayOf","defaultProps","undefined"],"mappings":"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","file":"imports/core/components/AutoForm/SelectFieldInput.jsx.map","sourcesContent":["import PropTypes from 'prop-types';\nimport React, { Component } from 'react';\n\nimport cleanMethod from 'core/api/cleanMethods';\nimport { T } from 'core/components/Translation';\nimport Select from 'core/components/Select';\nimport ValidIcon from './ValidIcon';\nimport FormValidator from './FormValidator';\n\nconst styles = {\n  div: {\n    position: 'relative',\n  },\n  savingIcon: {\n    position: 'absolute',\n    top: 16,\n    right: -25,\n  },\n};\n\nexport default class SelectFieldInput extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      value: this.props.inputProps.currentValue || null,\n      errorText: '',\n      saving: false,\n    };\n  }\n\n  handleChange = (_, value) => {\n    this.setState({ value }, () => this.saveValue());\n  };\n\n  saveValue = () => {\n    const { inputProps: { id }, updateFunc, docId } = this.props;\n    const { value } = this.state;\n    const object = { [id]: value };\n\n    cleanMethod(updateFunc, { object, id: docId })\n      .then((result) =>\n        // on success, set saving briefly to true, before setting it to false again to trigger icon\n      {\n        this.setState(\n          { errorText: '', saving: true },\n          this.setState({ saving: false }),\n        );\n      })\n      .catch((error) => {\n        this.setState({ saving: false, errorText: error.message });\n      });\n  };\n\n  mapOptions = () =>\n    this.props.inputProps.options.map(({ id, intlId, intlValues, label, ...otherProps }) => ({\n      label: label || (\n        <T\n          id={`Forms.${intlId || this.props.inputProps.id}.${id}`}\n          values={intlValues}\n        />\n      ),\n      id,\n      ...otherProps,\n    }));\n\n  render() {\n    const {\n      inputProps: {\n        style,\n        label,\n        disabled,\n        options,\n        noValidator,\n        id,\n        required,\n      },\n      admin,\n    } = this.props;\n    const { value, saving, errorText } = this.state;\n\n    return (\n      <div style={{ ...styles.div, ...style }}>\n        <Select\n          id={id}\n          label={label}\n          value={value || null}\n          onChange={this.handleChange}\n          style={{ ...style, marginBottom: 8 }}\n          disabled={disabled}\n          renderValue={val => this.mapOptions().find(o => o.id === val).label}\n          options={this.mapOptions()}\n        />\n        <ValidIcon\n          saving={saving}\n          error={errorText !== ''}\n          style={styles.savingIcon}\n          value={value}\n          required={required}\n          hide={admin}\n        />\n        {!noValidator && <FormValidator {...this.props} />}\n      </div>\n    );\n  }\n}\n\nSelectFieldInput.propTypes = {\n  currentValue: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  docId: PropTypes.string.isRequired,\n  updateFunc: PropTypes.string.isRequired,\n  inputProps: PropTypes.shape({\n    label: PropTypes.node.isRequired,\n    disabled: PropTypes.bool,\n    options: PropTypes.arrayOf(PropTypes.object).isRequired,\n    id: PropTypes.string.isRequired,\n  }).isRequired,\n};\n\nSelectFieldInput.defaultProps = {\n  currentValue: undefined,\n  disabled: false,\n};\n"]},"hash":"5dc968b61fcdc76c3c81d02b6a1249874335cf4e"}
