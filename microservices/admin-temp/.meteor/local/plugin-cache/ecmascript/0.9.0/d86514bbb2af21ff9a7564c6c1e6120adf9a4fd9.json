{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"meteor/okgrow:analytics","imported":["analytics"],"specifiers":[{"kind":"named","imported":"analytics","local":"analytics"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"packages/okgrow:analytics/examples/iron-router/iron-router.js","filenameRelative":"packages/okgrow:analytics/examples/iron-router/iron-router.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"packages/okgrow:analytics/examples/iron-router/iron-router.js.map","sourceFileName":"packages/okgrow:analytics/examples/iron-router/iron-router.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"iron-router"},"ignored":false,"code":"var analytics = void 0;\nmodule.watch(require(\"meteor/okgrow:analytics\"), {\n  analytics: function (v) {\n    analytics = v;\n  }\n}, 0);\n\n// eslint-disable-line import/no-extraneous-dependencies, import/extensions\nif (Meteor.isClient) {\n  Router.route('/', function () {\n    function routeRoot() {\n      this.layout('mainLayout');\n      this.render('one');\n    }\n\n    return routeRoot;\n  }(), {\n    name: 'home'\n  });\n  Router.route('/one', function () {\n    function routeOne() {\n      this.layout('mainLayout');\n      this.render('one');\n    }\n\n    return routeOne;\n  }(), {\n    name: 'one'\n  });\n  Router.route('/two', function () {\n    function routeTwo() {\n      this.layout('mainLayout');\n      this.render('two');\n    }\n\n    return routeTwo;\n  }(), {\n    name: 'two'\n  });\n  Router.route('/three', function () {\n    function routeThree() {\n      this.layout('mainLayout');\n      this.render('three');\n    }\n\n    return routeThree;\n  }(), {\n    name: 'three'\n  });\n  Template.mainLayout.onCreated(function () {\n    function mainLayoutOnCreated() {\n      Meteor.subscribe('oauthInfo');\n      var self = this;\n      self.log = new ReactiveVar([]);\n      self.currentIdentity = new ReactiveVar('No Identity Set'); // We don't want to register analytics if it has been blocked by an adblocker.\n\n      if (typeof analytics === 'undefined') return;\n      self.currentIdentity.set(analytics._user._getTraits().email || 'No Identity Set');\n      analytics.on('page', function (event, properties, options) {\n        var latest = self.log.get();\n        latest.push(\"Page: \" + options.path);\n        self.log.set(latest);\n      });\n      analytics.on('identify', function (event, properties) {\n        var latest = self.log.get();\n        latest.push(\"Identify: \" + properties.email);\n        self.log.set(latest);\n        self.currentIdentity.set(properties.email);\n      });\n      analytics.on('track', function (event) {\n        var latest = self.log.get();\n        latest.push(\"Track: \" + event);\n        self.log.set(latest);\n      });\n    }\n\n    return mainLayoutOnCreated;\n  }());\n  Template.mainLayout.helpers({\n    log: function () {\n      return Template.instance().log.get();\n    },\n    currentIdentity: function () {\n      return Template.instance().currentIdentity.get();\n    },\n    isOauth: function () {\n      var user = Meteor.user();\n      var message = 'Not Signed In.';\n\n      if (user && user.services) {\n        if (user.services.facebook) {\n          message = \"Signed in with Facebook as \" + user.services.facebook.name + \" (\" + user.services.facebook.email + \")\";\n        } else if (user.services.github) {\n          message = \"Signed in with Github as \" + user.services.github.username + \" (\" + user.services.github.email + \")\";\n        } else if (user.services.google) {\n          message = \"Signed in with Google as \" + user.services.google.name + \" (\" + user.services.google.email + \")\";\n        }\n      } else if (user) {\n        message = 'Not an oauth login';\n      }\n\n      return message;\n    }\n  });\n  Template.mainLayout.onRendered(function () {\n    function mainLayoutOnRendered() {\n      Tracker.autorun(function () {\n        document.title = Router.current().route.getName();\n      });\n    }\n\n    return mainLayoutOnRendered;\n  }());\n}\n\nif (Meteor.isServer) {\n  Meteor.publish('oauthInfo', function () {\n    function publishOAuthInfo() {\n      return Meteor.users.find({\n        _id: this.userId\n      }, {\n        fields: {\n          'services.facebook.name': 1,\n          'services.facebook.email': 1,\n          'services.github.username': 1,\n          'services.github.email': 1,\n          'services.google.name': 1,\n          'services.google.email': 1\n        }\n      });\n    }\n\n    return publishOAuthInfo;\n  }());\n}","map":{"version":3,"sources":["packages/okgrow:analytics/examples/iron-router/iron-router.js"],"names":["analytics","module","watch","require","v","Meteor","isClient","Router","route","routeRoot","layout","render","name","routeOne","routeTwo","routeThree","Template","mainLayout","onCreated","mainLayoutOnCreated","subscribe","self","log","ReactiveVar","currentIdentity","set","_user","_getTraits","email","on","event","properties","options","latest","get","push","path","helpers","instance","isOauth","user","message","services","facebook","github","username","google","onRendered","mainLayoutOnRendered","Tracker","autorun","document","title","current","getName","isServer","publish","publishOAuthInfo","users","find","_id","userId","fields"],"mappings":"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","file":"packages/okgrow:analytics/examples/iron-router/iron-router.js.map","sourcesContent":["import { analytics } from 'meteor/okgrow:analytics'; // eslint-disable-line import/no-extraneous-dependencies, import/extensions\n\nif (Meteor.isClient) {\n  Router.route('/', function routeRoot() {\n    this.layout('mainLayout');\n    this.render('one');\n  }, {\n    name: 'home',\n  });\n\n  Router.route('/one', function routeOne() {\n    this.layout('mainLayout');\n    this.render('one');\n  }, {\n    name: 'one',\n  });\n\n  Router.route('/two', function routeTwo() {\n    this.layout('mainLayout');\n    this.render('two');\n  }, {\n    name: 'two',\n  });\n\n  Router.route('/three', function routeThree() {\n    this.layout('mainLayout');\n    this.render('three');\n  }, {\n    name: 'three',\n  });\n\n  Template.mainLayout.onCreated(function mainLayoutOnCreated() {\n    Meteor.subscribe('oauthInfo');\n    const self = this;\n    self.log = new ReactiveVar([]);\n    self.currentIdentity = new ReactiveVar('No Identity Set');\n\n    // We don't want to register analytics if it has been blocked by an adblocker.\n    if (typeof analytics === 'undefined') return;\n\n    self.currentIdentity.set(analytics._user._getTraits().email || 'No Identity Set');\n\n    analytics.on('page', (event, properties, options) => {\n      const latest = self.log.get();\n      latest.push(`Page: ${options.path}`);\n      self.log.set(latest);\n    });\n\n    analytics.on('identify', (event, properties) => {\n      const latest = self.log.get();\n      latest.push(`Identify: ${properties.email}`);\n      self.log.set(latest);\n      self.currentIdentity.set(properties.email);\n    });\n\n    analytics.on('track', (event) => {\n      const latest = self.log.get();\n      latest.push(`Track: ${event}`);\n      self.log.set(latest);\n    });\n  });\n\n  Template.mainLayout.helpers({\n    log() { return Template.instance().log.get(); },\n    currentIdentity() { return Template.instance().currentIdentity.get(); },\n    isOauth() {\n      const user = Meteor.user();\n      let message = 'Not Signed In.';\n      if (user && user.services) {\n        if (user.services.facebook) {\n          message = `Signed in with Facebook as ${user.services.facebook.name} (${user.services.facebook.email})`;\n        } else if (user.services.github) {\n          message = `Signed in with Github as ${user.services.github.username} (${user.services.github.email})`;\n        } else if (user.services.google) {\n          message = `Signed in with Google as ${user.services.google.name} (${user.services.google.email})`;\n        }\n      } else if (user) {\n        message = 'Not an oauth login';\n      }\n      return message;\n    },\n  });\n\n  Template.mainLayout.onRendered(function mainLayoutOnRendered() {\n    Tracker.autorun(() => {\n      document.title = Router.current().route.getName();\n    });\n  });\n}\n\nif (Meteor.isServer) {\n  Meteor.publish('oauthInfo', function publishOAuthInfo() {\n    return Meteor.users.find(\n      { _id: this.userId },\n      {\n        fields: {\n          'services.facebook.name': 1,\n          'services.facebook.email': 1,\n          'services.github.username': 1,\n          'services.github.email': 1,\n          'services.google.name': 1,\n          'services.google.email': 1,\n        },\n      },\n    );\n  });\n}\n"]},"hash":"d86514bbb2af21ff9a7564c6c1e6120adf9a4fd9"}
