{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[],"exports":{"exported":["node","maxDepth","getDepth","node"],"specifiers":[{"kind":"local","local":"node","exported":"default"},{"kind":"local","local":"maxDepth","exported":"default"},{"kind":"local","local":"getDepth","exported":"getDepth"},{"kind":"local","local":"node","exported":"node"}]}}},"options":{"filename":"packages/cultofcoders:grapher/lib/exposure/lib/enforceMaxDepth.js","filenameRelative":"packages/cultofcoders:grapher/lib/exposure/lib/enforceMaxDepth.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"packages/cultofcoders:grapher/lib/exposure/lib/enforceMaxDepth.js.map","sourceFileName":"packages/cultofcoders:grapher/lib/exposure/lib/enforceMaxDepth.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"enforceMaxDepth"},"ignored":false,"code":"module.export({\n    getDepth: function () {\n        return getDepth;\n    }\n});\nmodule.exportDefault(function (node, maxDepth) {\n    if (maxDepth === undefined) {\n        return node;\n    }\n\n    var depth = getDepth(node);\n\n    if (depth > maxDepth) {\n        throw new Meteor.Error('too-deep', 'Your graph request is too deep and it is not allowed.');\n    }\n\n    return node;\n});\n\nfunction getDepth(node) {\n    if (node.collectionNodes.length === 0) {\n        return 1;\n    }\n\n    return 1 + _.max(_.map(node.collectionNodes, getDepth));\n}","map":{"version":3,"sources":["packages/cultofcoders:grapher/lib/exposure/lib/enforceMaxDepth.js"],"names":["module","export","getDepth","exportDefault","node","maxDepth","undefined","depth","Meteor","Error","collectionNodes","length","_","max","map"],"mappings":"AAAAA,OAAOC,MAAP,CAAc;AAACC,cAAS;AAAA,eAAIA,QAAJ;AAAA;AAAV,CAAd;AAAAF,OAAOG,aAAP,CAAe,UAAUC,IAAV,EAAgBC,QAAhB,EAA0B;AACrC,QAAIA,aAAaC,SAAjB,EAA4B;AACxB,eAAOF,IAAP;AACH;;AAED,QAAMG,QAAQL,SAASE,IAAT,CAAd;;AAEA,QAAIG,QAAQF,QAAZ,EAAsB;AAClB,cAAM,IAAIG,OAAOC,KAAX,CAAiB,UAAjB,EAA6B,uDAA7B,CAAN;AACH;;AAED,WAAOL,IAAP;AACH,CAZD;;AAcO,SAASF,QAAT,CAAkBE,IAAlB,EAAwB;AAC3B,QAAIA,KAAKM,eAAL,CAAqBC,MAArB,KAAgC,CAApC,EAAuC;AACnC,eAAO,CAAP;AACH;;AAED,WAAO,IAAIC,EAAEC,GAAF,CACPD,EAAEE,GAAF,CAAMV,KAAKM,eAAX,EAA4BR,QAA5B,CADO,CAAX;AAGH","file":"packages/cultofcoders:grapher/lib/exposure/lib/enforceMaxDepth.js.map","sourcesContent":["export default function (node, maxDepth) {\n    if (maxDepth === undefined) {\n        return node;\n    }\n\n    const depth = getDepth(node);\n\n    if (depth > maxDepth) {\n        throw new Meteor.Error('too-deep', 'Your graph request is too deep and it is not allowed.')\n    }\n\n    return node;\n}\n\nexport function getDepth(node) {\n    if (node.collectionNodes.length === 0) {\n        return 1;\n    }\n\n    return 1 + _.max(\n        _.map(node.collectionNodes, getDepth)\n    );\n}"]},"hash":"7bce6039c6a16cbb0a2e78f9d6a845d37d3ad07a"}
