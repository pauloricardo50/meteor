{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"../../security","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"SecurityService"}]},{"source":"../../mutations","imported":["createMutator"],"specifiers":[{"kind":"named","imported":"createMutator","local":"createMutator"}]},{"source":"../LoanService","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"LoanService"}]},{"source":"../mutationDefinitions","imported":["*"],"specifiers":[{"kind":"namespace","local":"defs"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"imports/core/api/loans/server/mutations.js","filenameRelative":"imports/core/api/loans/server/mutations.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"useNativeAsyncAwait":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"imports/core/api/loans/server/mutations.js.map","sourceFileName":"imports/core/api/loans/server/mutations.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"mutations"},"ignored":false,"code":"\"use strict\";\n\nvar SecurityService = void 0;\nmodule.watch(require(\"../../security\"), {\n  default: function _default(v) {\n    SecurityService = v;\n  }\n}, 0);\n\nvar _createMutator = void 0;\n\nmodule.watch(require(\"../../mutations\"), {\n  createMutator: function createMutator(v) {\n    _createMutator = v;\n  }\n}, 1);\nvar LoanService = void 0;\nmodule.watch(require(\"../LoanService\"), {\n  default: function _default(v) {\n    LoanService = v;\n  }\n}, 2);\nvar defs = void 0;\nmodule.watch(require(\"../mutationDefinitions\"), {\n  \"*\": function _(v) {\n    defs = v;\n  }\n}, 3);\n\n_createMutator(defs.LOAN_INSERT, function (_ref) {\n  var object = _ref.object,\n      userId = _ref.userId;\n  SecurityService.loans.isAllowedToInsert();\n  return LoanService.insert({\n    object: object,\n    userId: userId\n  });\n});\n\n_createMutator(defs.LOAN_UPDATE, function (_ref2) {\n  var loanId = _ref2.loanId,\n      object = _ref2.object;\n  SecurityService.loans.isAllowedToUpdate(loanId);\n  return LoanService.update({\n    loanId: loanId,\n    object: object\n  });\n});\n\n_createMutator(defs.LOAN_DELETE, function (_ref3) {\n  var loanId = _ref3.loanId;\n  SecurityService.loans.isAllowedToDelete(loanId);\n  return LoanService.delete({\n    loanId: loanId\n  });\n});\n\n_createMutator(defs.INCREMENT_LOAN_STEP, function (_ref4) {\n  var loanId = _ref4.loanId;\n  SecurityService.loans.isAllowedToUpdate(loanId);\n  return LoanService.incrementStep({\n    loanId: loanId\n  });\n});\n\n_createMutator(defs.REQUEST_LOAN_VERIFICATION, function (_ref5) {\n  var loanId = _ref5.loanId;\n  SecurityService.loans.isAllowedToUpdate(loanId);\n  return LoanService.askVerification({\n    loanId: loanId\n  });\n});\n\n_createMutator(defs.START_AUCTION, function (_ref6) {\n  var loanId = _ref6.loanId;\n  SecurityService.loans.isAllowedToUpdate(loanId);\n  return LoanService.startAuction({\n    loanId: loanId\n  });\n});\n\n_createMutator(defs.END_AUCTION, function (_ref7) {\n  var loanId = _ref7.loanId;\n  SecurityService.checkCurrentUserIsAdmin();\n  return LoanService.startAuction({\n    loanId: loanId\n  });\n});\n\n_createMutator(defs.CANCEL_AUCTION, function (_ref8) {\n  var loanId = _ref8.loanId;\n  SecurityService.checkCurrentUserIsAdmin();\n  return LoanService.startAuction({\n    loanId: loanId\n  });\n});\n\n_createMutator(defs.CONFIRM_CLOSING, function (_ref9) {\n  var loanId = _ref9.loanId,\n      object = _ref9.object;\n  SecurityService.checkCurrentUserIsAdmin();\n  return LoanService.confirmClosing({\n    loanId: loanId,\n    object: object\n  });\n});","map":{"version":3,"sources":["imports/core/api/loans/server/mutations.js"],"names":["SecurityService","module","watch","require","default","v","createMutator","LoanService","defs","LOAN_INSERT","object","userId","loans","isAllowedToInsert","insert","LOAN_UPDATE","loanId","isAllowedToUpdate","update","LOAN_DELETE","isAllowedToDelete","delete","INCREMENT_LOAN_STEP","incrementStep","REQUEST_LOAN_VERIFICATION","askVerification","START_AUCTION","startAuction","END_AUCTION","checkCurrentUserIsAdmin","CANCEL_AUCTION","CONFIRM_CLOSING","confirmClosing"],"mappings":"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","file":"imports/core/api/loans/server/mutations.js.map","sourcesContent":["import SecurityService from '../../security';\nimport { createMutator } from '../../mutations';\nimport LoanService from '../LoanService';\nimport * as defs from '../mutationDefinitions';\n\ncreateMutator(defs.LOAN_INSERT, ({ object, userId }) => {\n  SecurityService.loans.isAllowedToInsert();\n  return LoanService.insert({ object, userId });\n});\n\ncreateMutator(defs.LOAN_UPDATE, ({ loanId, object }) => {\n  SecurityService.loans.isAllowedToUpdate(loanId);\n  return LoanService.update({ loanId, object });\n});\n\ncreateMutator(defs.LOAN_DELETE, ({ loanId }) => {\n  SecurityService.loans.isAllowedToDelete(loanId);\n  return LoanService.delete({ loanId });\n});\n\ncreateMutator(defs.INCREMENT_LOAN_STEP, ({ loanId }) => {\n  SecurityService.loans.isAllowedToUpdate(loanId);\n  return LoanService.incrementStep({ loanId });\n});\n\ncreateMutator(defs.REQUEST_LOAN_VERIFICATION, ({ loanId }) => {\n  SecurityService.loans.isAllowedToUpdate(loanId);\n  return LoanService.askVerification({ loanId });\n});\n\ncreateMutator(defs.START_AUCTION, ({ loanId }) => {\n  SecurityService.loans.isAllowedToUpdate(loanId);\n  return LoanService.startAuction({ loanId });\n});\n\ncreateMutator(defs.END_AUCTION, ({ loanId }) => {\n  SecurityService.checkCurrentUserIsAdmin();\n  return LoanService.startAuction({ loanId });\n});\n\ncreateMutator(defs.CANCEL_AUCTION, ({ loanId }) => {\n  SecurityService.checkCurrentUserIsAdmin();\n  return LoanService.startAuction({ loanId });\n});\n\ncreateMutator(defs.CONFIRM_CLOSING, ({ loanId, object }) => {\n  SecurityService.checkCurrentUserIsAdmin();\n  return LoanService.confirmClosing({ loanId, object });\n});\n"]},"hash":"5e8cc43fb2c02a12ec0bbd59e84e96a6314dd9be"}
