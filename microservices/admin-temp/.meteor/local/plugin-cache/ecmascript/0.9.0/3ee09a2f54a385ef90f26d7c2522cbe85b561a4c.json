{"metadata":{"usedHelpers":["inherits","possibleConstructorReturn","classCallCheck","interopRequireDefault"],"marked":[],"modules":{"imports":[{"source":"./base.js","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"Link"}]},{"source":"./lib/smartArguments.js","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"SmartArgs"}]}],"exports":{"exported":["LinkOneMeta"],"specifiers":[{"kind":"local","local":"LinkOneMeta","exported":"default"}]}}},"options":{"filename":"packages/cultofcoders:grapher/lib/links/linkTypes/linkOneMeta.js","filenameRelative":"packages/cultofcoders:grapher/lib/links/linkTypes/linkOneMeta.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"packages/cultofcoders:grapher/lib/links/linkTypes/linkOneMeta.js.map","sourceFileName":"packages/cultofcoders:grapher/lib/links/linkTypes/linkOneMeta.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"linkOneMeta"},"ignored":false,"code":"var _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _possibleConstructorReturn2 = require(\"babel-runtime/helpers/possibleConstructorReturn\");\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require(\"babel-runtime/helpers/inherits\");\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nmodule.export({\n    \"default\": function () {\n        return LinkOneMeta;\n    }\n});\nvar Link = void 0;\nmodule.watch(require(\"./base.js\"), {\n    \"default\": function (v) {\n        Link = v;\n    }\n}, 0);\nvar SmartArgs = void 0;\nmodule.watch(require(\"./lib/smartArguments.js\"), {\n    \"default\": function (v) {\n        SmartArgs = v;\n    }\n}, 1);\n\nvar LinkOneMeta = function (_Link) {\n    (0, _inherits3.default)(LinkOneMeta, _Link);\n\n    function LinkOneMeta() {\n        (0, _classCallCheck3.default)(this, LinkOneMeta);\n        return (0, _possibleConstructorReturn3.default)(this, _Link.apply(this, arguments));\n    }\n\n    LinkOneMeta.prototype.set = function () {\n        function set(what) {\n            var _$set;\n\n            var metadata = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n            if (this.isVirtual) {\n                this._virtualAction('set', what);\n\n                return this;\n            }\n\n            var field = this.linkStorageField;\n            metadata._id = this.identifyId(what, true);\n\n            this._validateIds([metadata._id]);\n\n            this.object[field] = metadata;\n            this.linker.mainCollection.update(this.object._id, {\n                $set: (_$set = {}, _$set[field] = metadata, _$set)\n            });\n            return this;\n        }\n\n        return set;\n    }();\n\n    LinkOneMeta.prototype.metadata = function () {\n        function metadata(extendMetadata) {\n            if (this.isVirtual) {\n                this._virtualAction('metadata', undefined, extendMetadata);\n\n                return this;\n            }\n\n            var field = this.linkStorageField;\n\n            if (!extendMetadata) {\n                return this.object[field];\n            } else {\n                var _$set2;\n\n                _.extend(this.object[field], extendMetadata);\n\n                this.linker.mainCollection.update(this.object._id, {\n                    $set: (_$set2 = {}, _$set2[field] = this.object[field], _$set2)\n                });\n            }\n\n            return this;\n        }\n\n        return metadata;\n    }();\n\n    LinkOneMeta.prototype.unset = function () {\n        function unset() {\n            var _$set3;\n\n            if (this.isVirtual) {\n                this._virtualAction('unset');\n\n                return this;\n            }\n\n            var field = this.linkStorageField;\n            this.object[field] = {};\n            this.linker.mainCollection.update(this.object._id, {\n                $set: (_$set3 = {}, _$set3[field] = {}, _$set3)\n            });\n            return this;\n        }\n\n        return unset;\n    }();\n\n    LinkOneMeta.prototype.add = function () {\n        function add(what, metadata) {\n            if (this.isVirtual) {\n                this._virtualAction('add', what, metadata);\n\n                return this;\n            }\n\n            throw new Meteor.Error('invalid-command', 'You are trying to *add* in a relationship that is single. Please use set/unset for *single* relationships');\n        }\n\n        return add;\n    }();\n\n    LinkOneMeta.prototype.remove = function () {\n        function remove(what) {\n            if (this.isVirtual) {\n                this._virtualAction('remove', what);\n\n                return this;\n            }\n\n            throw new Meteor.Error('invalid-command', 'You are trying to *remove* in a relationship that is single. Please use set/unset for *single* relationships');\n        }\n\n        return remove;\n    }();\n\n    return LinkOneMeta;\n}(Link);","map":{"version":3,"sources":["packages/cultofcoders:grapher/lib/links/linkTypes/linkOneMeta.js"],"names":["module","export","LinkOneMeta","Link","watch","require","v","SmartArgs","set","what","metadata","isVirtual","_virtualAction","field","linkStorageField","_id","identifyId","_validateIds","object","linker","mainCollection","update","$set","extendMetadata","undefined","_","extend","unset","add","Meteor","Error","remove"],"mappings":"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","file":"packages/cultofcoders:grapher/lib/links/linkTypes/linkOneMeta.js.map","sourcesContent":["import Link from './base.js';\nimport SmartArgs from './lib/smartArguments.js';\n\nexport default class LinkOneMeta extends Link {\n    set(what, metadata = {}) {\n        if (this.isVirtual) {\n            this._virtualAction('set', what);\n            return this;\n        }\n\n        let field = this.linkStorageField;\n        metadata._id = this.identifyId(what, true);\n        this._validateIds([metadata._id]);\n\n        this.object[field] = metadata;\n\n        this.linker.mainCollection.update(this.object._id, {\n            $set: {\n                [field]: metadata\n            }\n        });\n\n        return this;\n    }\n\n    metadata(extendMetadata) {\n        if (this.isVirtual) {\n            this._virtualAction('metadata', undefined, extendMetadata);\n\n            return this;\n        }\n\n        let field = this.linkStorageField;\n\n        if (!extendMetadata) {\n            return this.object[field];\n        } else {\n            _.extend(this.object[field], extendMetadata);\n\n            this.linker.mainCollection.update(this.object._id, {\n                $set: {\n                    [field]: this.object[field]\n                }\n            });\n        }\n\n        return this;\n    }\n\n    unset() {\n        if (this.isVirtual) {\n            this._virtualAction('unset');\n            return this;\n        }\n\n        let field = this.linkStorageField;\n        this.object[field] = {};\n\n        this.linker.mainCollection.update(this.object._id, {\n            $set: {\n                [field]: {}\n            }\n        });\n\n        return this;\n    }\n\n    add(what, metadata) {\n        if (this.isVirtual) {\n            this._virtualAction('add', what, metadata);\n            return this;\n        }\n\n        throw new Meteor.Error('invalid-command', 'You are trying to *add* in a relationship that is single. Please use set/unset for *single* relationships');\n    }\n\n    remove(what) {\n        if (this.isVirtual) {\n            this._virtualAction('remove', what);\n            return this;\n        }\n\n        throw new Meteor.Error('invalid-command', 'You are trying to *remove* in a relationship that is single. Please use set/unset for *single* relationships');\n    }\n}"]},"hash":"3ee09a2f54a385ef90f26d7c2522cbe85b561a4c"}
