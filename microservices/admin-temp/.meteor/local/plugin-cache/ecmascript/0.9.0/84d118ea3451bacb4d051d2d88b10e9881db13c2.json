{"metadata":{"usedHelpers":["extends","inherits","possibleConstructorReturn","classCallCheck","interopRequireDefault"],"marked":[],"modules":{"imports":[{"source":"react","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"React"}]},{"source":"meteor/react-meteor-data","imported":["createContainer"],"specifiers":[{"kind":"named","imported":"createContainer","local":"createContainer"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"packages/cultofcoders:grapher-react/legacy/createQueryContainer.js","filenameRelative":"packages/cultofcoders:grapher-react/legacy/createQueryContainer.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"packages/cultofcoders:grapher-react/legacy/createQueryContainer.js.map","sourceFileName":"packages/cultofcoders:grapher-react/legacy/createQueryContainer.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"createQueryContainer"},"ignored":false,"code":"var _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _possibleConstructorReturn2 = require(\"babel-runtime/helpers/possibleConstructorReturn\");\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require(\"babel-runtime/helpers/inherits\");\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _extends3 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends4 = _interopRequireDefault(_extends3);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar React = void 0;\nmodule.watch(require(\"react\"), {\n    \"default\": function (v) {\n        React = v;\n    }\n}, 0);\nvar createContainer = void 0;\nmodule.watch(require(\"meteor/react-meteor-data\"), {\n    createContainer: function (v) {\n        createContainer = v;\n    }\n}, 1);\nmodule.exportDefault(function (query, component) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    if (Meteor.isDevelopment) {\n        console.warn('createQueryContainer() is deprecated, please use withQuery() instead');\n    }\n\n    if (options.reactive) {\n        return createContainer(function (props) {\n            var _extends2;\n\n            if (props.params) {\n                query.setParams(props.params);\n            }\n\n            var handler = query.subscribe();\n            return (0, _extends4.default)((_extends2 = {\n                query: query,\n                loading: !handler.ready()\n            }, _extends2[options.dataProp] = options.single ? _.first(query.fetch()) : query.fetch(), _extends2), props);\n        }, component);\n    }\n\n    var MethodQueryComponent = function (_React$Component) {\n        (0, _inherits3.default)(MethodQueryComponent, _React$Component);\n\n        function MethodQueryComponent() {\n            var _this$state;\n\n            (0, _classCallCheck3.default)(this, MethodQueryComponent);\n\n            var _this = (0, _possibleConstructorReturn3.default)(this, _React$Component.call(this));\n\n            _this.state = (_this$state = {}, _this$state[options.dataProp] = undefined, _this$state.error = undefined, _this$state.loading = true, _this$state);\n            return _this;\n        }\n\n        MethodQueryComponent.prototype.componentWillReceiveProps = function () {\n            function componentWillReceiveProps(nextProps) {\n                this._fetch(nextProps.params);\n            }\n\n            return componentWillReceiveProps;\n        }();\n\n        MethodQueryComponent.prototype.componentDidMount = function () {\n            function componentDidMount() {\n                this._fetch(this.props.params);\n            }\n\n            return componentDidMount;\n        }();\n\n        MethodQueryComponent.prototype._fetch = function () {\n            function _fetch(params) {\n                var _this2 = this;\n\n                if (params) {\n                    query.setParams(params);\n                }\n\n                query.fetch(function (error, data) {\n                    var _state;\n\n                    var state = (_state = {\n                        error: error\n                    }, _state[options.dataProp] = options.single ? _.first(data) : data, _state.loading = false, _state);\n\n                    _this2.setState(state);\n                });\n            }\n\n            return _fetch;\n        }();\n\n        MethodQueryComponent.prototype.render = function () {\n            function render() {\n                var state = this.state,\n                    props = this.props;\n                return React.createElement(component, (0, _extends4.default)({\n                    query: query\n                }, state, props));\n            }\n\n            return render;\n        }();\n\n        return MethodQueryComponent;\n    }(React.Component);\n\n    MethodQueryComponent.propTypes = {\n        params: React.PropTypes.object\n    };\n    return MethodQueryComponent;\n});","map":{"version":3,"sources":["packages/cultofcoders:grapher-react/legacy/createQueryContainer.js"],"names":["React","module","watch","require","v","createContainer","exportDefault","query","component","options","Meteor","isDevelopment","console","warn","reactive","props","params","setParams","handler","subscribe","loading","ready","dataProp","single","_","first","fetch","MethodQueryComponent","state","undefined","error","componentWillReceiveProps","nextProps","_fetch","componentDidMount","data","setState","render","createElement","Component","propTypes","PropTypes","object"],"mappings":";;;;;;;;;;;;;;;;;;AAAA,IAAIA,cAAJ;AAAUC,OAAOC,KAAP,CAAaC,QAAQ,OAAR,CAAb,EAA8B;AAAA,yBAASC,CAAT,EAAW;AAACJ,gBAAMI,CAAN;AAAQ;AAApB,CAA9B,EAAoD,CAApD;AAAuD,IAAIC,wBAAJ;AAAoBJ,OAAOC,KAAP,CAAaC,QAAQ,0BAAR,CAAb,EAAiD;AAACE,mBAAD,YAAiBD,CAAjB,EAAmB;AAACC,0BAAgBD,CAAhB;AAAkB;AAAtC,CAAjD,EAAyF,CAAzF;AAArFH,OAAOK,aAAP,CAGe,UAACC,KAAD,EAAQC,SAAR,EAAoC;AAAA,QAAjBC,OAAiB,uEAAP,EAAO;;AAC/C,QAAIC,OAAOC,aAAX,EAA0B;AACtBC,gBAAQC,IAAR,CAAa,sEAAb;AACH;;AAED,QAAIJ,QAAQK,QAAZ,EAAsB;AAClB,eAAOT,gBAAgB,UAACU,KAAD,EAAW;AAAA;;AAC9B,gBAAIA,MAAMC,MAAV,EAAkB;AACdT,sBAAMU,SAAN,CAAgBF,MAAMC,MAAtB;AACH;;AAED,gBAAME,UAAUX,MAAMY,SAAN,EAAhB;AAEA;AACIZ,4BADJ;AAEIa,yBAAS,CAACF,QAAQG,KAAR;AAFd,yBAGKZ,QAAQa,QAHb,IAGwBb,QAAQc,MAAR,GAAiBC,EAAEC,KAAF,CAAQlB,MAAMmB,KAAN,EAAR,CAAjB,GAA0CnB,MAAMmB,KAAN,EAHlE,cAIOX,KAJP;AAMH,SAbM,EAaJP,SAbI,CAAP;AAcH;;AApB8C,QAsBzCmB,oBAtByC;AAAA;;AAuB3C,wCAAc;AAAA;;AAAA;;AAAA,uEACV,2BADU;;AAEV,kBAAKC,KAAL,kCACKnB,QAAQa,QADb,IACwBO,SADxB,cAEIC,KAFJ,GAEWD,SAFX,cAGIT,OAHJ,GAGa,IAHb;AAFU;AAOb;;AA9B0C,uCAgC3CW,yBAhC2C;AAAA,+CAgCjBC,SAhCiB,EAgCN;AACjC,qBAAKC,MAAL,CAAYD,UAAUhB,MAAtB;AACH;;AAlC0C;AAAA;;AAAA,uCAoC3CkB,iBApC2C;AAAA,yCAoCvB;AAChB,qBAAKD,MAAL,CAAY,KAAKlB,KAAL,CAAWC,MAAvB;AACH;;AAtC0C;AAAA;;AAAA,uCAwC3CiB,MAxC2C;AAAA,4BAwCpCjB,MAxCoC,EAwC5B;AAAA;;AACX,oBAAIA,MAAJ,EAAY;AACRT,0BAAMU,SAAN,CAAgBD,MAAhB;AACH;;AAEDT,sBAAMmB,KAAN,CAAY,UAACI,KAAD,EAAQK,IAAR,EAAiB;AAAA;;AACzB,wBAAMP;AACFE;AADE,8BAEDrB,QAAQa,QAFP,IAEkBb,QAAQc,MAAR,GAAiBC,EAAEC,KAAF,CAAQU,IAAR,CAAjB,GAAiCA,IAFnD,SAGFf,OAHE,GAGO,KAHP,SAAN;;AAMA,2BAAKgB,QAAL,CAAcR,KAAd;AACH,iBARD;AASH;;AAtD0C;AAAA;;AAAA,uCAwD3CS,MAxD2C;AAAA,8BAwDlC;AAAA,oBACET,KADF,GACkB,IADlB,CACEA,KADF;AAAA,oBACSb,KADT,GACkB,IADlB,CACSA,KADT;AAGL,uBAAOf,MAAMsC,aAAN,CAAoB9B,SAApB;AACHD;AADG,mBAEAqB,KAFA,EAGAb,KAHA,EAAP;AAKH;;AAhE0C;AAAA;;AAAA;AAAA,MAsBZf,MAAMuC,SAtBM;;AAmE/CZ,yBAAqBa,SAArB,GAAiC;AAC7BxB,gBAAQhB,MAAMyC,SAAN,CAAgBC;AADK,KAAjC;AAIA,WAAOf,oBAAP;AACH,CA3ED","file":"packages/cultofcoders:grapher-react/legacy/createQueryContainer.js.map","sourcesContent":["import React from 'react';\nimport {createContainer} from 'meteor/react-meteor-data';\n\nexport default (query, component, options = {}) => {\n    if (Meteor.isDevelopment) {\n        console.warn('createQueryContainer() is deprecated, please use withQuery() instead')\n    }\n\n    if (options.reactive) {\n        return createContainer((props) => {\n            if (props.params) {\n                query.setParams(props.params);\n            }\n\n            const handler = query.subscribe();\n\n            return {\n                query,\n                loading: !handler.ready(),\n                [options.dataProp]: options.single ? _.first(query.fetch()) : query.fetch(),\n                ...props\n            }\n        }, component);\n    }\n\n    class MethodQueryComponent extends React.Component {\n        constructor() {\n            super();\n            this.state = {\n                [options.dataProp]: undefined,\n                error: undefined,\n                loading: true\n            }\n        }\n\n        componentWillReceiveProps(nextProps) {\n            this._fetch(nextProps.params);\n        }\n\n        componentDidMount() {\n            this._fetch(this.props.params);\n        }\n\n        _fetch(params) {\n            if (params) {\n                query.setParams(params);\n            }\n\n            query.fetch((error, data) => {\n                const state = {\n                    error,\n                    [options.dataProp]: options.single ? _.first(data) : data,\n                    loading: false\n                };\n\n                this.setState(state);\n            });\n        }\n\n        render() {\n            const {state, props} = this;\n\n            return React.createElement(component, {\n                query,\n                ...state,\n                ...props\n            })\n        }\n    }\n\n    MethodQueryComponent.propTypes = {\n        params: React.PropTypes.object\n    };\n\n    return MethodQueryComponent;\n}"]},"hash":"84d118ea3451bacb4d051d2d88b10e9881db13c2"}
