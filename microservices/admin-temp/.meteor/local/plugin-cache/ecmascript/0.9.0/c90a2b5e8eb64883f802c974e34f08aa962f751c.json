{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"meteor/meteor","imported":["Meteor"],"specifiers":[{"kind":"named","imported":"Meteor","local":"Meteor"}]},{"source":"meteor/accounts-base","imported":["Accounts"],"specifiers":[{"kind":"named","imported":"Accounts","local":"Accounts"}]},{"source":"../../../utils/saveStartForm","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"saveStartForm"}]},{"source":"../../../utils/analytics","imported":["addUserTracking"],"specifiers":[{"kind":"named","imported":"addUserTracking","local":"addUserTracking"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"imports/core/api/methods/server/createUserAndLoan.js","filenameRelative":"imports/core/api/methods/server/createUserAndLoan.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"useNativeAsyncAwait":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"imports/core/api/methods/server/createUserAndLoan.js.map","sourceFileName":"imports/core/api/methods/server/createUserAndLoan.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"createUserAndLoan"},"ignored":false,"code":"\"use strict\";\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\n\nvar _Accounts = void 0;\n\nmodule.watch(require(\"meteor/accounts-base\"), {\n  Accounts: function Accounts(v) {\n    _Accounts = v;\n  }\n}, 1);\nvar saveStartForm = void 0;\nmodule.watch(require(\"../../../utils/saveStartForm\"), {\n  default: function _default(v) {\n    saveStartForm = v;\n  }\n}, 2);\n\nvar _addUserTracking = void 0;\n\nmodule.watch(require(\"../../../utils/analytics\"), {\n  addUserTracking: function addUserTracking(v) {\n    _addUserTracking = v;\n  }\n}, 3);\n\n_Meteor.methods({\n  createUserAndLoan: function createUserAndLoan(_ref) {\n    var email = _ref.email,\n        formState = _ref.formState;\n    console.log('creating user and loan...', email, formState); // Create the new user without a password\n\n    var newUserId = void 0;\n\n    try {\n      newUserId = _Accounts.createUser({\n        email: email\n      });\n    } catch (e) {\n      throw new _Meteor.Error(\"Couldn't create new user\", e);\n    } // Send an enrollment email\n\n\n    _Accounts.sendEnrollmentEmail(newUserId); // Insert the formdata to loan and borrower(s)\n\n\n    return saveStartForm(formState, newUserId);\n  }\n});","map":{"version":3,"sources":["imports/core/api/methods/server/createUserAndLoan.js"],"names":["Meteor","module","watch","require","v","Accounts","saveStartForm","default","addUserTracking","methods","createUserAndLoan","email","formState","console","log","newUserId","createUser","e","Error","sendEnrollmentEmail"],"mappings":";;AAAA,IAAIA,gBAAJ;;AAAWC,OAAOC,KAAP,CAAaC,QAAQ,eAAR,CAAb,EAAsC;AAACH,QAAD,kBAAQI,CAAR,EAAU;AAACJ,cAAOI,CAAP;AAAS;AAApB,CAAtC,EAA4D,CAA5D;;AAA+D,IAAIC,kBAAJ;;AAAaJ,OAAOC,KAAP,CAAaC,QAAQ,sBAAR,CAAb,EAA6C;AAACE,UAAD,oBAAUD,CAAV,EAAY;AAACC,gBAASD,CAAT;AAAW;AAAxB,CAA7C,EAAuE,CAAvE;AAA0E,IAAIE,sBAAJ;AAAkBL,OAAOC,KAAP,CAAaC,QAAQ,8BAAR,CAAb,EAAqD;AAACI,SAAD,oBAASH,CAAT,EAAW;AAACE,oBAAcF,CAAd;AAAgB;AAA5B,CAArD,EAAmF,CAAnF;;AAAsF,IAAII,yBAAJ;;AAAoBP,OAAOC,KAAP,CAAaC,QAAQ,0BAAR,CAAb,EAAiD;AAACK,iBAAD,2BAAiBJ,CAAjB,EAAmB;AAACI,uBAAgBJ,CAAhB;AAAkB;AAAtC,CAAjD,EAAyF,CAAzF;;AAK7RJ,QAAOS,OAAP,CAAe;AACbC,mBADa,mCAC2B;AAAA,QAApBC,KAAoB,QAApBA,KAAoB;AAAA,QAAbC,SAAa,QAAbA,SAAa;AACtCC,YAAQC,GAAR,CAAY,2BAAZ,EAAyCH,KAAzC,EAAgDC,SAAhD,EADsC,CAEtC;;AACA,QAAIG,kBAAJ;;AACA,QAAI;AACFA,kBAAYV,UAASW,UAAT,CAAoB;AAAEL;AAAF,OAApB,CAAZ;AACD,KAFD,CAEE,OAAOM,CAAP,EAAU;AACV,YAAM,IAAIjB,QAAOkB,KAAX,CAAiB,0BAAjB,EAA6CD,CAA7C,CAAN;AACD,KARqC,CAUtC;;;AACAZ,cAASc,mBAAT,CAA6BJ,SAA7B,EAXsC,CAatC;;;AACA,WAAOT,cAAcM,SAAd,EAAyBG,SAAzB,CAAP;AACD;AAhBY,CAAf","file":"imports/core/api/methods/server/createUserAndLoan.js.map","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { Accounts } from 'meteor/accounts-base';\nimport saveStartForm from 'core/utils/saveStartForm';\nimport { addUserTracking } from 'core/utils/analytics';\n\nMeteor.methods({\n  createUserAndLoan({ email, formState }) {\n    console.log('creating user and loan...', email, formState);\n    // Create the new user without a password\n    let newUserId;\n    try {\n      newUserId = Accounts.createUser({ email });\n    } catch (e) {\n      throw new Meteor.Error(\"Couldn't create new user\", e);\n    }\n\n    // Send an enrollment email\n    Accounts.sendEnrollmentEmail(newUserId);\n\n    // Insert the formdata to loan and borrower(s)\n    return saveStartForm(formState, newUserId);\n  },\n});\n"]},"hash":"c90a2b5e8eb64883f802c974e34f08aa962f751c"}
