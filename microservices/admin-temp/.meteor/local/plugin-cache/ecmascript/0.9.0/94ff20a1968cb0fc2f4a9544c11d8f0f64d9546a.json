{"metadata":{"usedHelpers":["inherits","possibleConstructorReturn","createClass","classCallCheck","interopRequireDefault"],"marked":[],"modules":{"imports":[{"source":"react","imported":["default","Component"],"specifiers":[{"kind":"named","imported":"default","local":"React"},{"kind":"named","imported":"Component","local":"Component"}]},{"source":"prop-types","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"PropTypes"}]},{"source":"meteor/meteor","imported":["Meteor"],"specifiers":[{"kind":"named","imported":"Meteor","local":"Meteor"}]},{"source":"../../../core/api/cleanMethods","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"cleanMethod"}]},{"source":"../../../core/components/Button","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"Button"}]},{"source":"../../../core/components/Material/TextField","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"TextField"}]},{"source":"../../../core/components/Material/MenuItem","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"MenuItem"}]},{"source":"../../../core/components/Select","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"Select"}]}],"exports":{"exported":["VerifyPage"],"specifiers":[{"kind":"local","local":"VerifyPage","exported":"default"}]}}},"options":{"filename":"imports/ui/pages/VerifyPage/VerifyPage.jsx","filenameRelative":"imports/ui/pages/VerifyPage/VerifyPage.jsx","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"imports/ui/pages/VerifyPage/VerifyPage.jsx.map","sourceFileName":"imports/ui/pages/VerifyPage/VerifyPage.jsx","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"VerifyPage"},"ignored":false,"code":"\"use strict\";\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require(\"babel-runtime/helpers/createClass\");\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require(\"babel-runtime/helpers/possibleConstructorReturn\");\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require(\"babel-runtime/helpers/inherits\");\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nmodule.export({\n  \"default\": function () {\n    function _default() {\n      return VerifyPage;\n    }\n\n    return _default;\n  }()\n});\n\nvar React = void 0,\n    _Component = void 0;\n\nmodule.watch(require(\"react\"), {\n  \"default\": function () {\n    function _default(v) {\n      React = v;\n    }\n\n    return _default;\n  }(),\n  Component: function () {\n    function Component(v) {\n      _Component = v;\n    }\n\n    return Component;\n  }()\n}, 0);\nvar PropTypes = void 0;\nmodule.watch(require(\"prop-types\"), {\n  \"default\": function () {\n    function _default(v) {\n      PropTypes = v;\n    }\n\n    return _default;\n  }()\n}, 1);\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function () {\n    function Meteor(v) {\n      _Meteor = v;\n    }\n\n    return Meteor;\n  }()\n}, 2);\nvar cleanMethod = void 0;\nmodule.watch(require(\"../../../core/api/cleanMethods\"), {\n  \"default\": function () {\n    function _default(v) {\n      cleanMethod = v;\n    }\n\n    return _default;\n  }()\n}, 3);\nvar Button = void 0;\nmodule.watch(require(\"../../../core/components/Button\"), {\n  \"default\": function () {\n    function _default(v) {\n      Button = v;\n    }\n\n    return _default;\n  }()\n}, 4);\nvar TextField = void 0;\nmodule.watch(require(\"../../../core/components/Material/TextField\"), {\n  \"default\": function () {\n    function _default(v) {\n      TextField = v;\n    }\n\n    return _default;\n  }()\n}, 5);\nvar MenuItem = void 0;\nmodule.watch(require(\"../../../core/components/Material/MenuItem\"), {\n  \"default\": function () {\n    function _default(v) {\n      MenuItem = v;\n    }\n\n    return _default;\n  }()\n}, 6);\nvar Select = void 0;\nmodule.watch(require(\"../../../core/components/Select\"), {\n  \"default\": function () {\n    function _default(v) {\n      Select = v;\n    }\n\n    return _default;\n  }()\n}, 7);\nvar styles = {\n  dropdown: {\n    width: 150\n  },\n  buttons: {\n    margin: 8\n  },\n  finalButton: {\n    marginTop: 40\n  }\n};\n\nvar VerifyPage = function (_Component2) {\n  (0, _inherits3.default)(VerifyPage, _Component2);\n\n  function VerifyPage(props) {\n    (0, _classCallCheck3.default)(this, VerifyPage);\n\n    var _this = (0, _possibleConstructorReturn3.default)(this, (VerifyPage.__proto__ || Object.getPrototypeOf(VerifyPage)).call(this, props));\n\n    _this.handleChange = function (_, value) {\n      return _this.setState({\n        validated: value\n      });\n    };\n\n    _this.handleChangeComment = function (event, i) {\n      var array = _this.state.comments.slice();\n\n      array[i] = event.target.value;\n\n      _this.setState({\n        comments: array\n      });\n    };\n\n    _this.handleSubmit = function () {\n      var object = {\n        'logic.verification.requested': false,\n        'logic.verification.comments': _this.state.comments,\n        'logic.verification.validated': _this.state.validated\n      };\n      cleanMethod('updateLoan', {\n        object: object,\n        id: _this.props.loan._id\n      }).then(function () {\n        _Meteor.call('adminActions.completeActionByType', {\n          loanId: _this.props.loan._id,\n          type: 'verify'\n        });\n\n        _Meteor.call('email.send', {\n          emailId: _this.state.validated ? 'verificationPassed' : 'verificationError',\n          loanId: _this.props.loan._id,\n          userId: _this.props.loan.userId,\n          template: 'notification+CTA'\n        });\n\n        window.close();\n      });\n    };\n\n    _this.comments = [];\n    var v = _this.props.loan.logic.verification;\n    _this.state = {\n      comments: v.comments && v.comments.length ? v.comments : [''],\n      validated: v.validated === undefined ? null : v.validated\n    };\n    return _this;\n  }\n\n  (0, _createClass3.default)(VerifyPage, [{\n    key: \"render\",\n    value: function () {\n      function render() {\n        var _this2 = this;\n\n        if (this.props.loan.logic.verification.requested !== true) {\n          return React.createElement(\n            \"section\",\n            {\n              className: \"text-center\"\n            },\n            React.createElement(\n              \"h1\",\n              null,\n              \"Ce client n'a pas demand\\xE9 de v\\xE9rification\"\n            )\n          );\n        }\n\n        return React.createElement(\n          \"section\",\n          {\n            className: \"mask1\"\n          },\n          React.createElement(\n            \"h1\",\n            null,\n            \"V\\xE9rifier un dossier\"\n          ),\n          React.createElement(\n            \"h3\",\n            null,\n            \"Fichiers \\xE0 ouvrir:\"\n          ),\n          React.createElement(\n            \"ul\",\n            null,\n            React.createElement(\n              \"li\",\n              null,\n              \"Demande de pr\\xEAt: \",\n              React.createElement(\n                \"span\",\n                {\n                  className: \"bold\"\n                },\n                this.props.loan._id\n              )\n            ),\n            this.props.borrowers.map(function (b, i) {\n              return React.createElement(\n                \"li\",\n                {\n                  key: b._id\n                },\n                \"Emprunteur \",\n                i + 1,\n                \": \",\n                React.createElement(\n                  \"span\",\n                  {\n                    className: \"bold\"\n                  },\n                  b._id\n                )\n              );\n            })\n          ),\n          React.createElement(\"hr\", null),\n          React.createElement(\n            \"div\",\n            {\n              className: \"text-center\"\n            },\n            React.createElement(\n              \"h2\",\n              null,\n              \"R\\xE9ponse\"\n            ),\n            React.createElement(Select, {\n              value: this.state.validated,\n              onChange: this.handleChange,\n              style: styles.dropdown,\n              options: [{\n                id: null\n              }, {\n                id: true,\n                label: 'Valide'\n              }, {\n                id: false,\n                label: 'Pas valide'\n              }]\n            })\n          ),\n          this.state.comments.map(function (c, i) {\n            return React.createElement(TextField, {\n              key: i,\n              value: c,\n              multiline: true,\n              rows: 2,\n              fullWidth: true,\n              label: \"Commentaire No.\" + (i + 1),\n              onChange: function () {\n                function onChange(e) {\n                  return _this2.handleChangeComment(e, i);\n                }\n\n                return onChange;\n              }()\n            });\n          }),\n          React.createElement(\n            \"div\",\n            {\n              className: \"text-center\"\n            },\n            React.createElement(Button, {\n              raised: true,\n              label: \"+\",\n              onClick: function () {\n                function onClick() {\n                  return _this2.setState(function (prev) {\n                    return {\n                      comments: [].concat(_toConsumableArray(prev.comments), [''])\n                    };\n                  });\n                }\n\n                return onClick;\n              }(),\n              primary: true,\n              style: styles.buttons\n            }),\n            React.createElement(Button, {\n              raised: true,\n              label: \"-\",\n              onClick: function () {\n                function onClick() {\n                  return _this2.setState(function (prev) {\n                    return {\n                      comments: [].concat(_toConsumableArray(prev.comments)).splice(-1, 1)\n                    };\n                  });\n                }\n\n                return onClick;\n              }(),\n              disabled: this.state.comments.length <= 1,\n              style: styles.buttons\n            })\n          ),\n          React.createElement(\n            \"div\",\n            {\n              className: \"description\"\n            },\n            React.createElement(\n              \"p\",\n              null,\n              \"Ceci enverra un email au client en notification\"\n            )\n          ),\n          React.createElement(\n            \"div\",\n            {\n              className: \"text-center\",\n              style: styles.finalButton\n            },\n            React.createElement(Button, {\n              raised: true,\n              label: \"Envoyer\",\n              primary: true,\n              disabled: !(this.state.validated === true || this.state.validated === false && this.state.comments[0]),\n              onClick: this.handleSubmit\n            })\n          )\n        );\n      }\n\n      return render;\n    }()\n  }]);\n  return VerifyPage;\n}(_Component);\n\nVerifyPage.propTypes = {\n  loan: PropTypes.objectOf(PropTypes.any).isRequired\n};","map":{"version":3,"sources":["imports/ui/pages/VerifyPage/VerifyPage.jsx"],"names":["module","export","VerifyPage","React","Component","watch","require","v","PropTypes","Meteor","cleanMethod","Button","TextField","MenuItem","Select","styles","dropdown","width","buttons","margin","finalButton","marginTop","props","handleChange","_","value","setState","validated","handleChangeComment","event","i","array","state","comments","slice","target","handleSubmit","object","id","loan","_id","then","call","loanId","type","emailId","userId","template","window","close","logic","verification","length","undefined","requested","borrowers","map","b","label","c","e","prev","splice","propTypes","objectOf","any","isRequired"],"mappings":"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","file":"imports/ui/pages/VerifyPage/VerifyPage.jsx.map","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { Meteor } from 'meteor/meteor';\n\nimport cleanMethod from 'core/api/cleanMethods';\n\nimport Button from 'core/components/Button';\nimport TextField from 'core/components/Material/TextField';\n// import DropDownMenu from 'core/components/Material/DropDownMenu';\nimport MenuItem from 'core/components/Material/MenuItem';\nimport Select from 'core/components/Select';\n\nconst styles = {\n  dropdown: {\n    width: 150,\n  },\n  buttons: {\n    margin: 8,\n  },\n  finalButton: {\n    marginTop: 40,\n  },\n};\n\nexport default class VerifyPage extends Component {\n  constructor(props) {\n    super(props);\n\n    this.comments = [];\n\n    const v = this.props.loan.logic.verification;\n\n    this.state = {\n      comments: v.comments && v.comments.length ? v.comments : [''],\n      validated: v.validated === undefined ? null : v.validated,\n    };\n  }\n\n  handleChange = (_, value) => this.setState({ validated: value });\n\n  handleChangeComment = (event, i) => {\n    const array = this.state.comments.slice();\n    array[i] = event.target.value;\n    this.setState({ comments: array });\n  };\n\n  handleSubmit = () => {\n    const object = {\n      'logic.verification.requested': false,\n      'logic.verification.comments': this.state.comments,\n      'logic.verification.validated': this.state.validated,\n    };\n\n    cleanMethod('updateLoan', {\n      object,\n      id: this.props.loan._id,\n    }).then(() => {\n      Meteor.call('adminActions.completeActionByType', {\n        loanId: this.props.loan._id,\n        type: 'verify',\n      });\n\n      Meteor.call('email.send', {\n        emailId: this.state.validated\n          ? 'verificationPassed'\n          : 'verificationError',\n        loanId: this.props.loan._id,\n        userId: this.props.loan.userId,\n        template: 'notification+CTA',\n      });\n\n      window.close();\n    });\n  };\n\n  render() {\n    if (this.props.loan.logic.verification.requested !== true) {\n      return (\n        <section className=\"text-center\">\n          <h1>Ce client n'a pas demandé de vérification</h1>\n        </section>\n      );\n    }\n\n    return (\n      <section className=\"mask1\">\n        <h1>Vérifier un dossier</h1>\n\n        <h3>Fichiers à ouvrir:</h3>\n        <ul>\n          <li>\n            Demande de prêt: <span className=\"bold\">{this.props.loan._id}</span>\n          </li>\n          {this.props.borrowers.map((b, i) => (\n            <li key={b._id}>\n              Emprunteur {i + 1}: <span className=\"bold\">{b._id}</span>\n            </li>\n          ))}\n        </ul>\n\n        <hr />\n\n        <div className=\"text-center\">\n          <h2>Réponse</h2>\n          <Select\n            value={this.state.validated}\n            onChange={this.handleChange}\n            style={styles.dropdown}\n            options={[\n              { id: null },\n              { id: true, label: 'Valide' },\n              { id: false, label: 'Pas valide' },\n            ]}\n          />\n        </div>\n\n        {this.state.comments.map((c, i) => (\n          <TextField\n            key={i}\n            value={c}\n            multiline\n            rows={2}\n            fullWidth\n            label={`Commentaire No.${i + 1}`}\n            onChange={e => this.handleChangeComment(e, i)}\n          />\n        ))}\n        <div className=\"text-center\">\n          <Button\n            raised\n            label=\"+\"\n            onClick={() =>\n              this.setState(prev => ({ comments: [...prev.comments, ''] }))\n            }\n            primary\n            style={styles.buttons}\n          />\n          <Button\n            raised\n            label=\"-\"\n            onClick={() =>\n              this.setState(prev => ({\n                comments: [...prev.comments].splice(-1, 1),\n              }))\n            }\n            disabled={this.state.comments.length <= 1}\n            style={styles.buttons}\n          />\n        </div>\n        <div className=\"description\">\n          <p>Ceci enverra un email au client en notification</p>\n        </div>\n        <div className=\"text-center\" style={styles.finalButton}>\n          <Button\n            raised\n            label=\"Envoyer\"\n            primary\n            disabled={\n              !(\n                this.state.validated === true ||\n                (this.state.validated === false && this.state.comments[0])\n              )\n            }\n            onClick={this.handleSubmit}\n          />\n        </div>\n      </section>\n    );\n  }\n}\n\nVerifyPage.propTypes = {\n  loan: PropTypes.objectOf(PropTypes.any).isRequired,\n};\n"]},"hash":"94ff20a1968cb0fc2f4a9544c11d8f0f64d9546a"}
