{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"react","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"React"}]},{"source":"../../../core/components/DropdownMenu","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"DropdownMenu"}]},{"source":"../../../core/api","imported":["callMutation","mutations"],"specifiers":[{"kind":"named","imported":"callMutation","local":"callMutation"},{"kind":"named","imported":"mutations","local":"mutations"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"imports/ui/pages/TasksPage/TasksAssignedUserDropdown.jsx","filenameRelative":"imports/ui/pages/TasksPage/TasksAssignedUserDropdown.jsx","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"imports/ui/pages/TasksPage/TasksAssignedUserDropdown.jsx.map","sourceFileName":"imports/ui/pages/TasksPage/TasksAssignedUserDropdown.jsx","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"TasksAssignedUserDropdown"},"ignored":false,"code":"\"use strict\";\n\nvar React = void 0;\nmodule.watch(require(\"react\"), {\n  \"default\": function () {\n    function _default(v) {\n      React = v;\n    }\n\n    return _default;\n  }()\n}, 0);\nvar DropdownMenu = void 0;\nmodule.watch(require(\"../../../core/components/DropdownMenu\"), {\n  \"default\": function () {\n    function _default(v) {\n      DropdownMenu = v;\n    }\n\n    return _default;\n  }()\n}, 1);\n\nvar _callMutation = void 0,\n    _mutations = void 0;\n\nmodule.watch(require(\"../../../core/api\"), {\n  callMutation: function () {\n    function callMutation(v) {\n      _callMutation = v;\n    }\n\n    return callMutation;\n  }(),\n  mutations: function () {\n    function mutations(v) {\n      _mutations = v;\n    }\n\n    return mutations;\n  }()\n}, 2);\n\nvar firstUserAssign = function () {\n  function firstUserAssign(_ref) {\n    var taskAssignedTo = _ref.taskAssignedTo,\n        relatedUserId = _ref.relatedUserId,\n        user = _ref.user,\n        taskId = _ref.taskId,\n        taskType = _ref.taskType;\n\n    if (!taskAssignedTo) {\n      console.log(taskAssignedTo, relatedUserId, user, taskId, taskType);\n\n      _callMutation(_mutations.ASSIGN_ADMIN_TO_NEW_USER_TASK, {\n        userId: relatedUserId,\n        adminId: user._id,\n        taskId: taskId,\n        taskType: taskType\n      });\n    } else {\n      _callMutation(_mutations.TASK_CHANGE_ASSIGNED_TO, {\n        taskId: taskId,\n        newAssignee: user._id\n      });\n    }\n  }\n\n  return firstUserAssign;\n}();\n\nvar changeAssignedUser = function () {\n  function changeAssignedUser(_ref2) {\n    var user = _ref2.user,\n        task = _ref2.task,\n        taskAssignedTo = _ref2.taskAssignedTo;\n    console.log(task);\n    var taskUserId = task.user ? task.user._id : undefined;\n\n    if (!taskUserId) {\n      _callMutation(_mutations.TASK_GET_RELATED_TO, {\n        task: task\n      }).then(function (relatedUserId) {\n        firstUserAssign({\n          taskAssignedTo: taskAssignedTo,\n          relatedUserId: relatedUserId,\n          user: user,\n          taskId: task._id,\n          taskType: task.type\n        });\n      });\n    } else {\n      firstUserAssign({\n        taskAssignedTo: taskAssignedTo,\n        taskUserId: taskUserId,\n        user: user,\n        taskId: task._id,\n        taskType: task.type\n      });\n    }\n  }\n\n  return changeAssignedUser;\n}();\n\nvar getMenuItems = function () {\n  function getMenuItems(users, task) {\n    var taskAssignedTo = task.assignedUser ? task.assignedUser._id : undefined;\n    var options = users.map(function (user) {\n      return {\n        id: user._id,\n        show: user._id !== taskAssignedTo,\n        label: user.emails[0].address,\n        link: false,\n        onClick: function () {\n          function onClick() {\n            changeAssignedUser({\n              user: user,\n              task: task,\n              taskAssignedTo: taskAssignedTo\n            });\n          }\n\n          return onClick;\n        }()\n      };\n    });\n    return options;\n  }\n\n  return getMenuItems;\n}();\n\nvar TasksAssignedUserDropdown = function () {\n  function TasksAssignedUserDropdown(props) {\n    var data = props.data,\n        isLoading = props.isLoading,\n        error = props.error,\n        task = props.task,\n        styles = props.styles;\n\n    if (isLoading) {\n      return null;\n    }\n\n    if (error) {\n      return React.createElement(\n        \"div\",\n        null,\n        \"Error: \",\n        error.reason\n      );\n    }\n\n    return React.createElement(DropdownMenu, {\n      iconType: \"personAdd\",\n      options: getMenuItems(data, task),\n      style: styles\n    });\n  }\n\n  return TasksAssignedUserDropdown;\n}();\n\nmodule.exportDefault(TasksAssignedUserDropdown);","map":{"version":3,"sources":["imports/ui/pages/TasksPage/TasksAssignedUserDropdown.jsx"],"names":["React","module","watch","require","v","DropdownMenu","callMutation","mutations","firstUserAssign","taskAssignedTo","relatedUserId","user","taskId","taskType","console","log","ASSIGN_ADMIN_TO_NEW_USER_TASK","userId","adminId","_id","TASK_CHANGE_ASSIGNED_TO","newAssignee","changeAssignedUser","task","taskUserId","undefined","TASK_GET_RELATED_TO","then","type","getMenuItems","users","assignedUser","options","map","id","show","label","emails","address","link","onClick","TasksAssignedUserDropdown","props","data","isLoading","error","styles","reason","exportDefault"],"mappings":"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","file":"imports/ui/pages/TasksPage/TasksAssignedUserDropdown.jsx.map","sourcesContent":["import React from 'react';\nimport DropdownMenu from 'core/components/DropdownMenu/';\nimport { callMutation, mutations } from 'core/api';\n\nconst firstUserAssign = ({\n  taskAssignedTo,\n  relatedUserId,\n  user,\n  taskId,\n  taskType,\n}) => {\n  if (!taskAssignedTo) {\n    console.log(taskAssignedTo, relatedUserId, user, taskId, taskType);\n    callMutation(mutations.ASSIGN_ADMIN_TO_NEW_USER_TASK, {\n      userId: relatedUserId,\n      adminId: user._id,\n      taskId,\n      taskType,\n    });\n  } else {\n    callMutation(mutations.TASK_CHANGE_ASSIGNED_TO, {\n      taskId,\n      newAssignee: user._id,\n    });\n  }\n};\n\nconst changeAssignedUser = ({ user, task, taskAssignedTo }) => {\n  console.log(task);\n  const taskUserId = task.user ? task.user._id : undefined;\n  if (!taskUserId) {\n    callMutation(mutations.TASK_GET_RELATED_TO, {\n      task,\n    }).then((relatedUserId) => {\n      firstUserAssign({\n        taskAssignedTo,\n        relatedUserId,\n        user,\n        taskId: task._id,\n        taskType: task.type,\n      });\n    });\n  } else {\n    firstUserAssign({\n      taskAssignedTo,\n      taskUserId,\n      user,\n      taskId: task._id,\n      taskType: task.type,\n    });\n  }\n};\n\nconst getMenuItems = (users, task) => {\n  const taskAssignedTo = task.assignedUser ? task.assignedUser._id : undefined;\n  const options = users.map(user => ({\n    id: user._id,\n    show: user._id !== taskAssignedTo,\n    label: user.emails[0].address,\n    link: false,\n    onClick: () => {\n      changeAssignedUser({\n        user,\n        task,\n        taskAssignedTo,\n      });\n    },\n  }));\n  return options;\n};\n\nconst TasksAssignedUserDropdown = (props) => {\n  const { data, isLoading, error, task, styles } = props;\n\n  if (isLoading) {\n    return null;\n  }\n  if (error) {\n    return <div>Error: {error.reason}</div>;\n  }\n\n  return (\n    <DropdownMenu\n      iconType=\"personAdd\"\n      options={getMenuItems(data, task)}\n      style={styles}\n    />\n  );\n};\n\nexport default TasksAssignedUserDropdown;\n"]},"hash":"6fe6a71aafc2db38fd65038c1a3b09435c05a4cc"}
