{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"meteor/meteor","imported":["Meteor"],"specifiers":[{"kind":"named","imported":"Meteor","local":"Meteor"}]},{"source":"meteor/okgrow:analytics","imported":["analytics"],"specifiers":[{"kind":"named","imported":"analytics","local":"analytics"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"packages/okgrow:analytics/examples/flow-router/imports/flow-router.js","filenameRelative":"packages/okgrow:analytics/examples/flow-router/imports/flow-router.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"useNativeAsyncAwait":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"packages/okgrow:analytics/examples/flow-router/imports/flow-router.js.map","sourceFileName":"packages/okgrow:analytics/examples/flow-router/imports/flow-router.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"flow-router"},"ignored":false,"code":"let Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 0);\nlet analytics;\nmodule.watch(require(\"meteor/okgrow:analytics\"), {\n  analytics(v) {\n    analytics = v;\n  }\n\n}, 1);\n\n// eslint-disable-line import/no-extraneous-dependencies, import/extensions\nif (Meteor.isClient) {\n  FlowRouter.route('/', {\n    action() {\n      BlazeLayout.render('mainLayout', {\n        main: 'one'\n      });\n    },\n\n    name: 'Home' // used for track\n\n  });\n  FlowRouter.route('/one', {\n    action() {\n      BlazeLayout.render('mainLayout', {\n        main: 'one'\n      });\n    },\n\n    name: 'One' // used for track\n\n  });\n  FlowRouter.route('/two', {\n    action() {\n      BlazeLayout.render('mainLayout', {\n        main: 'two'\n      });\n    },\n\n    name: 'Two' // used for track\n\n  });\n  FlowRouter.route('/three', {\n    action() {\n      BlazeLayout.render('mainLayout', {\n        main: 'three'\n      });\n    }\n\n  }); // without 'name', path is used for tracking\n\n  Template.mainLayout.onCreated(function mainLayoutOnCreated() {\n    Meteor.subscribe('oauthInfo');\n    const self = this;\n    self.log = new ReactiveVar([]);\n    self.currentIdentity = new ReactiveVar('No Identity Set'); // We don't want to register analytics if it has been blocked by an adblocker.\n\n    if (typeof analytics === 'undefined') return;\n    self.currentIdentity.set(analytics._user._getTraits().email || 'No Identity Set');\n    analytics.on('page', (event, properties, options) => {\n      const latest = self.log.get();\n      latest.push(`Page: ${options.path}`);\n      self.log.set(latest);\n    });\n    analytics.on('identify', (event, properties) => {\n      const latest = self.log.get();\n      latest.push(`Identify: ${properties.email}`);\n      self.log.set(latest);\n      self.currentIdentity.set(properties.email);\n    });\n    analytics.on('track', event => {\n      const latest = self.log.get();\n      latest.push(`Track: ${event}`);\n      self.log.set(latest);\n    });\n  });\n  Template.mainLayout.onRendered(function mainLayoutOnRendered() {\n    Tracker.autorun(() => {\n      document.title = FlowRouter.getRouteName();\n    });\n  });\n  Template.mainLayout.helpers({\n    log() {\n      return Template.instance().log.get();\n    },\n\n    currentIdentity() {\n      return Template.instance().currentIdentity.get();\n    },\n\n    isOauth() {\n      const user = Meteor.user();\n      let message = 'Not Signed In.';\n\n      if (user && user.services) {\n        if (user.services.facebook) {\n          message = `Signed in with Facebook as ${user.services.facebook.name} (${user.services.facebook.email})`;\n        } else if (user.services.github) {\n          message = `Signed in with Github as ${user.services.github.username} (${user.services.github.email})`;\n        } else if (user.services.google) {\n          message = `Signed in with Google as ${user.services.google.name} (${user.services.google.email})`;\n        }\n      } else if (user) {\n        message = 'Not an oauth login';\n      }\n\n      return message;\n    }\n\n  });\n}\n\nif (Meteor.isServer) {\n  Meteor.publish('oauthInfo', function publisOAuthInfo() {\n    return Meteor.users.find({\n      _id: this.userId\n    }, {\n      fields: {\n        'services.facebook.name': 1,\n        'services.facebook.email': 1,\n        'services.github.username': 1,\n        'services.github.email': 1,\n        'services.google.name': 1,\n        'services.google.email': 1\n      }\n    });\n  });\n}","map":{"version":3,"sources":["packages/okgrow:analytics/examples/flow-router/imports/flow-router.js"],"names":["Meteor","module","watch","require","v","analytics","isClient","FlowRouter","route","action","BlazeLayout","render","main","name","Template","mainLayout","onCreated","mainLayoutOnCreated","subscribe","self","log","ReactiveVar","currentIdentity","set","_user","_getTraits","email","on","event","properties","options","latest","get","push","path","onRendered","mainLayoutOnRendered","Tracker","autorun","document","title","getRouteName","helpers","instance","isOauth","user","message","services","facebook","github","username","google","isServer","publish","publisOAuthInfo","users","find","_id","userId","fields"],"mappings":"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","file":"packages/okgrow:analytics/examples/flow-router/imports/flow-router.js.map","sourcesContent":["import { Meteor } from 'meteor/meteor'; // eslint-disable-line import/no-extraneous-dependencies, import/extensions\nimport { analytics } from 'meteor/okgrow:analytics'; // eslint-disable-line import/no-extraneous-dependencies, import/extensions\n\nif (Meteor.isClient) {\n  FlowRouter.route('/', {\n    action() {\n      BlazeLayout.render('mainLayout', { main: 'one' });\n    },\n    name: 'Home', // used for track\n  });\n\n  FlowRouter.route('/one', {\n    action() {\n      BlazeLayout.render('mainLayout', { main: 'one' });\n    },\n    name: 'One', // used for track\n  });\n\n  FlowRouter.route('/two', {\n    action() {\n      BlazeLayout.render('mainLayout', { main: 'two' });\n    },\n    name: 'Two', // used for track\n  });\n\n  FlowRouter.route('/three', {\n    action() {\n      BlazeLayout.render('mainLayout', { main: 'three' });\n    },\n  }); // without 'name', path is used for tracking\n\n  Template.mainLayout.onCreated(function mainLayoutOnCreated() {\n    Meteor.subscribe('oauthInfo');\n    const self = this;\n    self.log = new ReactiveVar([]);\n    self.currentIdentity = new ReactiveVar('No Identity Set');\n\n    // We don't want to register analytics if it has been blocked by an adblocker.\n    if (typeof analytics === 'undefined') return;\n\n    self.currentIdentity.set(analytics._user._getTraits().email || 'No Identity Set');\n\n    analytics.on('page', (event, properties, options) => {\n      const latest = self.log.get();\n      latest.push(`Page: ${options.path}`);\n      self.log.set(latest);\n    });\n\n    analytics.on('identify', (event, properties) => {\n      const latest = self.log.get();\n      latest.push(`Identify: ${properties.email}`);\n      self.log.set(latest);\n      self.currentIdentity.set(properties.email);\n    });\n\n    analytics.on('track', (event) => {\n      const latest = self.log.get();\n      latest.push(`Track: ${event}`);\n      self.log.set(latest);\n    });\n  });\n\n  Template.mainLayout.onRendered(function mainLayoutOnRendered() {\n    Tracker.autorun(() => {\n      document.title = FlowRouter.getRouteName();\n    });\n  });\n\n  Template.mainLayout.helpers({\n    log() { return Template.instance().log.get(); },\n    currentIdentity() { return Template.instance().currentIdentity.get(); },\n    isOauth() {\n      const user = Meteor.user();\n      let message = 'Not Signed In.';\n      if (user && user.services) {\n        if (user.services.facebook) {\n          message = `Signed in with Facebook as ${user.services.facebook.name} (${user.services.facebook.email})`;\n        } else if (user.services.github) {\n          message = `Signed in with Github as ${user.services.github.username} (${user.services.github.email})`;\n        } else if (user.services.google) {\n          message = `Signed in with Google as ${user.services.google.name} (${user.services.google.email})`;\n        }\n      } else if (user) {\n        message = 'Not an oauth login';\n      }\n      return message;\n    },\n  });\n}\n\nif (Meteor.isServer) {\n  Meteor.publish('oauthInfo', function publisOAuthInfo() {\n    return Meteor.users.find(\n      { _id: this.userId },\n      {\n        fields: {\n          'services.facebook.name': 1,\n          'services.facebook.email': 1,\n          'services.github.username': 1,\n          'services.github.email': 1,\n          'services.google.name': 1,\n          'services.google.email': 1,\n        },\n      },\n    );\n  });\n}\n"]},"hash":"eb263ccfd45b2f4432e0400c2857ddd414fd68c1"}
