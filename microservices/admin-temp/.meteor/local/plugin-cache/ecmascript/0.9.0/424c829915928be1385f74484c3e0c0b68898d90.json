{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"meteor/meteor","imported":["Meteor"],"specifiers":[{"kind":"named","imported":"Meteor","local":"Meteor"}]},{"source":"../../security","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"SecurityService"}]},{"source":"../../mutations","imported":["createMutator"],"specifiers":[{"kind":"named","imported":"createMutator","local":"createMutator"}]},{"source":"../PropertyService","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"PropertyService"}]},{"source":"../mutationDefinitions","imported":["*"],"specifiers":[{"kind":"namespace","local":"defs"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"imports/core/api/properties/server/mutations.js","filenameRelative":"imports/core/api/properties/server/mutations.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"useNativeAsyncAwait":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"imports/core/api/properties/server/mutations.js.map","sourceFileName":"imports/core/api/properties/server/mutations.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"mutations"},"ignored":false,"code":"\"use strict\";\n\nvar _Meteor = void 0;\n\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function Meteor(v) {\n    _Meteor = v;\n  }\n}, 0);\nvar SecurityService = void 0;\nmodule.watch(require(\"../../security\"), {\n  default: function _default(v) {\n    SecurityService = v;\n  }\n}, 1);\n\nvar _createMutator = void 0;\n\nmodule.watch(require(\"../../mutations\"), {\n  createMutator: function createMutator(v) {\n    _createMutator = v;\n  }\n}, 2);\nvar PropertyService = void 0;\nmodule.watch(require(\"../PropertyService\"), {\n  default: function _default(v) {\n    PropertyService = v;\n  }\n}, 3);\nvar defs = void 0;\nmodule.watch(require(\"../mutationDefinitions\"), {\n  \"*\": function _(v) {\n    defs = v;\n  }\n}, 4);\n\n_createMutator(defs.PROPERTY_INSERT, function (_ref) {\n  var object = _ref.object,\n      userId = _ref.userId;\n  var userIdIsDefined = userId !== undefined;\n\n  if (userIdIsDefined) {\n    SecurityService.checkCurrentUserIsAdmin();\n  } else {\n    SecurityService.properties.isAllowedToInsert();\n  }\n\n  return PropertyService.insert({\n    object: object,\n    userId: userIdIsDefined ? userId : _Meteor.userId()\n  });\n});\n\n_createMutator(defs.PROPERTY_UPDATE, function (_ref2) {\n  var propertyId = _ref2.propertyId,\n      object = _ref2.object;\n  SecurityService.properties.isAllowedToUpdate(propertyId);\n  return PropertyService.update({\n    propertyId: propertyId,\n    object: object\n  });\n});\n\n_createMutator(defs.PROPERTY_DELETE, function (_ref3) {\n  var propertyId = _ref3.propertyId;\n  SecurityService.properties.isAllowedToDelete(propertyId);\n  return PropertyService.remove({\n    propertyId: propertyId\n  });\n});","map":{"version":3,"sources":["imports/core/api/properties/server/mutations.js"],"names":["Meteor","module","watch","require","v","SecurityService","default","createMutator","PropertyService","defs","PROPERTY_INSERT","object","userId","userIdIsDefined","undefined","checkCurrentUserIsAdmin","properties","isAllowedToInsert","insert","PROPERTY_UPDATE","propertyId","isAllowedToUpdate","update","PROPERTY_DELETE","isAllowedToDelete","remove"],"mappings":";;AAAA,IAAIA,gBAAJ;;AAAWC,OAAOC,KAAP,CAAaC,QAAQ,eAAR,CAAb,EAAsC;AAACH,QAAD,kBAAQI,CAAR,EAAU;AAACJ,cAAOI,CAAP;AAAS;AAApB,CAAtC,EAA4D,CAA5D;AAA+D,IAAIC,wBAAJ;AAAoBJ,OAAOC,KAAP,CAAaC,QAAQ,gBAAR,CAAb,EAAuC;AAACG,SAAD,oBAASF,CAAT,EAAW;AAACC,sBAAgBD,CAAhB;AAAkB;AAA9B,CAAvC,EAAuE,CAAvE;;AAA0E,IAAIG,uBAAJ;;AAAkBN,OAAOC,KAAP,CAAaC,QAAQ,iBAAR,CAAb,EAAwC;AAACI,eAAD,yBAAeH,CAAf,EAAiB;AAACG,qBAAcH,CAAd;AAAgB;AAAlC,CAAxC,EAA4E,CAA5E;AAA+E,IAAII,wBAAJ;AAAoBP,OAAOC,KAAP,CAAaC,QAAQ,oBAAR,CAAb,EAA2C;AAACG,SAAD,oBAASF,CAAT,EAAW;AAACI,sBAAgBJ,CAAhB;AAAkB;AAA9B,CAA3C,EAA2E,CAA3E;AAA8E,IAAIK,aAAJ;AAASR,OAAOC,KAAP,CAAaC,QAAQ,wBAAR,CAAb,EAA+C;AAAC,KAAD,aAAKC,CAAL,EAAO;AAACK,WAAKL,CAAL;AAAO;AAAf,CAA/C,EAAgE,CAAhE;;AAOpXG,eAAcE,KAAKC,eAAnB,EAAoC,gBAAwB;AAAA,MAArBC,MAAqB,QAArBA,MAAqB;AAAA,MAAbC,MAAa,QAAbA,MAAa;AAC1D,MAAMC,kBAAkBD,WAAWE,SAAnC;;AACA,MAAID,eAAJ,EAAqB;AACnBR,oBAAgBU,uBAAhB;AACD,GAFD,MAEO;AACLV,oBAAgBW,UAAhB,CAA2BC,iBAA3B;AACD;;AAED,SAAOT,gBAAgBU,MAAhB,CAAuB;AAC5BP,kBAD4B;AAE5BC,YAAQC,kBAAkBD,MAAlB,GAA2BZ,QAAOY,MAAP;AAFP,GAAvB,CAAP;AAID,CAZD;;AAcAL,eAAcE,KAAKU,eAAnB,EAAoC,iBAA4B;AAAA,MAAzBC,UAAyB,SAAzBA,UAAyB;AAAA,MAAbT,MAAa,SAAbA,MAAa;AAC9DN,kBAAgBW,UAAhB,CAA2BK,iBAA3B,CAA6CD,UAA7C;AACA,SAAOZ,gBAAgBc,MAAhB,CAAuB;AAAEF,0BAAF;AAAcT;AAAd,GAAvB,CAAP;AACD,CAHD;;AAKAJ,eAAcE,KAAKc,eAAnB,EAAoC,iBAAoB;AAAA,MAAjBH,UAAiB,SAAjBA,UAAiB;AACtDf,kBAAgBW,UAAhB,CAA2BQ,iBAA3B,CAA6CJ,UAA7C;AACA,SAAOZ,gBAAgBiB,MAAhB,CAAuB;AAAEL;AAAF,GAAvB,CAAP;AACD,CAHD","file":"imports/core/api/properties/server/mutations.js.map","sourcesContent":["import { Meteor } from 'meteor/meteor';\n\nimport SecurityService from '../../security';\nimport { createMutator } from '../../mutations';\nimport PropertyService from '../PropertyService';\nimport * as defs from '../mutationDefinitions';\n\ncreateMutator(defs.PROPERTY_INSERT, ({ object, userId }) => {\n  const userIdIsDefined = userId !== undefined;\n  if (userIdIsDefined) {\n    SecurityService.checkCurrentUserIsAdmin();\n  } else {\n    SecurityService.properties.isAllowedToInsert();\n  }\n\n  return PropertyService.insert({\n    object,\n    userId: userIdIsDefined ? userId : Meteor.userId(),\n  });\n});\n\ncreateMutator(defs.PROPERTY_UPDATE, ({ propertyId, object }) => {\n  SecurityService.properties.isAllowedToUpdate(propertyId);\n  return PropertyService.update({ propertyId, object });\n});\n\ncreateMutator(defs.PROPERTY_DELETE, ({ propertyId }) => {\n  SecurityService.properties.isAllowedToDelete(propertyId);\n  return PropertyService.remove({ propertyId });\n});\n"]},"hash":"424c829915928be1385f74484c3e0c0b68898d90"}
