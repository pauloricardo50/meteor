{"metadata":{"usedHelpers":["extends","interopRequireDefault"],"marked":[],"modules":{"imports":[{"source":"./loanFunctions","imported":["getMonthlyWithExtractedOffer"],"specifiers":[{"kind":"named","imported":"getMonthlyWithExtractedOffer","local":"getMonthlyWithExtractedOffer"}]},{"source":"../api/constants","imported":["OFFER_TYPE","INTEREST_RATES"],"specifiers":[{"kind":"named","imported":"OFFER_TYPE","local":"OFFER_TYPE"},{"kind":"named","imported":"INTEREST_RATES","local":"INTEREST_RATES"}]}],"exports":{"exported":["getRange","extractOffers","getBestRate"],"specifiers":[{"kind":"local","local":"getRange","exported":"getRange"},{"kind":"local","local":"extractOffers","exported":"extractOffers"},{"kind":"local","local":"getBestRate","exported":"getBestRate"}]}}},"options":{"filename":"imports/core/utils/offerFunctions.js","filenameRelative":"imports/core/utils/offerFunctions.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"spec":false,"loose":false}],[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"imports/core/utils/offerFunctions.js.map","sourceFileName":"imports/core/utils/offerFunctions.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"offerFunctions"},"ignored":false,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getRange = undefined;\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nmodule.export({\n  getRange: function () {\n    function getRange() {\n      return _getRange;\n    }\n\n    return getRange;\n  }(),\n  extractOffers: function () {\n    function extractOffers() {\n      return _extractOffers;\n    }\n\n    return extractOffers;\n  }(),\n  getBestRate: function () {\n    function getBestRate() {\n      return _getBestRate;\n    }\n\n    return getBestRate;\n  }()\n});\n\nvar _getMonthlyWithExtractedOffer = void 0;\n\nmodule.watch(require(\"./loanFunctions\"), {\n  getMonthlyWithExtractedOffer: function () {\n    function getMonthlyWithExtractedOffer(v) {\n      _getMonthlyWithExtractedOffer = v;\n    }\n\n    return getMonthlyWithExtractedOffer;\n  }()\n}, 0);\nexports.getRange = _getRange;\n\nvar _OFFER_TYPE = void 0,\n    _INTEREST_RATES = void 0;\n\nmodule.watch(require(\"../api/constants\"), {\n  OFFER_TYPE: function () {\n    function OFFER_TYPE(v) {\n      _OFFER_TYPE = v;\n    }\n\n    return OFFER_TYPE;\n  }(),\n  INTEREST_RATES: function () {\n    function INTEREST_RATES(v) {\n      _INTEREST_RATES = v;\n    }\n\n    return INTEREST_RATES;\n  }()\n}, 1);\n\nvar _getRange = function () {\n  function _getRange(_ref, key) {\n    var offers = _ref.offers;\n    return offers.reduce(function (accumulator, offer) {\n      var standard = offer.standardOffer[key];\n      var counterpart = offer.counterpartOffer && offer.counterpartOffer[key];\n\n      if (standard < accumulator.min) {\n        accumulator.min = standard;\n      }\n\n      if (standard > accumulator.max) {\n        accumulator.max = standard;\n      }\n\n      if (counterpart) {\n        if (counterpart < accumulator.min) {\n          accumulator.min = counterpart;\n        }\n\n        if (counterpart > accumulator.max) {\n          accumulator.max = counterpart;\n        }\n      }\n\n      return accumulator;\n    }, {\n      min: Infinity,\n      max: 0\n    });\n  }\n\n  return _getRange;\n}();\n\nvar _extractOffers = function () {\n  function _extractOffers(_ref2) {\n    var offers = _ref2.offers,\n        loan = _ref2.loan,\n        property = _ref2.property;\n    var array = [];\n    offers.forEach(function (offer) {\n      var meta = {\n        organization: offer.organization,\n        canton: offer.canton,\n        id: offer._id,\n        rating: 5\n      };\n      array.push((0, _extends3.default)({}, offer.standardOffer, meta, {\n        conditions: offer.conditions,\n        uid: \"standard\" + offer._id,\n        type: _OFFER_TYPE.STANDARD\n      }));\n      array[array.length - 1].monthly = _getMonthlyWithExtractedOffer({\n        loan: loan,\n        property: property,\n        offer: array[array.length - 1]\n      });\n\n      if (offer.counterpartOffer) {\n        array.push((0, _extends3.default)({}, offer.counterpartOffer, meta, {\n          conditions: offer.conditions,\n          counterparts: offer.counterparts,\n          uid: \"counterparts\" + offer._id,\n          type: _OFFER_TYPE.COUNTERPARTS\n        }));\n        array[array.length - 1].monthly = _getMonthlyWithExtractedOffer({\n          loan: loan,\n          property: property,\n          offer: array[array.length - 1]\n        });\n      }\n    });\n    return array;\n  }\n\n  return _extractOffers;\n}();\n\nvar _getBestRate = function () {\n  function _getBestRate(_ref3) {\n    var _ref3$offers = _ref3.offers,\n        offers = _ref3$offers === undefined ? [] : _ref3$offers;\n    var duration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : _INTEREST_RATES.YEARS_10;\n    return offers.length ? Math.min.apply(Math, _toConsumableArray(offers.reduce(function (acc, offer) {\n      if (offer.standardOffer[duration]) {\n        acc.push(offer.standardOffer[duration]);\n      }\n\n      if (offer.counterpartOffer && offer.counterpartOffer[duration]) {\n        acc.push(offer.counterpartOffer[duration]);\n      }\n\n      return acc;\n    }, []))) : undefined;\n  }\n\n  return _getBestRate;\n}();","map":{"version":3,"sources":["imports/core/utils/offerFunctions.js"],"names":["module","export","getRange","extractOffers","getBestRate","getMonthlyWithExtractedOffer","watch","require","v","OFFER_TYPE","INTEREST_RATES","key","offers","reduce","accumulator","offer","standard","standardOffer","counterpart","counterpartOffer","min","max","Infinity","loan","property","array","forEach","meta","organization","canton","id","_id","rating","push","conditions","uid","type","STANDARD","length","monthly","counterparts","COUNTERPARTS","duration","YEARS_10","Math","acc","undefined"],"mappings":"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","file":"imports/core/utils/offerFunctions.js.map","sourcesContent":["import { getMonthlyWithExtractedOffer } from './loanFunctions';\nimport { OFFER_TYPE, INTEREST_RATES } from '../api/constants';\n\nexport const getRange = ({ offers }, key) =>\n  offers.reduce(\n    (accumulator, offer) => {\n      const standard = offer.standardOffer[key];\n      const counterpart = offer.counterpartOffer && offer.counterpartOffer[key];\n\n      if (standard < accumulator.min) {\n        accumulator.min = standard;\n      }\n      if (standard > accumulator.max) {\n        accumulator.max = standard;\n      }\n      if (counterpart) {\n        if (counterpart < accumulator.min) {\n          accumulator.min = counterpart;\n        }\n        if (counterpart > accumulator.max) {\n          accumulator.max = counterpart;\n        }\n      }\n\n      return accumulator;\n    },\n    { min: Infinity, max: 0 },\n  );\n\nexport const extractOffers = ({ offers, loan, property }) => {\n  const array = [];\n  offers.forEach((offer) => {\n    const meta = {\n      organization: offer.organization,\n      canton: offer.canton,\n      id: offer._id,\n      rating: 5,\n    };\n\n    array.push({\n      ...offer.standardOffer,\n      ...meta,\n      conditions: offer.conditions,\n      uid: `standard${offer._id}`,\n      type: OFFER_TYPE.STANDARD,\n    });\n    array[array.length - 1].monthly = getMonthlyWithExtractedOffer({\n      loan,\n      property,\n      offer: array[array.length - 1],\n    });\n\n    if (offer.counterpartOffer) {\n      array.push({\n        ...offer.counterpartOffer,\n        ...meta,\n        conditions: offer.conditions,\n        counterparts: offer.counterparts,\n        uid: `counterparts${offer._id}`,\n        type: OFFER_TYPE.COUNTERPARTS,\n      });\n      array[array.length - 1].monthly = getMonthlyWithExtractedOffer({\n        loan,\n        property,\n        offer: array[array.length - 1],\n      });\n    }\n  });\n  return array;\n};\n\nexport const getBestRate = (\n  { offers = [] },\n  duration = INTEREST_RATES.YEARS_10,\n) =>\n  (offers.length\n    ? Math.min(...offers.reduce((acc, offer) => {\n      if (offer.standardOffer[duration]) {\n        acc.push(offer.standardOffer[duration]);\n      }\n      if (offer.counterpartOffer && offer.counterpartOffer[duration]) {\n        acc.push(offer.counterpartOffer[duration]);\n      }\n      return acc;\n    }, []))\n    : undefined);\n"]},"hash":"75fb826684041193b9d5083da8f23abfbb39e53d"}
