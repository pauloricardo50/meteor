{"metadata":{"usedHelpers":["inherits","possibleConstructorReturn","classCallCheck","extends","interopRequireDefault"],"marked":[],"modules":{"imports":[{"source":"react","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"React"}]},{"source":"./getDisplayName","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"getDisplayName"}]}],"exports":{"exported":["withStaticQueryContainer","WrappedComponent"],"specifiers":[{"kind":"local","local":"withStaticQueryContainer","exported":"default"},{"kind":"local","local":"WrappedComponent","exported":"default"}]}}},"options":{"filename":"packages/cultofcoders:grapher-react/lib/withStaticQuery.js","filenameRelative":"packages/cultofcoders:grapher-react/lib/withStaticQuery.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"packages/cultofcoders:grapher-react/lib/withStaticQuery.js.map","sourceFileName":"packages/cultofcoders:grapher-react/lib/withStaticQuery.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"withStaticQuery"},"ignored":false,"code":"var _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _possibleConstructorReturn2 = require(\"babel-runtime/helpers/possibleConstructorReturn\");\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require(\"babel-runtime/helpers/inherits\");\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nmodule.export({\n    \"default\": function () {\n        return withStaticQueryContainer;\n    }\n});\nvar React = void 0;\nmodule.watch(require(\"react\"), {\n    \"default\": function (v) {\n        React = v;\n    }\n}, 0);\nvar getDisplayName = void 0;\nmodule.watch(require(\"./getDisplayName\"), {\n    \"default\": function (v) {\n        getDisplayName = v;\n    }\n}, 1);\n\nfunction withStaticQueryContainer(WrappedComponent) {\n    /**\n     * We use it like this so we can have naming inside React Dev Tools\n     * This is a standard pattern in HOCs\n     */var GrapherStaticQueryContainer = function (_React$Component) {\n        (0, _inherits3.default)(GrapherStaticQueryContainer, _React$Component);\n\n        function GrapherStaticQueryContainer() {\n            var _temp, _this, _ret;\n\n            (0, _classCallCheck3.default)(this, GrapherStaticQueryContainer);\n\n            for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n                args[_key] = arguments[_key];\n            }\n\n            return _ret = (_temp = (_this = (0, _possibleConstructorReturn3.default)(this, _React$Component.call.apply(_React$Component, [this].concat(args))), _this), _this.state = {\n                isLoading: true,\n                error: null,\n                data: []\n            }, _this.refetch = function () {\n                var query = _this.props.query;\n\n                _this.fetch(query);\n            }, _temp), (0, _possibleConstructorReturn3.default)(_this, _ret);\n        }\n\n        GrapherStaticQueryContainer.prototype.componentWillReceiveProps = function () {\n            function componentWillReceiveProps(nextProps) {\n                var query = nextProps.query;\n                this.fetch(query);\n            }\n\n            return componentWillReceiveProps;\n        }();\n\n        GrapherStaticQueryContainer.prototype.componentDidMount = function () {\n            function componentDidMount() {\n                var _this2 = this;\n\n                var _props = this.props,\n                    query = _props.query,\n                    config = _props.config;\n                this.fetch(query);\n\n                if (config.pollingMs) {\n                    this.pollingInterval = setInterval(function () {\n                        _this2.fetch(query);\n                    }, config.pollingMs);\n                }\n            }\n\n            return componentDidMount;\n        }();\n\n        GrapherStaticQueryContainer.prototype.componentWillUnmount = function () {\n            function componentWillUnmount() {\n                this.pollingInterval && clearInterval(this.pollingInterval);\n            }\n\n            return componentWillUnmount;\n        }();\n\n        GrapherStaticQueryContainer.prototype.fetch = function () {\n            function fetch(query) {\n                var _this3 = this;\n\n                query.fetch(function (error, data) {\n                    if (error) {\n                        _this3.setState({\n                            error: error,\n                            data: [],\n                            isLoading: false\n                        });\n                    } else {\n                        _this3.setState({\n                            error: null,\n                            data: data,\n                            isLoading: false\n                        });\n                    }\n                });\n            }\n\n            return fetch;\n        }();\n\n        GrapherStaticQueryContainer.prototype.render = function () {\n            function render() {\n                var _props2 = this.props,\n                    config = _props2.config,\n                    props = _props2.props,\n                    query = _props2.query;\n                return React.createElement(WrappedComponent, {\n                    grapher: this.state,\n                    config: config,\n                    query: query,\n                    props: (0, _extends3.default)({}, props, {\n                        refetch: this.refetch\n                    })\n                });\n            }\n\n            return render;\n        }();\n\n        return GrapherStaticQueryContainer;\n    }(React.Component);\n\n    GrapherStaticQueryContainer.displayName = \"StaticQuery(\" + getDisplayName(WrappedComponent) + \")\";\n    return GrapherStaticQueryContainer;\n}","map":{"version":3,"sources":["packages/cultofcoders:grapher-react/lib/withStaticQuery.js"],"names":["module","export","withStaticQueryContainer","React","watch","require","v","getDisplayName","WrappedComponent","GrapherStaticQueryContainer","state","isLoading","error","data","refetch","query","props","fetch","componentWillReceiveProps","nextProps","componentDidMount","config","pollingMs","pollingInterval","setInterval","componentWillUnmount","clearInterval","setState","render","createElement","grapher","Component","displayName"],"mappings":";;;;;;;;;;;;;;;;;;AAAAA,OAAOC,MAAP,CAAc;AAAC,eAAQ;AAAA,eAAIC,wBAAJ;AAAA;AAAT,CAAd;AAAsD,IAAIC,cAAJ;AAAUH,OAAOI,KAAP,CAAaC,QAAQ,OAAR,CAAb,EAA8B;AAAA,yBAASC,CAAT,EAAW;AAACH,gBAAMG,CAAN;AAAQ;AAApB,CAA9B,EAAoD,CAApD;AAAuD,IAAIC,uBAAJ;AAAmBP,OAAOI,KAAP,CAAaC,QAAQ,kBAAR,CAAb,EAAyC;AAAA,yBAASC,CAAT,EAAW;AAACC,yBAAeD,CAAf;AAAiB;AAA7B,CAAzC,EAAwE,CAAxE;;AAG3H,SAASJ,wBAAT,CAAkCM,gBAAlC,EAAoD;AAC/D;;;OAD+D,IAKzDC,2BALyD;AAAA;;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;;AAAA,8KAM3DC,KAN2D,GAMnD;AACJC,2BAAW,IADP;AAEJC,uBAAO,IAFH;AAGJC,sBAAM;AAHF,aANmD,QAkD3DC,OAlD2D,GAkDjD,YAAM;AAAA,oBACLC,KADK,GACI,MAAKC,KADT,CACLD,KADK;;AAEZ,sBAAKE,KAAL,CAAWF,KAAX;AACH,aArD0D;AAAA;;AAAA,8CAY3DG,yBAZ2D;AAAA,+CAYjCC,SAZiC,EAYtB;AAAA,oBAC1BJ,KAD0B,GACjBI,SADiB,CAC1BJ,KAD0B;AAEjC,qBAAKE,KAAL,CAAWF,KAAX;AACH;;AAf0D;AAAA;;AAAA,8CAiB3DK,iBAjB2D;AAAA,yCAiBvC;AAAA;;AAAA,6BACQ,KAAKJ,KADb;AAAA,oBACTD,KADS,UACTA,KADS;AAAA,oBACFM,MADE,UACFA,MADE;AAEhB,qBAAKJ,KAAL,CAAWF,KAAX;;AAEA,oBAAIM,OAAOC,SAAX,EAAsB;AAClB,yBAAKC,eAAL,GAAuBC,YAAY,YAAM;AACrC,+BAAKP,KAAL,CAAWF,KAAX;AACH,qBAFsB,EAEpBM,OAAOC,SAFa,CAAvB;AAGH;AACJ;;AA1B0D;AAAA;;AAAA,8CA4B3DG,oBA5B2D;AAAA,4CA4BpC;AACnB,qBAAKF,eAAL,IAAwBG,cAAc,KAAKH,eAAnB,CAAxB;AACH;;AA9B0D;AAAA;;AAAA,8CAgC3DN,KAhC2D;AAAA,2BAgCrDF,KAhCqD,EAgC9C;AAAA;;AACTA,sBAAME,KAAN,CAAY,UAACL,KAAD,EAAQC,IAAR,EAAiB;AACzB,wBAAID,KAAJ,EAAW;AACP,+BAAKe,QAAL,CAAc;AACVf,wCADU;AAEVC,kCAAM,EAFI;AAGVF,uCAAW;AAHD,yBAAd;AAKH,qBAND,MAMO;AACH,+BAAKgB,QAAL,CAAc;AACVf,mCAAO,IADG;AAEVC,sCAFU;AAGVF,uCAAW;AAHD,yBAAd;AAKH;AACJ,iBAdD;AAeH;;AAhD0D;AAAA;;AAAA,8CAuD3DiB,MAvD2D;AAAA,8BAuDlD;AAAA,8BAC0B,KAAKZ,KAD/B;AAAA,oBACEK,MADF,WACEA,MADF;AAAA,oBACUL,KADV,WACUA,KADV;AAAA,oBACiBD,KADjB,WACiBA,KADjB;AAGL,uBAAOZ,MAAM0B,aAAN,CAAoBrB,gBAApB,EAAsC;AACzCsB,6BAAS,KAAKpB,KAD2B;AAEzCW,kCAFyC;AAGzCN,gCAHyC;AAIzCC,sDAAWA,KAAX;AAAkBF,iCAAS,KAAKA;AAAhC;AAJyC,iBAAtC,CAAP;AAMH;;AAhE0D;AAAA;;AAAA;AAAA,MAKrBX,MAAM4B,SALe;;AAmE/DtB,gCAA4BuB,WAA5B,oBAAyDzB,eAAeC,gBAAf,CAAzD;AAEA,WAAOC,2BAAP;AACH","file":"packages/cultofcoders:grapher-react/lib/withStaticQuery.js.map","sourcesContent":["import React from 'react';\nimport getDisplayName from './getDisplayName';\n\nexport default function withStaticQueryContainer(WrappedComponent) {\n    /**\n     * We use it like this so we can have naming inside React Dev Tools\n     * This is a standard pattern in HOCs\n     */\n    class GrapherStaticQueryContainer extends React.Component {\n        state = {\n            isLoading: true,\n            error: null,\n            data: [],\n        };\n\n        componentWillReceiveProps(nextProps) {\n            const {query} = nextProps;\n            this.fetch(query);\n        }\n\n        componentDidMount() {\n            const {query, config} = this.props;\n            this.fetch(query);\n\n            if (config.pollingMs) {\n                this.pollingInterval = setInterval(() => {\n                    this.fetch(query);\n                }, config.pollingMs)\n            }\n        }\n\n        componentWillUnmount() {\n            this.pollingInterval && clearInterval(this.pollingInterval);\n        }\n\n        fetch(query) {\n            query.fetch((error, data) => {\n                if (error) {\n                    this.setState({\n                        error,\n                        data: [],\n                        isLoading: false,\n                    })\n                } else {\n                    this.setState({\n                        error: null,\n                        data,\n                        isLoading: false,\n                    });\n                }\n            });\n        }\n\n        refetch = () => {\n            const {query} = this.props;\n            this.fetch(query);\n        };\n\n        render() {\n            const {config, props, query} = this.props;\n\n            return React.createElement(WrappedComponent, {\n                grapher: this.state,\n                config,\n                query,\n                props: {...props, refetch: this.refetch},\n            });\n        }\n    }\n\n    GrapherStaticQueryContainer.displayName = `StaticQuery(${getDisplayName(WrappedComponent)})`;\n\n    return GrapherStaticQueryContainer;\n}"]},"hash":"ff01c7a3c30e11079051af1652968669b2efcf12"}
