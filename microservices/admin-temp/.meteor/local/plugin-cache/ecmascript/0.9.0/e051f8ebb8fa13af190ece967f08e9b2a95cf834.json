{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"meteor/accounts-base","imported":["Accounts"],"specifiers":[{"kind":"named","imported":"Accounts","local":"Accounts"}]},{"source":"./helpers.js","imported":["redirect","validatePassword","validateEmail","validateUsername"],"specifiers":[{"kind":"named","imported":"redirect","local":"redirect"},{"kind":"named","imported":"validatePassword","local":"validatePassword"},{"kind":"named","imported":"validateEmail","local":"validateEmail"},{"kind":"named","imported":"validateUsername","local":"validateUsername"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"packages/std:accounts-ui/imports/accounts_ui.js","filenameRelative":"packages/std:accounts-ui/imports/accounts_ui.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"packages/std:accounts-ui/imports/accounts_ui.js.map","sourceFileName":"packages/std:accounts-ui/imports/accounts_ui.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"accounts_ui"},"ignored":false,"code":"var Accounts = void 0;\nmodule.watch(require(\"meteor/accounts-base\"), {\n  Accounts: function (v) {\n    Accounts = v;\n  }\n}, 0);\nvar redirect = void 0,\n    validatePassword = void 0,\n    validateEmail = void 0,\n    validateUsername = void 0;\nmodule.watch(require(\"./helpers.js\"), {\n  redirect: function (v) {\n    redirect = v;\n  },\n  validatePassword: function (v) {\n    validatePassword = v;\n  },\n  validateEmail: function (v) {\n    validateEmail = v;\n  },\n  validateUsername: function (v) {\n    validateUsername = v;\n  }\n}, 1);\n/**\n * @summary Accounts UI\n * @namespace\n * @memberOf Accounts\n */Accounts.ui = {};\nAccounts.ui._options = {\n  requestPermissions: [],\n  requestOfflineToken: {},\n  forceApprovalPrompt: {},\n  requireEmailVerification: false,\n  passwordSignupFields: 'EMAIL_ONLY_NO_PASSWORD',\n  minimumPasswordLength: 7,\n  loginPath: '/',\n  signUpPath: null,\n  resetPasswordPath: null,\n  profilePath: '/',\n  changePasswordPath: null,\n  homeRoutePath: '/',\n  onSubmitHook: function () {},\n  onPreSignUpHook: function () {\n    return new Promise(function (resolve) {\n      return resolve();\n    });\n  },\n  onPostSignUpHook: function () {},\n  onEnrollAccountHook: function () {\n    return redirect(\"\" + Accounts.ui._options.loginPath);\n  },\n  onResetPasswordHook: function () {\n    return redirect(\"\" + Accounts.ui._options.loginPath);\n  },\n  onVerifyEmailHook: function () {\n    return redirect(\"\" + Accounts.ui._options.profilePath);\n  },\n  onSignedInHook: function () {\n    return redirect(\"\" + Accounts.ui._options.homeRoutePath);\n  },\n  onSignedOutHook: function () {\n    return redirect(\"\" + Accounts.ui._options.homeRoutePath);\n  },\n  emailPattern: new RegExp('[^@]+@[^@\\.]{2,}\\.[^\\.@]+')\n}; /**\n    * @summary Configure the behavior of [`<Accounts.ui.LoginForm />`](#react-accounts-ui).\n    * @anywhere\n    * @param {Object} options\n    * @param {Object} options.requestPermissions Which [permissions](#requestpermissions) to request from the user for each external service.\n    * @param {Object} options.requestOfflineToken To ask the user for permission to act on their behalf when offline, map the relevant external service to `true`. Currently only supported with Google. See [Meteor.loginWithExternalService](#meteor_loginwithexternalservice) for more details.\n    * @param {Object} options.forceApprovalPrompt If true, forces the user to approve the app's permissions, even if previously approved. Currently only supported with Google.\n    * @param {String} options.passwordSignupFields Which fields to display in the user creation form. One of '`USERNAME_AND_EMAIL`', '`USERNAME_AND_OPTIONAL_EMAIL`', '`USERNAME_ONLY`', '`EMAIL_ONLY`', or '`NO_PASSWORD`' (default).\n    */\n\nAccounts.ui.config = function (options) {\n  // validate options keys\n  var VALID_KEYS = ['passwordSignupFields', 'requestPermissions', 'requestOfflineToken', 'forbidClientAccountCreation', 'requireEmailVerification', 'minimumPasswordLength', 'loginPath', 'signUpPath', 'resetPasswordPath', 'profilePath', 'changePasswordPath', 'homeRoutePath', 'onSubmitHook', 'onPreSignUpHook', 'onPostSignUpHook', 'onEnrollAccountHook', 'onResetPasswordHook', 'onVerifyEmailHook', 'onSignedInHook', 'onSignedOutHook', 'validateField', 'emailPattern'];\n  Object.keys(options).forEach(function (key) {\n    if (!VALID_KEYS.includes(key)) throw new Error(\"Accounts.ui.config: Invalid key: \" + key);\n  }); // Deal with `passwordSignupFields`\n\n  if (options.passwordSignupFields) {\n    if ([\"USERNAME_AND_EMAIL\", \"USERNAME_AND_OPTIONAL_EMAIL\", \"USERNAME_ONLY\", \"EMAIL_ONLY\", \"EMAIL_ONLY_NO_PASSWORD\", \"USERNAME_AND_EMAIL_NO_PASSWORD\"].includes(options.passwordSignupFields)) {\n      Accounts.ui._options.passwordSignupFields = options.passwordSignupFields;\n    } else {\n      throw new Error(\"Accounts.ui.config: Invalid option for `passwordSignupFields`: \" + options.passwordSignupFields);\n    }\n  } // Deal with `requestPermissions`\n\n\n  if (options.requestPermissions) {\n    Object.keys(options.requestPermissions).forEach(function (service) {\n      var score = options.requestPermissions[service];\n\n      if (Accounts.ui._options.requestPermissions[service]) {\n        throw new Error(\"Accounts.ui.config: Can't set `requestPermissions` more than once for \" + service);\n      } else if (!(scope instanceof Array)) {\n        throw new Error(\"Accounts.ui.config: Value for `requestPermissions` must be an array\");\n      } else {\n        Accounts.ui._options.requestPermissions[service] = scope;\n      }\n    });\n  } // Deal with `requestOfflineToken`\n\n\n  if (options.requestOfflineToken) {\n    Object.keys(options.requestOfflineToken).forEach(function (service) {\n      var value = options.requestOfflineToken[service];\n      if (service !== 'google') throw new Error(\"Accounts.ui.config: `requestOfflineToken` only supported for Google login at the moment.\");\n\n      if (Accounts.ui._options.requestOfflineToken[service]) {\n        throw new Error(\"Accounts.ui.config: Can't set `requestOfflineToken` more than once for \" + service);\n      } else {\n        Accounts.ui._options.requestOfflineToken[service] = value;\n      }\n    });\n  } // Deal with `forceApprovalPrompt`\n\n\n  if (options.forceApprovalPrompt) {\n    Object.keys(options.forceApprovalPrompt).forEach(function (service) {\n      var value = options.forceApprovalPrompt[service];\n      if (service !== 'google') throw new Error(\"Accounts.ui.config: `forceApprovalPrompt` only supported for Google login at the moment.\");\n\n      if (Accounts.ui._options.forceApprovalPrompt[service]) {\n        throw new Error(\"Accounts.ui.config: Can't set `forceApprovalPrompt` more than once for \" + service);\n      } else {\n        Accounts.ui._options.forceApprovalPrompt[service] = value;\n      }\n    });\n  } // Deal with `requireEmailVerification`\n\n\n  if (options.requireEmailVerification) {\n    if (typeof options.requireEmailVerification != 'boolean') {\n      throw new Error(\"Accounts.ui.config: \\\"requireEmailVerification\\\" not a boolean\");\n    } else {\n      Accounts.ui._options.requireEmailVerification = options.requireEmailVerification;\n    }\n  } // Deal with `minimumPasswordLength`\n\n\n  if (options.minimumPasswordLength) {\n    if (typeof options.minimumPasswordLength != 'number') {\n      throw new Error(\"Accounts.ui.config: \\\"minimumPasswordLength\\\" not a number\");\n    } else {\n      Accounts.ui._options.minimumPasswordLength = options.minimumPasswordLength;\n    }\n  } // Deal with the hooks.\n\n\n  var _arr = ['onSubmitHook', 'onPreSignUpHook', 'onPostSignUpHook'];\n\n  for (var _i = 0; _i < _arr.length; _i++) {\n    var hook = _arr[_i];\n\n    if (options[hook]) {\n      if (typeof options[hook] != 'function') {\n        throw new Error(\"Accounts.ui.config: \\\"\" + hook + \"\\\" not a function\");\n      } else {\n        Accounts.ui._options[hook] = options[hook];\n      }\n    }\n  } // Deal with pattern.\n\n\n  var _arr2 = ['emailPattern'];\n\n  for (var _i2 = 0; _i2 < _arr2.length; _i2++) {\n    var _hook = _arr2[_i2];\n\n    if (options[_hook]) {\n      if (!(options[_hook] instanceof RegExp)) {\n        throw new Error(\"Accounts.ui.config: \\\"\" + _hook + \"\\\" not a Regular Expression\");\n      } else {\n        Accounts.ui._options[_hook] = options[_hook];\n      }\n    }\n  } // deal with the paths.\n\n\n  var _arr3 = ['loginPath', 'signUpPath', 'resetPasswordPath', 'profilePath', 'changePasswordPath', 'homeRoutePath'];\n\n  for (var _i3 = 0; _i3 < _arr3.length; _i3++) {\n    var path = _arr3[_i3];\n\n    if (typeof options[path] !== 'undefined') {\n      if (options[path] !== null && typeof options[path] !== 'string') {\n        throw new Error(\"Accounts.ui.config: \" + path + \" is not a string or null\");\n      } else {\n        Accounts.ui._options[path] = options[path];\n      }\n    }\n  } // deal with redirect hooks.\n\n\n  var _loop = function (_hook2) {\n    if (options[_hook2]) {\n      if (typeof options[_hook2] == 'function') {\n        Accounts.ui._options[_hook2] = options[_hook2];\n      } else if (typeof options[_hook2] == 'string') {\n        Accounts.ui._options[_hook2] = function () {\n          return redirect(options[_hook2]);\n        };\n      } else {\n        throw new Error(\"Accounts.ui.config: \\\"\" + _hook2 + \"\\\" not a function or an absolute or relative path\");\n      }\n    }\n  };\n\n  var _arr4 = ['onEnrollAccountHook', 'onResetPasswordHook', 'onVerifyEmailHook', 'onSignedInHook', 'onSignedOutHook'];\n\n  for (var _i4 = 0; _i4 < _arr4.length; _i4++) {\n    var _hook2 = _arr4[_i4];\n\n    _loop(_hook2);\n  }\n};\n\nmodule.exportDefault(Accounts);","map":{"version":3,"sources":["packages/std:accounts-ui/imports/accounts_ui.js"],"names":["Accounts","module","watch","require","v","redirect","validatePassword","validateEmail","validateUsername","ui","_options","requestPermissions","requestOfflineToken","forceApprovalPrompt","requireEmailVerification","passwordSignupFields","minimumPasswordLength","loginPath","signUpPath","resetPasswordPath","profilePath","changePasswordPath","homeRoutePath","onSubmitHook","onPreSignUpHook","Promise","resolve","onPostSignUpHook","onEnrollAccountHook","onResetPasswordHook","onVerifyEmailHook","onSignedInHook","onSignedOutHook","emailPattern","RegExp","config","options","VALID_KEYS","Object","keys","forEach","key","includes","Error","score","service","scope","Array","value","hook","path","exportDefault"],"mappings":"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","file":"packages/std:accounts-ui/imports/accounts_ui.js.map","sourcesContent":["import { Accounts } from 'meteor/accounts-base';\nimport {\n  redirect,\n  validatePassword,\n  validateEmail,\n  validateUsername,\n} from './helpers.js';\n\n/**\n * @summary Accounts UI\n * @namespace\n * @memberOf Accounts\n */\nAccounts.ui = {};\n\nAccounts.ui._options = {\n  requestPermissions: [],\n  requestOfflineToken: {},\n  forceApprovalPrompt: {},\n  requireEmailVerification: false,\n  passwordSignupFields: 'EMAIL_ONLY_NO_PASSWORD',\n  minimumPasswordLength: 7,\n  loginPath: '/',\n  signUpPath: null,\n  resetPasswordPath: null,\n  profilePath: '/',\n  changePasswordPath: null,\n  homeRoutePath: '/',\n  onSubmitHook: () => {},\n  onPreSignUpHook: () => new Promise(resolve => resolve()),\n  onPostSignUpHook: () => {},\n  onEnrollAccountHook: () => redirect(`${Accounts.ui._options.loginPath}`),\n  onResetPasswordHook: () => redirect(`${Accounts.ui._options.loginPath}`),\n  onVerifyEmailHook: () => redirect(`${Accounts.ui._options.profilePath}`),\n  onSignedInHook: () => redirect(`${Accounts.ui._options.homeRoutePath}`),\n  onSignedOutHook: () => redirect(`${Accounts.ui._options.homeRoutePath}`),\n  emailPattern: new RegExp('[^@]+@[^@\\.]{2,}\\.[^\\.@]+'),\n};\n\n/**\n * @summary Configure the behavior of [`<Accounts.ui.LoginForm />`](#react-accounts-ui).\n * @anywhere\n * @param {Object} options\n * @param {Object} options.requestPermissions Which [permissions](#requestpermissions) to request from the user for each external service.\n * @param {Object} options.requestOfflineToken To ask the user for permission to act on their behalf when offline, map the relevant external service to `true`. Currently only supported with Google. See [Meteor.loginWithExternalService](#meteor_loginwithexternalservice) for more details.\n * @param {Object} options.forceApprovalPrompt If true, forces the user to approve the app's permissions, even if previously approved. Currently only supported with Google.\n * @param {String} options.passwordSignupFields Which fields to display in the user creation form. One of '`USERNAME_AND_EMAIL`', '`USERNAME_AND_OPTIONAL_EMAIL`', '`USERNAME_ONLY`', '`EMAIL_ONLY`', or '`NO_PASSWORD`' (default).\n */\nAccounts.ui.config = function(options) {\n  // validate options keys\n  const VALID_KEYS = [\n    'passwordSignupFields',\n    'requestPermissions',\n    'requestOfflineToken',\n    'forbidClientAccountCreation',\n    'requireEmailVerification',\n    'minimumPasswordLength',\n    'loginPath',\n    'signUpPath',\n    'resetPasswordPath',\n    'profilePath',\n    'changePasswordPath',\n    'homeRoutePath',\n    'onSubmitHook',\n    'onPreSignUpHook',\n    'onPostSignUpHook',\n    'onEnrollAccountHook',\n    'onResetPasswordHook',\n    'onVerifyEmailHook',\n    'onSignedInHook',\n    'onSignedOutHook',\n    'validateField',\n    'emailPattern',\n  ];\n\n  Object.keys(options).forEach(function (key) {\n    if (!VALID_KEYS.includes(key))\n      throw new Error(\"Accounts.ui.config: Invalid key: \" + key);\n  });\n\n  // Deal with `passwordSignupFields`\n  if (options.passwordSignupFields) {\n    if ([\n      \"USERNAME_AND_EMAIL\",\n      \"USERNAME_AND_OPTIONAL_EMAIL\",\n      \"USERNAME_ONLY\",\n      \"EMAIL_ONLY\",\n      \"EMAIL_ONLY_NO_PASSWORD\",\n      \"USERNAME_AND_EMAIL_NO_PASSWORD\"\n    ].includes(options.passwordSignupFields)) {\n      Accounts.ui._options.passwordSignupFields = options.passwordSignupFields;\n    }\n    else {\n      throw new Error(\"Accounts.ui.config: Invalid option for `passwordSignupFields`: \" + options.passwordSignupFields);\n    }\n  }\n\n  // Deal with `requestPermissions`\n  if (options.requestPermissions) {\n    Object.keys(options.requestPermissions).forEach(service => {\n      const score = options.requestPermissions[service];\n      if (Accounts.ui._options.requestPermissions[service]) {\n        throw new Error(\"Accounts.ui.config: Can't set `requestPermissions` more than once for \" + service);\n      }\n      else if (!(scope instanceof Array)) {\n        throw new Error(\"Accounts.ui.config: Value for `requestPermissions` must be an array\");\n      }\n      else {\n        Accounts.ui._options.requestPermissions[service] = scope;\n      }\n    });\n  }\n\n  // Deal with `requestOfflineToken`\n  if (options.requestOfflineToken) {\n    Object.keys(options.requestOfflineToken).forEach(service => {\n      const value = options.requestOfflineToken[service];\n      if (service !== 'google')\n        throw new Error(\"Accounts.ui.config: `requestOfflineToken` only supported for Google login at the moment.\");\n\n      if (Accounts.ui._options.requestOfflineToken[service]) {\n        throw new Error(\"Accounts.ui.config: Can't set `requestOfflineToken` more than once for \" + service);\n      }\n      else {\n        Accounts.ui._options.requestOfflineToken[service] = value;\n      }\n    });\n  }\n\n  // Deal with `forceApprovalPrompt`\n  if (options.forceApprovalPrompt) {\n    Object.keys(options.forceApprovalPrompt).forEach(service => {\n      const value = options.forceApprovalPrompt[service];\n      if (service !== 'google')\n        throw new Error(\"Accounts.ui.config: `forceApprovalPrompt` only supported for Google login at the moment.\");\n\n      if (Accounts.ui._options.forceApprovalPrompt[service]) {\n        throw new Error(\"Accounts.ui.config: Can't set `forceApprovalPrompt` more than once for \" + service);\n      }\n      else {\n        Accounts.ui._options.forceApprovalPrompt[service] = value;\n      }\n    });\n  }\n\n  // Deal with `requireEmailVerification`\n  if (options.requireEmailVerification) {\n    if (typeof options.requireEmailVerification != 'boolean') {\n      throw new Error(`Accounts.ui.config: \"requireEmailVerification\" not a boolean`);\n    }\n    else {\n      Accounts.ui._options.requireEmailVerification = options.requireEmailVerification;\n    }\n  }\n\n  // Deal with `minimumPasswordLength`\n  if (options.minimumPasswordLength) {\n    if (typeof options.minimumPasswordLength != 'number') {\n      throw new Error(`Accounts.ui.config: \"minimumPasswordLength\" not a number`);\n    }\n    else {\n      Accounts.ui._options.minimumPasswordLength = options.minimumPasswordLength;\n    }\n  }\n\n  // Deal with the hooks.\n  for (let hook of [\n    'onSubmitHook',\n    'onPreSignUpHook',\n    'onPostSignUpHook',\n  ]) {\n    if (options[hook]) {\n      if (typeof options[hook] != 'function') {\n        throw new Error(`Accounts.ui.config: \"${hook}\" not a function`);\n      }\n      else {\n        Accounts.ui._options[hook] = options[hook];\n      }\n    }\n  }\n\n  // Deal with pattern.\n  for (let hook of [\n    'emailPattern',\n  ]) {\n    if (options[hook]) {\n      if (!(options[hook] instanceof RegExp)) {\n        throw new Error(`Accounts.ui.config: \"${hook}\" not a Regular Expression`);\n      }\n      else {\n        Accounts.ui._options[hook] = options[hook];\n      }\n    }\n  }\n\n  // deal with the paths.\n  for (let path of [\n    'loginPath',\n    'signUpPath',\n    'resetPasswordPath',\n    'profilePath',\n    'changePasswordPath',\n    'homeRoutePath'\n  ]) {\n    if (typeof options[path] !== 'undefined') {\n      if (options[path] !== null && typeof options[path] !== 'string') {\n        throw new Error(`Accounts.ui.config: ${path} is not a string or null`);\n      }\n      else {\n        Accounts.ui._options[path] = options[path];\n      }\n    }\n  }\n\n  // deal with redirect hooks.\n  for (let hook of [\n      'onEnrollAccountHook',\n      'onResetPasswordHook',\n      'onVerifyEmailHook',\n      'onSignedInHook',\n      'onSignedOutHook']) {\n    if (options[hook]) {\n      if (typeof options[hook] == 'function') {\n        Accounts.ui._options[hook] = options[hook];\n      }\n      else if (typeof options[hook] == 'string') {\n        Accounts.ui._options[hook] = () => redirect(options[hook]);\n      }\n      else {\n        throw new Error(`Accounts.ui.config: \"${hook}\" not a function or an absolute or relative path`);\n      }\n    }\n  }\n};\n\nexport default Accounts;\n"]},"hash":"e051f8ebb8fa13af190ece967f08e9b2a95cf834"}
